<!DOCTYPE html>
<html class="nojs" lang="en-GB" dir="ltr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>Deploy a Hugo Blog Github Actions – Ramblings of a cloud engineer</title>
<meta name="description" content="Intro Hi folks. Today I thought I show you how you can use Github Actions to deploy a hugo based blog like this one. Let&amp;amp;rsquo;s dive in. Actions What are actions? If you …">
<meta name="created" content="2019-03-19T22:01:00+0100">
<meta name="modified" content="2019-03-19T22:01:00+0100">
<meta name="author" content="hannibal">
<meta name="contact" content="skarslo777@gmail.com">
<meta property="og:site_name" content="Ramblings of a cloud engineer">
<meta property="og:title" content="Deploy a Hugo Blog Github Actions">
<meta property="og:url" content="https://skarlso.github.io/2019/03/19/deploy-hugo-blog-github-actions/">
<meta property="og:type" content="article">
<meta property="og:image" content="https://skarlso.github.io/apple-touch-icon.png">
<meta name="generator" content="Hugo 0.83.1" />
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="theme-color" content="#ffffff">


<link rel="canonical" href="https://skarlso.github.io/2019/03/19/deploy-hugo-blog-github-actions/">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">

<link rel="stylesheet" href="/css/mobile.2ab74aa64785dcab8114959e76ca140cf76207cd85989bc6d4fc3b12f734a09e.css" media="screen">
<link rel="stylesheet" href="/css/styles.934ca64e1cd8b39bd18393dc4fa4788aab68ce041fa7830964c671eed3da2b40.css">
<link rel="stylesheet" href="/css/print.27fc184f8670f41a2690985390779e7b20335a8fadff8fa015cf9417ffe50c36.css" media="print">

<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "headline": "Deploy a Hugo Blog Github Actions",
    "datePublished": "2019-03-19T22:01:00+01:00",
    "dateModified": "2019-03-19T22:01:00+01:00",
    "url" : "https://skarlso.github.io/2019/03/19/deploy-hugo-blog-github-actions/",
    "description": "Intro Hi folks. Today I thought I show you how you can use Github Actions to deploy a hugo based blog like this one. Let\u0026amp;rsquo;s dive in. Actions What are actions? If you …",
    "image" : "https://skarlso.github.io/apple-touch-icon.png",
    "author": {
      "@type": "Person",
      "name": "hannibal"
    },
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https://skarlso.github.io"
    },
    "publisher": {
      "@type": "Organization",
      "name": "Ramblings of a cloud engineer",
      "logo" : {
        "@type": "ImageObject",
        "url": "https://skarlso.github.io/apple-touch-icon.png"
      },
      "url": "https://skarlso.github.io"
    }
  }
</script>

<script src="/js/script-early.min.3b0e641814c87f6a1d6ffa5e7d597f29faa8ce11482541e8801dc34013817c91.js"></script>
<script defer src="/js/lib/umbrella.min.6e17830ccdded0a13b96d6993865b58202bc2ee750e5892a51858ab048b2bebb.js"></script>
<script defer src="/js/mobile.min.abb9438113cb72181ecda30b9375cc0771c7ce2e7354414a7c1296b45cf47135.js"></script>
<script defer src="/js/script.min.a71d161caff0970fa29a345da3bd9b444f629eccf1e4922585879b44f8f30160.js"></script>

<script src="/js/tracking.min.cab571d19167308ad205e765770573e4bae7f3dab20f07533ba563eea84c8202.js"></script>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-69463020-2', 'auto');
	
	ga('send', 'pageview');
}
</script>

</head>

<body class="single-page">
<div class="page layout__page layout__sidebar-second">
<header class="header layout__header">
<a href="/" title="Home" rel="home" class="header__logo"><img src="/images/logo.png" alt="Home" class="header__logo-image"></a>
<h1 class="header__site-name">
<a href="/" title="Home" class="header__site-link" rel="home"><span>Ramblings of a cloud engineer</span></a>
</h1>
<div class="region header__region">
</div>
</header>

<nav class="main-menu layout__navigation">
<h2 class="visually-hidden">Main menu</h2>
<ul class="navbar">
<li><a href="/">Home</a></li>
<li><a href="/blog/" class="active" aria-current="page">Blog</a></li>
</ul>
</nav>


<main class="main layout__main">
<article class="section-blog single-view">
<header>
<h1 class="title title-submitted">Deploy a Hugo Blog Github Actions</h1>
<div class="submitted">
<span class="author" itemprop="author">hannibal</span> - <time class="created-date" datetime="2019-03-19T22:01:00&#43;01:00">19 March, 2019</time>
</div>
</header>
<div class="content">
<h1 id="intro">Intro</h1>
<p>Hi folks.</p>
<p>Today I thought I show you how you can use <a href="https://github.com/features/actions">Github Actions</a> to deploy a hugo based blog like this one.</p>
<p>Let&rsquo;s dive in.</p>
<h1 id="actions">Actions</h1>
<p>What are actions? If you read the above linked document they are basically steps performed in containers based on some events that happened with your repository. Events can be such as pushing, creating a PR or creating/closing an issue etc.</p>
<p>We need an even on a push.</p>
<p>Actions is in beta right now so much of the documentation has some gaps but they are fairly okay. I recommend reading through this one carefully: <a href="https://developer.github.com/actions/">Developer Guide</a>. This describes for example accessing the environment. That is important because we will need to access the generated content from one action in the next action.</p>
<h1 id="dockerfile">Dockerfile</h1>
<p>Each action requires a Dockerfile which will be used to create a container to run this particular action in. The Dockerfile uses LABELS to mark a container. It is recommended to create an ENTRYPOINT in the Dockerfile that can work with CMDs passed in from the action.</p>
<p>For example my pusher container has the ability to push into any repository thanks to using arguments for the entrypoint.sh script.</p>
<p>We&rsquo;ll see that later on.</p>
<h1 id="blog-actions">Blog actions</h1>
<p>Let&rsquo;s look at the two actions in detail which we&rsquo;ll be using.</p>
<h2 id="builder">Builder</h2>
<p>First, we need to build the blog. This is accomplished pretty much the same as I wrote earlier in the travis blog part but with a little extra information.</p>
<p>This is the Dockerfile:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Dockerfile" data-lang="Dockerfile"><span style="color:#66d9ef">FROM</span><span style="color:#e6db74"> golang:latest</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">LABEL</span> <span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Hugo Builder&#34;</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">LABEL</span> <span style="color:#e6db74">&#34;maintainer&#34;</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Gergely Brautigam &lt;gergely@gergelybrautigam.com&gt;&#34;</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">LABEL</span> <span style="color:#e6db74">&#34;version&#34;</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;0.1.0&#34;</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">LABEL</span> <span style="color:#e6db74">&#34;com.github.actions.name&#34;</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Go Builder&#34;</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">LABEL</span> <span style="color:#e6db74">&#34;com.github.actions.description&#34;</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Build a hugo blog&#34;</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">LABEL</span> <span style="color:#e6db74">&#34;com.github.actions.icon&#34;</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;package&#34;</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">LABEL</span> <span style="color:#e6db74">&#34;com.github.actions.color&#34;</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;#E0EBF5&#34;</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">RUN</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  apt-get update <span style="color:#f92672">&amp;&amp;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  apt-get install -y ca-certificates openssl git <span style="color:#f92672">&amp;&amp;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  update-ca-certificates <span style="color:#f92672">&amp;&amp;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  rm -rf /var/lib/apt<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">RUN</span> go get github.com/gohugoio/hugo<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">COPY</span> entrypoint.sh /entrypoint.sh<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">ENTRYPOINT</span> [<span style="color:#e6db74">&#34;/entrypoint.sh&#34;</span>]<span style="color:#960050;background-color:#1e0010">
</span></code></pre></div><p>Pretty simple. The entrypoint script looks like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e">#!/bin/bash
</span><span style="color:#75715e"></span>
set -e
set -x
set -o pipefail

<span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> -z <span style="color:#e6db74">&#34;</span>$GITHUB_WORKSPACE<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span>
  echo <span style="color:#e6db74">&#34;Set the GITHUB_WORKSPACE env variable.&#34;</span>
  exit <span style="color:#ae81ff">1</span>
<span style="color:#66d9ef">fi</span>

<span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> -z <span style="color:#e6db74">&#34;</span>$GITHUB_REPOSITORY<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span>
  echo <span style="color:#e6db74">&#34;Set the GITHUB_REPOSITORY env variable.&#34;</span>
  exit <span style="color:#ae81ff">1</span>
<span style="color:#66d9ef">fi</span>

root_path<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$GITHUB_WORKSPACE<span style="color:#e6db74">&#34;</span>
echo <span style="color:#e6db74">&#34;Root path is: </span><span style="color:#e6db74">${</span>root_path<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
blog_path<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$GITHUB_WORKSPACE<span style="color:#e6db74">/.blog&#34;</span>
echo <span style="color:#e6db74">&#34;Blog path is: </span><span style="color:#e6db74">${</span>blog_path<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
mkdir -p <span style="color:#e6db74">&#34;</span>$blog_path<span style="color:#e6db74">&#34;</span>
mkdir -p <span style="color:#e6db74">&#34;</span>$root_path<span style="color:#e6db74">&#34;</span>
cd <span style="color:#e6db74">&#34;</span>$root_path<span style="color:#e6db74">&#34;</span>
echo <span style="color:#e6db74">&#34;Preparing to build blog&#34;</span>
hugo --theme hermit
echo <span style="color:#e6db74">&#34;Building is done. Copying over generated files&#34;</span>
cp -R public/* <span style="color:#e6db74">&#34;</span>$blog_path<span style="color:#e6db74">&#34;</span>/
echo <span style="color:#e6db74">&#34;Copy is done.&#34;</span>

exit <span style="color:#ae81ff">0</span>
</code></pre></div><p>The interesting parts here are <code>GITHUB_WORKSPACE</code> and <code>GITHUB_REPOSITORY</code>. The workspace is where the repository is located at.</p>
<p>This is the place where we will copy our built blog files. Since this is a mount basically on the local build machine the next action which comes along will see the folder <code>.blog</code>. This is how we pass artifacts between actions.</p>
<p>This action can be found here: <a href="https://github.com/Skarlso/blog-builder">Hugo Blog Builder Action</a>.</p>
<h2 id="publisher">Publisher</h2>
<p>Once the building finishes successfully we can push it to the new location.</p>
<p>Dockerfile is similar to the one above in every regard. Except for the name and that it doesn&rsquo;t need Hugo and the command&hellip;</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Dockerfile" data-lang="Dockerfile"><span style="color:#66d9ef">FROM</span><span style="color:#e6db74"> golang:latest</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">LABEL</span> <span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Hugo Pusher&#34;</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">LABEL</span> <span style="color:#e6db74">&#34;maintainer&#34;</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Gergely Brautigam &lt;gergely@gergelybrautigam.com&gt;&#34;</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">LABEL</span> <span style="color:#e6db74">&#34;version&#34;</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;0.1.0&#34;</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">LABEL</span> <span style="color:#e6db74">&#34;com.github.actions.name&#34;</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Go Pusher&#34;</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">LABEL</span> <span style="color:#e6db74">&#34;com.github.actions.description&#34;</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Push a hugo blog&#34;</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">LABEL</span> <span style="color:#e6db74">&#34;com.github.actions.icon&#34;</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;package&#34;</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">LABEL</span> <span style="color:#e6db74">&#34;com.github.actions.color&#34;</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;#E0EBF5&#34;</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">RUN</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  apt-get update <span style="color:#f92672">&amp;&amp;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  apt-get install -y ca-certificates openssl git <span style="color:#f92672">&amp;&amp;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  update-ca-certificates <span style="color:#f92672">&amp;&amp;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  rm -rf /var/lib/apt<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">COPY</span> entrypoint.sh /entrypoint.sh<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">ENTRYPOINT</span> [<span style="color:#e6db74">&#34;/entrypoint.sh&#34;</span>]<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">CMD</span> [<span style="color:#e6db74">&#34;Skarlso/skarlso.github.io.git&#34;</span>]<span style="color:#960050;background-color:#1e0010">
</span></code></pre></div><p>Why do we require the CMD? Let&rsquo;s take a look at the script.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e">#!/bin/bash
</span><span style="color:#75715e"></span>
set -e
set -x

<span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> -z <span style="color:#e6db74">&#34;</span>$GITHUB_WORKSPACE<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span>
  echo <span style="color:#e6db74">&#34;Set the GITHUB_WORKSPACE env variable.&#34;</span>
  exit <span style="color:#ae81ff">1</span>
<span style="color:#66d9ef">fi</span>

<span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> -z <span style="color:#e6db74">&#34;</span>$GITHUB_REPOSITORY<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span>
  echo <span style="color:#e6db74">&#34;Set the GITHUB_REPOSITORY env variable.&#34;</span>
  exit <span style="color:#ae81ff">1</span>
<span style="color:#66d9ef">fi</span>

setup_git<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
  repo<span style="color:#f92672">=</span>$1
  git config --global user.email <span style="color:#e6db74">&#34;bot@github.com&#34;</span>
  git config --global user.name <span style="color:#e6db74">&#34;Github Actions&#34;</span>
  git init
  echo <span style="color:#e6db74">&#34;Starting to clone blog repository&#34;</span>
  git remote add origin https://<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>PUSH_TOKEN<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>@github.com/<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>repo<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> &gt; /dev/null 2&gt;&amp;<span style="color:#ae81ff">1</span>
  git pull origin master
  echo <span style="color:#e6db74">&#34;Cloning is done&#34;</span>
  ls -l
<span style="color:#f92672">}</span>

commit_website_files<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
  git add .
  git commit -am <span style="color:#e6db74">&#34;Github Action Build </span><span style="color:#e6db74">${</span>GITHUB_SHA<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
<span style="color:#f92672">}</span>

upload_files<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
  git push --quiet --set-upstream origin master
<span style="color:#f92672">}</span>

echo <span style="color:#e6db74">&#34;Beginning publishing workflow&#34;</span>
repo<span style="color:#f92672">=</span>$1
<span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -z <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>repo<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
    echo <span style="color:#e6db74">&#34;Repo must be defined.&#34;</span>
    exit <span style="color:#ae81ff">1</span>
<span style="color:#66d9ef">fi</span>
echo <span style="color:#e6db74">&#34;Using repository </span><span style="color:#e6db74">${</span>repo<span style="color:#e6db74">}</span><span style="color:#e6db74"> to push to&#34;</span>
mkdir /opt/publish <span style="color:#f92672">&amp;&amp;</span> cd /opt/publish
blog_path<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$GITHUB_WORKSPACE<span style="color:#e6db74">/.blog&#34;</span>
echo <span style="color:#e6db74">&#34;Blog is located at: </span><span style="color:#e6db74">${</span>blog_path<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
ls -l <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>blog_path<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
echo <span style="color:#e6db74">&#34;Setting up git&#34;</span>
setup_git <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>repo<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
cp -R <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>blog_path<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>/* .
echo <span style="color:#e6db74">&#34;Copied over generated content from blog path. Committing.&#34;</span>
commit_website_files
echo <span style="color:#e6db74">&#34;Committed. Pushing.&#34;</span>
upload_files
echo <span style="color:#e6db74">&#34;All done.&#34;</span>
exit <span style="color:#ae81ff">0</span>
</code></pre></div><p>Now this is a lot more involved. I&rsquo;m leaving as many echos in here as possible for esae of debugging.</p>
<p>The interesting part in here is the <code>repo=$1</code>. This is why we need CMD specified. But this is what makes this Action a bit more flexible too. It can push anywhere it has access to.</p>
<p>This action can be found here: <a href="https://github.com/Skarlso/blog-publisher">Hugo Blog Publisher Action</a>.</p>
<h2 id="the-workflow-file">The Workflow file</h2>
<p>How does this all fit together? You have to create a workflow file which looks something like this:</p>
<pre><code>workflow &quot;Publish Blog&quot; {
  on = &quot;push&quot;
  resolves = [&quot;blog-publisher&quot;]
}

action &quot;blog-builder&quot; {
  uses = &quot;skarlso/blog-builder@master&quot;
  secrets = [&quot;GITHUB_TOKEN&quot;]
}

action &quot;blog-publisher&quot; {
  uses = &quot;skarlso/blog-publisher@master&quot;
  needs = [&quot;blog-builder&quot;]
  secrets = [&quot;GITHUB_TOKEN&quot;, &quot;PUSH_TOKEN&quot;]
}
</code></pre><p>This is located in your repositroy under <code>.github/main.workdflow</code>. Notice the secrets. GITHUB_TOKEN is created for you by Github. This is a basic token which lets you access the github API. But it can&rsquo;t be used for pushing code. Thus, we need another token. This can be defined under your repository / settings / secrets. Once you have a token, add a new secret called PUSH_TOKEN and&hellip; done.</p>
<p>Everything should be ready to go.</p>
<h2 id="location-of-the-actions">Location of the actions</h2>
<p>Now, I read the doc and should have been possible to have these actions in the repositroy itself. However, I faced some problems with that setup so I ended up having actions in their respectice repository. That&rsquo;s why <code>uses</code> is set up to be <code>skarlso/&lt;action-name&gt;@branch</code>.</p>
<h1 id="conclusion">Conclusion</h1>
<p>On a push now the blog is built and published. If a step fails it won&rsquo;t be published. It&rsquo;s actually a lot faster than my travis build was.</p>
<p>Thank you for reading,</p>
<p>Gergely.</p>


</div>
</article>
</main>


<aside class="sidebar layout__second-sidebar">
<section>
<h4 class="menu"><a href="/blog/" class="active" aria-current="page">Blog</a></h4>
<ul class="menu">
<li><a href="/2021/04/21/readers-digest/">Reader&#39;s Digest 2021-04</a></li>
<li><a href="/2021/03/23/readers-digest/">Reader&#39;s Digest 2021-03</a></li>
<li><a href="/2021/02/01/readers-digest/">Reader&#39;s Digest 2021-01</a></li>
<li><a href="/2020/07/23/kubernetes-deploy-golang-react-apps-separately-part1/">How to deploy a Go (Golang) backend with a React frontend separately on Kubernetes - Part One</a></li>
<li><a href="/2020/05/11/good-code-reviews/">How to do a good code review</a></li>
<li><a href="/2020/02/17/making-spa-refresh-work-with-go-backend/">How to Make SPA refresh work with a Go backend</a></li>
<li><a href="/2019/10/15/kubernetes-cluster-part2/">Using a Kubernetes based Cluster for Various Services with auto HTTPS - Part 2</a></li>
<li><a href="/2019/10/10/practical-go-summary/">Summary of Practical Go workshop from Dave Cheney</a></li>
<li><a href="/2019/10/01/killing-kubernetes-cluster/">How I killed my entire Kubernetes cluster</a></li>
<li><a href="/2019/09/21/kubernetes-cluster/">Using a Kubernetes based Cluster for Various Services with auto HTTPS</a></li>
<li><a href="/2019/09/19/updated-face-recog-drawing/">Updated Face-recog architecture drawing</a></li>
<li><a href="/2019/04/21/efferent-and-afferent-metrics-in-go/">Efferent and Afferent metrics in Go</a></li>
<li><a href="/2019/04/12/living-with-a-parser/">Living with a new Parser for a year</a></li>
<li><a href="/2019/03/19/deploy-hugo-blog-github-actions/" class="active" aria-current="page">Deploy a Hugo Blog Github Actions</a></li>
<li><a href="/2019/03/19/cronohub/">Cronohub: Archive from anywhere to anywhere</a></li>
<li><a href="/2019/03/18/hugo-blog-with-travis-deployment/">Deploy a Hugo Blog with Travis on Git Push</a></li>
<li><a href="/2019/02/17/go-ssh-with-host-key-verification/">Go SSH with Host Key Verification</a></li>
<li><a href="/2018/10/29/go-plugin-tutorial/">Extensive tutorial on go-plugin.</a></li>
<li><a href="/2018/09/17/furnace-plugin-update/">Furnace with a new Plugin System</a></li>
<li><a href="/2018/09/13/gotp/">TOTP generator with account handling for multiple tokens</a></li>
<li><a href="/2018/06/08/fork-updater/">Keep your git forks updated all the time</a></li>
<li><a href="/2018/03/15/kubernetes-distributed-application/">Kubernetes distributed application deployment with sample Face Recognition App</a></li>
<li><a href="/2018/02/06/go-budapest-meetup/">Go Budapest Meetup</a></li>
<li><a href="/2018/01/23/nginx-certbot-ansible/">Ansible &#43; Nginx &#43; LetsEncrypt &#43; Wiki &#43; Nagios</a></li>
<li><a href="/2018/01/13/furnace-massive-update/">Huge Furnace Update</a></li>
<li><a href="/2017/12/04/commit-build-deploy/">Commit-Build-Deploy With AWS CodeBuild and Lambda</a></li>
<li><a href="/2017/11/06/furnace-ikea-manual/">Furnace Ikea Manual</a></li>
<li><a href="/2017/09/03/furnace-binaries/">Furnace Binaries</a></li>
<li><a href="/2017/05/31/notetaking/">Notetaking</a></li>
<li><a href="/2017/05/28/replace-eval-with-object-send-and-a-parser/">Replacing Eval with Object.send and a self written Parser</a></li>
<li><a href="/2017/04/16/building-furnace-part-4/">Furnace - The building of an AWS CLI Tool for CloudFormation and CodeDeploy - Part 4</a></li>
<li><a href="/2017/03/22/building-furnace-part-3/">Furnace - The building of an AWS CLI Tool for CloudFormation and CodeDeploy - Part 3</a></li>
<li><a href="/2017/03/19/building-furnace-part-2/">Furnace - The building of an AWS CLI Tool for CloudFormation and CodeDeploy - Part 2</a></li>
<li><a href="/2017/03/17/test-new-hugo/">Testing new Hugo if posts are generated properly</a></li>
<li><a href="/2017/03/16/building-furnace-part-1/">Furnace - The building of an AWS CLI Tool for CloudFormation and CodeDeploy - Part 1</a></li>
<li><a href="/2017/03/03/images-on-old-posts/">Images on older posts</a></li>
<li><a href="/2017/02/15/how-to-https-with-hugo-letsencrypt-haproxy/">How to HTTPS with Hugo LetsEncrypt and HAProxy</a></li>
<li><a href="/2016/11/02/google-signin-with-go-part2/">How to do Google Sign-In with Go - Part 2</a></li>
<li><a href="/2016/10/06/rscrap-ruby-scraping-with-cronjob-scripts/">RScrap scraper</a></li>
<li><a href="/2016/09/17/simple-hometheater-with-remote-and-flirc/">Budget Home Theather with a Headless Raspberry Pi and Flirc for Remote Controlling</a></li>
<li><a href="/2016/08/19/always-go-with-bytes/">Always Go with []byte</a></li>
<li><a href="/2016/08/16/never-changing-regex/">Global variable for never changing regex</a></li>
<li><a href="/2016/08/13/drupal-missing-toolbar-and-settings-not-saving/">Drupal missing ToolBar and settings not saving</a></li>
<li><a href="/2016/07/28/jenkins-best-practices/">Jenkins Best Practices Talk</a></li>
<li><a href="/2016/07/12/ruby-sieve/">Ruby Sieve</a></li>
<li><a href="/2016/07/12/simple-hook-to-rid-of-trouble/">Simple hook to rid of trouble</a></li>
<li><a href="/2016/06/12/google-signin-with-go/">How to do Google sign-in with Go</a></li>
<li><a href="/2016/04/17/minecraft-server-aws-s3-backup-part2/">Minecraft world automatic backup to AWS S3 bucket - Part 2 (Custom functions)</a></li>
<li><a href="/2016/04/16/minecraft-server-aws-s3-backup/">Minecraft world automatic backup to AWS S3 bucket</a></li>
<li><a href="/2016/03/29/minecraft-server-with-docker-and-osx/">Minecraft Server with Docker on OSX &#43; Mods</a></li>
<li><a href="/2016/03/09/wercker-fixed/">Wercker Fixed</a></li>
<li><a href="/2016/03/04/wercker-test-2/">Wercker Test</a></li>
<li><a href="/2016/02/10/hugo-autodeploy-with-wercker/">Hugo Autodeploy with Wercker and Github - Pages</a></li>
<li><a href="/2016/02/10/wercker-test/">Wercker Test</a></li>
<li><a href="/2016/02/02/doing-cors-in-go-with-gin-and-json/">Doing CORS in Go with Gin and JSON</a></li>
<li><a href="/2016/01/22/my-journey-in-advent-of-code/">My Journey in advent of code</a></li>
<li><a href="/2016/01/05/improving-performance-with-byte-slice-and-int-map/">Improving performance with byte slice and int map</a></li>
<li><a href="/2016/01/01/byte-arrays-and-channels/">Byte arrays and Channels</a></li>
<li><a href="/2015/12/29/use-byte-array-instead-of-strings/">Use Byte Array Instead of Strings</a></li>
<li><a href="/2015/12/29/use-byte-slice-instead-of-strings/">Use Byte Slice Instead of Strings</a></li>
<li><a href="/2015/12/23/recursive-freq-count/">Recursive Letter Frequency Count</a></li>
<li><a href="/2015/12/08/go-development-environment/">Go Development Environment</a></li>
<li><a href="/2015/12/07/welcome-to-my-new-blog/">Welcome To My New Blog</a></li>
<li><a href="/2015/11/20/go-jira-api-client/">Go JIRA API client</a></li>
<li><a href="/2015/11/15/the-one-hundred-day-github-challenge/">The One Hundred Day GitHub Challenge</a></li>
<li><a href="/2015/11/09/go-progress-quest/">Go Progress Quest</a></li>
<li><a href="/2015/10/26/kill-a-program-on-connecting-to-a-specific-wifi-osx/">Kill a Program on Connecting to a specific WiFi – OSX</a></li>
<li><a href="/2015/10/15/circular-buffer-in-go/">Circular buffer in Go</a></li>
<li><a href="/2015/10/15/jenkins-job-dsl-and-groovy-goodness/">Jenkins Job DSL and Groovy goodness</a></li>
<li><a href="/2015/10/04/datamunger-kata-with-go/">DataMunger Kata with Go</a></li>
<li><a href="/2015/10/02/how-to-aggregate-tests-with-jenkins-with-aggregate-plugin-on-non-relating-jobs/">How to Aggregate Tests with Jenkins with Aggregate Plugin on non-relating jobs</a></li>
<li><a href="/2015/09/07/i-used-to-have-great-ideas-on-the-toilet-but-i-no-longer-do/">I used to have great ideas on the toilet, but I no longer do.</a></li>
<li><a href="/2015/07/30/sieve-of-eratosthenes-in-go/">Sieve of Eratosthenes in Go</a></li>
<li><a href="/2015/07/22/quick-tip-for-debugging-headless-locally/">Quick Tip for Debugging Headless Locally</a></li>
<li><a href="/2015/07/19/converting-numbers-into-string-representations/">Converting numbers into string representations</a></li>
<li><a href="/2015/07/16/selenium-testing-with-packer-and-vagrant/">Selenium Testing with Packer and Vagrant</a></li>
<li><a href="/2015/07/15/bitwise-operator/">Bitwise &amp; Operator</a></li>
<li><a href="/2015/07/01/packer-0-8-1/">Packer 0.8.1.</a></li>
<li><a href="/2015/06/30/powershell-can-also-be-nice-or-installing-java-silently-and-waiting/">Powershell can also be nice -Or Installing Java silently and waiting</a></li>
<li><a href="/2015/06/27/the-packer-the-windows-and-the-vagrant-box/">The Packer, The Windows, and the Vagrant box</a></li>
<li><a href="/2015/06/06/docker-ruby-lotus-go-cd/">Docker &#43; Java &#43; Vagrant&#43; GO.CD</a></li>
<li><a href="/2015/05/21/setting-up-a-new-laptop-with-puppet/">Setting up a new Laptop with Puppet</a></li>
<li><a href="/2015/05/19/busy-building-the-future/">Busy building the future</a></li>
<li><a href="/2015/04/21/django-rpg-part-3/">Django – RPG – Part 3</a></li>
<li><a href="/2015/04/12/django-rpg-part-2/">Django – RPG – Part 2</a></li>
<li><a href="/2015/04/10/django-rpg-2/">Django – RPG – Part 1</a></li>
<li><a href="/2015/04/10/small-python-gui-to-calculate-lever-distance/">Small Python GUI to Calculate Lever Distance</a></li>
<li><a href="/2015/03/15/python-and-my-math-commitment/">Python and my Math commitment</a></li>
<li><a href="/2015/03/02/sphere-judge-online-python-kivy-android-app-part-2/">Sphere Judge Online – Python Kivy Android app – Part 2</a></li>
<li><a href="/2015/02/26/sphere-judge-online-python-kivy-android-app/">Sphere Judge Online – Python Kivy Android app</a></li>
<li><a href="/2015/02/08/why-lock-picking-is-like-testing/">Why Lock Picking is like Testing</a></li>
<li><a href="/2015/02/01/building-an-rpg-app-with-meteor-part-one-the-struggle/">Building an RPG App with Meteor – Part One – The struggle</a></li>
<li><a href="/2015/01/29/javascript-web-framework-meteor/">JavaScript Web Framework – Meteor</a></li>
<li><a href="/2015/01/28/when-cucumber-goes-wrong/">When cucumber goes wrong</a></li>
<li><a href="/2015/01/27/from-zero-to-hundred-in-four-seconds/">From Zero to Hundred in Four seconds</a></li>
<li><a href="/2015/01/26/why-testers-are-like-scientists/">Why Testers are, like scientists</a></li>
<li><a href="/2014/11/15/why-the-expressiveness-of-your-tests-is-important-part-one/">Why the expressiveness of your Tests is important – Part One</a></li>
<li><a href="/2014/11/07/updating-all-jenkins-jobs-via-jenkins-api-python/">Updating All Jenkins Jobs Via Jenkins API – Python</a></li>
<li><a href="/2014/10/23/the-seven-guidelines-of-context-driven-testing/">The seven Principles of Context Driven Testing – Mind Map</a></li>
<li><a href="/2014/08/25/python-course-review/">Python Course Review</a></li>
<li><a href="/2014/05/31/five-reasons-why-a-tester-should-learn-sql/">Five reasons why a tester should learn SQL</a></li>
<li><a href="/2014/05/26/tdd-is-dead-not-really/">TDD is Dead – Not really</a></li>
<li><a href="/2014/05/23/five-reasons-why-a-front-end-tester-should-learn-javascript/">Five reasons why a front-end tester should learn Javascript</a></li>
<li><a href="/2014/05/20/note-taking-what-when-how-often/">Note taking what when how often</a></li>
<li><a href="/2014/05/18/using-chrome-search-engine-multiple-search-params/">Using Chrome Search Engine – Multiple Search Params</a></li>
<li><a href="/2014/05/16/how-i-started-running/">How I started Running</a></li>
<li><a href="/2014/04/13/how-the-past-influences-the-present/">How the past influences the present</a></li>
<li><a href="/2014/02/19/example-when-to-use-the-strategy-pattern/">Example when to use the Strategy Pattern</a></li>
<li><a href="/2014/02/13/how-to-write-a-blog-why-long-posts-rarely-work/">How to write a blog – Why long posts rarely work</a></li>
<li><a href="/2014/02/11/how-to-check-content-header-on-unknown-number-of-items-python/">How to check content header on unknown number of items – Python</a></li>
<li><a href="/2014/02/11/the-method-of-loci-and-how-it-works-for-me/">The method of Loci and how it works for me</a></li>
<li><a href="/2014/02/10/why-you-should-learn-using-vim/">Why you should learn using Vim</a></li>
<li><a href="/2014/02/09/why-does-it-matter-if-i-sit-in-an-office-or-in-a-park/">Why does it matter if I sit in an office or in a park</a></li>
<li><a href="/2014/02/04/how-i-recruit-why-tool-requirements-are-stupid/">How I recruit – Why tool requirements are stupid</a></li>
<li><a href="/2013/11/02/why-you-should-care-about-the-quality-of-your-test-code/">Why you should care about the quality of your test code</a></li>
<li><a href="/2013/10/11/diary-of-a-bit/">Diary of a Bit</a></li>
<li><a href="/2013/08/26/low-tech-why-having-less-will-fell-more/">Low Tech – Why having less will fell more</a></li>
<li><a href="/2013/07/31/why-not-to-automate-everything/">Why not to automate everything…</a></li>
<li><a href="/2013/06/24/sublime-text-5/">Sublime text</a></li>
<li><a href="/2013/04/18/cucumber-jvm-and-afterall/">Cucumber-Jvm And @AfterAll</a></li>
<li><a href="/2013/04/15/cucumber-test-name-and-tags-on-feature/">Cucumber Test Name and Tags on Feature</a></li>
<li><a href="/2013/04/11/groovy-and-grails-course-summary/">Groovy and Grails course summary</a></li>
<li><a href="/2013/04/11/my-history-in-testing/">My history in testing</a></li>
<li><a href="/2013/01/31/its-all-about-human-interaction/">It’s all about human interaction.</a></li>
<li><a href="/2013/01/21/what-you-really-need-to-become-a-testing-expert/">What you really need to know to become a Testing Expert</a></li>
<li><a href="/2013/01/04/from-chaos-there-shall-be-order/">From Chaos There Shall Be Order</a></li>
<li><a href="/2012/12/12/methodologies-thought-patterns-lies/">Methodologies, Thought Patterns, Lies</a></li>
<li><a href="/2012/12/01/teas-testing-exploration-adventure-session/">TEAS: Testing Exploration Adventure Session</a></li>
<li><a href="/2012/10/09/how-to-eliminate-a-parameter-boom/">How to eliminate a parameter boom</a></li>
<li><a href="/2012/09/30/89/">Coderetreat London</a></li>
<li><a href="/2012/09/20/what-my-brain-is-up-to-the-whole-day/">What my brain is up to the whole day…</a></li>
<li><a href="/2012/09/09/learning-programming-with-a-visual-mind/">Learning programming with a visual mind</a></li>
<li><a href="/2012/07/12/tdd-and-game-of-life/">TDD and Game of Life</a></li>
<li><a href="/2012/06/28/journey-into-an-unknown-system/">Journey into an unknown system</a></li>
<li><a href="/2012/06/26/solution-to-wrap-kata/">Solution to Wrap Kata</a></li>
<li><a href="/2012/06/18/how-to-read-a-professional-book-for-slow-learners/">How to read a professional book for slow learners</a></li>
<li><a href="/2012/06/13/dont-throw-exception/">Don’t throw Exception</a></li>
<li><a href="/2012/06/13/how-to-write-a-professional-blog/">How to write a professional blog</a></li>
<li><a href="/2012/06/13/making-your-code-understandable/">Making your code understandable</a></li>
<li><a href="/2012/04/11/getting-dual-card-to-work-on-ubuntu-12-04/">Getting Dual Card to work on Ubuntu 12.04.</a></li>
<li><a href="/2012/03/04/jms-connection-setup-and-framework/">JMS Connection setup and Framework</a></li>
<li><a href="/2012/02/27/configuration/">Configuration</a></li>
<li><a href="/2012/02/26/hello-and-welcome/">Hello and welcome</a></li>
<li><a href="/2012/02/26/testing-code-tag/">Testing ‘code’ tag.</a></li>
</ul>
</section>
</aside>
<footer class="footer layout__footer">
<p><!-- raw HTML omitted --></p>
<p>Powered by <a href="https://gohugo.io/">Hugo</a> and the <a href="https://github.com/frjo/hugo-theme-zen">Zen theme</a>.</p>

</footer>
</div>
<div class="mobile-nav" dir="ltr">
  <div class="mobile-nav__cover"></div>
  <a href="#navigation" class="mobile-nav__toggle" aria-haspopup="true" role="button">Menu</a>
  <div class="mobile-nav__sheet">
    <div class="mobile-nav__region">
    
    </div>
    <nav class="mobile-nav__main-menu">
    <h2 class="visually-hidden">Main menu</h2>
    <ul class="mobile-nav__navbar">
    <li><a href="/">Home</a></li>
    <li><a href="/blog/" class="active" aria-current="page">Blog</a></li>
    </ul>
    </nav>
  </div>
</div>
</body>
</html>
