<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>Cucumber-Jvm And @AfterAll :: Ramblings of a cloud engineer</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="Hey folks.
I find out something new about cucumber-jvm every day.
If you want something that is executed after all of the tests have finished you must use the Java shutdownHook. It&amp;#8217;s simple really you add in a block of code that can run right before the JVM quits. I know I know&amp;#8230; It sounds awful but I found out that this is the actual way of doing this with java / cucumber."/>
<meta name="keywords" content=""/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="https://skarlso.github.io/2013/04/18/cucumber-jvm-and-afterall/" />


<link rel="stylesheet" href="https://skarlso.github.io/assets/style.css">

  <link rel="stylesheet" href="https://skarlso.github.io/assets/green.css">



<link rel="stylesheet" href="https://skarlso.github.io/style.css">


<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://skarlso.github.io/img/apple-touch-icon-144-precomposed.png">

  <link rel="shortcut icon" href="https://skarlso.github.io/img/favicon/green.png">



<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Cucumber-Jvm And @AfterAll :: Ramblings of a cloud engineer — " />
<meta name="twitter:description" content="Hey folks.
I find out something new about cucumber-jvm every day.
If you want something that is executed after all of the tests have finished you must use the Java shutdownHook. It&amp;#8217;s simple really you add in a block of code that can run right before the JVM quits. I know I know&amp;#8230; It sounds awful but I found out that this is the actual way of doing this with java / cucumber." />
<meta name="twitter:site" content="https://skarlso.github.io/" />
<meta name="twitter:creator" content="hannibal" />
<meta name="twitter:image" content="">


<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Cucumber-Jvm And @AfterAll :: Ramblings of a cloud engineer — ">
<meta property="og:description" content="Hey folks.
I find out something new about cucumber-jvm every day.
If you want something that is executed after all of the tests have finished you must use the Java shutdownHook. It&amp;#8217;s simple really you add in a block of code that can run right before the JVM quits. I know I know&amp;#8230; It sounds awful but I found out that this is the actual way of doing this with java / cucumber." />
<meta property="og:url" content="https://skarlso.github.io/2013/04/18/cucumber-jvm-and-afterall/" />
<meta property="og:site_name" content="Cucumber-Jvm And @AfterAll" />
<meta property="og:image" content="">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">
<meta property="article:section" content="java" /><meta property="article:section" content="problem solving" /><meta property="article:section" content="testing" />
<meta property="article:published_time" content="2013-04-18 00:00:00 &#43;0000 UTC" />







</head>
<body class="">
<div class="container">
  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="https://skarlso.github.io/">
  <div class="logo">
    Terminal
  </div>
</a>

    </div>
    <div class="menu-trigger">menu</div>
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="https://skarlso.github.io/">Home</a></li>
        
      
        
          <li><a href="https://skarlso.github.io/blog/">Blog</a></li>
        
      
        
          <li><a href="https://skarlso.github.io/categories/">Categories</a></li>
        
      
    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="https://skarlso.github.io/">Home</a></li>
      
    
      
        <li><a href="https://skarlso.github.io/blog/">Blog</a></li>
      
    
      
        <li><a href="https://skarlso.github.io/categories/">Categories</a></li>
      
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
  <div class="post">
    <h1 class="post-title"><a href="https://skarlso.github.io/2013/04/18/cucumber-jvm-and-afterall/">Cucumber-Jvm And @AfterAll</a></h1>
    <div class="post-meta">
      <span class="post-date">
        2013-04-18
      </span>
      <span class="post-author">:: hannibal</span>
    </div>

    
      <span class="post-tags">
        
          #<a href="https://skarlso.github.io/tags/cucumber-jm">cucumber-jm</a>&nbsp;
        
      </span>
    

    

    <div class="post-content">
      <p>Hey folks.</p>

<p>I find out something new about cucumber-jvm every day.</p>

<p>If you want something that is executed after all of the tests have finished you must use the Java shutdownHook. It&#8217;s simple really you add in a block of code that can run right before the JVM quits. I know I know&#8230; It sounds awful but I found out that this is the actual way of doing this with java / cucumber.</p>

<p>Anyways&#8230;</p>

<p>Here is something to do when all of your test quit-&gt;</p>

<div class="wp_syntax">
  <table>
    <tr>
      <td class="code">
        <pre class="java" style="font-family:monospace;">    <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">static</span> <span style="color: #000066; font-weight: bold;">void</span> attachShutDownHook<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
        <span style="color: #003399;">Runtime</span>.<span style="color: #006633;">getRuntime</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>.<span style="color: #006633;">addShutdownHook</span><span style="color: #009900;">&#40;</span><span style="color: #000000; font-weight: bold;">new</span> <span style="color: #003399;">Thread</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
            @Override
            <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000066; font-weight: bold;">void</span> run<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
                <span style="color: #003399;">Properties</span> properties <span style="color: #339933;">=</span> <span style="color: #003399;">System</span>.<span style="color: #006633;">getProperties</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
                <span style="color: #003399;">String</span> filename <span style="color: #339933;">=</span> properties.<span style="color: #006633;">getProperty</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">"filename"</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
                <span style="color: #003399;">String</span> path <span style="color: #339933;">=</span> properties.<span style="color: #006633;">getProperty</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">"path"</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
                List<span style="color: #339933;">&lt;</span>Story<span style="color: #339933;">&gt;</span> stories <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> ArrayList<span style="color: #339933;">&lt;&gt;</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
                Path file <span style="color: #339933;">=</span> Paths.<span style="color: #006633;">get</span><span style="color: #009900;">&#40;</span>path <span style="color: #339933;">+</span> filename<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
                <span style="color: #000000; font-weight: bold;">try</span> <span style="color: #009900;">&#123;</span>
                    <span style="color: #000000; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>Files.<span style="color: #006633;">exists</span><span style="color: #009900;">&#40;</span>file<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
                        List<span style="color: #339933;">&lt;</span>String<span style="color: #339933;">&gt;</span> lines <span style="color: #339933;">=</span> Files.<span style="color: #006633;">readAllLines</span><span style="color: #009900;">&#40;</span>file, Charset.<span style="color: #006633;">defaultCharset</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
                        <span style="color: #000000; font-weight: bold;">for</span> <span style="color: #009900;">&#40;</span><span style="color: #003399;">String</span> line <span style="color: #339933;">:</span> lines<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
                            <span style="color: #666666; font-style: italic;">//add file lines to a report here</span>
                        <span style="color: #009900;">&#125;</span>
                    <span style="color: #009900;">&#125;</span>
                <span style="color: #009900;">&#125;</span> <span style="color: #000000; font-weight: bold;">catch</span> <span style="color: #009900;">&#40;</span><span style="color: #003399;">IOException</span> e<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
                    logger.<span style="color: #006633;">error</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">"Exception occurred: "</span> <span style="color: #339933;">+</span> e.<span style="color: #006633;">getLocalizedMessage</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
                <span style="color: #009900;">&#125;</span>
                    <span style="color: #666666; font-style: italic;">//send report to a remote location here</span>
                    <span style="color: #666666; font-style: italic;">//since this is a shutdown hook this should take only a few seconds.</span>
            <span style="color: #009900;">&#125;</span>
        <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
        logger.<span style="color: #006633;">infor</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">"Shut Down Hook Attached."</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    <span style="color: #009900;">&#125;</span></pre>
      </td>
    </tr>
  </table>
</div>

<p>So there you go. You would need to call this in a @BeforeClass to have it attached. This is a small hook attached after each test has run which would submit a report built up from a file. Why not use a listener or a custom report generator or whatever? Because maybe you have the report done in a remote place where you need to place a csv file which will be available to everybody to look at. And you want the report to be sent and generated dynamically. Or you have some clean up to do after your suit is done.</p>

<p>In ruby the @AfterAll is actually equivalent to this which in ruby land would be at_exit.</p>

<p>For example:</p>

<div class="wp_syntax">
  <table>
    <tr>
      <td class="code">
        <pre class="ruby" style="font-family:monospace;">  <span style="color:#CC0066; font-weight:bold;">at_exit</span> <span style="color:#9966CC; font-weight:bold;">do</span>
    <span style="color:#008000; font-style:italic;"># Global teardown</span>
    TempFileManager.<span style="color:#9900CC;">clean_up</span>
  <span style="color:#9966CC; font-weight:bold;">end</span></pre>
      </td>
    </tr>
  </table>
</div>

<p>So there it is. Hope this helped.</p>

<p>Cheers,</p>

<p>And as always,</p>

<p>Have a nice day!</p>

<p>G.</p>

    </div>
    
      <div class="pagination">
        <div class="pagination__title">
          <span class="pagination__title-h"></span>
          <hr />
        </div>
        <div class="pagination__buttons">
          
            <span class="button previous">
              <a href="https://skarlso.github.io/2013/06/24/sublime-text-5/">
                <span class="button__icon">←</span>
                <span class="button__text">Sublime text</span>
              </a>
            </span>
          
          
            <span class="button next">
              <a href="https://skarlso.github.io/2013/04/15/cucumber-test-name-and-tags-on-feature/">
                <span class="button__text">Cucumber Test Name and Tags on Feature</span>
                <span class="button__icon">→</span>
              </a>
            </span>
          
        </div>
      </div>
    
  </div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2019 Powered by <a href="http://gohugo.io">Hugo</a></span>
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
    
  </div>
</footer>

<script src="https://skarlso.github.io/assets/main.js"></script>
<script src="https://skarlso.github.io/assets/prism.js"></script>

  
</div>

</body>
</html>
