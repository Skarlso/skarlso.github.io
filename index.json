[{"content":"Digital and analog notes together This fight is as old as time itself. Okay, maybe not that old. But as soon as viable digital note-taking tools appeared it was on. Since then, many solutions that live together have appeared. PKM tools like Second Brain running hand-in-hand with Zettelkasten or BuJo have opened my eyes to combining them in a way that makes the outcome more powerful than each alone would be.\nI\u0026rsquo;m going to write down a day of mine using these methods together and show you my journey.\nStart of the day There are many benefits to note-taking by hand. It has been proven countless times that it increases creativity, forces deliberate thinking because of the slow writing process and removes any distractions that you would get from the digital gizmo you are tapping along on.\nUltimately it comes down to preference of course. So, let me paint you a picture of most of my mornings.\nMost weekdays, I wake up at 6 AM (this might vary for you). It\u0026rsquo;s a good time to start since, usually, the kids have to go to school on time. It also leaves me some time to get ready, eat, drink coffee and do my morning routine.\nMorning Routine I like the \u0026ldquo;distraction-free\u0026rdquo; part of the paper. I eat my meal, I talk to my wife, then make myself a good cup of coffee and sit down to plan my day. I take out my journal and favorite pen and just start doing some planning. I\u0026rsquo;m using BuJo for this. Nothing fancy. I don\u0026rsquo;t draw elaborate artsy things. A simple monthly planner. Monthly TODOs and events. Then come the days. I start by writing out all the tasks from yesterday that I didn\u0026rsquo;t manage to finish and think about their importance.\nThen I\u0026rsquo;ll write out the new ones that might have occurred to me during the night. Once done, I\u0026rsquo;ll finish up by clearing up the previous day\u0026rsquo;s collection notes. I write a loose collection note because\u0026hellip; We\u0026rsquo;ll get to that.\nThis routine is more than just writing down tasks. I could do that in a TODO app, sure. But a TODO app is way too fast. I type fast even on a mobile phone. I just hemorrhage it out without second thought. When I\u0026rsquo;m writing it out of paper it makes me think more as I write down the words. Another thing is that it makes it REAL. In a TODO app ( I use Obsidian ) they sort of tend to disappear. They aren\u0026rsquo;t that tangible. It\u0026rsquo;s easy to get them out of my mind. My notebook is always next to me, open for the latest task/day. This makes it real. Sure, my phone is next to me as well. But it\u0026rsquo;s off most of the time. Thus, when I glance at it, there is nothing. Therefore everything is okay, right?\nAlso, this morning routine helps me to have a clear picture of how this day needs to go for me. Which gives me a sense of purpose. That is always nice.\nDuring the day This is where the fun begins. During the day, I would mostly use my PKM. I\u0026rsquo;m following Tiago Forte\u0026rsquo;s Second Brain practice with PARA(Projects, Archive, Resource, Areas) folders. It worked well for me. As Sascha over at Zettelkasten described it, the important things are on the surface. They are immediate and visible. I don\u0026rsquo;t have to care about anything else other than the projects I\u0026rsquo;m working on. Which might be a travel I\u0026rsquo;m planning or a work-related item I\u0026rsquo;m coding up.\nThis is a general overview of my Obsidian TODOs: I, usually, take notes in Obsidian. This happens in the ongoing project\u0026rsquo;s note. I create notes haphazardly throughout the day about anything and tag them. Then, at the end of the day, I cleared them out and put them into the right sections. Area or Resource. This is my Inbox.\nAt night At the end of the day, I would go over my notebook\u0026rsquo;s pages to see if I can still cross out anything or if I\u0026rsquo;m done for the day. Sometimes I\u0026rsquo;ll forget to do this when I\u0026rsquo;m exhausted. But it\u0026rsquo;s fine, because the next day morning, I will do this anyways.\nThinking on paper So what am I doing with my notebook? Most of the time, I think on paper. Thinking on paper helps a lot with Focusing Effort. I capitalize this because it\u0026rsquo;s important. When I\u0026rsquo;m in thinking mode, I want to focus. I want zero distractions, zero clicking, zero everything. Just me, a pen and paper. It\u0026rsquo;s faster to draw anything. It\u0026rsquo;s faster to scribble, draw boxes make meaningful connections. The slow writing makes me think. Analyze. Understand. Gather follow-up questions.\nI tried iPads for a while. But again, it\u0026rsquo;s not real. It\u0026rsquo;s all digital. I like drawing on an iPad, I use it for this blog from time to time. And for fun. But thinking is a different thing. I need something tangible.\nI even write out code from time to time on paper. Just fast stuff. Nothing fancy. Probably fails syntax checks. I don\u0026rsquo;t care. I just need to get it out of my head.\nAnother thing is tracking tasks. Sometimes I duplicate them in Obsidian as you can see from the image. I plan them out on paper and then transcribe them to Obsidian. But from time to time I stop doing that and I go all out on paper. I, usually, transcribe them if I want to tie them to a project.\nCrossing of tasks The satisfaction of crossing out a task on paper releases 100000 times more dopamine in my brain than ticking a box in Obsidian. You might think that, okay, you prefer paper tasks. And you would probably be mostly right. However. This has the added benefit that because I enjoy it so much, I\u0026rsquo;m more motivated to DO the thing just to get that rush of crossing out the task. Every tiny bit of boost helps when doing chores. Be that around the house, for the kids, work or personal projects; or just life in general.\nColors I like colorful things. From the image, you can see that I\u0026rsquo;m trying to apply some emojis to tasks to make them stand out or to be more interesting. But honestly, nothing ( for me at least ) beats some colors on the tasks, or some small personalized scribble on the paper next to a task to make it more significant or to stand out. Or just to make it plain more interesting to look at! The more I look at it, the more ingrained it will be and the more likely that I will do the thing!\nIndexes vs Search I\u0026rsquo;m using an index in my notebook for all relevant things. I even have tags in my notebook. How does that look like you might wonder? Super simple. ( remember I like keeping things simple ). At the beginning of the notebook, a couple of pages are left empty. There, I will gather all tags that I come up with in this notebook. ( I tried to be consistent with previous notebooks ). Then, I just keep putting page numbers next to it on which I mentioned this tag. Simple. For example, a tag like #go:\nPage 1: #go: 1, 5, 34, 78\nSometimes I also write a tiny bit of context next to the number. Maybe something like tutorial, blog, idea\u0026hellip; Anything that would give me some incentive to look at it later.\nFurther, my index contains main concepts, days maybe, projects and monthly calendar locations. Sometimes, I\u0026rsquo;ll also write some interesting tid-bit on it.\nIn Obsidian, I also use tags. Plus global search and the PARA folder structure help me find anything I want. I\u0026rsquo;m also using Zettelkasten to refine my learning process. I could summarize it like this:\nI use paper to track and think I use Obsidian to organize and collect information I use Zettelkasten to integrate, understand analyze and digest the collected information I won\u0026rsquo;t lie, this requires work. Sometimes a LOT of work. And a lot of reading. But I enjoy it. I get a lot of this system. I get to track things, find things, draw things, analyze things and understand things.\nConclusion I hope this makes sense dear reader. I combine all of these things to make a perfect system for me. I took the things from each system and mashed them together. I like the outcome. Do you?\nAnd thank you for taking the time to go over it. Any questions, I\u0026rsquo;m happy to answer in the comments.\nThank you for reading!\nGergely.\n","permalink":"https://skarlso.github.io/2023/07/28/digital-and-analog-notes-together/","summary":"Digital and analog notes together This fight is as old as time itself. Okay, maybe not that old. But as soon as viable digital note-taking tools appeared it was on. Since then, many solutions that live together have appeared. PKM tools like Second Brain running hand-in-hand with Zettelkasten or BuJo have opened my eyes to combining them in a way that makes the outcome more powerful than each alone would be.","title":"Digital and Analog notes together"},{"content":"Adding a certificate to a GitHub runner Imagine having a project where you have a server that you would like to run with TLS. Let\u0026rsquo;s say, you want to run a Docker registry in a cluster using TLS. You need the generated certificate\u0026rsquo;s root certificate in the trust store of the GitHub action runner.\nThis is simple with mkcert.\nThe action is simple:\nname: tests on: pull_request: paths-ignore: - \u0026#39;CODE_OF_CONDUCT.md\u0026#39; - \u0026#39;README.md\u0026#39; - \u0026#39;Contributing.md\u0026#39; workflow_call: push: branches: - main permissions: contents: read # for actions/checkout to fetch code jobs: run-test-suite: runs-on: ubuntu-latest steps: - name: Checkout uses: actions/checkout@v3 - name: Setup Go uses: actions/setup-go@v3 with: go-version-file: \u0026#39;${{ github.workspace }}/go.mod\u0026#39; - name: Restore Go cache uses: actions/cache@v3 with: path: /home/runner/work/_temp/_github_home/go/pkg/mod key: ${{ runner.os }}-go-${{ hashFiles(\u0026#39;**/go.sum\u0026#39;) }} restore-keys: | ${{ runner.os }}-go- - name: Run e2e run: make e2e This is nothing fancy. The fancy thing is coming from the make e2e part.\nFirst, we make sure we have mkcert:\nMKCERT ?= $(LOCALBIN)/mkcert MKCERT_VERSION ?= v1.4.4 ... .PHONY: mkcert mkcert: $(MKCERT) $(MKCERT): $(LOCALBIN) curl -L \u0026#34;https://github.com/FiloSottile/mkcert/releases/download/$(MKCERT_VERSION)/mkcert-$(MKCERT_VERSION)-$(UNAME)-amd64\u0026#34; -o $(LOCALBIN)/mkcert chmod +x $(LOCALBIN)/mkcert Then, let\u0026rsquo;s add a target which we\u0026rsquo;ll call before the test is called:\n.PHONY: generate-developer-certs generate-developer-certs: mkcert ./hack/create_developer_certificate_secrets.sh Lastly, put this as a dependency on our test target:\n.PHONY: e2e e2e: generate-developer-certs test-summary-tool ## Runs e2e tests $(GOTESTSUM) --format testname -- -count=1 -tags=e2e ./e2e That\u0026rsquo;s all the setup we need in the GitHub action workflow part. Now, let\u0026rsquo;s take a look at the magic:\n#!/usr/bin/env bash # You can ignore this. path=$(pwd) if [[ \u0026#34;${path}\u0026#34; == *hack* ]]; then echo \u0026#34;This script is intended to be executed from the project root.\u0026#34; exit 1 fi if [ \u0026#34;$(kubectl get secret -n ocm-system registry-certs)\u0026#34; ]; then echo \u0026#34;secret already exist, no need to re-run\u0026#34; exit 0 fi echo \u0026#34;generating developer certificates and kubernetes secrets\u0026#34; # Set up certificate paths CAROOT=./hack/certs ./bin/mkcert -install certPath=\u0026#34;./hack/certs/cert.pem\u0026#34; keyPath=\u0026#34;./hack/certs/key.pem\u0026#34; rootCAPath=\u0026#34;./hack/certs/rootCA.pem\u0026#34; echo \u0026#34;updating root certificate\u0026#34; sudo cat \u0026#34;${rootCAPath}\u0026#34; | sudo tee -a /etc/ssl/certs/ca-certificates.crt || echo \u0026#34;failed to append to ca-certificates. Ignoring the failure\u0026#34; if [ ! -e \u0026#34;${certPath}\u0026#34; ] \u0026amp;\u0026amp; [ ! -e \u0026#34;${keyPath}\u0026#34; ]; then echo -n \u0026#34;certificates not found, generating...\u0026#34; CAROOT=./hack/certs ./bin/mkcert -cert-file ./hack/certs/cert.pem -key-file ./hack/certs/key.pem registry.ocm-system.svc.cluster.local localhost 127.0.0.1 ::1 echo \u0026#34;done\u0026#34; else echo \u0026#34;certificates found, will not re-generate\u0026#34; fi # You can ignore this. echo -n \u0026#34;creating secret...\u0026#34; kubectl create secret generic \\ -n ocm-system registry-certs \\ --from-file=caFile=\u0026#34;${rootCAPath}\u0026#34; \\ --from-file=certFile=\u0026#34;${certPath}\u0026#34; \\ --from-file=keyFile=\u0026#34;${keyPath}\u0026#34; \\ --dry-run=client -o yaml \u0026gt; ./hack/certs/registry_certs_secret.yaml Let\u0026rsquo;s break this down line by line:\n1-15: Ignore this part. It\u0026rsquo;s just checking some things before running. 19: This is calling mkcert but notice the CAROOT setting. This will output the root certificate to that location. 27: Now, this is the important bit. Here, since we are using Ubuntu machine type, we append our certificate to the system\u0026rsquo;s root certificates. There are other ways to do this but none of them will work properly on GitHub actions or requires way too much fiddling. This is a heck of a lot easier to execute. 29-37: If the certificates do not exist it will create them. This, again, is using the configured ROOT location. This is done so that when this script is running locally, it doesn\u0026rsquo;t continue re-generating the certificates constantly. 39-45: Here, we create the secret which will contain our certificates.\nSo that\u0026rsquo;s the script.\nHow to automatically create developer certificates To do this automatically we use a combination of Makefile targets and Tilt. Tilt configures the mount and Makefile target calls mkcert and the script and then runs the e2e tests locally using Kind.\nfor o in objects: if o.get(\u0026#39;kind\u0026#39;) == \u0026#39;Deployment\u0026#39; and o.get(\u0026#39;metadata\u0026#39;).get(\u0026#39;name\u0026#39;) == \u0026#39;ocm-controller\u0026#39;: print(\u0026#39;updating ocm-controller deployment to add generated certificates\u0026#39;) o[\u0026#39;spec\u0026#39;][\u0026#39;template\u0026#39;][\u0026#39;spec\u0026#39;][\u0026#39;volumes\u0026#39;] = [{\u0026#39;name\u0026#39;: \u0026#39;root-certificate\u0026#39;, \u0026#39;secret\u0026#39;: {\u0026#39;secretName\u0026#39;: \u0026#39;registry-certs\u0026#39;, \u0026#39;items\u0026#39;: [{\u0026#39;key\u0026#39;: \u0026#39;caFile\u0026#39;, \u0026#39;path\u0026#39;: \u0026#39;ca.pem\u0026#39;}]}}] o[\u0026#39;spec\u0026#39;][\u0026#39;template\u0026#39;][\u0026#39;spec\u0026#39;][\u0026#39;containers\u0026#39;][0][\u0026#39;volumeMounts\u0026#39;] = [{\u0026#39;mountPath\u0026#39;: \u0026#39;/certs\u0026#39;, \u0026#39;name\u0026#39;: \u0026#39;root-certificate\u0026#39;}] The name can be made configurable with an environment property, but here we just ignore that in the dev environment.\nAdding the root certificate to the container To add the root certificate to the container in which our controller is running, we use an entrypoint.sh script. We get the root certificate that is mounted into the container and then append that rootCA to the system CA. When done we launch our manager.\n#!/usr/bin/env sh rootCA=${REGISTRY_ROOT_CERTIFICATE:-/certs/ca.pem} if [ ! -e \u0026#34;${rootCA}\u0026#34; ]; then echo \u0026#34;warning... root certificate at location ${rootCA} not found.\u0026#34; exec \u0026#34;$@\u0026#34; fi echo \u0026#34;updating root certificate with provided certificate...\u0026#34; tee -a /etc/ssl/certs/ca-certificates.crt \u0026lt; \u0026#34;${rootCA}\u0026#34; echo \u0026#34;done.\u0026#34; exec \u0026#34;$@\u0026#34; That\u0026rsquo;s all we need. With this, our controller will now understand our self-signed certificate or any certificate that is provided to the controller if it exists.\nConclusion This is it. We have all the things we need for a self-signer certificate to seamlessly work in dev and in CI environment. The whole project with all the files can be found here: ocm-controller.\nThank you for reading!\nGergely.\n","permalink":"https://skarlso.github.io/2023/07/04/how-to-add-self-signed-certificates-to-github-action-runner-using-mkcert/","summary":"Adding a certificate to a GitHub runner Imagine having a project where you have a server that you would like to run with TLS. Let\u0026rsquo;s say, you want to run a Docker registry in a cluster using TLS. You need the generated certificate\u0026rsquo;s root certificate in the trust store of the GitHub action runner.\nThis is simple with mkcert.\nThe action is simple:\nname: tests on: pull_request: paths-ignore: - \u0026#39;CODE_OF_CONDUCT.md\u0026#39; - \u0026#39;README.","title":"How to add a self-signed certificate to the GitHub action runner"},{"content":"Well, the previous post was a lie ( or rather a copy and paste error ).\n","permalink":"https://skarlso.github.io/2023/05/11/comments-are-back/","summary":"Well, the previous post was a lie ( or rather a copy and paste error ).","title":"Comments are back"},{"content":"Hello dear reader.\nI switched to a new theme that has Dark Mode. I\u0026rsquo;m hoping nothing changed regarding the RSS functionality.\nI removed the comments because I rarely used them.\nAlso disabled any sort of tracking.\nEnjoy, Gergely.\n","permalink":"https://skarlso.github.io/2023/05/11/test-comments/","summary":"Hello dear reader.\nI switched to a new theme that has Dark Mode. I\u0026rsquo;m hoping nothing changed regarding the RSS functionality.\nI removed the comments because I rarely used them.\nAlso disabled any sort of tracking.\nEnjoy, Gergely.","title":"Test comments"},{"content":"Hello dear reader.\nI switched to a new theme that has Dark Mode. I\u0026rsquo;m hoping nothing changed regarding the RSS functionality.\nI removed the comments because I rarely used them.\nAlso disabled any sort of tracking.\nEnjoy, Gergely.\n","permalink":"https://skarlso.github.io/2023/05/10/dark-mode/","summary":"Hello dear reader.\nI switched to a new theme that has Dark Mode. I\u0026rsquo;m hoping nothing changed regarding the RSS functionality.\nI removed the comments because I rarely used them.\nAlso disabled any sort of tracking.\nEnjoy, Gergely.","title":"Dark mode and a new theme"},{"content":"Welcome dear reader.\nWhen last we met, we talked a lot about setting up Tilt for rapid controller development.\nNow, let\u0026rsquo;s see how powerful Tilt can be once we bring it together with Kubernetes\u0026rsquo; e2e-framework.\nController E2E Framework I\u0026rsquo;d like to present my controller-e2e-framework which brings Tilt and e2e-framework together to easily write and run tests for controllers that work together.\nThis framework can be used to integration test or e2e test controllers that work together. They set up some kind of ref connection between certain objects and perform some operation on said object.\nThe result should contain the operation of both (or many) controllers.\nThe linked organization contains three main repositories. Let\u0026rsquo;s walk through them.\nTest 1 Controller Test 1 controller is a simple controller that accepts a basic object like this:\napiVersion: delivery.controller-e2e-framework/v1alpha1 kind: Controller metadata: name: controller-sample spec: ref: kind: Responder apiVersion: delivery.controller-e2e-framework/v1alpha1 name: test-responder The ref is the interface between test-2-controller and test-1-controller. Its simple operation involves fetching this reference, whatever the kind is, adding a label to it, and patching that object back to Kubernetes.\nThe label that it adds is controller-e2e-framework.controlled = true.\nThis repository contains another main ingredient. A simple Tilt file that does the following. It builds the project and sets up all necessary yaml objects like the CRD definition, RBAC, any patches that might exist and the deployment.\nThis is important to note for various reasons. First, if we would build a testing image instead of using Tilt, we would flood the package manager with a bunch of test imagines. Or, always set the latest image, in which case, we would lose the ability to debug any problems. Further, we would have to have some kind of way to download the manifest files that correspond to that version. If doing local development, that would be a hassle or we would have to have a checked-out source of the manifest files anyways.\nThus, we bring together all of this with Tilt which uses a local registry and the files from the checked-out source.\nThis simple Tiltfile looks like this:\n# -*- mode: Python -*- kubectl_cmd = \u0026#34;kubectl\u0026#34; # verify kubectl command exists if str(local(\u0026#34;command -v \u0026#34; + kubectl_cmd + \u0026#34; || true\u0026#34;, quiet = True)) == \u0026#34;\u0026#34;: fail(\u0026#34;Required command \u0026#39;\u0026#34; + kubectl_cmd + \u0026#34;\u0026#39; not found in PATH\u0026#34;) # Use kustomize to build the install yaml files install = kustomize(\u0026#39;config/default\u0026#39;) # Update the root security group. Tilt requires root access to update the # running process. objects = decode_yaml_stream(install) for o in objects: if o.get(\u0026#39;kind\u0026#39;) == \u0026#39;Deployment\u0026#39; and o.get(\u0026#39;metadata\u0026#39;).get(\u0026#39;name\u0026#39;) == \u0026#39;test-1-controller\u0026#39;: o[\u0026#39;spec\u0026#39;][\u0026#39;template\u0026#39;][\u0026#39;spec\u0026#39;][\u0026#39;securityContext\u0026#39;][\u0026#39;runAsNonRoot\u0026#39;] = False break updated_install = encode_yaml_stream(objects) # Apply the updated yaml to the cluster. # Allow duplicates so the e2e test can include this tilt file with other tilt files # setting up the same namespace. k8s_yaml(updated_install, allow_duplicates = True) load(\u0026#39;ext://restart_process\u0026#39;, \u0026#39;docker_build_with_restart\u0026#39;) # enable hot reloading by doing the following: # - locally build the whole project # - create a docker imagine using tilt\u0026#39;s hot-swap wrapper # - push that container to the local tilt registry # Once done, rebuilding now should be a lot faster since only the relevant # binary is rebuilt and the hot swat wrapper takes care of the rest. local_resource( \u0026#39;test-1-controller-binary\u0026#39;, \u0026#39;CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -o bin/manager ./\u0026#39;, deps = [ \u0026#34;main.go\u0026#34;, \u0026#34;go.mod\u0026#34;, \u0026#34;go.sum\u0026#34;, \u0026#34;api\u0026#34;, \u0026#34;controllers\u0026#34;, \u0026#34;pkg\u0026#34;, ], ) # Build the docker image for our controller. We use a specific Dockerfile # since tilt can\u0026#39;t run on a scratch container. # `only` here is important, otherwise, the container will get updated # on _any_ file change. We only want to monitor the binary. # If debugging is enabled, we switch to a different docker file using # the delve port. entrypoint = [\u0026#39;/manager\u0026#39;] dockerfile = \u0026#39;tilt.dockerfile\u0026#39; docker_build_with_restart( \u0026#39;ghcr.io/controller-e2e-framework/test-1-controller\u0026#39;, \u0026#39;.\u0026#39;, dockerfile = dockerfile, entrypoint = entrypoint, only=[ \u0026#39;./bin\u0026#39;, ], live_update = [ sync(\u0026#39;./bin/manager\u0026#39;, \u0026#39;/manager\u0026#39;), ], ) Basic things, plus the modification of the root securityContext so Tilt can hot-swap the binary.\nTest 2 Controller Test 2 controller looks at a responder object and once it detects the above label on the object, it will set a status flag called Acquired to true. Also, a simple operation just to demo how these two controllers work together.\nThis repository has the same Tiltfile as test-1-controller.\nE2E Framework Now comes the main menu. The heart of the thing.\nFirst, we can determine the flow. We would like to apply two files. controller-sample.yaml and responder-sample.yaml. This will kick-start the whole process of reconciliation of the responder object.\nOnce these two exists and we verified that they exist, we will wait for the label to be applied and the Acquired flag to be set to true.\nLet\u0026rsquo;s look at the architecture of this whole thing.\nWhat happens here is as follows\u0026hellip; e2e-framework has a TestMain function defined.\nfunc TestMain(m *testing.M) { cfg, _ := envconf.NewFromFlags() testEnv = env.NewWithConfig(cfg) kindClusterName = envconf.RandomName(\u0026#34;test-controller-e2e\u0026#34;, 32) namespace = envconf.RandomName(\u0026#34;namespace\u0026#34;, 16) testEnv.Setup( envfuncs.CreateKindCluster(kindClusterName), envfuncs.CreateNamespace(namespace), shared.RunTiltForControllers(\u0026#34;test-1-controller\u0026#34;, \u0026#34;test-2-controller\u0026#34;), ) testEnv.Finish( envfuncs.DeleteNamespace(namespace), envfuncs.DestroyKindCluster(kindClusterName), ) os.Exit(testEnv.Run(m)) } This function has a Setup and a Teardown phase. During this phase, a kind cluster is created and tilt ci is executed to bring up a cluster and run tilt. But what Tiltfile does it run? Well\u0026hellip; it imports all the Tiltfiles of the defined controllers.\nThis part:\nshared.RunTiltForControllers(\u0026#34;test-1-controller\u0026#34;, \u0026#34;test-2-controller\u0026#34;), But where are they? They have to be checked-out next to this project. Then, the framework will do a cd ..` like a thing and look for these folders until it either finds them or reaches the root.\ntilt ci is super convenient because it will run to completion or fail if it doesn\u0026rsquo;t start up for whatever reason. Thus we can be sure that we set up RBAC and controller settings correctly. Something that we can\u0026rsquo;t test through pure unit testing.\nOnce we have a cluster and tilt the test starts. Here we have steps that are either a Setup an Assess or a Teardown.\nWe can extract a bunch of steps here to make it easy to just plug together tests using common steps.\nLike, setting up a scheme, looking for objects, checking object state, applying test data, etc.\nIn this test we do something like this:\nfunc TestControllerApply(t *testing.T) { t.Log(\u0026#34;running component version apply\u0026#34;) feature := features.New(\u0026#34;Custom Controller\u0026#34;). Setup(setup.AddSchemeAndNamespace(cv1.AddToScheme, namespace)). Setup(setup.AddSchemeAndNamespace(rv1.AddToScheme, namespace)). Setup(setup.ApplyTestData(v1alpha1.AddToScheme, namespace, \u0026#34;*\u0026#34;)). Assess(\u0026#34;check if controller was created\u0026#34;, assess.ResourceWasCreated(\u0026#34;controller-sample\u0026#34;, namespace, \u0026amp;cv1.Controller{})). Assess(\u0026#34;check if responder was created\u0026#34;, assess.ResourceWasCreated(\u0026#34;responder-sample\u0026#34;, namespace, \u0026amp;rv1.Responder{})). Assess(\u0026#34;wait for responder condition to be true\u0026#34;, func(ctx context.Context, t *testing.T, cfg *envconf.Config) context.Context { ... We have then waiters or waiting steps for certain conditions and once everything is tested and done, we remove all objects in a Teardown so the next test doesn\u0026rsquo;t collide with anything.\nTeardown(func(ctx context.Context, t *testing.T, cfg *envconf.Config) context.Context { t.Helper() t.Log(\u0026#34;teardown\u0026#34;) // remove test resources before exiting r, err := resources.New(cfg.Client().RESTConfig()) if err != nil { t.Fatal(err) } if err := decoder.DecodeEachFile(ctx, os.DirFS(\u0026#34;./testdata\u0026#34;), \u0026#34;*\u0026#34;, decoder.DeleteHandler(r), // try to DELETE objects after decoding decoder.MutateNamespace(namespace), // inject a namespace into decoded objects, before calling DeleteHandler ); err != nil { t.Fatal(err) } t.Log(\u0026#34;teardown done\u0026#34;) return ctx }).Feature() This is super convenient because we tested apply, scheme, delete and finalizers, everything in one go.\nAnd the BEST part about all this is that the ONLY thing the user needs to run is just go test ./....\nYou can funk it up if you wish to only run a single suite with go test -v ./test/controller.\nCI To set all this up in a CI that runs it continuously or some kind of trigger just set it up like this:\nname: e2e on: workflow_dispatch: {} schedule: - cron: 0 0 * * 1 # every Monday at 00:00 permissions: contents: read # for actions/checkout to fetch code jobs: kind-linux: runs-on: ubuntu-latest steps: - name: Checkout this repo uses: actions/checkout@v3 with: path: e2e-framework - name: Checkout test-1-framework uses: actions/checkout@v3 with: repository: \u0026#39;controller-e2e-framework/test-1-controller\u0026#39; path: test-1-controller - name: Checkout test-2-controller uses: actions/checkout@v3 with: repository: \u0026#39;controller-e2e-framework/test-2-controller\u0026#39; path: test-2-controller - name: Setup Go uses: actions/setup-go@v3 with: go-version-file: \u0026#39;${{ github.workspace }}/e2e-framework/go.mod\u0026#39; - name: Restore Go cache uses: actions/cache@v3 with: path: /home/runner/work/_temp/_github_home/go/pkg/mod key: ${{ runner.os }}-go-${{ hashFiles(\u0026#39;**/go.sum\u0026#39;) }} restore-keys: | ${{ runner.os }}-go- - name: Run tests run: cd e2e-framework \u0026amp;\u0026amp; go test ./... Note that you need to have checkout access to all repositories involved.\nConclusion I find this testing amazingly simple. It lets me focus on the tests and I know that I will run the same thing in CI and my local__ environment. And I know that any modification I\u0026rsquo;ll do in code will immediately be tested without me having to either run something weird with exported environment properties such as TEST_IMAGE or a dedicated test runner with some weird parameters. CI runs the same thing I\u0026rsquo;m running on my local environment. And that\u0026rsquo;s go test ./....\nThank you for reading.\nAnd as always, have a nice day.\nGergely.\n","permalink":"https://skarlso.github.io/2023/03/12/painless-controller-testing-with-e2e-framework-tilt/","summary":"Welcome dear reader.\nWhen last we met, we talked a lot about setting up Tilt for rapid controller development.\nNow, let\u0026rsquo;s see how powerful Tilt can be once we bring it together with Kubernetes\u0026rsquo; e2e-framework.\nController E2E Framework I\u0026rsquo;d like to present my controller-e2e-framework which brings Tilt and e2e-framework together to easily write and run tests for controllers that work together.\nThis framework can be used to integration test or e2e test controllers that work together.","title":"Painless controller testing with e2e-framework and tilt"},{"content":"Welcome dear reader.\nToday, we are going to dive into how to use Tilt to speed up the feedback loop of developing a Kubernetes controller. We are going to do that using an open-source project called OCM which has a controller called ocm-controller. I\u0026rsquo;m going to walk through the following process:\nresearching tilt what it could do for me understanding the Tilt file trivial mapping of the developer process understanding Starlark adding more features tackling hot swapping troubleshooting Let\u0026rsquo;s dive in.\nRapid controller development with Tilt Tilt If you know some things about Tilt already, skip ahead to where I\u0026rsquo;ll be applying its concepts to the controller here.\nWhat is Tilt Tilt is a tool we can use to automate build and deploy processes for microservices. Technically, it can handle so much more than just a simple controller, but we are going to use this example to keep it simple for a first start.\nWhat can it do It is almost like a controller itself. It has an internal control loop that constantly \u0026ldquo;reconciles\u0026rdquo; the environment to make sure it\u0026rsquo;s up-to-date. I\u0026rsquo;m using quotes because it\u0026rsquo;s not 100% like that. It doesn\u0026rsquo;t recreate if something is deleted. But it does update them if the configuration changes. For example, if you create a secret with an incorrect name, and change its name, there won\u0026rsquo;t be two secrets, one with the correct name, and the other with an incorrect name, but one secret with the correct name.\nReading the documentation - where to start You can start by visiting the docs and then jumping right into First Look At Tilt.\nThis will guide you through setting up Tilt. There is one thing I don\u0026rsquo;t like here\u0026hellip; It\u0026rsquo;s starting by using a demo application and a special command called tilt demo. I believe that this is not a great way to begin because you will never run this command again. I would have preferred to do a walkthrough like the one I\u0026rsquo;m going to write now. But, this is my view. Others might find the demo app more useful. Nevertheless, it\u0026rsquo;s useful to read through it to understand the basic concepts and the application (avatar generator) is pretty sweet!\nConcepts You can read all about the concepts here.\nTL;DR:\nTilt uses building blocks called Resources that it manages. A resource can be anything from a Deployment or a local file or a script or a service. It does that so it can track them separately and display them in a shiny UI.\nControl Loop The control loop is described here.\nTL;DR:\nIt\u0026rsquo;s a feedback loop around things that happen and things that Tilt watches. Tilt continuously watches resources and reacts to their changes in ways that are described in the Tiltfile. Another interesting effect of this is that if a resource is already running in your cluster it won\u0026rsquo;t try to rebuild/redeploy that.\nTiltfile We are going to dive deep into the Tiltfile a bit later, for now, it\u0026rsquo;s the main file that describes the behavior of tilt. It\u0026rsquo;s using Starlark which is a dialect of Python. Here is an example:\n# Define a number number = 18 # Define a dictionary people = { \u0026#34;Alice\u0026#34;: 22, \u0026#34;Bob\u0026#34;: 40, \u0026#34;Charlie\u0026#34;: 55, \u0026#34;Dave\u0026#34;: 14, } names = \u0026#34;, \u0026#34;.join(people.keys()) # Alice, Bob, Charlie, Dave # Define a function def greet(name): \u0026#34;\u0026#34;\u0026#34;Return a greeting.\u0026#34;\u0026#34;\u0026#34; return \u0026#34;Hello {}!\u0026#34;.format(name) greeting = greet(names) above30 = [name for name, age in people.items() if age \u0026gt;= 30] print(\u0026#34;{} people are above 30.\u0026#34;.format(len(above30))) def fizz_buzz(n): \u0026#34;\u0026#34;\u0026#34;Print Fizz Buzz numbers from 1 to n.\u0026#34;\u0026#34;\u0026#34; for i in range(1, n + 1): s = \u0026#34;\u0026#34; if i % 3 == 0: s += \u0026#34;Fizz\u0026#34; if i % 5 == 0: s += \u0026#34;Buzz\u0026#34; print(s if s else i) fizz_buzz(20) This syntax is used for configuration. As you can see, it supports various Python things which give the user the ability to do virtually anything in Tilt.\ndownload yaml manifests mutate objects changes deployments before applying them ( this will be important later ) run a local script fetch something from a remote location Anything is possible.\nA Tiltfile has a bunch of built-in functions and APIs which are described here.\nHowever, I found that THIS API page will be your best friend together with the extensions list Tilt Extensions. Tilt\u0026rsquo;s functionality is extended using extensions that are loaded using an expression like this load('ext://restart_process', 'docker_build_with_restart').\nDuring troubleshooting, reading the extension\u0026rsquo;s code or documentation can often be helpful.\nThe Writing your first Tiltfile guide is pretty good though for demystifying and understanding the dialect. It\u0026rsquo;s rather basic but that\u0026rsquo;s all you need to get started. So next, let\u0026rsquo;s dive into how to gradually build up a complex Tiltfile and development process.\nThe development process of a controller Basic flow When you are building a controller you have a couple of choices:\nrun the controller locally on your machine by calling the compile manager binary Most of the time you\u0026rsquo;d do this but by doing this, you are skipping testing in cluster communication, RBAC, service discovery, etc. Also, it gets cumbersome to constantly port-forward other services being used by your controller to access them.\nbuild a container and push it to a registry and publish the deployment with the given container image and tag This is good if you want to test the release process of new containers. But takes a lot of time.\nuse a local docker registry with kind (https://kind.sigs.k8s.io/docs/user/local-registry/) and do a cycle of constant build/push/deploy like this\ndocker build -t localhost:5001/open-component-model/ocm-controller:v0.0.1 . ... docker push localhost:5001/open-component-model/ocm-controller:v0.0.1 All of these take time. Building a docker container, even when it\u0026rsquo;s reusing layers, takes time. For ocm-controller, on my machine, it takes about two minutes or so. Then push and deploy takes another couple of seconds.\nTilt can help a lot in speeding up this process. We\u0026rsquo;ll see about that later.\nMapping flow to Tiltfile We are going to choose the third option. Tilt has its local registry and uses unique build tags for each container to be able to debug problems for a specific change.\nAs a first step, to keep it simple, we map the process of installing controller resources and deploying them using `docker_build``.\nUsually, a controller uses kustomize. Tilt can leverage that. We can use kustomize to build a single install file that will create the deployment, the RBAX roles, and any other thing, like patches, configuration and the CRDs.\nTo do this, we simply run kustomize build ./config/default \u0026gt; install.yaml. The install.yaml` will contain everything that can be applied to the cluster as is. Tilt can do the same thing using a very simple directive. Take a look at our first draft of a Tiltfile:\n# Apply the install file to the cluster k8s_yaml(kustomize(\u0026#39;config/default\u0026#39;)) docker_build(\u0026#39;ghcr.io/open-component-model/ocm-controller\u0026#39;, \u0026#39;.\u0026#39;) By defining the docker_build directive we make it possible for Tilt to use a local registry. Internally, it will do its magic and change the deployment\u0026rsquo;s image to the right registry address.\nIn reality, this is the actual deployment that will be used:\nImage: localhost:5001/ghcr.io_open-component-model_ocm-controller:tilt-772cb281aa593470 Now, we can try and test our Tiltfile. To use tilt, simply run tilt up next to the Tiltfile. Press space and you should see your deployment starting up. Any errors will nicely be displayed on the respective resource.\nIf we make any changes to any of the files now, tilt will rebuild the entire container. This is already nice because this means that you don\u0026rsquo;t have to bother with building, pushing and updating the kustomize manifest to use the local registry. Tilt will take care of all that for us.\nBut wait\u0026hellip; there is more!\nIntroducing settings For now, let\u0026rsquo;s upgrade our Tilt experience with a couple of settings so any user can customize their deployment for themselves. Starlark is just a Python dialect so we can do something like this:\n# -*- mode: Python -*- kubectl_cmd = \u0026#34;kubectl\u0026#34; # verify kubectl command exists if str(local(\u0026#34;command -v \u0026#34; + kubectl_cmd + \u0026#34; || true\u0026#34;, quiet = True)) == \u0026#34;\u0026#34;: fail(\u0026#34;Required command \u0026#39;\u0026#34; + kubectl_cmd + \u0026#34;\u0026#39; not found in PATH\u0026#34;) # set defaults settings = { \u0026#34;create_secrets\u0026#34;: { \u0026#34;enable\u0026#34;: True, \u0026#34;token\u0026#34;: os.getenv(\u0026#34;GITHUB_TOKEN\u0026#34;, \u0026#34;\u0026#34;), \u0026#34;email\u0026#34;: os.getenv(\u0026#34;GITHUB_EMAIL\u0026#34;, \u0026#34;\u0026#34;), \u0026#34;user\u0026#34;: os.getenv(\u0026#34;GITHUB_USER\u0026#34;, \u0026#34;\u0026#34;), }, \u0026#34;forward_registry\u0026#34;: False, \u0026#34;verification_keys\u0026#34;: {}, } # global settings tilt_file = \u0026#34;./tilt-settings.yaml\u0026#34; if os.path.exists(\u0026#34;./tilt-settings.yaml\u0026#34;) else \u0026#34;./tilt-settings.json\u0026#34; settings.update(read_yaml( tilt_file, default = {}, )) Okay, what is happening here? Let\u0026rsquo;s break it down.\nkubectl_cmd is just a convenient variable so we don\u0026rsquo;t have to repeat the command as a string.\nThe next section checks whether the kubectl command exists. We are using a tilt built-in command called local to execute a local command called command.\nNow comes the interesting part. We define a dict. This is something akin to dict, but it\u0026rsquo;s a Starlark dict. You can check the dialect definition in the Specification. This doc will also be your best friend. The dict can be found here.\nNext, we define the variable tilt_file and assign it either json or a yaml extension with the name tilt-settings. After this comes another built-in directive called read_yaml. This is a versatile directive that will produce a yaml output from the given file. If the file is not found it will use default to set some default values. update will merge the two produced dict results.\nSo, with a local file like this:\ncreate_secrets: enabled: false We\u0026rsquo;ll get a dict like this:\nsettings = { \u0026#34;create_secrets\u0026#34;: { \u0026#34;enable\u0026#34;: False, }, \u0026#34;forward_registry\u0026#34;: False, \u0026#34;verification_keys\u0026#34;: {}, } We can override any values in our settings and customize the deployment.\nAdding more features Let\u0026rsquo;s add some more features. ocm uses flux for deployment and various other tasks. To help the user, add a simple flux bootstrap OR install. Maybe the user doesn\u0026rsquo;t want to bootstrap a repository but does want flux CRDs and components installed in the cluster. The two commands we would like to replicate are:\nflux bootstrap github --owner=skarlso --repository=ocm-flux-example --path . and simply\nflux install \u0026hellip; depending on the user\u0026rsquo;s choice. First, we\u0026rsquo;ll extend our settings:\nsettings = { \u0026#34;flux\u0026#34;: { \u0026#34;enabled\u0026#34;: False, \u0026#34;bootstrap\u0026#34;: True, \u0026#34;repository\u0026#34;: os.getenv(\u0026#34;FLUX_REPOSITORY\u0026#34;, \u0026#34;podinfo-flux-example\u0026#34;), \u0026#34;owner\u0026#34;: os.getenv(\u0026#34;FLUX_OWNER\u0026#34;, \u0026#34;\u0026#34;), \u0026#34;path\u0026#34;: os.getenv(\u0026#34;FLUX_PATH\u0026#34;, \u0026#34;.\u0026#34;), }, \u0026#34;create_secrets\u0026#34;: { \u0026#34;enable\u0026#34;: True, \u0026#34;token\u0026#34;: os.getenv(\u0026#34;GITHUB_TOKEN\u0026#34;, \u0026#34;\u0026#34;), \u0026#34;email\u0026#34;: os.getenv(\u0026#34;GITHUB_EMAIL\u0026#34;, \u0026#34;\u0026#34;), \u0026#34;user\u0026#34;: os.getenv(\u0026#34;GITHUB_USER\u0026#34;, \u0026#34;\u0026#34;), }, \u0026#34;forward_registry\u0026#34;: False, \u0026#34;verification_keys\u0026#34;: {}, } Here, we used another built-in directive with os.getenv. These could just be empty, but we give the option of users to define environment properties instead of a file. Whichever is more convenient.\nNow, we\u0026rsquo;ll add the flux commands:\nflux_cmd = \u0026#39;flux\u0026#39; opts = settings.get(\u0026#34;flux\u0026#34;) if opts.get(\u0026#34;enabled\u0026#34;): if str(local(\u0026#34;command -v \u0026#34; + flux_cmd + \u0026#34; || true\u0026#34;, quiet = True)) == \u0026#34;\u0026#34;: fail(\u0026#34;Required command \u0026#39;\u0026#34; + flux_cmd + \u0026#34;\u0026#39; not found in PATH\u0026#34;) if opts.get(\u0026#34;bootstrap\u0026#34;): local(\u0026#34;%s bootstrap github --owner %s --repository %s --path %s\u0026#34; % (flux_cmd, opts.get(\u0026#39;owner\u0026#39;), opts.get(\u0026#39;repository\u0026#39;), opts.get(\u0026#39;path\u0026#39;))) else: local(flux_cmd + \u0026#34; install\u0026#34;) Super easy. This feels familiar, doesn\u0026rsquo;t it? It\u0026rsquo;s just like when you first began using something like Ansible to code down some deployment or translate some weird script into a higher-order definition or a DSL.\nLet\u0026rsquo;s go one step further and try to make this nicer to read by using functions.\ndef bootstrap_or_install_flux(): opts = settings.get(\u0026#34;flux\u0026#34;) if not opts.get(\u0026#34;enabled\u0026#34;): return if str(local(\u0026#34;command -v \u0026#34; + flux_cmd + \u0026#34; || true\u0026#34;, quiet = True)) == \u0026#34;\u0026#34;: fail(\u0026#34;Required command \u0026#39;\u0026#34; + flux_cmd + \u0026#34;\u0026#39; not found in PATH\u0026#34;) # flux bootstrap github --owner=${FLUX_OWNER} --repository=${FLUX_REPOSITORY} --path ${FLUX_PATH} if opts.get(\u0026#34;bootstrap\u0026#34;): local(\u0026#34;%s bootstrap github --owner %s --repository %s --path %s\u0026#34; % (flux_cmd, opts.get(\u0026#39;owner\u0026#39;), opts.get(\u0026#39;repository\u0026#39;), opts.get(\u0026#39;path\u0026#39;))) else: local(flux_cmd + \u0026#34; install\u0026#34;) How does our complete Tiltfile now look like, you might wonder. Let\u0026rsquo;s take a look:\n# -*- mode: Python -*- kubectl_cmd = \u0026#34;kubectl\u0026#34; flux_cmd = \u0026#34;flux\u0026#34; # verify kubectl command exists if str(local(\u0026#34;command -v \u0026#34; + kubectl_cmd + \u0026#34; || true\u0026#34;, quiet = True)) == \u0026#34;\u0026#34;: fail(\u0026#34;Required command \u0026#39;\u0026#34; + kubectl_cmd + \u0026#34;\u0026#39; not found in PATH\u0026#34;) # set defaults settings = { \u0026#34;flux\u0026#34;: { \u0026#34;enabled\u0026#34;: False, \u0026#34;bootstrap\u0026#34;: True, \u0026#34;repository\u0026#34;: os.getenv(\u0026#34;FLUX_REPOSITORY\u0026#34;, \u0026#34;podinfo-flux-example\u0026#34;), \u0026#34;owner\u0026#34;: os.getenv(\u0026#34;FLUX_OWNER\u0026#34;, \u0026#34;\u0026#34;), \u0026#34;path\u0026#34;: os.getenv(\u0026#34;FLUX_PATH\u0026#34;, \u0026#34;.\u0026#34;), }, \u0026#34;forward_registry\u0026#34;: False, \u0026#34;verification_keys\u0026#34;: {}, } # global settings tilt_file = \u0026#34;./tilt-settings.yaml\u0026#34; if os.path.exists(\u0026#34;./tilt-settings.yaml\u0026#34;) else \u0026#34;./tilt-settings.json\u0026#34; settings.update(read_yaml( tilt_file, default = {}, )) def bootstrap_or_install_flux(): opts = settings.get(\u0026#34;flux\u0026#34;) if not opts.get(\u0026#34;enabled\u0026#34;): return if str(local(\u0026#34;command -v \u0026#34; + flux_cmd + \u0026#34; || true\u0026#34;, quiet = True)) == \u0026#34;\u0026#34;: fail(\u0026#34;Required command \u0026#39;\u0026#34; + flux_cmd + \u0026#34;\u0026#39; not found in PATH\u0026#34;) # flux bootstrap github --owner=${FLUX_OWNER} --repository=${FLUX_REPOSITORY} --path ${FLUX_PATH} if opts.get(\u0026#34;bootstrap\u0026#34;): local(\u0026#34;%s bootstrap github --owner %s --repository %s --path %s\u0026#34; % (flux_cmd, opts.get(\u0026#39;owner\u0026#39;), opts.get(\u0026#39;repository\u0026#39;), opts.get(\u0026#39;path\u0026#39;))) else: local(flux_cmd + \u0026#34; install\u0026#34;) # set up the development environment # check if flux is needed bootstrap_or_install_flux() # Use kustomize to build the install yaml files k8s_yaml(kustomize(\u0026#39;config/default\u0026#39;)) docker_build(\u0026#39;ghcr.io/open-component-model/ocm-controller\u0026#39;, \u0026#39;.\u0026#39;) # This is new thing we added here to port-forward more on this a bit later. if settings.get(\u0026#39;forward_registry\u0026#39;): k8s_resource(\u0026#39;ocm-controller\u0026#39;, extra_pod_selectors = [{\u0026#39;app\u0026#39;: \u0026#39;registry\u0026#39;}], port_forwards=5000) This looks pretty nice already. But there is a lot more that we can do.\nAdding secrets Another thing that OCM needs ( or any other deployment really ) is creating secrets for various things and deployments. OCM needs some docker registry credentials and some other credentials to pull things from outside repositories.\nCreating secrets can be done by using an extension. The particular extension we are looking for is secrets.\nWe will use three types. A from-file for creating a secret that contains an SSH key. A plain key/value secret for repository access. And a docker-registry type secret.\n# set defaults settings = { \u0026#34;flux\u0026#34;: { \u0026#34;enabled\u0026#34;: False, \u0026#34;bootstrap\u0026#34;: True, \u0026#34;repository\u0026#34;: os.getenv(\u0026#34;FLUX_REPOSITORY\u0026#34;, \u0026#34;podinfo-flux-example\u0026#34;), \u0026#34;owner\u0026#34;: os.getenv(\u0026#34;FLUX_OWNER\u0026#34;, \u0026#34;\u0026#34;), \u0026#34;path\u0026#34;: os.getenv(\u0026#34;FLUX_PATH\u0026#34;, \u0026#34;.\u0026#34;), }, \u0026#34;install_unpacker\u0026#34;: { \u0026#34;enabled\u0026#34;: False, \u0026#34;path\u0026#34;: \u0026#34;\u0026#34;, }, # Added this one # +++++++++++++++ \u0026#34;create_secrets\u0026#34;: { \u0026#34;enable\u0026#34;: True, \u0026#34;token\u0026#34;: os.getenv(\u0026#34;GITHUB_TOKEN\u0026#34;, \u0026#34;\u0026#34;), \u0026#34;email\u0026#34;: os.getenv(\u0026#34;GITHUB_EMAIL\u0026#34;, \u0026#34;\u0026#34;), \u0026#34;user\u0026#34;: os.getenv(\u0026#34;GITHUB_USER\u0026#34;, \u0026#34;\u0026#34;), }, # +++++++++++++++ \u0026#34;forward_registry\u0026#34;: False, \u0026#34;verification_keys\u0026#34;: {}, } # ... other stuff ... def create_secrets(): opts = settings.get(\u0026#34;create_secrets\u0026#34;) if not opts.get(\u0026#34;enable\u0026#34;): return k8s_yaml(secret_yaml_registry(\u0026#34;regcred\u0026#34;, \u0026#34;ocm-system\u0026#34;, flags_dict = { \u0026#39;docker-server\u0026#39;: \u0026#39;ghcr.io\u0026#39;, \u0026#39;docker-username\u0026#39;: opts.get(\u0026#39;user\u0026#39;), \u0026#39;docker-email\u0026#39;: opts.get(\u0026#39;email\u0026#39;), \u0026#39;docker-password\u0026#39;: opts.get(\u0026#39;token\u0026#39;), })) k8s_yaml(secret_from_dict(\u0026#34;creds\u0026#34;, \u0026#34;ocm-system\u0026#34;, inputs = { \u0026#39;username\u0026#39; : opts.get(\u0026#39;user\u0026#39;), \u0026#39;password\u0026#39; : opts.get(\u0026#39;token\u0026#39;), })) def create_verification_keys(): keys = settings.get(\u0026#34;verification_keys\u0026#34;) if not keys: return for key, value in keys.items(): secret_create_generic(key, \u0026#39;ocm-system\u0026#39;, from_file=value) We added two new functions and an extension to the settings. Let\u0026rsquo;s break this down.\nk8s_yaml(secret_yaml_registry -\u0026gt; this directive creates a yaml output which we apply to the cluster. Its kubectl equivalent would be\nkubectl create secret docker-registry -n ocm-system regcred \\ --docker-server=ghcr.io \\ --docker-username=$GITHUB_USER \\ --docker-password=$GITHUB_TOKEN \\ --docker-email=$GITHUB_EMAIL k8s_yaml(secret_from_dict -\u0026gt; same here. Equivalent kubectl command: kubectl create secret generic creds --from-literal=username=$GITHUB_USER --from-literal=password=$GITHUB_TOKEN -n ocm-system\nNext, we have create_verification_keys. This is a bit trickier, but nothing too fancy. Verification keys are SSH keys that can be used to verify components. We can have multiple keys. Therefore, the setting is a dict. We loop through the dict and create a secret from each of those. This is what that setting could look like:\nverification_keys: alice: alice=./rsa.pub bob: bob=/Users/user/home/.ssh/bob.pub All valid values. If a key is missing or the path is wrong, tilt does a dry-run first, so before applying to the cluster there would be an error that the key cannot be found.\nPhew, this was quite a lot. But now, we have secrets. Next, is the most important topic of them all\u0026hellip;\nHot-Swapping Hot-swapping is the most important ability of tilt of all of them. Instead of rebuilding the whole container it can just rebuild the binary and switch out the running process. This is nothing new but combined with Kubernetes and the controller development cycle will provide us with valuable time saved.\nTo do that though, we first, need to give Tilt some new abilities.\nLetting Tilt build the controller Tilt needs to manage the building of the binary for our project. Lucky for me, ocm is pretty basic in its design. Doesn\u0026rsquo;t require anything too weird. Not that tilt doesn\u0026rsquo;t support weird, it does, with custom builds, but for me, this wasn\u0026rsquo;t needed.\nAnd I suspect for most controllers that is the case. Let\u0026rsquo;s add something called a local_resource.\nlocal_resource( \u0026#39;manager\u0026#39;, \u0026#39;CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -o bin/manager ./\u0026#39;, deps = [ \u0026#34;main.go\u0026#34;, \u0026#34;go.mod\u0026#34;, \u0026#34;go.sum\u0026#34;, \u0026#34;api\u0026#34;, \u0026#34;controllers\u0026#34;, \u0026#34;pkg\u0026#34;, ], ) A local_resource is similar to local. It executes a command on the host computer. However, it also creates a resource. Remember, that a resource is any unit of work that Tilt manages. To learn more read up here. The extra here is that whenever something changes in deps it will re-run the command and rebuild the resource.\nHere is the API definition of local_resource.\nThis means that whenever something changes in deps, like files in API or controllers or pkg, etc, tilt rebuilds our binary. It already monitors the component YAML files, now we also monitor the go files.\nWe can add any script here or anything that produces our binary.\nNow, we\u0026rsquo;ll modify our docker build. There are some gotcha\u0026rsquo;s there.\nRoot access The first gotcha is that Tilt requires root access to hot-swap processes. If you are doing it right, you are using a scratch container and something like this in your deployment:\nsecurityContext: runAsNonRoot: true seccompProfile: type: RuntimeDefault If you aren\u0026rsquo;t you really should be! First, problem is that scratch containers aren\u0026rsquo;t supported by Tilt because it expects certain commands to be in the container, like touch. So we add a very simple Dockerfile that only tilt will use.\nFROM alpine WORKDIR / COPY ./bin/manager /manager ENTRYPOINT [\u0026#34;/manager\u0026#34;] And, we have to get rid of the runAsNonRoot: true. Or rather, set it to false. Remember we are writing code here. So we just take the yaml, change that field, and apply it after we are finished updating the object. There is a little doc about that that you can read: Modifying YAML for Dev.\nLet\u0026rsquo;s take a look. The basic flow is:\nread in our kustomize files convert it to objects look for our deployment and change this setting compile it back to yaml apply We could also apply the objects separately but it\u0026rsquo;s nice to do it with the install yaml because it contains the CRDs and Kubernetes applies those first. It\u0026rsquo;s a server-side apply.\n# Use kustomize to build the install yaml files install = kustomize(\u0026#39;config/default\u0026#39;) # Update the root security group. Tilt requires root access to update the # running process. objects = decode_yaml_stream(install) for o in objects: if o.get(\u0026#39;kind\u0026#39;) == \u0026#39;Deployment\u0026#39; and o.get(\u0026#39;metadata\u0026#39;).get(\u0026#39;name\u0026#39;) == \u0026#39;ocm-controller\u0026#39;: o[\u0026#39;spec\u0026#39;][\u0026#39;template\u0026#39;][\u0026#39;spec\u0026#39;][\u0026#39;securityContext\u0026#39;][\u0026#39;runAsNonRoot\u0026#39;] = False break updated_install = encode_yaml_stream(objects) # Apply the updated yaml to the cluster. k8s_yaml(updated_install) And thus, if our kind is Deployment and the name is the one we are looking for ocm-controller we change that value under spec: template: spec: securityContext:. DONE. Next!\nWith restart Now that we have the right Dockerfile and the right deployment, let\u0026rsquo;s use another extension called restart_process.\nload(\u0026#39;ext://restart_process\u0026#39;, \u0026#39;docker_build_with_restart\u0026#39;) Load the extension and then change the docker_build to docker_build_with_restart like this:\ndocker_build_with_restart( \u0026#39;ghcr.io/open-component-model/ocm-controller\u0026#39;, \u0026#39;.\u0026#39;, dockerfile = \u0026#39;tilt.dockerfile\u0026#39;, entrypoint = [\u0026#39;/manager\u0026#39;], only=[ \u0026#39;./bin\u0026#39;, ], live_update = [ sync(\u0026#39;./bin/manager\u0026#39;, \u0026#39;/manager\u0026#39;), ], ) Let\u0026rsquo;s break this down. We have two pretty straightforward things. The first is the name of the container. The second is the context. The third is dockerfile our custom alpine container.\nFourth is entrypoint. Now comes the only part and the live_update. The only part here is important. This tells Tilt to only watch that folder for changes. Since the local_resource is already watching for changes to the binary the deployment only needs to care about that!\nlive_update tells Tilt what to change in the container. We copy from the local bin/managerto the container/manager. It can also execute a script in the container, but we don't need that here. For example, a restart.sh. Or, in the case of python a pip install -r requirements.txt` or something like that.\nThe rest is taken care of by a Tilt wrapper; a bash script that can swap out processes. That\u0026rsquo;s what docker_build_with_restart does. It wraps our container and Dockerfile into its container and runs our entrypoint.\nAttaching a debugger But I\u0026rsquo;m running the manager locally because I use a debugger.\nI hear you! And it\u0026rsquo;s possible with Tilt as well! We need to do a couple of things to achieve running delve correctly. Luckily, once set up, it should work for the foreseeable future.\nFirst, let\u0026rsquo;s alter our settings and include a debug value:\n# set defaults settings = { \u0026#34;flux\u0026#34;: { \u0026#34;enabled\u0026#34;: False, \u0026#34;bootstrap\u0026#34;: True, \u0026#34;repository\u0026#34;: os.getenv(\u0026#34;FLUX_REPOSITORY\u0026#34;, \u0026#34;podinfo-flux-example\u0026#34;), \u0026#34;owner\u0026#34;: os.getenv(\u0026#34;FLUX_OWNER\u0026#34;, \u0026#34;\u0026#34;), \u0026#34;path\u0026#34;: os.getenv(\u0026#34;FLUX_PATH\u0026#34;, \u0026#34;.\u0026#34;), }, \u0026#34;install_unpacker\u0026#34;: { \u0026#34;enabled\u0026#34;: False, \u0026#34;path\u0026#34;: \u0026#34;\u0026#34;, }, \u0026#34;debug\u0026#34;: { \u0026#34;enabled\u0026#34;: False, }, \u0026#34;create_secrets\u0026#34;: { \u0026#34;enable\u0026#34;: True, \u0026#34;token\u0026#34;: os.getenv(\u0026#34;GITHUB_TOKEN\u0026#34;, \u0026#34;\u0026#34;), \u0026#34;email\u0026#34;: os.getenv(\u0026#34;GITHUB_EMAIL\u0026#34;, \u0026#34;\u0026#34;), \u0026#34;user\u0026#34;: os.getenv(\u0026#34;GITHUB_USER\u0026#34;, \u0026#34;\u0026#34;), }, \u0026#34;forward_registry\u0026#34;: False, \u0026#34;verification_keys\u0026#34;: {}, } Once enabled, for simplicity, we will forward delve on port 30000.\nNext, we need a dedicated Dockerfile that installs and runs delve.\nFROM golang:1.20.1 WORKDIR / COPY ./bin/manager /manager RUN go install github.com/go-delve/delve/cmd/dlv@latest RUN chmod +x /go/bin/dlv RUN mv /go/bin/dlv / EXPOSE 30000 ENTRYPOINT [\u0026#34;/dlv\u0026#34;, \u0026#34;--listen=:30000\u0026#34;, \u0026#34;--api-version=2\u0026#34;, \u0026#34;--headless=true\u0026#34;, \u0026#34;--continue=true\u0026#34;, \u0026#34;--accept-multiclient=true\u0026#34;, \u0026#34;exec\u0026#34;, \u0026#34;/manager\u0026#34;, \u0026#34;--\u0026#34;] The two important settings here are --continue and --accept-multiclient. Without it, delve will stop the process and our readiness and liveliness probes will fail. Another super important part is -- at the end. Without it, our manager will not get the arguments passed in by the deployment. Or rather, it will try to pass them to delve.\nWith delve in place, now we get to the funky part. We need to tell Tilt to use our debug Dockerfile and change the entrypoint if debugging is enabled. Also, let\u0026rsquo;s not forget that the deployment needs to port-forward 30000 otherwise we can\u0026rsquo;t access it with our debugger. Another thing we SHOULD do is, alter the Go build process and add some flags. Usually, when debugging Go code you want the flags -N -l. We add that with a variable called gcflags.\n# ... other things ... # Update the root security group. Tilt requires root access to update the # running process. objects = decode_yaml_stream(install) for o in objects: if o.get(\u0026#39;kind\u0026#39;) == \u0026#39;Deployment\u0026#39; and o.get(\u0026#39;metadata\u0026#39;).get(\u0026#39;name\u0026#39;) == \u0026#39;ocm-controller\u0026#39;: o[\u0026#39;spec\u0026#39;][\u0026#39;template\u0026#39;][\u0026#39;spec\u0026#39;][\u0026#39;securityContext\u0026#39;][\u0026#39;runAsNonRoot\u0026#39;] = False # This is what we added. OCM has a single container so we don\u0026#39;t need to look for a specific one. if settings.get(\u0026#39;debug\u0026#39;).get(\u0026#39;enabled\u0026#39;): o[\u0026#39;spec\u0026#39;][\u0026#39;template\u0026#39;][\u0026#39;spec\u0026#39;][\u0026#39;containers\u0026#39;][0][\u0026#39;ports\u0026#39;] = [{\u0026#39;containerPort\u0026#39;: 30000}] break # ... other things .... # Update our Go build and add conditional gcflags. gcflags = \u0026#39;\u0026#39; if settings.get(\u0026#39;debug\u0026#39;).get(\u0026#39;enabled\u0026#39;): gcflags = \u0026#39;-N -l\u0026#39; local_resource( \u0026#39;manager\u0026#39;, \u0026#34;CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -gcflags \u0026#39;{gcflags}\u0026#39; -o bin/manager ./\u0026#34;.format(gcflags=gcflags), deps = [ \u0026#34;main.go\u0026#34;, \u0026#34;go.mod\u0026#34;, \u0026#34;go.sum\u0026#34;, \u0026#34;api\u0026#34;, \u0026#34;controllers\u0026#34;, \u0026#34;pkg\u0026#34;, ], ) # ... other things ... # Finally, our port-forwarding and the addition of the updated entrypoint and dockerfile. # The `[]` syntax on entrypoint is important because we want tilt to be able to append to it. entrypoint = [\u0026#39;/manager\u0026#39;] dockerfile = \u0026#39;tilt.dockerfile\u0026#39; if settings.get(\u0026#39;debug\u0026#39;).get(\u0026#39;enabled\u0026#39;): k8s_resource(\u0026#39;ocm-controller\u0026#39;, port_forwards=[ port_forward(30000, 30000, \u0026#39;debugger\u0026#39;), ]) entrypoint = [\u0026#39;/dlv\u0026#39;, \u0026#39;--listen=:30000\u0026#39;, \u0026#39;--api-version=2\u0026#39;, \u0026#39;--continue=true\u0026#39;, \u0026#39;--accept-multiclient=true\u0026#39;, \u0026#39;--headless=true\u0026#39;, \u0026#39;exec\u0026#39;, \u0026#39;/manager\u0026#39;, \u0026#39;--\u0026#39;] dockerfile = \u0026#39;tilt.debug.dockerfile\u0026#39; docker_build_with_restart( \u0026#39;ghcr.io/open-component-model/ocm-controller\u0026#39;, \u0026#39;.\u0026#39;, dockerfile = dockerfile, entrypoint = entrypoint, only=[ \u0026#39;./bin\u0026#39;, ], live_update = [ sync(\u0026#39;./bin/manager\u0026#39;, \u0026#39;/manager\u0026#39;), ], ) Now, to attach to the debugger in GoLand follow this guide: Attach To Remote Debugger.\nThe only important piece there is to clear the Shutdown remote debugger on disconnect flag.\nIn VSCode:\n{ \u0026#34;name\u0026#34;: \u0026#34;Connect to Container\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;go\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;attach\u0026#34;, \u0026#34;mode\u0026#34;: \u0026#34;remote\u0026#34;, \u0026#34;remotePath\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;port\u0026#34;: 30000, \u0026#34;host\u0026#34;: \u0026#34;127.0.0.1\u0026#34;, \u0026#34;showLog\u0026#34;: true, \u0026#34;trace\u0026#34;: \u0026#34;log\u0026#34;, \u0026#34;logOutput\u0026#34;: \u0026#34;rpc\u0026#34; } And that\u0026rsquo;s it! We got delve working.\nLet\u0026rsquo;s take a look at the full Tiltfile.\n# -*- mode: Python -*- kubectl_cmd = \u0026#34;kubectl\u0026#34; flux_cmd = \u0026#34;flux\u0026#34; # verify kubectl command exists if str(local(\u0026#34;command -v \u0026#34; + kubectl_cmd + \u0026#34; || true\u0026#34;, quiet = True)) == \u0026#34;\u0026#34;: fail(\u0026#34;Required command \u0026#39;\u0026#34; + kubectl_cmd + \u0026#34;\u0026#39; not found in PATH\u0026#34;) # set defaults settings = { \u0026#34;flux\u0026#34;: { \u0026#34;enabled\u0026#34;: False, \u0026#34;bootstrap\u0026#34;: True, \u0026#34;repository\u0026#34;: os.getenv(\u0026#34;FLUX_REPOSITORY\u0026#34;, \u0026#34;podinfo-flux-example\u0026#34;), \u0026#34;owner\u0026#34;: os.getenv(\u0026#34;FLUX_OWNER\u0026#34;, \u0026#34;\u0026#34;), \u0026#34;path\u0026#34;: os.getenv(\u0026#34;FLUX_PATH\u0026#34;, \u0026#34;.\u0026#34;), }, \u0026#34;install_unpacker\u0026#34;: { \u0026#34;enabled\u0026#34;: False, \u0026#34;path\u0026#34;: \u0026#34;\u0026#34;, }, \u0026#34;debug\u0026#34;: { \u0026#34;enabled\u0026#34;: False, }, \u0026#34;create_secrets\u0026#34;: { \u0026#34;enable\u0026#34;: True, \u0026#34;token\u0026#34;: os.getenv(\u0026#34;GITHUB_TOKEN\u0026#34;, \u0026#34;\u0026#34;), \u0026#34;email\u0026#34;: os.getenv(\u0026#34;GITHUB_EMAIL\u0026#34;, \u0026#34;\u0026#34;), \u0026#34;user\u0026#34;: os.getenv(\u0026#34;GITHUB_USER\u0026#34;, \u0026#34;\u0026#34;), }, \u0026#34;forward_registry\u0026#34;: False, \u0026#34;verification_keys\u0026#34;: {}, } # global settings tilt_file = \u0026#34;./tilt-settings.yaml\u0026#34; if os.path.exists(\u0026#34;./tilt-settings.yaml\u0026#34;) else \u0026#34;./tilt-settings.json\u0026#34; settings.update(read_yaml( tilt_file, default = {}, )) load(\u0026#39;ext://secret\u0026#39;, \u0026#39;secret_yaml_registry\u0026#39;, \u0026#39;secret_from_dict\u0026#39;, \u0026#39;secret_create_generic\u0026#39;) def bootstrap_or_install_flux(): opts = settings.get(\u0026#34;flux\u0026#34;) if not opts.get(\u0026#34;enabled\u0026#34;): return if str(local(\u0026#34;command -v \u0026#34; + flux_cmd + \u0026#34; || true\u0026#34;, quiet = True)) == \u0026#34;\u0026#34;: fail(\u0026#34;Required command \u0026#39;\u0026#34; + flux_cmd + \u0026#34;\u0026#39; not found in PATH\u0026#34;) # flux bootstrap github --owner=${FLUX_OWNER} --repository=${FLUX_REPOSITORY} --path ${FLUX_PATH} if opts.get(\u0026#34;bootstrap\u0026#34;): local(\u0026#34;%s bootstrap github --owner %s --repository %s --path %s\u0026#34; % (flux_cmd, opts.get(\u0026#39;owner\u0026#39;), opts.get(\u0026#39;repository\u0026#39;), opts.get(\u0026#39;path\u0026#39;))) else: local(flux_cmd + \u0026#34; install\u0026#34;) def install_unpacker(): opts = settings.get(\u0026#34;install_unpacker\u0026#34;) if not opts.get(\u0026#34;enabled\u0026#34;): return def create_secrets(): opts = settings.get(\u0026#34;create_secrets\u0026#34;) if not opts.get(\u0026#34;enable\u0026#34;): return k8s_yaml(secret_yaml_registry(\u0026#34;regcred\u0026#34;, \u0026#34;ocm-system\u0026#34;, flags_dict = { \u0026#39;docker-server\u0026#39;: \u0026#39;ghcr.io\u0026#39;, \u0026#39;docker-username\u0026#39;: opts.get(\u0026#39;user\u0026#39;), \u0026#39;docker-email\u0026#39;: opts.get(\u0026#39;email\u0026#39;), \u0026#39;docker-password\u0026#39;: opts.get(\u0026#39;token\u0026#39;), })) k8s_yaml(secret_from_dict(\u0026#34;creds\u0026#34;, \u0026#34;ocm-system\u0026#34;, inputs = { \u0026#39;username\u0026#39; : opts.get(\u0026#39;user\u0026#39;), \u0026#39;password\u0026#39; : opts.get(\u0026#39;token\u0026#39;), })) def create_verification_keys(): keys = settings.get(\u0026#34;verification_keys\u0026#34;) if not keys: return for key, value in keys.items(): secret_create_generic(key, \u0026#39;ocm-system\u0026#39;, from_file=value) # set up the development environment # check if flux is needed bootstrap_or_install_flux() # check if installing unpacker is needed install_unpacker() # Use kustomize to build the install yaml files install = kustomize(\u0026#39;config/default\u0026#39;) # Update the root security group. Tilt requires root access to update the # running process. objects = decode_yaml_stream(install) for o in objects: if o.get(\u0026#39;kind\u0026#39;) == \u0026#39;Deployment\u0026#39; and o.get(\u0026#39;metadata\u0026#39;).get(\u0026#39;name\u0026#39;) == \u0026#39;ocm-controller\u0026#39;: o[\u0026#39;spec\u0026#39;][\u0026#39;template\u0026#39;][\u0026#39;spec\u0026#39;][\u0026#39;securityContext\u0026#39;][\u0026#39;runAsNonRoot\u0026#39;] = False if settings.get(\u0026#39;debug\u0026#39;).get(\u0026#39;enabled\u0026#39;): o[\u0026#39;spec\u0026#39;][\u0026#39;template\u0026#39;][\u0026#39;spec\u0026#39;][\u0026#39;containers\u0026#39;][0][\u0026#39;ports\u0026#39;] = [{\u0026#39;containerPort\u0026#39;: 30000}] break updated_install = encode_yaml_stream(objects) # Apply the updated yaml to the cluster. k8s_yaml(updated_install) # Create Secrets create_secrets() create_verification_keys() load(\u0026#39;ext://restart_process\u0026#39;, \u0026#39;docker_build_with_restart\u0026#39;) # enable hot reloading by doing the following: # - locally build the whole project # - create a docker imagine using tilt\u0026#39;s hot-swap wrapper # - push that container to the local tilt registry # Once done, rebuilding now should be a lot faster since only the relevant # binary is rebuilt and the hot swat wrapper takes care of the rest. gcflags = \u0026#39;\u0026#39; if settings.get(\u0026#39;debug\u0026#39;).get(\u0026#39;enabled\u0026#39;): gcflags = \u0026#39;-N -l\u0026#39; local_resource( \u0026#39;manager\u0026#39;, \u0026#34;CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -gcflags \u0026#39;{gcflags}\u0026#39; -o bin/manager ./\u0026#34;.format(gcflags=gcflags), deps = [ \u0026#34;main.go\u0026#34;, \u0026#34;go.mod\u0026#34;, \u0026#34;go.sum\u0026#34;, \u0026#34;api\u0026#34;, \u0026#34;controllers\u0026#34;, \u0026#34;pkg\u0026#34;, ], ) # Build the docker image for our controller. We use a specific Dockerfile # since tilt can\u0026#39;t run on a scratch container. # `only` here is important, otherwise, the container will get updated # on _any_ file change. We only want to monitor the binary. # If debugging is enabled, we switch to a different docker file using # the delve port. entrypoint = [\u0026#39;/manager\u0026#39;] dockerfile = \u0026#39;tilt.dockerfile\u0026#39; if settings.get(\u0026#39;debug\u0026#39;).get(\u0026#39;enabled\u0026#39;): k8s_resource(\u0026#39;ocm-controller\u0026#39;, port_forwards=[ port_forward(30000, 30000, \u0026#39;debugger\u0026#39;), ]) entrypoint = [\u0026#39;/dlv\u0026#39;, \u0026#39;--listen=:30000\u0026#39;, \u0026#39;--api-version=2\u0026#39;, \u0026#39;--continue=true\u0026#39;, \u0026#39;--accept-multiclient=true\u0026#39;, \u0026#39;--headless=true\u0026#39;, \u0026#39;exec\u0026#39;, \u0026#39;/manager\u0026#39;, \u0026#39;--\u0026#39;] dockerfile = \u0026#39;tilt.debug.dockerfile\u0026#39; docker_build_with_restart( \u0026#39;ghcr.io/open-component-model/ocm-controller\u0026#39;, \u0026#39;.\u0026#39;, dockerfile = dockerfile, entrypoint = entrypoint, only=[ \u0026#39;./bin\u0026#39;, ], live_update = [ sync(\u0026#39;./bin/manager\u0026#39;, \u0026#39;/manager\u0026#39;), ], ) if settings.get(\u0026#39;forward_registry\u0026#39;): k8s_resource(\u0026#39;ocm-controller\u0026#39;, extra_pod_selectors = [{\u0026#39;app\u0026#39;: \u0026#39;registry\u0026#39;}], port_forwards=5000) That last line extracts a resource that Tilt doesn\u0026rsquo;t control. But we can say that it\u0026rsquo;s the resource ocm-controller by defining a label selector.\nNumbers So what did we improve after ALL of this hassle? Well, let\u0026rsquo;s see. Before, we needed around 2 minutes to build and deploy then test something. With Tilt, now it\u0026rsquo;s 10-15 SECONDS tops! That is a huge improvement in the feedback loop.\nWhen it gets annoying Any drawbacks? Well, if you are using GoLand or save changes frequently, it will rebuild. On. Each. Save. That can be pretty annoying. Luckily, Tilt got you covered. If you would like to pause for a second to do some rapid-fire changes, disable the local_resource ( whatever you named it, for me it\u0026rsquo;s manager ) that is the Go Build. If you do that, no changes will be reconciled, which means, the container will not be hot-swapped either.\nLooks like this:\nOnce re-enabled, you can continue your development cycle.\nConclusion Tilt is not easy to set up at times. Especially when you have to fiddle with a lot of access and custom-built stuff. The syntax and view of a complex Tiltfile can be rather intimidating. Some structure adds easier ways of reading, but sadly, this is seldom the case.\nHowever, it can be helped. A nice Tiltfile with rightly named functions and a good structure can help a lot in readability. Also, comments. And I can\u0026rsquo;t stress this enough. Add comments! They help a lot for a new person reading the file and understanding what is being altered why and where.\nThe Tiltfile as it looks like at the writing of this post can be found here.\nI hope this helped, and good luck!\nAs always,\nThank you for reading, Gergely.\n","permalink":"https://skarlso.github.io/2023/02/25/rapid-controller-development-with-tilt/","summary":"Welcome dear reader.\nToday, we are going to dive into how to use Tilt to speed up the feedback loop of developing a Kubernetes controller. We are going to do that using an open-source project called OCM which has a controller called ocm-controller. I\u0026rsquo;m going to walk through the following process:\nresearching tilt what it could do for me understanding the Tilt file trivial mapping of the developer process understanding Starlark adding more features tackling hot swapping troubleshooting Let\u0026rsquo;s dive in.","title":"Rapid Kubernetes Controller Development with Tilt"},{"content":"You can see, I wasn\u0026rsquo;t able to decide on a title. That\u0026rsquo;s because I wanted to express more than a \u0026ldquo;How to get started with Journaling\u0026rdquo; kind of vibe. There are a lot of posts about that already. Rather, this post depicts my struggle to get into this habit.\nTL;DR\nIt turned out that it took way too long to get into writing a simple entry with too many steps. Taking out a notebook and starting to write is a lot faster and cheaper.\nFor more details about the hows and whys, dear reader, continue.\nDigital Note Taking Let me tell you right off the bat, that I tried MANY things in the digital area. Wikis, note takers, markdown, not markdown. Syncs, dedicated software, and lately, Obsidian.\nObsidian works the best for me to this day. I use it for a lot of things, like notes for when I\u0026rsquo;m working on an issue. I use it as a second brain to store information. But that\u0026rsquo;s about it. I found it cumbersome when I wanted to use it for anything more/else. Such as journaling or Zettelkasten even.\nAs a Second-Brain it is invaluable. I search in it and review it when I can. But as a means to get into journaling and building a habit, it\u0026rsquo;s not working out. Why you may ask dear reader?\nSimple. It takes way too many steps to get to it. Even after I reduced some, it still takes too many steps. In the book, Atomic Habits, to build a habit, you need four basic steps.\nCue Craving Response Reward One of the most important steps is Make a new Habit more accessible/visible/obvious. Obsidian is way too far away.\nWhat are some of the steps to access Obsidian, let\u0026rsquo;s say, in the morning?\nWake up (( do other, none relevant things )) Walk to the computer Sit down ( Here is where it will fork around a bit ) (( if, I remembered on the previous day to not turn off my computer but let is sleep )) Hit a key on the keyboard to let it wake up Wait for my monitor to spin up Hit a couple more keys and get impatient in waiting The monitor finally turns on Log in (( if, I turned my computer off because I don\u0026rsquo;t want it to run all day then night )) Turn on the computer Wait of encryption to unlock The rest from above (( if, I remembered on the previous day to leave Obsidian open as the forefront app )) Once the computer is unlocked, create a new note Format it, add some title, start writing ( done ) (( if, I didn\u0026rsquo;t )) Switch to / Open Obsidian Create a new note Format it, add some title, start writing ( done ) (( if, I left a new entry already open ( this is a HUGE if ) and Obsidian is in focus )) Start writing So, even if I develop the habit to prepare for the next time ( which is also a thing in Atomic Habits ) I would have to remember a lot to do for it to work perfectly. And even then I would have to wait for all the things to turn on.\nThis is just too much time. Second Brain works, because I\u0026rsquo;m already at my computer when I\u0026rsquo;m learning something/do some kind of research/working. If I\u0026rsquo;m not at my computer, I probably have my phone with me, on which I can type rather quickly. So\u0026hellip; why not just use that, you might ask, dear reader?\nLet\u0026rsquo;s investigate.\nWake up Get my phone Unlock with pin ( I hate any kind of recognition thing that lets people unlock my phone with my unconscious body ) Open the app ( I put it in an easily accessible location ) Click / Switch / Swipe through it to open a new note ( or press a button that immediately opens a new note ) Start typing This is almost reasonable. But turns out, I hate having to type in my pin, select the app then press another thing. It\u0026rsquo;s just too high of an entry point. Maybe if my habit would already be formed the urge to do the thing I wanted would be higher. However\u0026hellip; There is another aspect to it that many will not acknowledge or glance over rather quickly.\nThe sense of not being present Maybe it is just me, but I think it\u0026rsquo;s just plain rude if you aren\u0026rsquo;t living alone. If you have family, and your relationship is good, you would like to engage with them and not bury yourself behind a screen, or immediately sit down in front of the computer. Of course, I can explain to my wife that I\u0026rsquo;m just journaling or writing down something, but for me, it still feels rude. I can\u0026rsquo;t help it.\nIn contrast, when I sit down and write something in a notebook that\u0026rsquo;s a conversation starter. My 5-year-old daughter immediately gets engaged and asks, what are you writing daddy? If I would be buried in the phone screen she\u0026rsquo;ll probably nag that I\u0026rsquo;m not paying attention to her. And, I believe, she would be right in that nag. Therefore, I try to avoid checking my phone too often when I\u0026rsquo;m around my family. But maybe, that\u0026rsquo;s just me.\nIf you aren\u0026rsquo;t convinced yet, here is another story. Recently, I had to go to a doctor because my knees are busted and need sugary. I write down everything in a small notebook when I feel the need, but this time, I forgot to take it with me, because I was using a different bag.\nThus, I resorted to taking notes and writing down some questions on my phone. The doctor actually got annoyed with me after two seconds, because she thought I\u0026rsquo;m not paying attention at all. Since it just looked like I was playing with my phone. I explained that, oh, no, no, I\u0026rsquo;m just taking notes and I have some questions written down here I would like to ask.\nShe said something like, oh okay, and proceeded to answer, but after a minute or two, she asked me to put it away, because it was annoying. And I completely understood. I never got any side-eye because I was taking notes in my notebook. Even in today\u0026rsquo;s world, people don\u0026rsquo;t associate a phone with notes. They associate the phone with playing around. There is a reason why many schools just plain don\u0026rsquo;t allow the usage of phones in the classroom. Even if you are just taking it to take notes, a notification could pop up, or you could get distracted by other apps on your phone. That\u0026rsquo;s just the nature of the beast.\nAnalog Note Taking Let\u0026rsquo;s take a stab at analog note-taking now. I think, dear reader, you already read a bunch of things about the benefits of analog note-taking. Hand-eye coordination. Easy to draw, scribble, and be more specific with diagrams, boxes, whatever. Even if you take notes on an iPad, it\u0026rsquo;s not the same and you know it. Remarkable might work for some, but not all. And it\u0026rsquo;s expensive to be a pen and paper that you have to charge. Also, today\u0026rsquo;s notebooks are mostly recycled paper. And if you still aren\u0026rsquo;t convinced, you can buy the ones which explicitly say, they will contribute to the planet\u0026rsquo;s health.\nWe also know the drawbacks. Let\u0026rsquo;s take a look.\nUnsearchable Indeed, a paper can\u0026rsquo;t have a neat little search engine in it. There is the Second Brain for that sort of information. That said, it can be helped a little bit. Try looking at indexing methods for the written word. I like this detailed post about indexing and indexing techniques from Soren Bjornstad.\nWhether you index by page or by keywords it gets a lot better finding things in your notebooks than flipping around pages.\nToo much space After a couple of years of doing this, I would imagine, that there will be several notebooks stored somewhere under your desk or in a drawer. I recommend reading this post from Austin Kleon about how to store and index notebooks.\nTL;DR: Label them and have a global index that keeps track of some other indexes in all of the books together. It\u0026rsquo;s not hard setting it up. Austin has a lot of other great posts about that.\nCrumbles after a couple of hundred years Come on.\nSo, why does this work? Back to the gist of things after this small detour. How did analog note-taking work for me in the end, you might ask dear reader? Quit talking around circles and show us the meat!\nOkay, so, compared to the previous activation cost, let\u0026rsquo;s see what it takes to get started with a notebook.\nWake up (( do other none relevant things )) Go to my desk Open my notebook at the last entry ( I have a notebook with a place marker ) Take the pen next to it Start writing That\u0026rsquo;s it. There are no extra steps whatsoever. The only thing I could make to make this even faster is if it would be next to my bed. But I prefer to write on a desk in relative comfort.\nI found myself looking forward to writing within a week of doing this. After a couple of other weeks, I found myself re-reading my journal. Something that I have never done with my digital notes.\nI went all out, and I keep track of expenses and projects in a project notebook and a small notebook for the expenses. It works. Why? Because it\u0026rsquo;s visible. It\u0026rsquo;s immediate. It\u0026rsquo;s next to me. I see it all the time. It\u0026rsquo;s not hidden in an app, not hidden in my computer. It. Is. Right. There.\nIt turns out, that helps immensely in getting started and building up my habit. I also found myself writing more and more by hand for other things too. For example, I finished Advent Of Code 2022 by writing everything down. It helped a lot. Something about writing and drawing small diagrams helped a lot in understanding the problem. I tried doing that digitally one day. I reverted to paper after a few minutes because it was too cumbersome to create diagrams and map out simple relationships. It\u0026rsquo;s not impossible, but honestly, you will never replace a simple stroke of a pen with digital technology that doesn\u0026rsquo;t use a\u0026hellip; pen.\nJust a preference? So, there you have it, dear reader. That\u0026rsquo;s my preference. You read my story, you know what I like and how I learned to get into journaling. Maybe this will help you get started a bit and after the habit is strong, you can try and make it digital. For, I believe, it will never replace my notebook. It\u0026rsquo;s just way too convenient. I can simply start writing, and drawing, with no battery, no nothing other than the pen drying out or the pages running out.\nConclusion Thank you for following me on this journey. I hope you enjoyed it.\nHave a nice day!\nGergely.\n","permalink":"https://skarlso.github.io/2023/01/04/forming-the-habit-of-journaling/","summary":"You can see, I wasn\u0026rsquo;t able to decide on a title. That\u0026rsquo;s because I wanted to express more than a \u0026ldquo;How to get started with Journaling\u0026rdquo; kind of vibe. There are a lot of posts about that already. Rather, this post depicts my struggle to get into this habit.\nTL;DR\nIt turned out that it took way too long to get into writing a simple entry with too many steps. Taking out a notebook and starting to write is a lot faster and cheaper.","title":"Forming the habit of analog journaling - Why the digital format did not work for me"},{"content":"Hello.\nThis one is a quick update. Just a showcase really.\nI wrote a tool to generate a sample YAML file from a CRD.\nGiven a CRD like this one, it would output a generate yaml sample like this:\napiVersion: infrastructure.cluster.x-k8s.io/v1beta1 kind: AWSCluster metadata: {} spec: additionalTags: {} bastion: allowedCIDRBlocks: [\u0026#34;string\u0026#34;] ami: string disableIngressRules: true enabled: true instanceType: string controlPlaneEndpoint: host: string port: 1 controlPlaneLoadBalancer: additionalSecurityGroups: [\u0026#34;string\u0026#34;] crossZoneLoadBalancing: true healthCheckProtocol: string name: string scheme: string subnets: [\u0026#34;string\u0026#34;] identityRef: kind: AWSCluster name: string imageLookupBaseOS: string imageLookupFormat: string imageLookupOrg: string network: cni: cniIngressRules: - description: string fromPort: 1 protocol: string toPort: 1 securityGroupOverrides: {} subnets: - availabilityZone: string cidrBlock: string id: string ipv6CidrBlock: string isIpv6: true isPublic: true natGatewayId: string routeTableId: string tags: {} vpc: availabilityZoneSelection: string availabilityZoneUsageLimit: 1 cidrBlock: string id: string internetGatewayId: string ipv6: cidrBlock: string egressOnlyInternetGatewayId: string poolId: string tags: {} region: string s3Bucket: controlPlaneIAMInstanceProfile: string name: string nodesIAMInstanceProfiles: [\u0026#34;string\u0026#34;] sshKeyName: string status: bastion: addresses: - address: string type: string availabilityZone: string ebsOptimized: true enaSupport: true iamProfile: string id: string imageId: string instanceState: string networkInterfaces: [\u0026#34;string\u0026#34;] nonRootVolumes: - deviceName: string encrypted: true encryptionKey: string iops: 1 size: 1 throughput: 1 type: string privateIp: string publicIp: string rootVolume: deviceName: string encrypted: true encryptionKey: string iops: 1 size: 1 throughput: 1 type: string securityGroupIds: [\u0026#34;string\u0026#34;] spotMarketOptions: maxPrice: string sshKeyName: string subnetId: string tags: {} tenancy: string type: string userData: string volumeIDs: [\u0026#34;string\u0026#34;] conditions: - lastTransitionTime: string message: string reason: string severity: string status: string type: string failureDomains: {} networkStatus: apiServerElb: attributes: crossZoneLoadBalancing: true idleTimeout: 1 availabilityZones: [\u0026#34;string\u0026#34;] dnsName: string healthChecks: healthyThreshold: 1 interval: 1 target: string timeout: 1 unhealthyThreshold: 1 listeners: - instancePort: 1 instanceProtocol: string port: 1 protocol: string name: string scheme: string securityGroupIds: [\u0026#34;string\u0026#34;] subnetIds: [\u0026#34;string\u0026#34;] tags: {} securityGroups: {} ready: true The link to the repo is here. Enjoy.\nFeedback is welcomed.\nThanks,\nGergely.\n","permalink":"https://skarlso.github.io/2022/10/19/crd-to-yaml/","summary":"Hello.\nThis one is a quick update. Just a showcase really.\nI wrote a tool to generate a sample YAML file from a CRD.\nGiven a CRD like this one, it would output a generate yaml sample like this:\napiVersion: infrastructure.cluster.x-k8s.io/v1beta1 kind: AWSCluster metadata: {} spec: additionalTags: {} bastion: allowedCIDRBlocks: [\u0026#34;string\u0026#34;] ami: string disableIngressRules: true enabled: true instanceType: string controlPlaneEndpoint: host: string port: 1 controlPlaneLoadBalancer: additionalSecurityGroups: [\u0026#34;string\u0026#34;] crossZoneLoadBalancing: true healthCheckProtocol: string name: string scheme: string subnets: [\u0026#34;string\u0026#34;] identityRef: kind: AWSCluster name: string imageLookupBaseOS: string imageLookupFormat: string imageLookupOrg: string network: cni: cniIngressRules: - description: string fromPort: 1 protocol: string toPort: 1 securityGroupOverrides: {} subnets: - availabilityZone: string cidrBlock: string id: string ipv6CidrBlock: string isIpv6: true isPublic: true natGatewayId: string routeTableId: string tags: {} vpc: availabilityZoneSelection: string availabilityZoneUsageLimit: 1 cidrBlock: string id: string internetGatewayId: string ipv6: cidrBlock: string egressOnlyInternetGatewayId: string poolId: string tags: {} region: string s3Bucket: controlPlaneIAMInstanceProfile: string name: string nodesIAMInstanceProfiles: [\u0026#34;string\u0026#34;] sshKeyName: string status: bastion: addresses: - address: string type: string availabilityZone: string ebsOptimized: true enaSupport: true iamProfile: string id: string imageId: string instanceState: string networkInterfaces: [\u0026#34;string\u0026#34;] nonRootVolumes: - deviceName: string encrypted: true encryptionKey: string iops: 1 size: 1 throughput: 1 type: string privateIp: string publicIp: string rootVolume: deviceName: string encrypted: true encryptionKey: string iops: 1 size: 1 throughput: 1 type: string securityGroupIds: [\u0026#34;string\u0026#34;] spotMarketOptions: maxPrice: string sshKeyName: string subnetId: string tags: {} tenancy: string type: string userData: string volumeIDs: [\u0026#34;string\u0026#34;] conditions: - lastTransitionTime: string message: string reason: string severity: string status: string type: string failureDomains: {} networkStatus: apiServerElb: attributes: crossZoneLoadBalancing: true idleTimeout: 1 availabilityZones: [\u0026#34;string\u0026#34;] dnsName: string healthChecks: healthyThreshold: 1 interval: 1 target: string timeout: 1 unhealthyThreshold: 1 listeners: - instancePort: 1 instanceProtocol: string port: 1 protocol: string name: string scheme: string securityGroupIds: [\u0026#34;string\u0026#34;] subnetIds: [\u0026#34;string\u0026#34;] tags: {} securityGroups: {} ready: true The link to the repo is here.","title":"Generate a sample YAML file from a CRD"},{"content":"Hello!\nI\u0026rsquo;ve been working on something extensive these days. Like my Grokking Algorithms summary, I now moved on to read Common-Sense Guide to Data Structures and Algorithms.\nAs with Grokking, I created a Go based repo and added notes for each chapter.\nThe repo can be located here.\nEnjoy, and thanks for reading. Gergely.\n","permalink":"https://skarlso.github.io/2022/09/25/data-structures-and-algorithms/","summary":"Hello!\nI\u0026rsquo;ve been working on something extensive these days. Like my Grokking Algorithms summary, I now moved on to read Common-Sense Guide to Data Structures and Algorithms.\nAs with Grokking, I created a Go based repo and added notes for each chapter.\nThe repo can be located here.\nEnjoy, and thanks for reading. Gergely.","title":"Summary of Common Sense guide to Data Structures and Algorithms"},{"content":"How to contribute to a new repository Hello Dear readers.\nToday, I\u0026rsquo;m going to walk you through a process of contributing into a new repository. If you are new to Go development and would like to contribute somewhere but are at a loss in large repositories, this post will be for you.\nI selected the top repository in trending Go today. Which is istio. I think that\u0026rsquo;s sufficiently large and I have no idea about the repository, so I\u0026rsquo;m going to walk you through my process. I did choose a repo that is in the area of my expertise though so I have an easier time deciphering what it is trying to do in the first place.\nThat is a good place to start at. Look for an area that you have at least a tiny bit of a clue about. Or if the area is completely dark for you, read up on it first. In case of istio, that would probably be Envoy and Kubernetes and a bit of networking.\nNotes As mentioned in this post, I take notes about a repository in my notebook when I first encounter it. Well, how does this look like exactly?\nGeneral Overview Once I located a project, I start taking it apart. Reading any docs, taking notes and drawing conclusions about what it does and why it\u0026rsquo;s existence is warranted. This looks like this:\nWe can see here I took some notes about what Istio does and hand drawn some images that they have. Why did I copy that? Because it helps me to understand the image better. Writing it all down and drawing it by hand helps me internalise it.\nRepository Next, I try to analyze what kind of repository I\u0026rsquo;m dealing with. CLI, Library, some kind of backend service, operator, server etc. Once I have a general understanding of what I\u0026rsquo;m dealing with, I inspect each and every folder individually and take notes about what they do at a high level and possible connections to other folders. This looks like this:\nWhen I go through the folders I also note down possible locations for editing things. Like the cni folder which most likely contains code I\u0026rsquo;m interested in.\nBuilding and test environment Next, how is the project built and set up? It\u0026rsquo;s not enough to understand the code. Eventually, I have to build and test what I wrote. Understanding how the environment is set up is crucial in understand how the whole thing works. Is it fully automatic, or does it require human interaction? Is it using containers? Does it have a Makefile? Does it have any other files? Manifest files, configuration, images, logo, static API documentation, sample codes\u0026hellip; etc. There are so many things besides code that are interesting and can tell you much about the project itself.\nThird party dependencies for example will tell you how many things you will need to get the project started. Does it have a dev guide? If not, can you write one? Often times, when I face a project which doesn\u0026rsquo;t have a dev guide but I have to/or want to work on it, I start with writing a dev guide while I\u0026rsquo;m trying to set it up and make it work first.\nOnce it\u0026rsquo;s working locally, I will start to either improve the dev process or convert my notes into a dev guide and contribute that back into the project.\nWhy bother with a local environment? Because feedback is the most important part of all of this. The feedback when writing code, by feedback I mean the time it takes to run the code and get back if it\u0026rsquo;s working or not, must be as quick as possible. No one likes waiting an hour just to find out that there was a typo in the code. Unit tests, manual tests must be fast coming. End-to-end tests are usually executed at the end of a dev cycle. They can, of course, lead to restarting the dev cycle but usually you don\u0026rsquo;t start out by running them.\nIssues and Testing Now, what to work on? You have a couple of choices. Improving documentation is always something that everyone will welcome. Why? Because writing docs is hard. Writing is hard. It takes effort and knowledge about the project. Dev guides are interesting and might actually be better written by someone outside the project because they won\u0026rsquo;t have project bias.\nBut if you don\u0026rsquo;t find any of this attractive and want to get your hands dirty, you might want to look through issues. Usually, if a project is big enough and a maintainers nice enough, you\u0026rsquo;ll have issues with labels like Good First Issue or Community Help Requested or Help Wanted. These are great places to start at. But more often than not, there are either no issues or none that you have any particular interest in or nothing that you can actually work on because they require background knowledge that you simply don\u0026rsquo;t have yet.\nWhat do you do in these cases? You start following the code as a flow. Try understanding what it\u0026rsquo;s doing if you follow through a use-case step-by-step. Or, simply, improve the test coverage. I assure you that no project out there, or only a small percentage, will have test coverage above 60-70%. And even then I might be optimistic.\nTake that on. The way I started writing Go is actually through improving the test coverage in Hugo and Go itself. Usually, test coverage PRs are also merged relatively fast, without too much hassle too. Thus it\u0026rsquo;s a good start to get your foot into the door.\nCoding Now that we have what we want, let\u0026rsquo;s get to coding. What I do first, before starting to code, is get to know the codebase. Get to know what kind of conventions there are. How the code is written and what you have to follow to use the same things. Look for interfaces, string formatters, even utils although I hate that package name. But still. Convenience codes exist in every repo. Try reusing as much as possible.\nIf you find that the code is not up to standards, start refactoring. Don\u0026rsquo;t change behaviour, just simplify, reduce, refactor. Refactoring and simplifying can help you a lot in understanding what the code does, because you basically rewrite it.\nSubmitting a PR Now that you have a bit of code even the smallest changeset will get you started in contributing to the project. Even if it\u0026rsquo;s a tiny bug fix it will get you started. I found that I sometimes think way too much about starting when in fact I should have just typed out a line of code or two and get to hacking. Just start writing for two minutes and get started! From there, things will come naturally.\nConclusion I was planning on having this post a bit larger and actually working on an issue in Istio but I have a new project which requires a lot of time learning the ins and outs of so I can\u0026rsquo;t learn yet another project right now.. But I also wanted to get started on this blog post and do write some remarks as an extra.\nThank you for reading!\nGergely.\n","permalink":"https://skarlso.github.io/2022/07/01/how-to-contribute-to-a-new-repository/","summary":"How to contribute to a new repository Hello Dear readers.\nToday, I\u0026rsquo;m going to walk you through a process of contributing into a new repository. If you are new to Go development and would like to contribute somewhere but are at a loss in large repositories, this post will be for you.\nI selected the top repository in trending Go today. Which is istio. I think that\u0026rsquo;s sufficiently large and I have no idea about the repository, so I\u0026rsquo;m going to walk you through my process.","title":"How to contribute to a new repository"},{"content":"Hacking on CAPA - The journey of implementing a nontrivial feature in a barely known codebase Hello Dear readers.\nToday, I would like to write about a project I\u0026rsquo;ve been working on these past months or so. This is a longer story and hopefully an interesting one to read.\nI\u0026rsquo;m going to write about the journey I took while trying to implement IPv6 based Kubernetes cluster for CAPA and EKS.\nThe interesting points of this journey are twofold. First, understanding IPv6 in AWS land and how it\u0026rsquo;s configured and how it works. What are it\u0026rsquo;s limitations and requirements? Topology, routing, security groups, launch configuration, IAM roles, node policies\u0026hellip; etc.\nThe second part is the codebase of CAPA, which was largely unknown to me. What I\u0026rsquo;m going to write about here is how I navigated these hurdles.\nTL;DR I take lots of notes and re-work these notes into a semi-zettelkasten format I read RFCs and documentations a couple times I start exploring the codebase by reading package information and going through a known code path like, creating a cluster and reading tests I had some prior knowledge due to working on a similar project at Weaveworks ( implementing ipv6 for eksctl ) I had ample of help from one of the project maintainers who happens to work at Weaveworks I had some documentation already available on IPv6 and AWS and could compare to existing, working IPv6 clusters using eksctl What is CAPA Before I begin, let\u0026rsquo;s talk about what CAPA is. It\u0026rsquo;s a project which implements cluster API for Kubernetes using AWS. CAPI ( Cluster API ) is simply a set of API projects and tooling for Kubernetes to basically use Kubernetes programmatically. It provides a way to create clusters using a management cluster which runs the API code using a couple CRDs and controllers.\nOnce you create your management cluster, you can apply a YAML template which will use the AWS API to create a set of objects for an EKS cluster. These are for example, IAM roles, a VPC, subnets, routing tables, security groups, IGWs, NAT gateways, instances and many many more things. Once that\u0026rsquo;s done it will keep reconciling the cluster. Detect diffs and manage its state until you remove the resources for it ( the CRDs installed onto the management cluster ).\nIPv6 The first thing to tackle was understanding and knowing IPv6. Though, funny enough, as we\u0026rsquo;ll see later, it wasn\u0026rsquo;t a hard requirement. Never the less, it did me good to study up on it.\nHow do I approach the unknown The reason why I wanted to understand IPv6 was because of how to calculate subnets. Subnetting is an interesting topic in the land of IPs and one that isn\u0026rsquo;t easy to grasp if you aren\u0026rsquo;t into these kinds of things in the first place.\nI did learn how to calculate CIDRs for IPv4 so I thought it should be kind of in the same ballpark. It actually took me a while to find a resource which neatly explained the math behind the calculations and not just throw a website into my face into which you input a prefix range and done, you have your subnets. I rarely watch videos but this one has a neat explanation with detailed calculations and samples.\nWhat I do in these cases, is as follows. I open up a new page in my trusty notebook and start listing what things I can read or watch to understand the subject at hand better. Then I slowly start working down my list, taking notes from the material or video in a fashion similar as what is depicted in Effective Note taking book written by Dr. Fiona McPherson. I create concept graphs and various visuals and just write down my thoughts.\nI\u0026rsquo;ll try to connect to future notes or write ideas next to it, things like \u0026ldquo;Oh this will be useful when I do x,y,z\u0026rdquo;.\nA page from one my notes:\nThis is in pre-review format. Once I\u0026rsquo;m done with a material, I\u0026rsquo;ll start translating the notes and get the gist of it into a semi-zettelkasten type of note system using Obsidian. Or if it makes more sense, I\u0026rsquo;ll use a single obsidian note to collect all the things together. For this implementation I\u0026rsquo;m doing on CAPA I have a single file which points to various other files with various other information about the code and about IPv6 itself.\nOnce I translated my written notes, I\u0026rsquo;ll move on to the next topic. I have lots of tags and always create back-links. I use something akin to Zettelkasten but with a slight modification that sometimes my atomic notes contain a bit more information than a single idea.\nWhy use a notebook in the digital age? I like writing by hand. It gives me a motoric impression of the subject and drawing pictures is a lot easier. Also, I found if I take notes on the computer in Obsidian directly, I tend to ramble more because typing is so easy. Which leaves my notes full of unnecessary information that I have to go through when refining. Lots more to read. Further, typing is so easy indeed, that it\u0026rsquo;s too easy. There are no motoric impressions, no muscle memory built no aid in thinking. And lastly, the linear nature of a notebook forces me to focus on a single thing at once unless I want my notes completely jumbled up. If I\u0026rsquo;m on the computer I found I tend to jump around different subjects all the time and not finish what I started.\nThis blog post\u0026rsquo;s idea has its origins in a notebook.\nUnderstanding IPv6 The first step I took was to understand IPv6 itself. I already knew a couple of things about it, but I didn\u0026rsquo;t intimately knew its structure and composition. The best way to know about these things is go to the source. I read a couple of RFCs about it. Notably RFC 8200 - The protocol itself and RFC 4291 - The Address itself.\nReading these and taking notes and understanding the underlying technology made me not be afraid of it anymore. But also it had the added benefit of me understanding why some of the decisions were made at AWS. I have a saying.\nIf you are afraid of it, you have to do it. If some technology or software concept or hard problem intimidates you THAT is a clear sign that you have to understand it and make it your own.\nNext, I watched the video about subnetting and read some posts, of which I saved the links and took some notes that I connected back to my existing notes, to get a large picture and the immediate usage and interesting parts of IPv6.\nIt was time to put it all in perspective.\nUnderstanding IPv6 in relation to AWS As always with AWS finding documentation which describes a feature in its completeness is near impossible. I found various blog posts, some hints here and there and when you open the EKS console page, there is an announcement at the top that they started supporting IPv6. That page contains some information about restrictions and requirements. But nothing profound enough to know how to call some APIs or what to set up or how routing works exactly. Or what to pass to the VPC. Or how to slice subnets not using eksctl and cloudformation.\nLucky for me, I had some prior knowledge in the area. I work at https://weave.works/. And at eksctl a couple of co-workers of mine already did some research and created some documentations that I was able to follow. But ultimately, that was using a different approach because it\u0026rsquo;s using CloudFormation. But the notes on security groups and VPCs was invaluable.\nThe other guide which helped me was the VPC usage guide and the IPv6 section. And the EKS usage guide and how to migrate to IPv6 clusters. There were numerous restrictions which helped me understand what I needed to create. I read these over 5-6 times.\nFrom all of these, notes taken into my trusty notebook in which I gathered together all the relevant information that I could connect to things I needed, I slowly put together an approach for CAPA.\nI also had the benefit that I could compare my CAPA created network topology to that of an eksctl created cluster. I could verify that the cluster created by CAPA had similar routings, VPCs and subnet configuration.\nFor example, a \u0026ldquo;private\u0026rdquo; ( there is no such thing as private in the land of IPv6 ( there are no private/local ips ) ) VPC configuration requires an Egress Only Internet Gateway for IPv6 clusters so network translation can still work.\nThe most difficult part though to discover was subnetting.\nThe journey of subnetting IPv6 My first approach was the mathematical one. I implemented code which would slice an IPv6 address into the needed number of subnets based on AZs that looked like this:\nfunc SplitIntoSubnetsIPv6(cidrBlock string, numSubnets int) ([]*net.IPNet, error) { _, parent, err := net.ParseCIDR(cidrBlock) if err != nil { return nil, errors.Wrap(err, \u0026#34;failed to parse CIDR\u0026#34;) } subnetBits := math.Ceil(math.Log2(float64(numSubnets))) networkLen, addrLen := parent.Mask.Size() modifiedNetworkLen := networkLen + int(subnetBits) if modifiedNetworkLen \u0026gt; addrLen { return nil, errors.Errorf(\u0026#34;cidr range %s cannot accommodate %d subnets\u0026#34;, cidrBlock, numSubnets) } addr, err := netaddr.ParseIPv6Net(cidrBlock) if err != nil { return nil, errors.Wrapf(err, \u0026#34;failed to parse network address %s\u0026#34;, cidrBlock) } var subnets []*net.IPNet for i := 0; i \u0026lt; numSubnets; i++ { subnetIP := addr.NthSubnet(uint(modifiedNetworkLen), uint64(i)) if subnetIP == nil { return nil, errors.Errorf(\u0026#34;exceeded the subnet space with len %d\u0026#34;, modifiedNetworkLen) } parsedSubnetIP, _, err := net.ParseCIDR(subnetIP.Long()) if err != nil { return nil, err } v := \u0026amp;net.IPNet{ IP: parsedSubnetIP, Mask: net.CIDRMask(modifiedNetworkLen, 128), } subnets = append(subnets, v) } return subnets, nil } It\u0026rsquo;s using a library to calculate the actual new IP based on NthSubnet. I did some bit shifting myself, but that turned out to be not so error resilient and didn\u0026rsquo;t handle some edge cases that the library already did.\nHowever, this research all turned out to be mute once I re-read my notes and some of the docs and I internalized the point that all subnets have a fixed prefix length of 64. And further reading about subnet IDs in IPv6 and creating IPv6 clusters using the console it became apparent that subnets are super easy, barely an inconvenience.\nSee, it basically works like this. You get an IPv6 pool and an IPv6 address with a fixed prefix length of 56. You need to switch that to 64 and just increase the subnet ID for any further subnets. This looks like this:\nfunc SplitIntoSubnetsIPv6(cidrBlock string, numSubnets int) ([]*net.IPNet, error) { _, ipv6CidrBlock, err := net.ParseCIDR(cidrBlock) if err != nil { return nil, fmt.Errorf(\u0026#34;failed to parse cidr block %s with error: %w\u0026#34;, cidrBlock, err) } // update the prefix to 64. ipv6CidrBlock.Mask = net.CIDRMask(64, 128) var ( subnets []*net.IPNet ) for i := 0; i \u0026lt; numSubnets; i++ { ipv6CidrBlock.IP[subnetIDLocation]++ newIP := net.ParseIP(ipv6CidrBlock.IP.String()) v := \u0026amp;net.IPNet{ IP: newIP, Mask: net.CIDRMask(64, 128), } subnets = append(subnets, v) } return subnets, nil } Boom. And that\u0026rsquo;s all there is to it! That\u0026rsquo;s mostly what the CloudFormation is doing internally too.\nWhy do you still need subnets? Once I gathered all resources that needed updates, it was time to write them down. Subnets and networking are obviously the two big hitters. With IPv4 we needed the separation and a thing called SecondaryCidrBlock because you can easily run out of ips. With IPv6 you don\u0026rsquo;t need to worry about that. However, we do still need to subnet, because we want resiliency through availability zones. Each AZ gets a subnet and an assigned IPv6 address.\nPrivate networking Another thing of the past is private networking. There no private addresses or local addresses for IPv6. All IPv6 addresses are public. Which means, we need another way of defining a private network. That is achieved through security groups and routing. The routes will have a new resource called EgressOnlyInternetGateway. Which is basically what it says. An IWG which works with IPv6 addresses, allows for outgoing communication through IPv6 but blocks all incoming data through IPv6.\nImplementation Time Alright. With these things out of the way, it was time to get acquainted with the source code.\nApproaching an unknown codebase I had the a couple of things on my side.\nI had ample of experience with working with controllers in Kubernetes I had personally wrote couple of projects which worked with AWS and the GO SDK I had experience in working with AWS in general I had one of the maintainers as a colleague working here at Weaveworks How did these things help me? Let\u0026rsquo;s take a look.\nThe fact that I already worked with a lot of controllers makes me aware of a couple of things when working with such a codebase. What are these?\nThe API is versioned in a certain way like alphav1 and alphav2 and betav1 and so on Lots and LOTS of generated code Controller lifecycle What does this mean? This has a couple of baggages when you think about it. The code has a reconciliation loop which takes care of creating, updating and deleting resources based on their state. But this also means that you have to always consider existing infrastructure and objects in Kubernetes. And when deleting you always have to be aware of finalizers. Unit testing and mocking calls and Kubernetes Certain package structure and code constructs All these helped me massively to discover where things are and why. Richard ( the maintainer ) talked us through a general flow and from there it was easier to go with the flow. And he was constantly available when I was stuck at a certain part like conversions\u0026hellip;\nAnalysing the code When faced with the unknown you must find what you might no in relation. I already knew it creates a cluster and that cluster has resources and log outputs. So\u0026hellip; follow the flow. I started checking out the code and followed a create code path. How a cluster is reconciled.\nI started taking notes and write down which package and path did what. I started following reconcileCluster. This is the main flow. It contained everything. I glanced over the sub flows of reconciling providers and security groups and the likes, but I mainly kept with the main flow.\nThis limitation allowed me to focus on the most important bits. Where code lives, why and how it is configured. Once I knew all of these things, I could focus on various sub-flows. Since my main focus was altering the network and instance bits, I focused on ReconcileNetwork flow and Machines.\nAgain, same thing. Go over the main flow, follow the code path, see how things are set up where they live and why, but don\u0026rsquo;t go too deep. Once the main flow is understood, follow the sub-flow, like reconcileVPC.\nUpdate, test, update, test\u0026hellip; Once I got a feel for things and noted down places where I probably will have to update something, I started updating things incrementally. Small bits at a time. My first update, for example, was this trivial thing:\n// EnableIPv6 requests an Amazon-provided IPv6 CIDR block with a /56 prefix length for // the VPC. You cannot specify the range of IP addresses, or the size of the // CIDR block. // +optional EnableIPv6 bool `json:\u0026#34;enableIPv6\u0026#34;` Basically I started updating the config types. It was a small, trivial thin to add but it got the ball rolling. Which is the most important part of tackling a hard problem. When the codebase is daunting and you have no idea where to even begin, a tiny update can make all the differences. It gets you started. It gives you an entry point.\nI started adding more new settings and types and once I had all the settings I could think of, I started writing code which actually used them. First, gradually. Things like these came in to picture:\ns.scope.VPC().EnableIPv6 = vpc.EnableIPv6 s.scope.VPC().IPv6CidrBlock = vpc.IPv6CidrBlock s.scope.VPC().IPv6Pool = vpc.IPv6Pool Just a trivial assignment. Then a tiny bit of logic\u0026hellip;\nif !s.scope.VPC().EnableIPv6 { return \u0026amp;infrav1.VPCSpec{ ID: *out.Vpc.VpcId, CidrBlock: *out.Vpc.CidrBlock, Tags: converters.TagsToMap(out.Vpc.Tags), }, nil } Deal with things that returned with normal flow. Here, the important part is that CIDR block is defined instead of IPv6CidrBlock.\nThese small, incremental updates, eventually lead to this pr: PR. As of this writing it needs some validations added and an e2e test, but it\u0026rsquo;s pretty much complete.\nTesting Tests are super important in a new codebase ( in an old one too, but that\u0026rsquo;s a different story ). Reading the tests helps me understand somewhat how the code is structured and what it does and why and what calls are expected to happen. What I do is, that I fiddle with the code and start to run the unit tests and see what things fail. That gives me more insight into how the thing I just changed works. This is invaluable when I\u0026rsquo;m facing code which is difficult to decipher.\nWrite tests folks! I don\u0026rsquo;t care if you use TDD or not, jut PLEASE write tests!\nConclusion If you made it this far, congratulations! You deserve a cookie. This has been my journey in understanding a fairly new thing and implementing it into a largely unknown codebase. How I approached it and how I eventually ended up writing around +2500 lines of code. You got some insight into how I take notes and how I figure out a larger problem in an unknown environment. I hope it was a good read and worth your time.\nThank you for reading!\nGergely.\n","permalink":"https://skarlso.github.io/2022/06/26/hacking-on-capa/","summary":"Hacking on CAPA - The journey of implementing a nontrivial feature in a barely known codebase Hello Dear readers.\nToday, I would like to write about a project I\u0026rsquo;ve been working on these past months or so. This is a longer story and hopefully an interesting one to read.\nI\u0026rsquo;m going to write about the journey I took while trying to implement IPv6 based Kubernetes cluster for CAPA and EKS.","title":"Hacking on CAPA - The journey of implementing a nontrivial feature in a barely known codebase"},{"content":"Hello Dear readers.\nToday, I would like to write about a small pet project of mine called Dependabot Bundler.\nWe\u0026rsquo;ve all been here:\nYou would like to review these individually, of course, however, having to individually merge them is quite the pain.\nIsn\u0026rsquo;t it a lot better to do this instead?\nA lot nicer and more comfortable, isn\u0026rsquo;t it?\nThis is done by running dependabot-bundler with the following command:\n./bundler --token ${GITHUB_TOKEN} --repo eksctl --owner weaveworks --author-name Skarlso --author-email gergely@weave.works --labels skip-release-notes The command has to be executed from the root folder of the project.\nThat\u0026rsquo;s all for today.\nThank you for reading! Gergely.\n","permalink":"https://skarlso.github.io/2022/05/16/dependabot-bundler/","summary":"Hello Dear readers.\nToday, I would like to write about a small pet project of mine called Dependabot Bundler.\nWe\u0026rsquo;ve all been here:\nYou would like to review these individually, of course, however, having to individually merge them is quite the pain.\nIsn\u0026rsquo;t it a lot better to do this instead?\nA lot nicer and more comfortable, isn\u0026rsquo;t it?\nThis is done by running dependabot-bundler with the following command:\n./bundler --token ${GITHUB_TOKEN} --repo eksctl --owner weaveworks --author-name Skarlso --author-email gergely@weave.","title":"Dependabot Bundler"},{"content":"Hello Dear readers.\nToday\u0026rsquo;s reader\u0026rsquo;s digest comes with a repo and some code too! Let\u0026rsquo;s dive in.\nReader\u0026rsquo;s Digest - January Immune Immune is an absolutely fabulous book. It\u0026rsquo;s amazing and in time of this pandemic a healthy read to boot. I love biology, but never went too deep into it. This book fascinated me with its colorful images, the style of Kurzgesagt story telling and the man himself, who is the voice of Kurzgesagt. I\u0026rsquo;ve read it all with his voice in my head.\nIt describes a great journey into the human body and how the immune system works in a high level view. It goes into some detail about cells and their responsibilities and how they distinguish self from other. How they wage war on intruders and how they fend off viruses and bacteria alike. It\u0026rsquo;s a captivating story! It has two major events that goes through the cycle of the immune system. One is a penetration of a toa with a sharp nail in the woods and how that infection spreads. And the other is when someone coughed in the office and you get infected by influenza.\nBook One of Wheel Of Time series Wheel Of Time is a fantasy novel I\u0026rsquo;ve been putting off reading for a while now, because it\u0026rsquo;s massive. It has 20 books in it in total. But I did start eventually with an audiobook of Eye of the world. I love Michael Kramer and Kate Reading. They are both absolutely fantastic and I know them already from other books of Brandon. The book has a good pace and although it starts off with little to no information about the world, you slowly are filled in as the journey goes.\nSkyward Flight - Cytonic This is the third book in the Skyward Flight series! We follow Spensa into the Nowhere, where she meets a gentleman adventurer named Chad. They find pirates, adventure, a quest\u0026hellip; All very much something Spensa enjoys too well. She finally gets a glimpse of her real power and understands them more. Fantastic third book, I enjoyed listening to it.\nSkyward Flight - Eversore - Book 3.1 This caught me off guard. I didn\u0026rsquo;t know this existed, neither did I know that book 2.1 exited which followed Alanik\u0026rsquo;s story and apparently, a lot of other things happened in that book too which were important to the whole of the series! I don\u0026rsquo;t understand why those didn\u0026rsquo;t come out as 1, 2, 3, 4, 5 instead of smaller books. Since they have events which are important to the characters and the story as a whole. Ah well. I listened to it now and it was fantastic. This book follows Jorgen, and how he develops his cytonic abilities. And they make acquaintance with the Kitsen!\nGrokking Algorithms Grokking Algorithms is a small book containing a set of basic algorithms explained in great detail! I made a Go based repository from them containing a great many explanations using Type Parameters (generics).\nThe repo is located here.\nThank you for reading!\nGergely.\n","permalink":"https://skarlso.github.io/2022/01/26/readers-digest/","summary":"Hello Dear readers.\nToday\u0026rsquo;s reader\u0026rsquo;s digest comes with a repo and some code too! Let\u0026rsquo;s dive in.\nReader\u0026rsquo;s Digest - January Immune Immune is an absolutely fabulous book. It\u0026rsquo;s amazing and in time of this pandemic a healthy read to boot. I love biology, but never went too deep into it. This book fascinated me with its colorful images, the style of Kurzgesagt story telling and the man himself, who is the voice of Kurzgesagt.","title":"Reader's Digest - January with Grokking Algorithms Go Generics Repository"},{"content":"Hello Dear readers.\nToday, I would like to write about a project design pattern I\u0026rsquo;ve been using successfully over the past years for various projects. It has many variations and it has some design patterns that are commonly found in the wild, so there is nothing really special about it.\nLet\u0026rsquo;s begin.\nProviders Pattern What is this pattern anyways? It\u0026rsquo;s a pattern I learned while working at ArangoDB. It\u0026rsquo;s quite nice and defines package abstractions wonderfully. It somewhat resembles the Repository pattern from DDD and also uses Chain of Responsibility to setup multiple providers for a given functionality. Like a fallback, in case a Provider does not understand the current thing it got. In that case, it will delegate to Next.\nI\u0026rsquo;m going to demonstrate all of the pattern\u0026rsquo;s capabilities through a sample project which is hopefully a sensible thing and not just dummy functionality.\nTL;DR A Provider is like the Repository pattern from DDD combined with Chain Of Responsibility. Basically, set up a Provider using an interface as a definition. Give that as dependency to another provider and call it\u0026rsquo;s function. If the Provider doesn\u0026rsquo;t understand the type its supposed to work on, it will call Next in the chain delegating the function to the following Provider. For a detailed use of this pattern, check out Providers Example project on GitHub.\nThe Project Providers Example is the project I\u0026rsquo;ll be using to demonstrate this pattern. It\u0026rsquo;s pretty simple; yet, I hope, it presents a useful function to be show off this pattern\u0026rsquo;s capabilities.\nIn essence, this is a plugin executor. We have a CLI which can register plugins to execute. These plugins can either be bare metal (as in a simple executable living somewhere), or a docker container, in which case it will use Docker to execute the plugin. It will forward all possible parameters and display any outputs.\nSimple, yet there are a couple things that we can extract into Providers such as:\nDealing with the archive ( so we can test the Tar function ) (sorry, I scrapped this, to keep things simple) Selecting the executing environment ( bare metal, container ) which we can chain Output formatting ( possibly, thing like, JSON, Table, etc. ) Saving things into a Database ( we will save what kind of plugins exist using sqlite ) 4.1. We\u0026rsquo;ll just save the name and the type for simplicity Basics Let\u0026rsquo;s take a look at the folder structure here.\n➜ providers-example git:(main) tree . ├── LICENSE ├── Makefile ├── README.md ├── bin ├── cmd │ ├── add.go │ ├── list.go │ ├── remove.go │ ├── root.go │ └── run.go ├── example │ └── echo_plugin │ └── Dockerfile ├── go.mod ├── go.sum ├── main.go ├── pkg │ ├── commands │ │ └── add.go │ ├── models │ │ └── plugin.go │ └── providers │ ├── archiver.go │ ├── bare │ │ └── bare_runner.go │ ├── container │ │ ├── container_runner.go │ │ └── container_runner_test.go │ ├── fakes │ │ └── fake_storer_client.go │ ├── runner.go │ ├── storage.go │ ├── storer │ │ └── storer.go │ └── tar │ ├── tar.go │ ├── tar_test.go │ └── testdata │ └── test.tar.gz └── tests └── integration ├── init_test.go └── plugin_store_test.go 18 directories, 29 files What are we looking at? We have some standard packages, like pkg, cmd and tests. What\u0026rsquo;s \u0026ldquo;new\u0026rdquo; is pkg/providers. I ended up not using archiver, but I left it in for prosperity. There are 3 interfaces under providers. Each support a simple functionality. Let\u0026rsquo;s go over them.\n// Archiver can extract files from an archive. type Archiver interface { Untar(content []byte) ([]byte, error) } My initial plan was to implement the bare metal as an ability to download an archive and then untar that. But I scrapped that idea for a simpler one. This provider would have been an untarer.\nNext up is storage.\n// ListOpts defines options for listing plugins. type ListOpts struct { TypeFilter string } // Storer can store information about the plugins that were created. //go:generate go run github.com/maxbrunsfeld/counterfeiter/v6 -generate //counterfeiter:generate -o fakes/fake_storer_client.go . Storer type Storer interface { Init() error Create(ctx context.Context, plugin *models.Plugin) error Get(ctx context.Context, name string) (*models.Plugin, error) Delete(ctx context.Context, name string) error List(ctx context.Context, opts ListOpts) ([]*models.Plugin, error) } A simple CRUD interface, with an Init action. Whatever that init is. Currently, I\u0026rsquo;m using sqlite3, so the live store init is simply creating the database file and bootstrapping it with the plugins table. I\u0026rsquo;m using counterfeiter to generate a mock which I\u0026rsquo;ll be using in tests to mock this provider where I don\u0026rsquo;t care about it.\nAnd the runner\u0026hellip;\n// Runner runs a plugin. type Runner interface { Run(ctx context.Context, name string, args []string) error } This is the single method a runner needs to be able to provide / do. A runner simply takes a name and some arguments and based on the plugin\u0026rsquo;s type, runs it.\nThese interfaces are then implemented by real providers. For example, the storage has its implementation under storer. Which has code for sqlite. The runner has two implementations. One for container and one for bare metal. And now, let\u0026rsquo;s see how the chain works.\nDependency Injection and Usage Take a closer look at the container implementation for example.\n// Config defines parameters for the Runner. type Config struct { DefaultMaximumCommandRuntime int } // Dependencies defines the provider dependencies this provider has. type Dependencies struct { Next providers.Runner Storer providers.Storer Logger zerolog.Logger } // Runner implements the Run interface for container based runtimes. type Runner struct { Config Dependencies cli client.APIClient } // NewRunner creates a new container based runtime. func NewRunner(cfg Config, deps Dependencies) (*Runner, error) { cli, err := client.NewClientWithOpts(client.FromEnv) if err != nil { deps.Logger.Debug().Err(err).Msg(\u0026#34;Failed to create docker client.\u0026#34;) return nil, err } return \u0026amp;Runner{ Config: cfg, Dependencies: deps, cli: cli, }, nil } This is the main structure of a provider. It gets Configuration options via the Config struct. Things like, DefaultMaximumCommandRuntime which is a configuration value for maximum wait time. And it gets dependencies, other providers and third party things, like logger, through the Dependencies struct. We also wire things up that we are going to use later on, like a client for Docker. Later on, in the tests, I can inject a mock for it.\nNotice the field in the Dependencies struct called Next. This is the chain\u0026rsquo;s first stop. In root.go we wired up next to be the bare metal type plugin like this:\nbarePlugin := bare.NewBareRunner(bare.Config{}, bare.Dependencies{ Logger: log, Storer: store, }) containerPlugin, err := container.NewRunner(container.Config{ DefaultMaximumCommandRuntime: 15, }, container.Dependencies{ Storer: store, Next: barePlugin, Logger: log, }) And then, when calling Run we check the type of the plugin we got, and if we know it, we execute it, if not, we call the Next thing in the chain. Simple.\n// Run implements the container based runtime details, using Docker as an engine. func (cr *Runner) Run(ctx context.Context, name string, args []string) error { // Find the plugin, get the location, find the type, if it\u0026#39;s not container, call next. cmd, err := cr.Storer.Get(ctx, name) if err != nil { return fmt.Errorf(\u0026#34;plugin not found: %w\u0026#34;, err) } if cmd.Type != models.Container { cr.Logger.Info().Msg(\u0026#34;Unknown plugin type, calling next in line.\u0026#34;) if cr.Next == nil { return fmt.Errorf(\u0026#34;no next provider configured\u0026#34;) } return cr.Next.Run(ctx, name, args) } if err := cr.runCommand(cmd.Name, cmd.Container.Image, args); err != nil { return fmt.Errorf(\u0026#34;failed to run command: %w\u0026#34;, err) } return nil } And that\u0026rsquo;s it! But wait a second. How is this different from just calling the thing? Well, this makes it so that in the actual code, we only have to call the top level element in the chain and call Run on it. A default if you will. By default, our plugins are of container type. This way, you can avoid a type switch for example. Or avoid having implementation choosing logic in the code when deciding what runner to use.\nif err := containerPlugin.Run(context.Background(), runArgs.name, runArgs.args); err != nil { log.Error().Err(err).Msg(\u0026#34;Failed to run plugin\u0026#34;) os.Exit(1) } I\u0026rsquo;m just calling containerPlugin\u0026rsquo;s Run and the rest will just work. With generics coming in 1.18 this will be even more easier to use.\nTestability The great thing about these providers are that they enclose ( you might say, encapsulate ) a single functionality. They provide some kind of behavior to another behavior. Because that behavior is defined by an interface, and the dependency requires an interface, it\u0026rsquo;s trivial to unit test the actual provider. For example, the storage. You see above, that the storage is defined as Storer providers.Storer. And we already have a fake. So in the tests we can set it up such as:\nfakeStorer := \u0026amp;fakes.FakeStorer{} fakeStorer.GetReturns(\u0026amp;models.Plugin{ ID: 1, Name: \u0026#34;test\u0026#34;, Type: models.Container, Container: \u0026amp;models.ContainerPlugin{ Image: \u0026#34;test-image\u0026#34;, }, }, nil) ... r := Runner{ Dependencies: Dependencies{ Storer: fakeStorer, Logger: logger, }, Config: Config{ DefaultMaximumCommandRuntime: 15, }, cli: apiClient, } After that, we can use it to return errors and various bits and pieces to test our actual plugin runner and not care about storage.\nPros and Cons The pros are obvious. Separation, testability, chaining, fallback logic, encapsulated behavior, etc.\nBut what about the cons? The downside could be the following things:\nnaming gets hard and packages can get prolific interfaces will be binding, changing them might result in changing a bunch of implementations some implementations might not use some parameters from the interface if they don\u0026rsquo;t provide that functionality ( this might be mitigated by a very restrictive interface design ) it\u0026rsquo;s a bit verbose ( this can be mitigated by not calling it dependencies or passing in a single struct instead of two) wiring up all the dependencies can lead to a long set up function if there are several providers ( this can be mitigated by having defaults and smaller setup functions ) Still, I think the benefits easily out weight these problems. And many other package designs have similar issues.\nOther providers This is just an example. Another couple of examples include:\nfallback authentication; start with Auth0, then SSH, username/password, finally localhost and fail output parsing; what does the struct provide, use that, otherwise, fallback to table github, gitlab, bitbucket handlers chained up and chosen based on url types Conclusions This is it. That\u0026rsquo;s the provider pattern. It\u0026rsquo;s a useful little tool in the box to have. With generics, the choosing type will change, but the pattern can adapt to that too. It\u0026rsquo;s a nice little thing to have. Of course it\u0026rsquo;s not a solution to all the problems ever. But I\u0026rsquo;ve been using it for a while now, to good effect.\nThanks for reading,\nGergely.\n","permalink":"https://skarlso.github.io/2021/12/21/providers-pattern/","summary":"Hello Dear readers.\nToday, I would like to write about a project design pattern I\u0026rsquo;ve been using successfully over the past years for various projects. It has many variations and it has some design patterns that are commonly found in the wild, so there is nothing really special about it.\nLet\u0026rsquo;s begin.\nProviders Pattern What is this pattern anyways? It\u0026rsquo;s a pattern I learned while working at ArangoDB. It\u0026rsquo;s quite nice and defines package abstractions wonderfully.","title":"Providers Pattern"},{"content":"Advent Of Code - Day 12 - Updated A comment from one of my readers prompted me to revise my solution on this trying to do part 2. The suggestions was that instead of using a struct as seen, use int and keep track of the count for small caves that way. I started to do that but got into various problems along the way when I got frustrated with my code, deleted the whole thing and begun again. But this lead me to a small, and better code than before which actually worked.\nDay 12 - Part 1 There are a number of things I realized and improved upon. Let\u0026rsquo;s take them one by one.\nParsing I did this whole convoluted way of parsing the \u0026ldquo;graph\u0026rdquo; into an actual graph when I saw two things. First, I don\u0026rsquo;t need a graph I just need the values. Second, if you don\u0026rsquo;t need the graph, you don\u0026rsquo;t have anything to initialize and you can use Go map\u0026rsquo;s feature of creating default entries for default keys.\nGo maps initialize to value default. For reference types that\u0026rsquo;s nil. For primitives, whatever the primitives zero value is. Empty string, 0, etc.\nThis lead me to parsing the input such as:\ninput := strings.Split(string(content), \u0026#34;\\n\u0026#34;) caves := make(map[string][]string) for _, line := range input { var ( a, b string ) split := strings.Split(line, \u0026#34;-\u0026#34;) a = split[0] b = split[1] caves[a] = append(caves[a], b) caves[b] = append(caves[b], a) } And that\u0026rsquo;s it. append deals with nil slices and creates the slice if needed. Meaning if the entry doesn\u0026rsquo;t exist, append will create a new slice for it.\nState I need to keep state of the caves I\u0026rsquo;m visiting somehow. After reading a bunch of more information on DFS and BFS and listing all paths and all those things I never read otherwise every in my day to day life, I saw, that I for part two, and in fact, for part 1 as well, I need a state which I can refresh based on the current location.\nPreviously, my recursive dfs was doing that with the path passed in. That\u0026rsquo;s all fine, but I also need now if I ever visited a cave twice. The suggestions of using an int for visited is nice, but somehow, wasn\u0026rsquo;t working for me, because I kept messing up the subtraction when recursing back. So I decided that I drop the recursing and try to do this iteratively.\nSecond, I also saw in most of the cases I don\u0026rsquo;t care about the path, I just need a count. I just kept the path for debug to see where my algorithm is going. So I ditched that and just increase a counter.\nTo keep the state I\u0026rsquo;m using a struct which will have the current value of the cave, the path so far which was travelled from the current location and so far and the fact if I visited this cave before.\ntype cave struct { value string pathSoFar []string twice bool } This allows for a number of things. First, I don\u0026rsquo;t need to pass around path recursively, I will have a reference to it at the current visited location. Second, I can track the actual state in the cave, like paint the cave if I already saw that one. Once that happens, every other cave will have this value passed around, meaning all other caves will come in with a flag, that hey, I already visited a cave twice before, so I\u0026rsquo;m not gonna do that again.\nThe Loop No, not the amazon prime series The Loop ( which is fantastic btw ), but the main for loop of this logic. Now that I have my state, I can just do a BFS on this baby. The main loop changes slightly. We now, keep track of caves, not just the values.\nBut it\u0026rsquo;s super easy. Barely an inconvenience. Oh really? Yeah, you see, we just make our queue have caves. But what about the seen part? This changes as well. Now, because we pass around the path taken so far, we\u0026rsquo;ll have to look in that path if the neighbor if our current cave is already in the path that has been taken so far for that save.\nJust create a small Contains method ( which will be obsolete after finally go 1.18 comes out with generics and we\u0026rsquo;ll have the mighty Filter or Search on our side!!!!!! ) like this:\nseen := func(a string, b []string) bool { for _, v := range b { if v == a { return true } } return false } \u0026hellip; and then we can look in the path if we met this cave before. What I also realized was that I was turning the cave value into lowercase and checked it that way, when I could have just said that if it matched with the ToLower version of the name it is lower case. :facepalm:. But this is why I\u0026rsquo;m doing AOC. To learn and evolve. Hopefully, I learned a lot from this day.\nSo the main loop:\ncount := 0 start := cave{ pos: \u0026#34;start\u0026#34;, pathSoFar: []string{\u0026#34;start\u0026#34;}, } queue := []cave{start} var current cave for len(queue) \u0026gt; 0 { current, queue = queue[0], queue[1:] if current.pos == \u0026#34;end\u0026#34; { count++ continue } for _, next := range caves[current.pos] { if !seen(next, current.pathSoFar) { path := make([]string, 0) path = append(path, current.pathSoFar...) if strings.ToLower(next) == next { path = append(path, next) } queue = append(queue, cave{ pos: next, pathSoFar: path, }) } } } And that\u0026rsquo;s it. We print count and we have our number.\nDay 12 - Part 2 Now that we have our state in the loop itself, we just add a new variable to the cave called twice (it was already there but I haven\u0026rsquo;t used it yet). Our criteria for twice is as follows. If we haven\u0026rsquo;t seen it yet, we explore it. If it is already in the path so far, from which we came in AND none of the caves so far were visited twice ( which we\u0026rsquo;ll know because we bring our marker with us during the loop ) we set our cave to visited ( paint it ) and we only take the path so far with us, so we don\u0026rsquo;t put this guy in the path YET. We\u0026rsquo;ll eventually do that though on the next time this cave is encountered at which point it will bring twice with it.\nHow does that look like in code?\nstart := cave{ value: \u0026#34;start\u0026#34;, pathSoFar: []string{\u0026#34;start\u0026#34;}, } queue := []cave{start} var current cave for len(queue) \u0026gt; 0 { current, queue = queue[0], queue[1:] if current.value == \u0026#34;end\u0026#34; { count++ continue } for _, next := range caves[current.value] { seenThisCaveBefore := seen(next, current.pathSoFar) if !seenThisCaveBefore { path := make([]string, 0) path = append(path, current.pathSoFar...) if strings.ToLower(next) == next { path = append(path, next) } queue = append(queue, cave{ value: next, pathSoFar: path, twice: current.twice, }) } else if seenThisCaveBefore \u0026amp;\u0026amp; !current.twice \u0026amp;\u0026amp; !seen(next, []string{\u0026#34;start\u0026#34;, \u0026#34;end\u0026#34;}) { queue = append(queue, cave{ value: next, pathSoFar: current.pathSoFar, twice: true, }) } } } Again, we start off by adding start. Oh, and we don\u0026rsquo;t do that for start or end. Also realized that I can use seen now as sort of like a check for a value NOT being one of two values instead of a convoluted if structure.\nSo if everything is as before, expect we also take twice with us, and if we\u0026rsquo;ve seenThisCaveBefore but we haven\u0026rsquo;t visited any caves twice before ( we take the marker with us during the journey ) and it\u0026rsquo;s not start or end, we mark it as visited twice, and we add pathSoFar as the current path so far, without adding this cave into it.\nAnd that\u0026rsquo;s it!\nConclusion This day was somehow difficult on the first run. I couldn\u0026rsquo;t figure out a nice way to keep track of my journey so far. What helped me eventually was the prompt from my reading and reading various articles about keeping track during a BFS and how listing all paths in a graph work. Which can be a difficult problem especially when there is a circle in the graph. This would probably not work in that case, but we are confident that Eric doesn\u0026rsquo;t do tricks like that.\nThe repository for all my solutions for AOC 2021 can be found here.\nThank you for reading!\nGergely.\n","permalink":"https://skarlso.github.io/2021/12/17/aoc-day12-updated/","summary":"Advent Of Code - Day 12 - Updated A comment from one of my readers prompted me to revise my solution on this trying to do part 2. The suggestions was that instead of using a struct as seen, use int and keep track of the count for small caves that way. I started to do that but got into various problems along the way when I got frustrated with my code, deleted the whole thing and begun again.","title":"Advent Of Code - Day 12 - Updated"},{"content":"Advent Of Code - Day 15 Today, again, we open up Red Blob Games. It is a great source of information and descriptions. Especially, since this scenario is right up Red Blob\u0026rsquo;s ally. We need some weighted path finding. And Red Blob has a lovely post on that using the ever famous Dijkstra algorithm with a Priority Queue.\nDay 15 - Part 1 Let\u0026rsquo;s get to it. After refreshing my memory about priority queues, I remembered that there is a package and some sample code in Go which implements priority queues using the container/heap package here.\nPretty straight forward. There are some bits that we don\u0026rsquo;t need. For example, the update function is not needed. And there is a single small thing which we really need to be aware of in this code base. This part:\nfunc (pq PriorityQueue) Less(i, j int) bool { // We want Pop to give us the highest, not lowest, priority so we use greater than here. return pq[i].priority \u0026gt; pq[j].priority } This infuriating detail got me at least 20 minutes of trying to figure out why my path wasn\u0026rsquo;t correct. We need to change this to \u0026lt;.\nAlso, important detail is that you don\u0026rsquo;t use the priority queue directly. You use it with heap.Push(\u0026amp;pq). Otherwise the priorities and indexes will not be up to date.\nOkay, first\u0026hellip; We parse our grid using our trusty character cheat code:\nfor _, i := range input { row := make([]int, 0) for _, v := range i { c := v - \u0026#39;0\u0026#39; row = append(row, int(c)) } grid = append(grid, row) } Then we write our path finding. It\u0026rsquo;s a bit more verbose in Go than in Python of course. We have to initialize the PQ, then add in some code to get the neighbors, than set up the cameFrom part and traverse that backwards to get our full path. I\u0026rsquo;m sure there are better solutions out there than this, but this is what I feel comfortable with. And I saw many solutions using PQ.\nThe whole thing looks like this:\nstart := point{x: 0, y: 0} goal := point{x: len(grid[0]) - 1, y: len(grid) - 1} pq := make(PriorityQueue, 0) heap.Init(\u0026amp;pq) heap.Push(\u0026amp;pq, \u0026amp;Item{ point: start, priority: grid[0][0], }) cost := map[point]int{ start: grid[0][0], } cameFrom := map[point]point{ start: start, } for pq.Len() \u0026gt; 0 { current := heap.Pop(\u0026amp;pq).(*Item) if current.point == goal { break } for _, next := range neighbors(current.point, grid) { newCost := cost[current.point] + grid[next.y][next.x] if v, ok := cost[next]; !ok || newCost \u0026lt; v { cameFrom[next] = current.point cost[next] = newCost heap.Push(\u0026amp;pq, \u0026amp;Item{ point: next, priority: newCost, }) } } } Not that bad. And now, following the path back and calculating the sum.\nvar sum int current := goal for current != start { sum += grid[current.y][current.x] current = cameFrom[current] } fmt.Println(\u0026#34;sum: \u0026#34;, sum) And that\u0026rsquo;s it. This is our correct number. Now, checking part 2\u0026hellip;\nDay 15 - Part 2 Part 2 is the same, but with a twist. We have to expand the grid by\u0026hellip; what? Uh. So, our tile is just a piece of a greater tile. And as we duplicate our tile, we need to increase the numbers by one compared to their original part.\nOkay, this takes a little bit to wrap my head around. So let\u0026rsquo;s remove some rules and make it easier. First, let\u0026rsquo;s deal with a simpler objective. Just copy our initial tile into a 5x5 grid. To do that, we create the initial grid with the size original y * 5 and original x * 5.\nexpandedGrid := make([][]int, len(grid)*5) for i := 0; i \u0026lt; len(expandedGrid); i++ { expandedGrid[i] = make([]int, len(grid[0])*5) } Done. Now, copy over the initial rows.\n// Prime the first tile for y := 0; y \u0026lt; len(grid); y++ { for x := 0; x \u0026lt; len(grid[y]); x++ { expandedGrid[y][x] = grid[y][x] } } With this, actually we did create our 5x5 matrix, so let\u0026rsquo;s think a little bit about the problem. We take each number of the original grid, and +1-it compared to the previous number in the original grid. Let\u0026rsquo;s make this easy as the example has it. If the grid would be a single number, 8, we would get this grid:\n8 9 1 2 3 9 1 2 3 4 1 2 3 4 5 2 3 4 5 6 3 4 5 6 7 If look at the pattern, all we have to do is create the first row correctly, and then we just +1 downwards on each column and we are golden(star (pun intended))! Nice. So, let\u0026rsquo;s create that first row.\n// fill out first line for all of the original grid sizes. for y := 0; y \u0026lt; len(grid); y++ { for x := len(grid[y]); x \u0026lt; len(expandedGrid[y]); x++ { // x - the length of the initial grid newValue := (expandedGrid[y][x-len(grid[y])] + 1) % 10 if newValue == 0 { newValue = 1 } expandedGrid[y][x] = newValue } } Basically, the newValue := (expandedGrid[y][x-len(grid[y])] + 1) % 10 new value, is the original location, which is the current location minus the size of the original grid[y] and then +1. And it wraps around of course.\nThat\u0026rsquo;s fantastic. With that, we have our first row like this:\n89123 00000 00000 00000 00000 Now, we just have to go downwards with the same logic. Compared to the original location, minus the size, and +1.\n// fill out downwards for y := len(grid); y \u0026lt; len(expandedGrid); y++ { for x := 0; x \u0026lt; len(expandedGrid[y]); x++ { // x - the length of the initial grid newValue := (expandedGrid[y-len(grid)][x] + 1) % 10 if newValue == 0 { newValue = 1 } expandedGrid[y][x] = newValue } } And done! We have our correct grid! We run the path finding, which didn\u0026rsquo;t change, and we have our correct result! Another star in the bag!\nConclusion Today, we again learned that Red Blob Games is an invaluable resource of path finding information. And it\u0026rsquo;s nice to read through the material once in a while to refresh our knowledge about these things that exist. And we had some fun manipulating a matrix again and understanding that patterns will save our asses in these exercises.\nThe repository for all my solutions for AOC 2021 can be found here.\nThank you for reading!\nGergely.\n","permalink":"https://skarlso.github.io/2021/12/15/aoc-day15/","summary":"Advent Of Code - Day 15 Today, again, we open up Red Blob Games. It is a great source of information and descriptions. Especially, since this scenario is right up Red Blob\u0026rsquo;s ally. We need some weighted path finding. And Red Blob has a lovely post on that using the ever famous Dijkstra algorithm with a Priority Queue.\nDay 15 - Part 1 Let\u0026rsquo;s get to it. After refreshing my memory about priority queues, I remembered that there is a package and some sample code in Go which implements priority queues using the container/heap package here.","title":"Advent Of Code - Day 15"},{"content":"Advent Of Code - Day 14 Now we have to do some chemistry. Santa is pretty cool this way. They have a lot of skills mastered and read manuals like an expert. But this also means that manuals are always faulty. But Santa manages to work around these problems rather well.\nDay 14 - Part 1 So, by reading the description and looking at the outcome, that a string only after 5 iterations will be this big, begs the question if we should build a primitive solution for this. Well, yes, I think we should. Part 2 will most likely be about something like, okay, now do this, but longer. I suspect this will be like the lanterfish thing. But let\u0026rsquo;s do it anyways.\nA naive approach is to track the whole string and concatenate. This is done rather quickly, and earns us a good place if you managed to either wake up early, or not go to bed at all.\nThe concatenation is done quickly:\nsteps := 10 // insert then skip because pairs overlap. for step := 0; step \u0026lt; steps; step++ { newTemplate := \u0026#34; \u0026#34; // cheeky for i := 0; i \u0026lt; len(template)-1; i++ { pair := string(template[i]) + string(template[i+1]) pair = string(pair[0]) + pairs[pair] + string(pair[1]) newTemplate = newTemplate[:len(newTemplate)-1] newTemplate += pair } template = newTemplate } And you can just see immediately how bad this would scale. But it works. And we have our star and the hull of the ship is now a bit stronger.\nDay 14 - Part 2 Of course part 2 hits us in the face again, but instead of a fishy fist, we get a chemical fist. We know that this is similar to the lanterfish problem, right? So we got to look for some patterns again. We will have to most likely track something other than the string. Which means there is a solution to this which involves only counting. But what do we count and how? This is the question.\nLet\u0026rsquo;s look at our string. Initial string is NNCB. We have a couple of pairs in this one as the example suggests. NN, NC, CB. That\u0026rsquo;s fine. Let\u0026rsquo;s look at the next iteration. NCNBCHB. Pairs?\nNC, CN, NB, BC, CH, HB. We can see now a tiny bit of a pattern; namely that we\u0026rsquo;ll always end with B and that we\u0026rsquo;ll always start with N. Next.\nNBCCNBBBCBHCB. Somewhat longer now, let\u0026rsquo;s list some pairs.\nNB, BC, CC, CN, NB\u0026hellip; hmmm. These are the same pairs. And if we go further and with a greater example, we\u0026rsquo;ll see that there are a finite number of pairs. So we track the pairs! But! Where do we get the pairs from? We can actually construct the pairs without having to concatenate all the strings.\nOkay, okay, wait, what? Let\u0026rsquo;s initialize things so we can understand better.\ntrackPairs := make(map[string]int) for i := 0; i \u0026lt; len(template)-1; i++ { trackPairs[string(template[i])+string(template[i+1])]++ } We have our initial pairs from the initial template. Now, what we have to do is use our rules for each pair in that map and construct new pairs with them. That part didn\u0026rsquo;t change. And add those pairs to a new map and update our tracking map.\nfor i := 0; i \u0026lt; steps; i++ { update := make(map[string]int) for k, v := range trackPairs { update[string(k[0])+rules[k]] += v update[rules[k]+string(k[1])] += v } trackPairs = update } We construct a new map and add the number of encountered pairs to this new pair. And if we already have it, it increases. Mind blown! This is all fine, but what do about counting the min and max characters? Well, all the characters are already there. Just construct a new map with a character count for each character.\ncounts := map[string]int{} for k, v := range trackPairs { counts[string(k[0])] += v } It\u0026rsquo;s enough to use the first one because they repeat.\nWe do some min, max on this map and tadaam. We have our value! We submit, and there is our second star. Fantastic!\nConclusion Today, we learned again, that we should always look for patterns in the output. Sometimes they are well hidden. So we write out everything and try all combinations of things until something clicks.\nThe repository for all my solutions for AOC 2021 can be found here.\nThank you for reading!\nGergely.\n","permalink":"https://skarlso.github.io/2021/12/14/aoc-day14/","summary":"Advent Of Code - Day 14 Now we have to do some chemistry. Santa is pretty cool this way. They have a lot of skills mastered and read manuals like an expert. But this also means that manuals are always faulty. But Santa manages to work around these problems rather well.\nDay 14 - Part 1 So, by reading the description and looking at the outcome, that a string only after 5 iterations will be this big, begs the question if we should build a primitive solution for this.","title":"Advent Of Code - Day 14"},{"content":"Advent Of Code - Day 13 This one was a lot of fun! Matrix folding was a bit fiddly but nothing too serious\u0026hellip;\nDay13 - Part 1 By solving this part, I actually solved both parts. I had to butcher it to not solve both parts because I already dealt with folding both ways. First, we parse our input.\nWe read out both the folding and the numbers first for easy handling later:\nreadingFolds := false for _, line := range input { // gather numbers if line == \u0026#34;\u0026#34; { readingFolds = true continue } if !readingFolds { numbers = append(numbers, line) } else { folders = append(folders, line) } } Now, we have the numbers and folding bits in different slices. First, parse the numbers:\npoints := make([]point, 0) maxx, maxy := 0, 0 for _, v := range numbers { var ( x, y int ) fmt.Sscanf(v, \u0026#34;%d,%d\u0026#34;, \u0026amp;x, \u0026amp;y) if x \u0026gt; maxx { maxx = x } if y \u0026gt; maxy { maxy = y } points = append(points, point{x: x, y: y}) } Our trusty Sscanf can help here again. Nice. We get the maximum length of things for later processing.\nThen we parse the folding bits (I\u0026rsquo;m going to show \u0026ldquo;part 2\u0026rdquo; here, since that\u0026rsquo;s the same as part 1, just without a for):\nfor _, f := range folders { split := strings.Split(f, \u0026#34; \u0026#34;) fold := split[len(split)-1] if fold[0] == \u0026#39;x\u0026#39; { // fmt.Println(\u0026#34;folding left\u0026#34;) var x int fmt.Sscanf(fold, \u0026#34;x=%d\u0026#34;, \u0026amp;x) for y := 0; y \u0026lt; len(grid); y++ { for j := x; j \u0026lt; len(grid[y]); j++ { if grid[y][j] == \u0026#34;#\u0026#34; { grid[y][x-(j-x)] = \u0026#34;#\u0026#34; } } } for i, v := range grid { v = v[:x] grid[i] = v } } else if fold[0] == \u0026#39;y\u0026#39; { // fmt.Println(\u0026#34;folding up\u0026#34;) var y int fmt.Sscanf(fold, \u0026#34;y=%d\u0026#34;, \u0026amp;y) // scan downwards // offset is i - y 7-3 -\u0026gt; 4 and we subtract that from level (7) for i := y; i \u0026lt; len(grid); i++ { for x := 0; x \u0026lt; len(grid[i]); x++ { if grid[i][x] == \u0026#34;#\u0026#34; { grid[y-(i-y)][x] = \u0026#34;#\u0026#34; } } } grid = grid[:y] } } This is a bit large and arguably, I could refactor this whole thing to be NOT this huge and separate. Let\u0026rsquo;s see what\u0026rsquo;s happening here\u0026hellip; First, Y, aka. fold up. We copy over all #s to the other side. How does the other side look like?\n...#..#..#. ....#...... ........... #.......... ...#....#.# -3 ........... -2 (5) ........... -1 (6) ........... -- this is where it will fold -\u0026gt; this will be 0 -\u0026gt; 7 ........... +1 (8) ........... +2 (9) .#....#.##. +3 ....#...... ......#...# #.......... #.#........ Then, we cut the grid at that point. Which is just grid = grid[:y] in Go. Pretty neat.\nAnd that\u0026rsquo;s it! For Part 2 I just added the loop and part 1 I just counter the #s and we were done. On Part 2 I let it fold and run a display to see the points.\nConclusion Today we learned to count coordinates. I\u0026rsquo;m sure someone had a better way of calculating the outcome.\nThe repository for all my solutions for AOC 2021 can be found here.\nThank you for reading!\nGergely.\n","permalink":"https://skarlso.github.io/2021/12/13/aoc-day13/","summary":"Advent Of Code - Day 13 This one was a lot of fun! Matrix folding was a bit fiddly but nothing too serious\u0026hellip;\nDay13 - Part 1 By solving this part, I actually solved both parts. I had to butcher it to not solve both parts because I already dealt with folding both ways. First, we parse our input.\nWe read out both the folding and the numbers first for easy handling later:","title":"Advent Of Code - Day 13"},{"content":"Advent Of Code - Day 12 EDIT: I revisited this problem and completely revised my solution to it: Day 12 Updated\nThis one is a bit different from our little BFS walk the other day. I didn\u0026rsquo;t quite remember how DFS works, so I looked at the Wikipedia a bit. Then I remembered that I implemented this previously at some point in a later year.\nDisclaimer: I didn\u0026rsquo;t manage to finish part 2. I\u0026rsquo;m not sure what the bug is, but I moved on. When I\u0026rsquo;ll have the inspiration, I\u0026rsquo;ll figure it out. Unless, someone has an idea what\u0026rsquo;s going on.\nDay 12 - Part 1 There isn\u0026rsquo;t much to decipher this time. It\u0026rsquo;s basically a graph traversal. Specifically, finding all path in a graph. With a tiny addition that large caves can be visited as many times as we like. Which just means that we\u0026rsquo;ll never put them into the visited | seen map.\nBut first we\u0026rsquo;ll have to construct our graph. That one is a bit fiddly. I wasn\u0026rsquo;t sure if the connections are directed or that there are on connections as in a -\u0026gt; b and this doesn\u0026rsquo;t mean that we\u0026rsquo;ll update the connection for b to point back to a.\nI choose to update both connections.\nSo once, the boring part is done and we managed to parse our graph we\u0026rsquo;ll have to do a dfs. We have to find ALL paths in this graph. For that we\u0026rsquo;ll collect the path in a global value and do some recursion with dfs. There is an iterative approach but I find the recursive one more intuitive.\nfunc dfs(curr *node, path []string, seen map[string]struct{}) { if isLower(curr.value) { seen[curr.value] = struct{}{} } path = append(path, curr.value) if curr.value == \u0026#34;end\u0026#34; { paths = append(paths, path) } else { for _, next := range curr.connections { if _, ok := seen[next.value]; !ok { dfs(next, path, seen) } } } delete(seen, curr.value) } What\u0026rsquo;s happening here? We only put it into seen if it\u0026rsquo;s lower case. This is where the big cave / small cave thing comes in. Then, we append the currently visiting node to the path. If we reached 'end' we are done with that part and we put our path so far into the all paths gathering global value. Then, we delete the current value and return. If it\u0026rsquo;s done at that point, it will just unravel and be done.\nIf we didn\u0026rsquo;t reach the path so far, we call dfs on each of the neighbors of our current node. So we identified our base case. Which is to check if we are at the end, and save the path. That\u0026rsquo;s it, we run this and we have our first star.\nDay 12 - Part 2 This is where it gets a bit more complex. We\u0026rsquo;ll have to now allow for a single cave to be visited twice. I\u0026rsquo;m doing that by looping over all of the small caves and adding them into a seenTwice map. But for some reason, I\u0026rsquo;m not getting the right value yet. We\u0026rsquo;ll get back to that.\nConclusion The repository for all my solutions for AOC 2021 can be found here.\nThank you for reading!\nGergely.\n","permalink":"https://skarlso.github.io/2021/12/12/aoc-day12/","summary":"Advent Of Code - Day 12 EDIT: I revisited this problem and completely revised my solution to it: Day 12 Updated\nThis one is a bit different from our little BFS walk the other day. I didn\u0026rsquo;t quite remember how DFS works, so I looked at the Wikipedia a bit. Then I remembered that I implemented this previously at some point in a later year.\nDisclaimer: I didn\u0026rsquo;t manage to finish part 2.","title":"Advent Of Code - Day 12"},{"content":"Advent Of Code - Day 11 Today was an easier one again. It\u0026rsquo;s been a while since I last did some recursion anyway. At least, that\u0026rsquo;s how I solved this. I\u0026rsquo;m pretty sure my solution isn\u0026rsquo;t the most efficient one, but at least it\u0026rsquo;s working and it\u0026rsquo;s not horrible.\nDay 11 - Part 1 We have some number tracking to do again. This time, instead of fishes, we find ourself an bioluminescent octopus! This time, the rules are neatly outlined to us in a straight forward list. It sort of is like a Conway\u0026rsquo;s Game of Life scenario in which the current point affects its neighbours.\nRemember last time we did directions? Well guess what\u0026rsquo;s coming to come in handy again. Our directions, but with diagonal directions.\nvar ( directions = []point{ {x: 0, y: -1}, {x: -1, y: -1}, {x: -1, y: 0}, {x: 1, y: 1}, {x: 0, y: 1}, {x: -1, y: 1}, {x: 1, y: 0}, {x: 1, y: -1}, } ) What the plan here? I\u0026rsquo;ve drawn it our on paper. It\u0026rsquo;s pretty easy actually. We have to track if an octopus already flashed or not. For that, we\u0026rsquo;ll use a struct which will hold something like flashed bool value. We\u0026rsquo;ll have to think about how to reset that after a step is done though.\nNext step is, go through the list and if they didn\u0026rsquo;t flash in that round ( aka !flashed ) then we increase its energy. If the energy is above 9 ( aka. == 10 ), we flash. What is flash? It\u0026rsquo;s a recursive function. When dealing with recursive functions you have to determine two things.\nWhat is my exit criteria? What is my base case? ( aka. the recurring logic ) What is our exit? When there are no more neighbours. What is our base case? Find all neighbours for a given point which did not flash yet and increase their energy. If they are energy reaches 10, flash. That\u0026rsquo;s where our recurring call will happen. If a neighbour reaches energy level 10 we\u0026rsquo;ll call flash with that neighbour\u0026rsquo;s coordinate.\nAlright, that isn\u0026rsquo;t so bad. Did we forget something? Yes\u0026hellip; The reset. Unfortunately, this also means that those which did flash, we\u0026rsquo;ll have to manually go and reset after everything has been done. If we reset them mid logic, then they might flash again, or might get their energy levels increased. Which is not what we want. Ah well.. I\u0026rsquo;ll figure something out later maybe.\nOkay, let\u0026rsquo;s see some code. Our initial thing is to loop through the steps and increase the energy level.\nfor i := 0; i \u0026lt; steps; i++ { for y := 0; y \u0026lt; len(grid); y++ { for x := 0; x \u0026lt; len(grid[y]); x++ { if !grid[y][x].flashed { grid[y][x].energy++ if grid[y][x].energy == 10 { flash(point{x: x, y: y}, i, grid) } } } } // reset flashed // unfortunate extra loop... for y := 0; y \u0026lt; len(grid); y++ { for x := 0; x \u0026lt; len(grid[y]); x++ { if grid[y][x].flashed { grid[y][x].flashed = false } } } } Now, flash\u0026hellip;\nfunc flash(currentPoint point, currentStep int, grid [10][10]*octopus) { // flash the current octopus flashCount++ grid[currentPoint.y][currentPoint.x].energy = 0 grid[currentPoint.y][currentPoint.x].flashed = true // select neighbors and increase their energy for _, d := range directions { np := point{x: currentPoint.x + d.x, y: currentPoint.y + d.y} if np.x \u0026gt;= 0 \u0026amp;\u0026amp; np.x \u0026lt; len(grid[currentPoint.y]) \u0026amp;\u0026amp; np.y \u0026gt;= 0 \u0026amp;\u0026amp; np.y \u0026lt; len(grid) { if !grid[np.y][np.x].flashed { grid[np.y][np.x].energy++ if grid[np.y][np.x].energy == 10 { flash(np, currentStep, grid) } } } } } So, what\u0026rsquo;s going on in here? Once an octopus flashes, we set its energy to 0 and we set flashed to true. This is important, because otherwise it would flash again in the same step. Which is not allowed. Then, we check its neighbors and increase their energy. And if that reaches 10, we flash\u0026hellip; And that\u0026rsquo;s it! We do some counting to get how many times we flashed and done!\nDay 10 - Part 2 Part 2 is just let it run and see when every one of these is 0. Pretty simple, I didn\u0026rsquo;t have to change much, just remove the counter for the for loop and add in a check in our reset loop which was already there anyways.\nallZeros := true for y := 0; y \u0026lt; len(grid); y++ { for x := 0; x \u0026lt; len(grid[y]); x++ { if grid[y][x].flashed { grid[y][x].flashed = false } if grid[y][x].energy != 0 { allZeros = false } } } if allZeros { // +1 because steps begin from 0. fmt.Println(\u0026#34;sync achieved at: \u0026#34;, i+1) display(grid) break } And with that, part 2 is done!\nConclusion Today we had a little fun with recursion. Which is nice, because I didn\u0026rsquo;t had to write recursion in a while.\nThe repository for all my solutions for AOC 2021 can be found here.\nThank you for reading!\nGergely.\n","permalink":"https://skarlso.github.io/2021/12/11/aoc-day11/","summary":"Advent Of Code - Day 11 Today was an easier one again. It\u0026rsquo;s been a while since I last did some recursion anyway. At least, that\u0026rsquo;s how I solved this. I\u0026rsquo;m pretty sure my solution isn\u0026rsquo;t the most efficient one, but at least it\u0026rsquo;s working and it\u0026rsquo;s not horrible.\nDay 11 - Part 1 We have some number tracking to do again. This time, instead of fishes, we find ourself an bioluminescent octopus!","title":"Advent Of Code - Day 11"},{"content":"Advent Of Code - Day 10 Again, a bit of breathing time with an easier one. Although, it can be difficult, if you go down the path of trying to do it via recursion.\nDay 10 - Part 1 We have to match brackets. There can be a bit of a hassle if you go off on the wrong foot and try to implement it using recursion. But that works perfectly fine as well. But, there is a more elegant solution in which we just use a stack or try matching the last by updating it constantly. The stack is a heck of a lot easier. And considering part 2, it\u0026rsquo;s also more convenient.\nLet\u0026rsquo;s see.. we parse our input, and then create a stack. In Go a stack is just simply a slice which we\u0026rsquo;ll manipulate like a stack.\nstack := make([]rune, 0) Why rune? Because we can iterate over strings which give runes.\nWhat are we trying to do? In the basest form, we push characters onto the stack. If a new one comes around which is a closing character, we see if the last one was an opening character for that closing one. If it wasn\u0026rsquo;t there is an error. If it was, great, we popped it off of the stack so the next character can come along.\nFirst, let\u0026rsquo;s create some maps which will hold some definitive values so we don\u0026rsquo;t have to search for anything.\nvar ( openingForClosed = map[rune]rune{ \u0026#39;)\u0026#39;: \u0026#39;(\u0026#39;, \u0026#39;]\u0026#39;: \u0026#39;[\u0026#39;, \u0026#39;}\u0026#39;: \u0026#39;{\u0026#39;, \u0026#39;\u0026gt;\u0026#39;: \u0026#39;\u0026lt;\u0026#39;, } openingDelimiters = map[rune]struct{}{ \u0026#39;(\u0026#39;: {}, \u0026#39;[\u0026#39;: {}, \u0026#39;{\u0026#39;: {}, \u0026#39;\u0026lt;\u0026#39;: {}, } closingDelimiters = map[rune]struct{}{ \u0026#39;)\u0026#39;: {}, \u0026#39;]\u0026#39;: {}, \u0026#39;}\u0026#39;: {}, \u0026#39;\u0026gt;\u0026#39;: {}, } points = map[rune]int{ \u0026#39;)\u0026#39;: 3, \u0026#39;]\u0026#39;: 57, \u0026#39;}\u0026#39;: 1197, \u0026#39;\u0026gt;\u0026#39;: 25137, } ) What have we here? We have the openingForClosed which we\u0026rsquo;ll use to see if the last character was an opening for our closing character. We have openingDelimiters which we\u0026rsquo;ll use to detect if we have an opening token. And closing, which is the same just for closings.\nThen we have our main logic:\nscore := 0 for _, line := range input { stack := make([]rune, 0) var last rune for _, r := range line { // if it\u0026#39;s an opening thing, push it in stack if _, ok := openingDelimiters[r]; ok { stack = append(stack, r) } // if it\u0026#39;s a closing one, pop one if it\u0026#39;s the opening of the previous one // we are good and we popped it. if _, ok := closingDelimiters[r]; ok { last, stack = stack[len(stack)-1], stack[:len(stack)-1] if last != openingForClosed[r] { score += points[r] break } } } } fmt.Println(\u0026#34;Number of corrupter lines: \u0026#34;, score) This is it. This is the whole thing, plus the score. We run this for our input and we are done.\nDay 10 - Part 2 And of course, if you had a little insight and read the thing which said some of these lines are incomplete, your first thought was surely, that we\u0026rsquo;ll have to complete them. And indeed, we have to. So our code is actually there already.\nWe have to discard the ones that are corrupt. And then we\u0026rsquo;ll have to complete the closing ones. But guess what\u0026hellip; After your inner loop completes, what remains in the stack are just the openings which don\u0026rsquo;t have any closings left.\nFor example the example contains this:\n}}]])})] - 288957 total points. What our stack will have are these:\n[({([[{{ Which is exactly what that is just reversed. Now, the scoring goes like this:\n): 1 point. ]: 2 points. }: 3 points. \u0026gt;: 4 points. But the same goes for the opening ones too! They cost the same\u0026hellip; Which means we just have to take what\u0026rsquo;s left in the stack, read it backwards, and score it.\nscores := make([]int, 0) out: for _, line := range input { stack := make([]rune, 0) var last rune for _, r := range line { // if it\u0026#39;s an opening thing, push it in stack if _, ok := openingDelimiters[r]; ok { stack = append(stack, r) } // if it\u0026#39;s a closing one, pop one if it\u0026#39;s the opening of the previous one // we are good and we popped it. if _, ok := closingDelimiters[r]; ok { last, stack = stack[len(stack)-1], stack[:len(stack)-1] if last != openingForClosed[r] { continue out // and this continue with a label to jump outside if the line is corrupt } } } // this is what changed score := 0 for i := len(stack) - 1; i \u0026gt;= 0; i-- { score *= 5 score += points[stack[i]] } scores = append(scores, score) } sort.Ints(scores) // sort and get the middle. fmt.Println(\u0026#34;middle score: \u0026#34;, scores[len(scores)/2]) } And that\u0026rsquo;s it, we have our end score.\nConclusion We learned today to not over complicate things. If we don\u0026rsquo;t have an idea about what to do, just try fitting the problem into random data structures and see if something sparks an idea. Finding the right data structure sometimes solves 90% of the problems.\nThe repository for all my solutions for AOC 2021 can be found here.\nThank you for reading!\nGergely.\n","permalink":"https://skarlso.github.io/2021/12/10/aoc-day10/","summary":"Advent Of Code - Day 10 Again, a bit of breathing time with an easier one. Although, it can be difficult, if you go down the path of trying to do it via recursion.\nDay 10 - Part 1 We have to match brackets. There can be a bit of a hassle if you go off on the wrong foot and try to implement it using recursion. But that works perfectly fine as well.","title":"Advent Of Code - Day 10"},{"content":"Advent Of Code - Day 9 This one was an interesting one, and a step up from previous days. I used a BFS here and I have a fantastic link for the description, usage and appliance of BFS and others like A*. Pop over to Red Blog Games for all the good stuff. There are fantastic articles about all sorts of path finding and walking algorithms.\nDay 9 - Part 1 We start off again with something easy. Basically, just walk through a map, and find lowest values in it compared to neighbors of a cell. Here, we get to know a thing called direction calculation. In Go I have a list of points for that which will come in handy in other situations. But first, let\u0026rsquo;s parse our input. This time, I actually have a neat little trick on Go to create a slice of numbers from a slice of string numbers:\ninput := strings.Split(string(content), \u0026#34;\\n\u0026#34;) grid := make([][]int, 0) for _, i := range input { row := make([]int, 0) for _, v := range i { c := v - \u0026#39;0\u0026#39; row = append(row, int(c)) } grid = append(grid, row) } In Go, characters are runes and they can be used like numbers with the ascii representations. So if you subtract the ascii number 0 from the ascii value 1 you\u0026rsquo;ll get 1 as a value. Converting that to int gives you the number that you want. Neat.\nWith that out of the way, let\u0026rsquo;s find our lowest points.\nsum := 0 // display(grid) for y := 0; y \u0026lt; len(grid); y++ { for x := 0; x \u0026lt; len(grid[y]); x++ { lowest := true for _, d := range directions { np := point{x: x + d.x, y: y + d.y} if np.x \u0026gt;= 0 \u0026amp;\u0026amp; np.x \u0026lt; len(grid[y]) \u0026amp;\u0026amp; np.y \u0026gt;= 0 \u0026amp;\u0026amp; np.y \u0026lt; len(grid) { if grid[np.y][np.x] \u0026lt;= grid[y][x] { lowest = false break } } } if lowest { fmt.Println(\u0026#34;lowest: \u0026#34;, grid[y][x]) sum += grid[y][x] + 1 } } } fmt.Println(\u0026#34;sum: \u0026#34;, sum) What is directions?\ndirections = []point{ {x: -1, y: 0}, {x: 0, y: -1}, {x: 1, y: 0}, {x: 0, y: 1}, } What\u0026rsquo;s happening here is, instead of doing something like if x-1 \u0026lt; ... x-1... we save the up, down, left, right as directions which we add to the current coordinates. This could easily now be expanded with say x: -1, y: -1 which would be to upper left corner. This way we don\u0026rsquo;t have to add any new ifs. We loop through them and check the boundaries.\nThen we just a min on all the points and sum them up. Done. Nice. Now, comes the bigger part.\nDay 9 - Part 2 For this, we first have to understand what the heck is going on. Reading the text, we see some keywords like, lowest point and that they should converge to that point. And also the 9 is the limit and it\u0026rsquo;s not part of the whole thing. We also read on that it flows downward which makes us tempted to do this search from the other way around. But, we already have the point of origin. So let\u0026rsquo;s start from there and go outside.\nWhat are we trying to do here exactly? We are trying to find paths which lead back to our lowest point. Our natural stopper will be the number 9 and the ends of the map. Also, we will search for higher numbers than ours. Just to recap. Start from lowest, and find paths with numbers that are higher than the previous number.\nThis is a BFS algorithm. And the linked blog will explain it better than I could. I really encourage you to take a look. It has great resources for these things.\nI\u0026rsquo;m just going to show the Go equivalent.\nfor _, p := range basins { sizes = append(sizes, calculateBasinSize(p, grid)) } sort.Ints(sizes) l := len(sizes) fmt.Println(\u0026#34;sum: \u0026#34;, sizes[l-1]*sizes[l-2]*sizes[l-3]) Calculate Basin is then the BFS:\nfunc neighbors(p point, grid [][]int) []point { var result []point for _, d := range directions { np := point{x: p.x + d.x, y: p.y + d.y} if np.x \u0026gt;= 0 \u0026amp;\u0026amp; np.x \u0026lt; len(grid[p.y]) \u0026amp;\u0026amp; np.y \u0026gt;= 0 \u0026amp;\u0026amp; np.y \u0026lt; len(grid) { if grid[np.y][np.x] \u0026gt; grid[p.y][p.x] \u0026amp;\u0026amp; grid[np.y][np.x] != 9 { result = append(result, np) } } } return result } func calculateBasinSize(p point, grid [][]int) int { start := p seen := map[point]struct{}{ start: {}, } queue := []point{start} var current point for len(queue) \u0026gt; 0 { current, queue = queue[0], queue[1:] for _, next := range neighbors(current, grid) { if _, ok := seen[next]; !ok { queue = append(queue, next) seen[next] = struct{}{} } } } return len(seen) } The gist of this is the queue thing, finding neighbors based on the rules we have. Greater than us, and not 9. And then we return the number of seen points. Those will be the size of the basin.\nAnd we are done. We do the calculation and hopefully we\u0026rsquo;ll have the right result.\nConclusion Today we learned about BFS and later on about A* and various path finding algorithms which will come in handy later on.\nThe repository for all my solutions for AOC 2021 can be found here.\nThank you for reading!\nGergely.\n","permalink":"https://skarlso.github.io/2021/12/09/aoc-day9/","summary":"Advent Of Code - Day 9 This one was an interesting one, and a step up from previous days. I used a BFS here and I have a fantastic link for the description, usage and appliance of BFS and others like A*. Pop over to Red Blog Games for all the good stuff. There are fantastic articles about all sorts of path finding and walking algorithms.\nDay 9 - Part 1 We start off again with something easy.","title":"Advent Of Code - Day 9"},{"content":"Advent Of Code - Day 8 If yesterday was a bit of a respite from adventuring, today was the boss fight for which we geared up for. The wall of text that hit us in the face, nearly depleted all of our HP. Let\u0026rsquo;s hope tomorrow brings some potions.\nDay 8 - Part 1 We start off relatively easy\u0026hellip; We have to deal with old school number displays that use segments to display numbers. Luckily, for part one, all we are interested about is to find numbers in the output which are a definitive match against numbers which are displayed using the segmented display system.\nThat\u0026rsquo;s easy, we just gather all numbers which correspond to a certain length.\nout := 0 for _, line := range strings.Split(string(content), \u0026#34;\\n\u0026#34;) { input := strings.Split(string(line), \u0026#34; | \u0026#34;) // signalPatterns := input[0] outputValue := input[1] for _, v := range strings.Split(outputValue, \u0026#34; \u0026#34;) { if _, ok := digitsToSegments[len(v)]; ok { out++ } } } fmt.Println(\u0026#34;out: \u0026#34;, out) Where digitsToSegments is just a map of length -\u0026gt; number.\nThat\u0026rsquo;s it. This is part 1. Super easy. Barely an inconvenience.\nDay 8 - Part 2 Okay, now comes the hard part. There are several solutions out there for this one. Some used bit logic, some used brute force, some used backtracking, some used set logic, some used permutations, and I used a lot of frigging Contains.\nThere is a lot I don\u0026rsquo;t like about the code, but I had my booster, I\u0026rsquo;m tired, and I \u0026ldquo;logiced\u0026rdquo; it out on paper. I actually saw a person doing the same and posting their logic on it on reddit. I did the same thing. Cool, I\u0026rsquo;m not insane.\nFirst step was to sort all of the values, since, I need to match them up later. This was just easier to do than creating a set and doing some intersection logic.\nOnce I had my sorted items, I isolated 1, 4, 7, 8 like above. Created a map for segmentToNumber and numberToSegment for easy parsing.\nAnd then, I started to find the rest of the numbers. The paper logic translated to this monstrosity.\nfunc findNumberMappings(s []string) { // find 6 and 9 var ( ninezero []string six, three, five, two, nine, zero string topOne, bottomOne string ) // find out which one of 1\u0026#39;s \u0026#34;ab\u0026#34; is in 6 and 9 // determine which of ones lines is top and bottom // find 2, 3, 5 and determine which is 2 and which is 5 // by checking which one it contains. // the rest is 3. for _, v := range s { // 9, 6, 0 if len(v) == 6 \u0026amp;\u0026amp; strings.Contains(v, string(numberToSegment[\u0026#34;1\u0026#34;][0])) \u0026amp;\u0026amp; strings.Contains(v, string(numberToSegment[\u0026#34;1\u0026#34;][1])) { ninezero = append(ninezero, v) } else if len(v) == 6 \u0026amp;\u0026amp; (strings.Contains(v, string(numberToSegment[\u0026#34;1\u0026#34;][0])) || strings.Contains(v, string(numberToSegment[\u0026#34;1\u0026#34;][1]))) { six = v } // 3 if len(v) == 5 \u0026amp;\u0026amp; strings.Contains(v, string(numberToSegment[\u0026#34;1\u0026#34;][0])) \u0026amp;\u0026amp; strings.Contains(v, string(numberToSegment[\u0026#34;1\u0026#34;][1])) { three = v } } if strings.Contains(six, string(numberToSegment[\u0026#34;1\u0026#34;][0])) { topOne = string(numberToSegment[\u0026#34;1\u0026#34;][1]) bottomOne = string(numberToSegment[\u0026#34;1\u0026#34;][0]) } else { topOne = string(numberToSegment[\u0026#34;1\u0026#34;][0]) bottomOne = string(numberToSegment[\u0026#34;1\u0026#34;][1]) } // find 2, 5 for _, v := range s { if len(v) == 5 \u0026amp;\u0026amp; v != three { if strings.Contains(v, topOne) { two = v } else if strings.Contains(v, bottomOne) { five = v } } } // 9 contains all segments of 4 nine = ninezero[0] zero = ninezero[1] isNine := true for _, c := range numberToSegment[\u0026#34;4\u0026#34;] { if !strings.Contains(nine, string(c)) { isNine = false break } } if !isNine { nine, zero = zero, nine } segmentToNumber[nine] = \u0026#34;9\u0026#34; segmentToNumber[six] = \u0026#34;6\u0026#34; segmentToNumber[two] = \u0026#34;2\u0026#34; segmentToNumber[three] = \u0026#34;3\u0026#34; segmentToNumber[five] = \u0026#34;5\u0026#34; segmentToNumber[zero] = \u0026#34;0\u0026#34; } Obviously, here, I need to replace the strings.Contains with some maps that I can than use more efficiently.\nI started working on something like:\ntype digit struct { value string chars map[rune]struct{} } And then use this instead of strings. The map than can be used for quick checking of segments. This should yield some better benchmark results. Overall it\u0026rsquo;s not that shabby.\nConclusion Today we learned to read again. And we also learned that drawing things on paper gives a better perspective and playground on working out some details about the problem.\nThe repository for all my solutions for AOC 2021 can be found here.\nThank you for reading!\nGergely.\n","permalink":"https://skarlso.github.io/2021/12/08/aoc-day8/","summary":"Advent Of Code - Day 8 If yesterday was a bit of a respite from adventuring, today was the boss fight for which we geared up for. The wall of text that hit us in the face, nearly depleted all of our HP. Let\u0026rsquo;s hope tomorrow brings some potions.\nDay 8 - Part 1 We start off relatively easy\u0026hellip; We have to deal with old school number displays that use segments to display numbers.","title":"Advent Of Code - Day 8"},{"content":"Advent Of Code - Day 7 Day 7 - Part 1 Today we got a bit of respite with an easy one. Sort of like a Dark Souls bonfire.\nLet\u0026rsquo;s list our constraints.\nToday, we face a giant whale and some crabs in submarines which are less than effective. If they only move horizontally I have no idea how they\u0026rsquo;ve gotten as far as you. Maybe they pivot from time to time. Or they are indigenous to this region only.\nIn any case, the crab want to rescue you by blasting a giant hole into the ground in which you can escape. For that they need to align to a position. We\u0026rsquo;ll have to try each position for the crabs to align to to find the one which requires the least amount of fuel ( steps ) to get to from each of the crabs.\nleast amount of fuel from each position of the crabs Okay, this isn\u0026rsquo;t so bad. This is a simple min search from a to b. Which is basically the lowest crab position to the highest crab position. We\u0026rsquo;ll try each one of them and which ever produced the least steps for each crab to take, wins.\nLet\u0026rsquo;s see some code. First, we parse the input. Just a strings.Split(line, \u0026quot;,\u0026quot;) this time. Then, we get the min and the max of the values to look for. This is simply a for ... if v \u0026lt; min ; if v \u0026gt; max. Nothing serious.\nThen we get to the meat. From the minimum, to the maximum, we calculate how much it would take to move to that position. The fuel is basically, the distance taken from a to b as an absolute value. abs(a-b). This is how that looks like:\nfor i := min; i \u0026lt;= max; i++ { currFuel := 0 for _, crab := range crabs { v := abs(i - crab) currFuel += v } if currFuel \u0026lt; minFuel { minFuel = currFuel } } We add all that together as our fuel and compare it to the smallest we found so far. And that\u0026rsquo;s it. We have the solution for part1. Bring it on part 2!\nDay 7 - Part 2 Okay, now we get to the fun stuff. Turns out, we actually have no idea how crab submarines work. Surprise, surprise. But they tell us that for each move they use +1 fuel. So 1 or the first, 2 for the second, 3 for the third, etc. We do some quick thinking and find that basically, each move requires +1 compared to the previous move. Now\u0026hellip; You might be tempted to change around your looping. But remember. Look for patterns! 1, 2, 3, 4\u0026hellip;. this is a base number sequence. And what you need is add 1, then 2, then 3, then 4 to the final sum for each move. So basically just sum the number sequence and add it to the end result.\nHere, the novice might be tempted to add the numbers with a for loop. But, if you remember your math class, there is a formula for that. It\u0026rsquo;s called the Gauss formula. But that\u0026rsquo;s just a fancy pants words for a base number sequence sum. It\u0026rsquo;s (n*(1+n))/2. Or better, (n*(a1+a2))/2. You can look it up further here.\nWith that, we simply create a small function value to calculate this:\nsum := func(n int) int { return (n * (1 + n)) / 2 } And we change our loop a tiny bit:\nfor i := min; i \u0026lt;= max; i++ { currFuel := 0 for _, crab := range crabs { v := sum(abs(i - crab)) // change this to add sum currFuel += v } if currFuel \u0026lt; minFuel { minFuel = currFuel } } And that\u0026rsquo;s it! With that, we have our number. Submit to AOC and that\u0026rsquo;s another star in the bag!\nThe repository for all my solutions for AOC 2021 can be found here.\nThank you for reading!\nGergely.\n","permalink":"https://skarlso.github.io/2021/12/07/aoc-day7/","summary":"Advent Of Code - Day 7 Day 7 - Part 1 Today we got a bit of respite with an easy one. Sort of like a Dark Souls bonfire.\nLet\u0026rsquo;s list our constraints.\nToday, we face a giant whale and some crabs in submarines which are less than effective. If they only move horizontally I have no idea how they\u0026rsquo;ve gotten as far as you. Maybe they pivot from time to time.","title":"Advent Of Code - Day 7"},{"content":"Advent Of Code - Day 6 Alright. This time, we are going to learn something that AOC does from time to time\u0026hellip; Let\u0026rsquo;s break it down.\nDay 6 - Part 1 We start off really easy. We venture around in the sea, looking for nothing but trouble. We have our squid friend with us, whom we were telling everything about vents on the sea floor. Which happen to line up perfectly straight for some weird reason.\nAnd then we encounter a bunch of fish. Like\u0026hellip; a LOT of fish. Nothing to worry about, right? But just in case, we map how these fish reproduce. AOC tells us here that they might be reproducing in an exponential. And in hindsight, this should have given us a clue on part 2. But I get ahead of myself.\nFirst, let\u0026rsquo;s list our constraints, or rules. We read the text and it\u0026rsquo;s not a 100% clear yet. We see some text in bold, usually those mean something. And with the number 7 we have our first rule.\nfish reproduce every 7 day We read on and we see that there is a behavior example there. Reading this requires a bit of understanding. But what comes out of it is that..\nA fish has an internal clock which decreases each day. When it hits 0 a new fish is created with initial timer of 8. The fish\u0026rsquo;s timer is then reset to 6. And that\u0026rsquo;s it. The rest is just basically telling us that then all fish will have their timer move. The rest of the text is basically fluff after this. We read things like, why it\u0026rsquo;s reset to 6 and not 7. But we already know that in computer science everything starts from 0 anyways. And it\u0026rsquo;s usually hinted if not. Then we have some more information that the new fish\u0026rsquo;s timer only ticks on the new day and not on the day it was born. That\u0026rsquo;s all fine.\nThen we have our first example. Cool, looks really nice. Let\u0026rsquo;s take it on.\nNow, here I decided that upon reading this, I\u0026rsquo;m going to create a fish struct and track the internal timer. Further, I decided that I\u0026rsquo;m going to let the fish take care of the tick event on each new day.\nThis looks like this:\ntype fish struct { timer int } func (f *fish) tick() *fish { if f.timer == 0 { f.timer = 6 return newFish() } f.timer-- return nil } func newFish() *fish { return \u0026amp;fish{ timer: 8, } } Basically, once it hits 0 we create a new fish with timer 8 and reset the timer back to 6. Pretty easy.\nWe loop this in a 80 day cycle, and the length of the created list is how many fish we\u0026rsquo;ll have. We always tick each fish on each day ( this should have raised an alarm flag here, but I was typing fast\u0026hellip; ).\nThe main loop looks like this:\ndays := 0 for days \u0026lt; max { for _, f := range fishes { if fish := f.tick(); fish != nil { fishes = append(fishes, fish) } } days++ } Sweet. We list the length of the list, and indeed, that\u0026rsquo;s the correct answer. We wrote a solution in about a minute or so. Little did we know that we were about to hit in the face with a giant fish shaped fist.\nDay 6 - Part 2 So, AOC does this sometimes. It present you with a simple problem and then says, okay, now do this times 1000000. And you sit there using your machine as a heating device for the next couple days while your solution is calculating.\nObviously, that\u0026rsquo;s not the right way to do it. When you face something like this, there is ALWAYS a solution which will run withing a couple seconds. There are two solutions. You either need caching, or you need to math that sh*t out.\nI don\u0026rsquo;t see an obvious way of caching here, so we\u0026rsquo;ll have to be a bit clever about it.\nLet\u0026rsquo;s try to think about this a bit. What is the most difficult part in this that runs to longest? Checking each and every fish and ticking them individually. We cannot do that. That will never ever be possible. There are way too many fish. We have to find a different angle to the problem. If we can\u0026rsquo;t track the fishes what can we track? We can track the number of days. But does that help us in any way?\nLet\u0026rsquo;s look at the example and try to see if we can find some kind of pattern as we go.\nThe ticks of the fish are the numbers of days it has left until it gives birth. All of the numbers will be in the range of 0-8.\nInitial day looks like this: 3, 4, 3, 1, 2. From the example. Sometimes it helps me to sort these numbers, see if I can make out a pattern. 1, 2, 3, 3, 4. Okay, we see there are two fishes which are on the same cycle. If, like we said, we are trying to track the days instead of the fish, take a look how many fishes on a day there are.\n0 1 2 3 4 5 6 7 8 0 1 1 2 1 0 0 0 0 Okay, let\u0026rsquo;s manually go and one-by-one increase the days and count the fish. Maybe we\u0026rsquo;ll see an emerging pattern.\nDay 1:\nAfter 1 day: 2,3,2,0,1\n0 1 2 3 4 5 6 7 8 1 1 2 1 0 0 0 0 0 Immediately we see something very cool. The numbers all remained the same, but they shifted by one to the left.\nLet\u0026rsquo;s keep going.\nAfter 2 days: 1,2,1,6,0,8\n0 1 2 3 4 5 6 7 8 1 2 1 0 0 0 1 0 1 Now we get to one of the rules. Once a fish reaches 0, there is a new fish and we reset the current fish to 6. What does that mean in our little table? Who was 0 before will be a 6 and an 8 now. Which means on the next day we can see that it will be 2, 0, 0, 0, 0, 1, 1, 1, 1 without even checking. Because our two 1s will be 0s on the next day and our one 2 will be a 1 and we get a new fish because we had a 0. But let\u0026rsquo;s check to make sure.\nAfter 3 days: 0,1,0,5,6,7,8\n0 1 2 3 4 5 6 7 8 2 0 0 0 0 1 1 1 1 And indeed, our assumption was right. But how do we track the increase? 6s will increase and 8s will track the new number of incoming fish.\nSo what does this tell us? It will help us keep track of the count of fish on each days. How do we get the total number of fish then? We\u0026rsquo;ll just sum up the numbers in this list.\nLet\u0026rsquo;s see some code. We start off by creating our initial list with the right number of fish from our input:\ndays := make([]int, 9) for _, f := range fishes { days[f]++ } This will produce our starting numbers. Now, what\u0026rsquo;s our cycle? Each day our fishes shift one to the left. With one tiny rule that the 0s will become 8s and 6s. Because they birth a new fish and they reset their timer back to 6. Shifting the numbers is easy, we just assign the next item to the current item. But we save the 0 first. And we create as many 6s and 8s as there were 0s.\nfor i := 0; i \u0026lt; max; i++ { first := days[0] for i := 0; i \u0026lt; 8; i++ { days[i] = days[i+1] } days[6] += first // we add them because there might be `6`s from the previous day too we don\u0026#39;t want to override those. days[8] = first // there are as many new fish as there were `0`s on the previous day } Next, we sum up the numbers:\nsum := 0 for _, f := range days { sum += f } fmt.Println(\u0026#34;number of fish: \u0026#34;, sum) And we are done. We run on our input, and this produces the right number pretty quickly instead of a year or a thousand.\nConclusion Phew, this one was a nice one! It prepared us for thinking a bit instead of blindly following the rules on the first part. It helps to take a look at the numbers and draw them out one by one on a piece of paper or on the computer or anywhere. Just trace the numbers by hand, which will surely make you see a pattern in all of it.\nAnd remember, that there is always a solution which will run fast. Whether it\u0026rsquo;s caching or a bit of math. And again, don\u0026rsquo;t be afraid to ask for clues! The people in the reddit forum are super nice and they will give you hints without spoiling the end result.\nThe repository for all my solutions for AOC 2021 can be found here.\nThank you for reading!\nGergely.\n","permalink":"https://skarlso.github.io/2021/12/06/aoc-day6/","summary":"Advent Of Code - Day 6 Alright. This time, we are going to learn something that AOC does from time to time\u0026hellip; Let\u0026rsquo;s break it down.\nDay 6 - Part 1 We start off really easy. We venture around in the sea, looking for nothing but trouble. We have our squid friend with us, whom we were telling everything about vents on the sea floor. Which happen to line up perfectly straight for some weird reason.","title":"Advent Of Code - Day 6"},{"content":"Advent of Code - Day 5 Alright. Today, we are going to learn something that will be useful to us in the coming days.\nLet\u0026rsquo;s see what we are dealing with.\nEdit: An interesting algorithm to read up on is Bresenham\u0026rsquo;s line algorithm.\nDay 5 - Part 1 We deal with vents today. The sea is a dangerous place after all. Fortunately for us, these vents line up perfectly so Santa can dodge them easily. We get a bunch of coordinates which form lines basically. The wording is pretty weird, says one end and the other. But these are just begin and end coordinates in a 2D grid.\nWe see the example, and it\u0026rsquo;s a 2D grid with lines drawn over. Let\u0026rsquo;s list our rules.\nlines with start x, y coordinates and end x, y coordinates only consider vertical and horizontal lines count the number of points where lines intersect Now, this seems like a problem for which you can use a 2D matrix. A coordinate system. But what if I tell you that you don\u0026rsquo;t need that. Why? Let\u0026rsquo;s think about this problem for a little bit. What do you need? You need a way to track some points. You need a way to see if a point already occurred or not\u0026hellip; Aka, was an intersection point of two or more lines. What could help you track if a certain point, a certain data, was already encountered or not? What could be something that could we could use to easily and quickly access a value using another value? Have a little think. Go on, I\u0026rsquo;ll wait.\nOkay, here we go. It\u0026rsquo;s a map. Or a dict. Or an associative array. That\u0026rsquo;s right, that\u0026rsquo;s all we need. A map which can track if we encountered a point before. The map key is x, y together and the value is a simple count.\nIn Go, we use a struct for that like this:\ntype point struct { x, y int } And then our map is like this: seaFloor := make(map[point]int).\nAlright let\u0026rsquo;s scan our input. We use our trusty Sscanf function again, because the input follows a nice format:\nfor _, l := range split { var ( x1, x2 int y1, y2 int ) fmt.Sscanf(l, \u0026#34;%d,%d -\u0026gt; %d,%d\u0026#34;, \u0026amp;x1, \u0026amp;y1, \u0026amp;x2, \u0026amp;y2) lines = append(lines, line{ begin: point{x: x1, y: y1}, end: point{x: x2, y: y2}, }) } Now, I know that we said, that a map is enough and you don\u0026rsquo;t need a 2D map. But how do we check horizontally and vertically then? Well, what is horizontal vertical? We check the sample.\n0,9 -\u0026gt; 5,9 8,0 -\u0026gt; 0,8 9,4 -\u0026gt; 3,4 2,2 -\u0026gt; 2,1 7,0 -\u0026gt; 7,4 6,4 -\u0026gt; 2,0 0,9 -\u0026gt; 2,9 3,4 -\u0026gt; 1,4 0,0 -\u0026gt; 8,8 5,5 -\u0026gt; 8,2 Out of these, horizontal and vertical only mean that ONE OF THE COORDINATES EQUALS. And the other either increases or decreases.\nOkay, so we track if we need to add or subtract 1 to a number. Because \u0026ldquo;drawing a line\u0026rdquo; is literally just increasing the coordinate. One of them at least.\nfor _, l := range lines { addx := 0 addy := 0 ... So when do we increase x and when y? If one of them is greater or smaller than the other.\nfor _, l := range lines { addx := 0 addy := 0 if l.begin.x \u0026gt; l.end.x { addx = -1 } if l.begin.x \u0026lt; l.end.x { addx = 1 } We do that with y as well. But\u0026hellip; This will result in both x and y increasing at the same time if neither of them equal. That would be\u0026hellip; diagonal! We ignore that. We could say at the begin, something like, if neither of them equal, continue.\nFor now I just skip if both addx and addy are not 0. Then comes our for loop. We have to \u0026ldquo;draw a line\u0026rdquo; from a starting point to and end point. So we just start adding the addN to the respective number until they match the end coordinate.\nAnd once we have a new coordinate we save that in our map. And if the map already contains it, we just increase that by one. In Go, that\u0026rsquo;s easy, because things in the map have a default value. For int that\u0026rsquo;s 0. Which is perfect for us.\nOur for loop looks like this:\nfor startX != targetX || startY != targetY { seaFloor[point{x: startX, y: startY}]++ startX += addX startY += addY } Easy. Except I had a small bug here, where I forgot to add the last item as well.\nseaFloor[point{x: startX, y: startY}]++ Now, we are ready to count overlaps. Which will just be going through the map and doing a count++ in case a value in the map is greater than 1.\noverlaps := 0 for _, v := range seaFloor { if v \u0026gt; 1 { overlaps++ } } fmt.Println(\u0026#34;overlaps: \u0026#34;, overlaps) And done! That\u0026rsquo;s all. No need for a 2D map or tracking coordinates or walking around with nested for loops.\nWe run this on the test and our sample input and we got the right result!\nDay 5 - Part 2 We check part 2 and guess what!! The only change is that we have to also run diagonally. What luck!?\nI just remove the addx and addy check and we have part 2 done.\nConclusion And that\u0026rsquo;s it! We are done for today. We learned that we don\u0026rsquo;t always need a matrix to solve problems with coordinates. We have to keep an open mind and find the right data to represent our problem. The right data will solve 50% of the puzzle.\nThe repository for all my solutions for AOC 2021 can be found here.\nThank you for reading!\nGergely.\n","permalink":"https://skarlso.github.io/2021/12/05/aoc-day5/","summary":"Advent of Code - Day 5 Alright. Today, we are going to learn something that will be useful to us in the coming days.\nLet\u0026rsquo;s see what we are dealing with.\nEdit: An interesting algorithm to read up on is Bresenham\u0026rsquo;s line algorithm.\nDay 5 - Part 1 We deal with vents today. The sea is a dangerous place after all. Fortunately for us, these vents line up perfectly so Santa can dodge them easily.","title":"Advent Of Code - Day 5"},{"content":"Advent of Code - Day 4 Disclaimer: There is surely a better solution than this one. But I\u0026rsquo;m fairly okay with this one. And I wrote it, so\u0026hellip;\nOkay, this day was a bit more complex now. But not in understanding what needed to be done, but implementing it. And then, part two of course.\nDay 4 - Part 1 We met a squid this day and decided to play a round of Bingo with it. Because, why not? Bingo is a simple game. You have several papers on which there are a couple numbers in a square. Someone draws a number, and you need to find that number on your boards, cards, slips, whatevers. Once you have marked 5 numbers in a row, or a column ( or, in the original game diagonal also goes ) you win.\nEasy. You have a matrix. Get a number. Mark the numbers in the matrix which equal to the drawn number.\nI\u0026rsquo;m gonna follow this logic. There might be better ones where you can calculate things based on some math, I encourage you to look at different solutions as well.\nFirst, we parse the input. Get the first line, and then skip the first two so we can get to the numbers.\nfor i, l := range split { if i \u0026lt; 2 { continue } if l == \u0026#34;\u0026#34; { boards = append(boards, board) board = make([][]int, 0) continue } nums := strings.Fields(l) n := make([]int, 0) for _, number := range nums { i, err := strconv.Atoi(number) if err != nil { log.Fatal(err) } n = append(n, i) } board = append(board, n) } This should do it. Now, there is a small surprise here. The numbers in the matrix are not separated by just a single space. They are separated by multiple ones. This is just a small extra to mess with your head. Lucky for us, Go has us covered with strings.Fields. This will retrieve just the numbers without the spaces.\nNow, we get to the main logic\u0026hellip; Draw, mark, see if we have a winning board, calculate score.\nfor _, n := range nums { markBoards(n, boards) if winner, ok := hasWinner(boards); ok { fmt.Println(\u0026#34;winner score: \u0026#34;, calculateScore(n, winner)) fmt.Println(\u0026#34;winner board: \u0026#34;, winner) os.Exit(0) } } Pretty easy. Marking the board is just going through all the boards in the list of boards and do a for i, for j to get at the right number and change that number to -1. Why does -1 work? Because if we read on, the score is calculated by going through the board and adding up UNMARKED numbers. So we don\u0026rsquo;t need any special way to keep track of marked numbers. We just care about the unmarked ones.\nNow, hasWinner is a bit more complex, but just because we need to check horizontally and vertically. And we have to remember that we have to stop immediately once we found a winner.\nI\u0026rsquo;m sure there is a better way to do this, but I just went for two loops:\nfunc hasWinner(boards [][][]int) ([][]int, bool) { for _, board := range boards { for i := 0; i \u0026lt; len(board); i++ { // check vertically rowWon := true for j := 0; j \u0026lt; len(board[i]); j++ { if board[i][j] != -1 { rowWon = false break } } if rowWon { return board, true } } // these are 5x5 and not varring in size. l := len(board[0]) for col := 0; col \u0026lt; l; col++ { colWon := true for i := 0; i \u0026lt; len(board); i++ { if board[i][col] != -1 { colWon = false break } } if colWon { return board, true } } } return nil, false } And then the calculation is just again going through and doing the adding and then the multiplication.\nWe run it on our test data and input and it works. Fantastic. On to part 2!\nDay 4 - Part 2 Part 2 is just about finding the last winning board. Great! We are already geared towards that. Once we find a winning board we remove that board and begin again. We do this until there are no boards left. I\u0026rsquo;m not sure how that will make sure that the squid wins, I don\u0026rsquo;t understand that part to be honest, but that\u0026rsquo;s not our goal.\nFor this, we slightly alter our main loop like this:\nfor len(boards) \u0026gt; 0 { for _, n := range nums { markBoards(n, boards) if loc, winner, ok := hasWinner(boards); ok { fmt.Printf(\u0026#34;winner score: number: %d, score: %d, loc: %d\\n\u0026#34;, n, calculateScore(n, winner), loc) boards = append(boards[:loc], boards[loc+1:]...) break } } } This will display all boards which win. I don\u0026rsquo;t really care about that, again, I could have just checked the last, or save all or when len==1 check it. But this was the fastest, easiest way to do it. And as I said in the begin, these are small scripts which I will probably never look at again, so I don\u0026rsquo;t care about maintainability. I care that it\u0026rsquo;s efficient, fast and easy to read / write.\nWe run this, and it works on the test and the input. And that\u0026rsquo;s it for part 2!\nConclusion We learned again that reading things and understanding can be hard. The samples can be daunting, but don\u0026rsquo;t let yourself be intimidated. And never be afraid to ask questions, look at what other people are doing especially if you just started doing AOC this year.\nBut most importantly, have fun with it!\nThe repository for all my solutions for AOC 2021 can be found here.\nThank you for reading!\nGergely.\n","permalink":"https://skarlso.github.io/2021/12/04/aoc-day4/","summary":"Advent of Code - Day 4 Disclaimer: There is surely a better solution than this one. But I\u0026rsquo;m fairly okay with this one. And I wrote it, so\u0026hellip;\nOkay, this day was a bit more complex now. But not in understanding what needed to be done, but implementing it. And then, part two of course.\nDay 4 - Part 1 We met a squid this day and decided to play a round of Bingo with it.","title":"Advent Of Code - Day 4"},{"content":"Advent Of Code - Day 3 Here we go for day 3!\nThis day was a tiny bit more complex. A lot of more things to read for sure! But all the more exciting!\nLet\u0026rsquo;s get to it!\nDay 3 - Part 1 We are dealing with binary numbers. At fist glance it can be daunting, but it\u0026rsquo;s actually not that complicated. We have to find two numbers. gamma rate and epsilon rate. To do that, we have to parse some binary numbers and then convert them to decimal. The two numbers can be found by looking for the most common bit at a given position in all of the numbers and the least common one at a given position in all of the given numbers. Better put, as we read on, find the bit that occurs most of the time and the one that occurs least of the time in all numbers and put them together. That\u0026rsquo;s your new number.\nAs always, let\u0026rsquo;s write out our constraints first!\nwe have a list of binary numbers we have to go through all of them and check a certain position for all of them find the most occurring number ( either 0, or 1 ) that occurs at position n append this number to a new number that is being constructed result Okay, so\u0026hellip; loop through the numbers, as we loop, check all of the numbers at position 0, 1, 2, 3\u0026hellip; and check which digit occurs most and least. Add the most one to the gamma rate and the least one to the epsilon rate.\nThis needs a bit of a brain wrap. We will loop through all the numbers, but we will also loop through all the numbers again but check a certain position. Meanwhile, we track the number of zeros and ones we count.\nThis will result in two loops. The first loop goes as long as the numbers are. And the second goes as many times as many numbers there are.\n// Loop as much as long the numbers are... for i := 0; i \u0026lt; len(nums[0]); i++ { zeros := 0 ones := 0 // loop through all the numbers and check digit location. for j := 0; j \u0026lt; len(nums); j++ { // count ones and zeros if nums[j][i] == \u0026#39;0\u0026#39; { zeros++ } else { ones++ } } // if zeros are larger gamma is 0 epsilon is 1. if zeros \u0026gt; ones { gamma += \u0026#34;0\u0026#34; epsilon += \u0026#34;1\u0026#34; } else { // if ones are larger, gamma is 1 epsilon is 0. gamma += \u0026#34;1\u0026#34; epsilon += \u0026#34;0\u0026#34; } } This will result in the right gamma and epsilon numbers, but we aren\u0026rsquo;t done yet there. We have to convert this to decimal. Lucky for us, Go provides tools for this. We simple call strconv.ParseInt like this:\ng, _ := strconv.ParseInt(gamma, 2, 64) e, _ := strconv.ParseInt(epsilon, 2, 64) fmt.Println(\u0026#34;result: \u0026#34;, g * e) And that\u0026rsquo;s it. We have our power consumption. On to Part 2!\nDay 3 - Part 2 Now that\u0026rsquo;s a doozy! That is a LOT of text\u0026hellip; Let\u0026rsquo;s try breaking it down. AOC now will teach you how to read. This is actually an important skill to acquire. A lot of times you will have to parse a lot of text and try to figure out what the actual task is.\nAgain, we are looking for two numbers. oxygen generator rating and CO2 scrubber rating. Now, it\u0026rsquo;s important again, to identify certain aspects here. Like last time I talked about that there are things which you can take for granted. Things and rules which will make it easier to find something or will define an exit criteria for a search or a filter. Reading here, we find such an exit criteria:\nprocess that involves filtering out values until only one remains.\nWe have to filter the numbers until only one remains. This is important. You can be sure that the result will always be a single number out of the list of numbers. That\u0026rsquo;s your exit criteria. You can stop once your list is filtered to a single number.\nThe next sentence I actually find confusing.\nBefore searching for either rating value, start with the full list of binary numbers from your diagnostic report and consider just the first bit of those numbers.\nFor me this implies that I would have to do something with the numbers before I start search. This is not true. It\u0026rsquo;s actually just outlining what you filter criteria will be\u0026hellip; which is:\nstart with the first bit selected numbers based on a predicate (described later as bit criteria) if you have one number left, stop continue with the next bit So what are the bit criteria?\nEach number has its own definition of criteria that it needs.\noxygen generator rating:\nthe most common value in a bit position if equal keep the 1s CO2 scrubber rating:\nthe least common value in a bit position if equal keep the 0s Then we have a nice and detailed example for both of the values. Basically, we\u0026rsquo;ll have two loops and we duplicate our list of numbers. Both loops will delete numbers based on the predicate until only a single number remains. All the while going through the bit positions until it\u0026rsquo;s done.\nThe basic algorithm looks like this:\nfunc filter(list []string, pred func(zeros, ones int) bool) string { // Start at position zero. bitPosition := 0 // until there is only a single left... for len(list) != 1 { zeros := 0 ones := 0 // same as before, we count the ones and zeros for _, o := range list { if o[bitPosition] == \u0026#39;0\u0026#39; { zeros++ } else { ones++ } } // we decide which number / position to keep var bit byte // based on the predicate, ones and zeros, decide which number will be kept. if pred(zeros, ones) { bit = \u0026#39;1\u0026#39; } else { bit = \u0026#39;0\u0026#39; } // remove the numbers which are not needed for i := 0; i \u0026lt; len(list); i++ { if list[i][bitPosition] == bit { list = append(list[:i], list[i+1:]...) i-- } } // check the next bit position bitPosition++ } // return return list[0] } And our predicates look like this:\noxygen := filter(oxygens, func(zeros, ones int) bool { return zeros \u0026gt; ones }) co2 := filter(co2s, func(zeros, ones int) bool { return zeros \u0026lt; ones || zeros == ones }) For oxygens, we are looking for most common values, otherwise it\u0026rsquo;s not needed. And for co2s we are looking for the least common values and if they equal, we want the zeros.\nAnd that\u0026rsquo;s pretty much it. Parsing and finding and understanding the problem was a bit harder this time around, but it will get a lot more convoluted after this.\nConclusion We got a taste of what longer and more convoluted descriptions will look like. We got prepared for reading. We learned a bit about strconv.ParseInt. Maybe it will be handy later.\nBTW this is something that is called trivially parallel. We could easily call these in a Go routine. But it wouldn\u0026rsquo;t matter since our sample size is rather small. Just keep in mind to keep an eye out for these.\nThe repository for all my solutions for AOC 2021 can be found here.\nThank you for reading!\nHappy coding!\nGergely.\n","permalink":"https://skarlso.github.io/2021/12/03/aoc-day3/","summary":"Advent Of Code - Day 3 Here we go for day 3!\nThis day was a tiny bit more complex. A lot of more things to read for sure! But all the more exciting!\nLet\u0026rsquo;s get to it!\nDay 3 - Part 1 We are dealing with binary numbers. At fist glance it can be daunting, but it\u0026rsquo;s actually not that complicated. We have to find two numbers. gamma rate and epsilon rate.","title":"Advent Of Code - Day 3"},{"content":"Advent Of Code - Day 2 Here we go for day 2!\nThese first couple of problems prepare you on how to deal with input mainly. Learn and get used to parsing lines, and get comfortable with data structures.\nDay 2 - Part 1 We continue the story of Santa and the submarine. This time, he has the task of trying to steer the thing. The task is straightforward. You get a couple of instructions and based on a value you increase or decrease a positions.\nWe have a choice to make here. The wording says horizontal position and depth. Considering the future of these exercises we could go with variable names horizontal and depth. But I choose x and y. Why did I do that? That sounds like I\u0026rsquo;m not considering the right variable names. But I\u0026rsquo;m preparing for the inevitable 2D coordinates that will definitely come. You might as well get comfortable dealing with them now.\nSo, what are our constraints?\nThis time, it\u0026rsquo;s quite clear and neatly packaged:\nforward X increases the horizontal position by X units. down X increases the depth by X units. up X decreases the depth by X units. Now comes a sentence I think is there only to confuse you. It might be not, but I swear I had to take a second look at that. The above constraints are clear and easy to follow. And then comes this sentence and makes me take spend a little bit more time on parsing them:\nNote that since you\u0026rsquo;re on a submarine, down and up affect your depth, and so they have the opposite result of what you might expect.\nNo, they are not. According to the constraints I expect down to increase depth and up to decrease depth. It\u0026rsquo;s clearly written there. I believe this sentence should just be ignored.\nLet\u0026rsquo;s get to solving this thing. We read the rest of the thing, and get to our test input.\nforward 5 down 5 forward 8 up 3 down 8 forward 2 What comes now, is trying to parse the input. In Go, Scanf is an option. In other languages, you might want to just Split(s, \u0026quot; \u0026quot;) split by space. In Go I\u0026rsquo;m using this:\nvar ( op string v int ) fmt.Sscanf(string(l), \u0026#34;%s %d\u0026#34;, \u0026amp;op, \u0026amp;v) What\u0026rsquo;s happening here is that l is a line from the above sample in a file ( reading line by line ). \u0026quot;%s %d\u0026quot; is saying scan for strings and then scan for a number. And the \u0026amp;op, \u0026amp;v just puts the result in their respective values.\nWe have the result now in values. Let\u0026rsquo;s implement the above three rules.\nswitch op { case \u0026#34;forward\u0026#34;: x += v case \u0026#34;up\u0026#34;: y -= v case \u0026#34;down\u0026#34;: y += v } Pretty neat. Could be an if. Could be made tidier. Doesn\u0026rsquo;t really matter as long as it solves the problem at hand. Competitive scripts usually are not meant to be maintainable masterpieces.\nIt gets the job done. Then we continue by reading what the actual result should be and we see that we just have to multiple horizontal position with depth. Which is x * y.\nfmt.Println(\u0026#34;mult: \u0026#34;, x*y) This gets us the right test value and, in fact, the right value to our input as well.\nHere, I would like to mention that you always have to deal with things like empty new lines, and spaces after a line. So always trim and make sure you don\u0026rsquo;t accidentally parse an empty line as a valid input.\nDay 2 - Part 2 Now, things get a bit more complex. Turns out we aren\u0026rsquo;t actually parsing the coordinates correctly, so there are some new constraints. What are they?\nWe have a new value, aim. And a new set of constraints:\ndown X increases your aim by X units. up X decreases your aim by X units. forward X does two things: It increases your horizontal position by X units. It increases your depth by your aim multiplied by X. Again, just ignore the fluff around this this time, because it\u0026rsquo;s more distracting than helpful. Sometimes it contains some weird extra info, but this time, I found them to be a bit misleading. The actual problem is super simple.\nWe change our implementation to increase decrease aim and do the thing for x and y a bit differently.\nFollowing the rules we get to this:\nswitch op { case \u0026#34;forward\u0026#34;: x += v y += (aim * v) case \u0026#34;up\u0026#34;: aim -= v case \u0026#34;down\u0026#34;: aim += v } Then we carefully read what has to be done to get the result and we see that it actually did not change. We still multiple x and y.\nAnd indeed, this is the correct result for our test, so we run it for our input and that should yield the right value.\nConclusion This day now showed you that input comes in various forms and formats which you need to be prepared to parse correctly. We made sure that we skip empty new lines and always trim possible spaces. And we got to know Sscanf which can be handy at times if the format is strict enough.\nWe also learned to read important information and disregard things which can distract from the actual goal.\nThe repository for all my solutions for AOC 2021 can be found here.\nThank you for reading!\nHappy coding!\nGergely.\n","permalink":"https://skarlso.github.io/2021/12/02/aoc-day2/","summary":"Advent Of Code - Day 2 Here we go for day 2!\nThese first couple of problems prepare you on how to deal with input mainly. Learn and get used to parsing lines, and get comfortable with data structures.\nDay 2 - Part 1 We continue the story of Santa and the submarine. This time, he has the task of trying to steer the thing. The task is straightforward. You get a couple of instructions and based on a value you increase or decrease a positions.","title":"Advent Of Code - Day 2"},{"content":"Advent Of Code - Day 1 Since 2015, Advent Of Code has been a part of my life. I\u0026rsquo;ve done various posts on it already, but this year will be different. I\u0026rsquo;m going to blog every day every solution, why and how I\u0026rsquo;ve gotten to that solution.\nThis isn\u0026rsquo;t going to be ever December, because I\u0026rsquo;m usually unable to solve a problem on a single day in the later days from day 10 or so. It takes more time then I have. But I will solve all of them. At the time of this writing, I have completed almost all puzzles except for year 2019 which I didn\u0026rsquo;t much enjoy to be honest.\nA bit of history before we begin I first heard of Advent Of Code when I joined Cheppers back in 2015. It was a great journey, and I loved every moment if it, but eventually I moved on. Advent of code, however, stayed with me over these past years. As someone without a formal CS education, I\u0026rsquo;m using these puzzles to catch up things I might have missed out. Everything I know I learned either by my self, or from books or videos or on the job. I begun coding at an early year and it stuck with me.\nI really struggled with some of these problems, and I haven\u0026rsquo;t been able to completely solve a single year so far without seeking help. Every year, I\u0026rsquo;m getting closer and closer to solving all of the days, but it hasn\u0026rsquo;t happened yet.\nIt was amazing in identifying my weak areas. Things like, geometry problems ( I have forgotten everything from school ) ( asteroids had to be shot down going in a circle on a 2d matrix ), permutation problems, graph traversal, BFS, DFS, backtracking\u0026hellip; As someone who never really had to deal with these things, I really lacked the know how.\nAs the years went by, and I solved all of the puzzles this way or that, and looked at what other people were cooking up, I begun to see that I started to improve in some of these areas.\nI know why I didn\u0026rsquo;t improve in the areas I would have liked to improve in. And that is, lack of reflection. What do I mean by that? I solved the problem, read someone\u0026rsquo;s solution, then went on with my life. The way to get better at something is through reflection and recall though. And I didn\u0026rsquo;t do either.\nSo this year, I\u0026rsquo;m going to reflect and recall all my solutions, and even though I might need help in the later days, I will never use anyone else\u0026rsquo;s code. I will always write my own. And then, reflect upon it, by writing a post and talking about why this solution works or how I\u0026rsquo;ve gotten to it.\nI also decided to finally create an SDK with all the common functions I\u0026rsquo;m using.\nDay 1 History out of the way, let\u0026rsquo;s break down day 1.\nPart 1 As usual, the first couple days are warmup. Easy problems to get your brain started into the right move and set up the story. Which is my favorite thing in all of this! Reasons why AOC is so awesome, is that it has an actual story! It isn\u0026rsquo;t just leetcode, or spoj or codewars or whatever. There is an actual story and it\u0026rsquo;s hilarious and a good read. And the problems aren\u0026rsquo;t just, solve x, solve y. They usually are diverse in some sense.\nPart 1 this year, sets us up on a wild ride under the sea. The keys dropped into the water and we hopped into a submarine to go after it.\nLet\u0026rsquo;s examine the problem.\nHow do I read AOC problems? First, I\u0026rsquo;m reading the story. I\u0026rsquo;m not in a hurry. I don\u0026rsquo;t want to be on the leader board. That\u0026rsquo;s not gonna happen. Then, I\u0026rsquo;m examining the problems and write down all the constraints ( aka, rules ).\nFor Part 1:\nwe have a set of numbers they are all positive integers ranging from 100 - 9999 ( it\u0026rsquo;s important to identify your working sample as your solution depends on it ) which means we can assume that there won\u0026rsquo;t be any negative numbers, floats, complex numbers, etc. ( narrows down the solution sample size ) The first order of business is to figure out how quickly the depth increases, just so you know what you\u0026rsquo;re dealing with - you never know if the keys will get carried into deeper water by an ocean current or a fish or something.\nwe need depth increases ( what does this mean? ) ( we read on to find out more ) To do this, count the number of times a depth measurement increases from the previous measurement.\nIt\u0026rsquo;s important to see what things are in bold. They provide rules, hints and further clues. It\u0026rsquo;s also important to read and re-read every sentence PROPERLY AND THOROUGHLY. Because sometimes they are confusing on purpose. From the above we gather the following rule:\ncount the number of times a number in the list increases compared to the previous one (numbers[n+1] \u0026gt; numbers[n]) And here is a tiny tidbit that I\u0026rsquo;m sure folks will glance over and yet it\u0026rsquo;s very important! In parentheses!\n(There is no measurement before the first measurement.)\nMeaning, you don\u0026rsquo;t compare the first one. This could cause a off by one error in part 2. It\u0026rsquo;s important to pay attention.\nThen we have the example, and we are off.\nCode Essentially we just loop through all numbers that we gathered, and if there is a bigger number as the current one we increase a counter.\ncounter := 0 for i := 0; i \u0026lt; len(n)-1; i++ { if n[i+1] \u0026gt; n[i] { counter++ } } fmt.Println(\u0026#34;Number of increases:\u0026#34;, counter) That\u0026rsquo;s it. We test it on the test which should yield the right number then we run it on our input, which also should yield the right number. This runs at a reasonable pace, so I think we are fine on optimization.\nOnwards to\u0026hellip;\nPart 2 As usually, with part 2, things get a bit more complex here. We now need to solve a sliding window of threes. This a bit confusing to read at first, but essentially, we just need to sum up groups and compare the sums. We have to still do that same thing as before, but now, we track a previous sum and we need to check the next 2 numbers in the list not just the current, and current + 1.\nThe term sliding-window can be a bit confusing here. It just means that we will compare a slice of the numbers. The A B C notation looks also weird to me. This one is a bit better:\nConsider a list like this 1, 2, 3, 4, 5, 6. We compare [1+2+3], [2+3+4], [3+4+5], [4+5+6].\nSo the sliding window is basically a set of three numbers counted from your current number. Instead of numbers[n] and numbers[n+1] we will look at numbers[n] + numbers[n+1] + numbers[n+2].\nFollowing that the code changes a tiny bit:\ncounter := 0 prevsum := math.MaxInt for i := 0; i \u0026lt; len(n)-1; i++ { if n[i] + n[i+1] + n[i+2] \u0026gt; prevsum { counter++ } } fmt.Println(\u0026#34;Number of increases:\u0026#34;, counter) Why did I add the math.MaxInt? Because we don\u0026rsquo;t count the first one, as pointed out by the previous sentence in parentheses!\nThis should give us the right value and both stars.\nClosing words So this is it for day 1. This one was an easy day. It prepared you to read the problem description. Understand it, and prase out the rules of engagement.\nThe repository for all my solutions for AOC 2021 can be found here.\nThanks for reading,\nGergely.\n","permalink":"https://skarlso.github.io/2021/12/01/aoc-day1/","summary":"Advent Of Code - Day 1 Since 2015, Advent Of Code has been a part of my life. I\u0026rsquo;ve done various posts on it already, but this year will be different. I\u0026rsquo;m going to blog every day every solution, why and how I\u0026rsquo;ve gotten to that solution.\nThis isn\u0026rsquo;t going to be ever December, because I\u0026rsquo;m usually unable to solve a problem on a single day in the later days from day 10 or so.","title":"Advent Of Code - Day 1"},{"content":"Prologue Hello all.\nThis is a summary of the book Programmer\u0026rsquo;s Brain. Let me begin by saying the book is fantastic and you should definitely read it. The research put into it is phenomenal, and the many linked notes, data and reference make for an amazing and compelling read!\nNot to mention that it is fantastic that someone put actual effort and data into finding out how programmers operate, think and behave. And most of all, how our code behaves and reading, and dealing with code is not just about understanding algorithms and finding the best possible and most optimized code ever.\nWhat does this summary contain? Information that I found useful about the book. It doesn\u0026rsquo;t contain everything, just the distilled amalgamation of information that I hand picked and will try to convey using my own words.\nLet\u0026rsquo;s dive in.\nPart One - Reading code better Understanding We all know that we read code more than we write it. It\u0026rsquo;s a basic premise, right? Yet, still we don\u0026rsquo;t write code for reading at all! We have to make a conscious effort of it to write it in a readable, compact way. We optimize for speed, optimize for structure, but we rarely, if at all, optimize for readability. For understandability. To please the reader, instead of the writer. To look ahead an think, by whom and how will this code be read again?\nThis part offers a couple of solutions to alleviate this pain.\nConfusion It identifies three things. Lack of Knowledge, Lack of Information and Lack of Processing Power.\nlack of information - basically, you don\u0026rsquo;t know enough about the project / code you are looking at lack of knowledge - you lack knowledge about the thing you are doing, i.e.: some obscure language syntax you are unfamiliar with lack of processing power - the code chunk you are looking at is too large, or you should break it down The book makes a point on how cognitive load works and why you should take care of it. I\u0026rsquo;m not going to detail that part ( read the book! ). But it\u0026rsquo;s basically all about how complex something looks until you have enough background in your long term memory to be able to decipher it instantly and not spending too much time on it.\nLack of processing power is alleviated by taking notes, jotting down information and functions and variables about the code you are writing. By using a second brain (i.e. paper) you lighten the load on your current working memory. Further, it might be helpful to refactor into something that you do understand and are already familiar with. For example, exploding a Python list comprehension into a for loops until you understand the whole thing. Then put it back and read it again.\nLack of knowledge is easy to mend. You read up on said topic / become better in it.\nLack of information again, just read up on the stuff you are missing.\nReading The book then continues with helping you speed read code better. There are fascinating researches quoted about various things they tried with experts and junior programmers and chess masters vs beginners.\nAs much as Go people dislike talking about design patterns in Go, they exist for a reason. The reason is that there are common problems which have common, tried solutions. It\u0026rsquo;s fare that these patterns apply differently in Go because of the structure available to us, but they still exist. And this is on which speed reading hinges. Patterns. The more patterns you recognize the faster you\u0026rsquo;ll be able to read code.\nfor loops, if err != nil checks. It\u0026rsquo;s ingrained now into your memory and you recognize and can read it at a glance.\nThis means, in order to help the reading of your code, you should focus on things called Beacons. Beacons are small, understandable (at a glance) parts of your code. Comments, patterns like if err != nil , chains, proper function names; all of these are beacons which help in understanding and reading your code better.\nFor faster code reading speed, you have to know patterns and idioms at a glance. Practice until you know them by heart. For example, you don\u0026rsquo;t have to look twice to identify a bridge above water, right? You know it\u0026rsquo;s a bridge because it looks like a bridge. It could be above a street too it still would be a bridge.\nTo be able to learn faster, the book, and indeed many other research papers now-a-days, suggest spaced repetition, recall, and / or flashcards.\nOne of the best suggestions I\u0026rsquo;ve gotten out of this book about reading and learning code, is if you have to Google something for the second time because you don\u0026rsquo;t remember how that works, you are wasting time and are adding to your cognitive load. At that point, you should make an effort to remember it with the above suggested tips. Why, even for the first time. If you Google something or look it up on StackOverflow, at that moment, you should create a flash card for it and condense that information WITH YOUR OWN WORDS! Then use spaced repetition / recall to remember it.\nIn the future you will benefit from having that thing in the back of your head.\nPart Two - Thinking about code Reading strategies Then we get to reading and understanding code. Research backed data proves that mathematical knowledge will not make you better at understanding code. Linguistic proves backs programming skills more than mathematical understanding. Logical proves also helps a lot more.\nEffective reading in general, can be broken down into the following sections:\nActivating \u0026ndash; try remembering things which relate or are similar to the thing you are reading Monitoring \u0026ndash; check your understanding as you go Determining importance \u0026ndash; discard things that are of no interest to you Inferring \u0026ndash; understand things that the text only implies Visualizing \u0026ndash; draw things \u0026ndash; only helps if you are visually inclined. I think you should do whatever helps you to understand Questioning \u0026ndash; without recall there is no remembering Summarizing \u0026ndash; write a summary IN YOUR OWN WORDS!!! ( I can\u0026rsquo;t stress this enough ) When you are reading code, you first will understand the code at hand, and then, a bigger picture understanding comes later. I\u0026rsquo;m not sure about which comes first. I think everyone is different. Someone might understand the bigger picture a lot easier than actual code. In any case, mapping either to the other is a difficult process. Inferring code from patterns and inferring the bigger picture from code. It\u0026rsquo;s a good exercise.\nThe book also separates variables based on behavior. This might help you understand the code better later, when you read it. It uses the following 11 categories:\nFollower Stepper Walker Temporary Counter/Gatherer Container Fixed value Flag Organizer Most-recent Holder Most-wanted Holder These are self-explanatory, but marking the variables might give you a hint on their purpose and maybe refactor them or name them appropriately.\nNow, we come to the interesting sub-section of problem solving.\nProblem solving Mental Models The way you create a mental model about a problem will decide how you\u0026rsquo;ll go about solving them. Which means, if your solution \u0026ldquo;feels dirty\u0026rdquo;, or is buggy and doesn\u0026rsquo;t feel right, you just might need to change your mental model about the problem. Or the data representing it. Your mental model will decide how you tackle this problem. So you better make sure your mental model is correct. A couple of mental models can be, diagrams, a graph, a state machine\u0026hellip; everything that can represent the logic of the code with a model.\nThinking with models about the logic of the code is an important skill. Abstracting the problem can give you a huge benefit in solving it.\nThere is an awesome quote from Rob Pike:\nA year or two after I’d joined the Labs, I was pair programming with Ken Thompson on an on-the-fly compiler for a little interactive graphics language designed by Gerard Holzmann. I was the faster typist, so I was at the keyboard and Ken was standing behind me as we programmed. We were working fast, and things broke, often visibly — it was a graphics language, after all. When something went wrong, I’d reflexively start to dig in to the problem, examining stack traces, sticking in print statements, invoking a debugger, and so on. But Ken would just stand and think, ignoring me and the code we’d just written. After a while I noticed a pattern: Ken would often understand the problem before I would, and would suddenly announce, “I know what’s wrong.” He was usually correct. I realized that Ken was building a mental model of the code and when something broke it was an error in the model. By thinking about how that problem could happen, he’d intuit where the model was wrong or where our code must not be satisfying the model.\nKen taught me that thinking before debugging is extremely important. If you dive into the bug, you tend to fix the local issue in the code, but if you think about the bug first, how the bug came to be, you often find and correct a higher-level problem in the code that will improve the design and prevent further bugs.\nI recognize this is largely a matter of style. Some people insist on line-by-line tool-driven debugging for everything. But I now believe that thinking — without looking at the code — is the best debugging tool of all, because it leads to better software.\nI love this. It shows that having a clear mental model of the code will help you in understanding it better. Work through the code, construct a model by following a call path. Understand and draw the entities which interact with each other through that path and construct a structure out of it. Draw that structure or put it into a state machine, write down how pieces and variables interact and you\u0026rsquo;ll have a clear understanding of what\u0026rsquo;s going on.\nThis is called following a focus point. A focus point is an entry to a system. Sometimes there are multiple focus points. They all represent a different path through the system but might use the same entities.\nThe more general mental models you store in your Long Term Memory, the easier it will be to identify and solve problems. Use flashcards to remember as many mental models as you can. Things like, tree traversal, sorting, data structures, thinking about architecture, layered architecture etc\u0026hellip; If you can recall them from heart you\u0026rsquo;ll be able to reason and understand code a lot better.\nNotional Machines The best way to describe a notional machine is an abstraction of the executing code. It\u0026rsquo;s a kind of mental model, but it\u0026rsquo;s always correct. A normal mental model can be incorrect. A notional machine always depicts what the machine is doing. I didn\u0026rsquo;t really find them helpful, but they might be helpful to others. Notional machines help us understand how the machine works, how code runs. There are multiple machines which can work together. To learn more about them, either read the book, or read this research paper on them.\nMisconceptions This one is interesting and certainly worth an explanation. Basically, you have to constantly check you biases about code, concepts and your mental models. Otherwise, you\u0026rsquo;ll fall into the routine of using the wrong model all the time. This isn\u0026rsquo;t always easy, because it might not be apparent at first. But never assume that what you know is always correct. Of course there are axioms like 1==1 which will always be true, but that doesn\u0026rsquo;t mean that a concept you might know is an axiom.\nAlways read the documentation and the code of the current project you are working on with the care of checking your mental models. They might be outdated or incorrect.\nPart Three - Writing better code How to get better at naming things This is a whole chapter in it\u0026rsquo;s own about naming things. That is an important chapter to be sure because naming is the hardest. But I found that the advice there is basically, name things in the context they are in and regarding the behavior they represent. Naming things has always been important. A good name will sometimes solve the whole problem in its own!\nThere was one time where I was thinking about how to implement a particular feature. I\u0026rsquo;ve spent a day on trying to come up with a nice solution. When I stepped back and thought about the problem without looking at the code. Building up a mental model, thinking about what I need and if there is a thing that can do that for me. When suddenly, the best name popped into my head based on the need, the circumstance and the behavior of the thing. Suddenly, the whole implementation laid itself out before me because I knew what I needed. I had a name for it.\nEqually, a bad name will deprive the understanding you need and, in fact, will make it much harder to implement anything else in that context.\nAmongst other things, the book suggests the three-step model. How Developer\u0026rsquo;s Choose Names.\nAvoid bad code and cognitive load First, let\u0026rsquo;s look at the cognitive load part. What does cognitive load mean? It means that you have to spend a lot of brain power / energy on understanding the actual code. Why is that? Is the code way too complex for what it\u0026rsquo;s doing? Is it written badly? Does it smell? Do you not understand the domain? Do you not understand the syntax? There are many things you can do to alleviate some of the pain. The main three are:\nMake sure you completely understand the domain This one is easy to dismiss but is actually hugely important. You have to be absolutely crystal clear that you understand the domain that the code is dealing with. Otherwise, the code will either not make sense, or will be difficult to interpret in it\u0026rsquo;s fullest. By understanding the domain, you\u0026rsquo;ll be able to figure out the code, even more so, you\u0026rsquo;ll be able to reason about the code. And maybe you\u0026rsquo;ll actually find that the code is in fact, wrong. It doesn\u0026rsquo;t actually implement the domain well.\nSimplify the code Sometimes the code is just written in an insane complex way for no apparent reason. Or there is a reason, you just don\u0026rsquo;t see it yet. And that\u0026rsquo;s okay! Start by refactoring the code in a way you understand or making it simpler. I, actually have a story about this.\nThere was a ticket in eksctl I picked up. Refactor the logging to expand nested task logging into a nice structure. Basically come from this:\n[ℹ] 3 sequential tasks: { delete nodegroup \u0026#34;ng-5b8f2f94\u0026#34;, 2 sequential sub-tasks: { 2 sequential sub-tasks: { delete IAM role for serviceaccount \u0026#34;default/s3-reader\u0026#34;, delete serviceaccount \u0026#34;default/s3-reader\u0026#34; }, delete IAM OIDC provider }, delete cluster control plane \u0026#34;irp-test-5-manual\u0026#34; [async] } to something like this:\n[ℹ] 3 sequential tasks: { delete nodegroup \u0026#34;ng-5b8f2f94\u0026#34;, 2 sequential sub-tasks: { 2 sequential sub-tasks: { delete IAM role for serviceaccount \u0026#34;default/s3-reader\u0026#34;, delete serviceaccount \u0026#34;default/s3-reader\u0026#34; } delete IAM OIDC provider } delete cluster control plane \u0026#34;irp-test-5-manual\u0026#34; [async] } Looks easy, right? This was the result: pr. It took me two days! Turns out what parsed the log messages was so convoluted and recursive that it was difficult to unravel. Ultimately, what I did was, I begun re-writing bits of it and simplifying the whole thing, running the code over and over to see what it produced. It was a loose, semi-recursive structure, where you had no idea how deep you are at any given moment; thus you couldn\u0026rsquo;t just indent things based on a counter or a tracker. It was always 1 or 0 deep.\nEven so, I think this will sort of break apart if we ever go 4-5 nested tasks deep\u0026hellip; but that\u0026rsquo;s a story for another day.\nThe lesson here is, that simplifying and re-writing the code made me understand what\u0026rsquo;s going on there a lot better and I was finally able to rewrite it.\nNext, the book talks about how code smells increase the cognitive load many fold. Eliminating code smells will increase the understandability of the code. Code smells have been introduced by Kent Beck and become more known when Martin Fowler wrote about them. A brief description can be found here. The Refactoring book identifies these code smells:\nLong Methods Long Parameter List Switch statements Alternative Classes with different Interfaces Primitive obsession - Avoid the overuse of primitive types in a class Incomplete Library class - Methods should not be added to random classes instead of to a library class. Large Class Lazy Class - doing too little Data Class - just dealing with data Temp fields Data Clumps Divergent Change | Shotgun surgery - change which results in unwanted change in different parts of the code Feature Envy Inappropriate intimacy - classes should not be connected to other classes extensively Duplicate code or code clones Superflouse comments Message Chains - aka. train wrecks Middle man - its only purpose is to delegate to other method calls Refused bequest (inherit unused behavior) Speculative generality - adding code \u0026ldquo;just in case\u0026rdquo; Some of these don\u0026rsquo;t really apply in Go, especially the pieces about classes and inheritance. But some of them do apply and should be looked out for. They can really complicate the code unnecessarily. Further anti-patterns are Structural and Linguistic.\nStructural: Code is okay, but structured in a way that is difficult to understand and process -\u0026gt; increases cognitive load. Linguistic: Bad / misleading names lead to confusion and bugs.\nSolving complex problems First, identify what the problem is. Re-write / re-formulate it in your own words. This will make sure that you understand the problem at hand properly. Then draw the problem out as much as possible and identify the individual constraints which exist. List them and examine them. If the problem is too complex, start removing or adding constraints until it is easier to think about the solution.\nThe book talks about State Space. A state space is all steps we could consider when solving the problem.\nNow, the book says something I would like to quote word for word, because I believe this is profound and should be taken to heart.\nIn 1945, Pólya wrote a short and famous book called How to Solve It. His book proposes a “system of thinking” to solve any problem involving three steps: \u0026gt; 1. Understanding the problem \u0026gt; 2. Devising a plan \u0026gt; 3. Carrying out the plan\nHowever, despite the popularity of generic approaches, research has consistently shown that problem solving is neither a generic skill nor a cognitive process.\nLet me repeat this. However, despite the popularity of generic approaches, research has consistently shown that problem solving is neither a generic skill nor a cognitive process.\nThere is no such thing as learning a base generic method of problem solving and then solve all possible problems. You have to exercise specific problems in order to be better at specific problems. Guess what this means on a broader aspect. Learning to play Chess will not make you smarter. It will make you good at chess. Playing games on Lumosity will not make you smarter. It will make you better at playing games on Lumosity.\nWhat will definitely help you though is the following. \u0026ldquo;Automate\u0026rdquo; mundane algorithms. What this means in practice is that you exercise problems which include things like, tree traversal, graph building, stack based operations, breath first search, depth first search, etc. Practice them until you know these things by heart. The same way you learn to do math. You solve quadratic functions until you know by hearth what the solution is.\nBut you don\u0026rsquo;t stop there!!! You also need to be able to evolve these. Apply them to similar problems and understand how a problem is similar, or break it down until you can make it similar. I\u0026rsquo;d like to think about like when Miyagi thought Daniel son wax on wax off technique and then suddenly, Daniel knew how to do karate. That\u0026rsquo;s a bit of stretch but you get the gist of the idea.\nThe main is that common things like, what is an optimistic or a pessimistic lock, have to be in your long term memory. Continuously Googling and looking at StackOverflow will not make you better at problem solving. That does not mean you shouldn\u0026rsquo;t!!!!!!!! BUT! You should eventually learn from it! And now, let me repeat an important sentence. IT IS OKAY TO LOOK AT SOLUTIONS FROM OTHER PEOPLE!! Like, in art. You first learn by coping things. Things from real world, other artist\u0026rsquo;s work. You study art from other people and drawing from masters. You understand how they did it, and replicate that until you know it by heart. On then do you begin to extend and find your own style.\nAnd so, it\u0026rsquo;s perfectly fine to look at other people\u0026rsquo;s solutions to hard problems AS LONG AS YOU LEARN FROM THEM! Look at the solution. Study it. Understand it. Then write your own! That\u0026rsquo;s how you\u0026rsquo;ll learn.\nThe book goes into a lot of detail about what kind of memory influences these problems. But this, the above thing, was my biggest takeaway from all of that. Basically, automating things in your brain will free up cognitive load when thinking about code and solving problems.\nPart Four - Collaborating on Code Writing code The book first starts off by listing all the different activities when writing code and sums them up into the following sub-sections:\nSearching\nMostly reading and learning the code. Hard on short term memory. Helps to write down where you are, what you are looking for and what did you already found to off-load cognitive load. Leave breadcrumbs, change the code here and there, leave a TODO / anchor.\nComprehension\n58% of our time is spent doing this activity. It\u0026rsquo;s about understanding the code and trying to find out what it does and how. Changing / simplifying the code helps. Draw models and leave notes on structure which can help you continue your task later.\nTranscription\n\u0026ldquo;Just coding\u0026rdquo; where you know what you are going to write where and why.\nIncrementation\nAdding new feature. Is hard on everything\u0026hellip;\nExploration\nThe final activity. Sketching with code. Vague idea but by writing code, your idea solidifies. Jot down your design, will help order your thoughts and free up mental space for other things.\nThen the book continue to talk about interrupts and how they are not really helpful. We already know this\u0026hellip;\nImproving the design of large systems This is an interesting chapter I completely misunderstood but I\u0026rsquo;m glad I got perspective on. It makes you think about your system\u0026rsquo;s design in terms of cognitive load and how hard it would be for other to find their way in it. Basically design your system with humans in mind. Is it easy to follow? Do package names make sense? Does that code have to live there? Your architecture might be awesome, and intricate, but if others can\u0026rsquo;t read it, then it they won\u0026rsquo;t collaborate on it. And if you are working in a team this is especially important. The book calls this CDCB ( cognitive dimension of codebases ).\nCDCB identifies the following dimensions:\nError Proneness This one is mostly about type safety and how easy it is in your code to make errors.\nConsistency How consistent is your code with itself. Naming, structure, where and why things are where they are. Paradigms, idioms being used\u0026hellip;\nDiffuseness How much space a programming construct takes. How long certain required syntaxes are. Things like for loops, and language structures. How compact or extent the code is.\nHidden Dependencies How visible are the code\u0026rsquo;s dependencies. Are there hidden things the user needs but is not apparent and not documented?\nProvisionality Exploring ideas can help when writing code. You start writing and that will give you ideas about how to proceed further. Your vague ideas become more concrete. Some language can be used better to do this because they don\u0026rsquo;t get in your way. Like Python, JavaScript. Go is strictly typed and will scream at you if you make a mistake. That can hinder exploration.\nViscosity How resistant is your code to changes.\nProgressive Evaluation Similar to Provisionality, this dimensions defines how hard it is to execute partial code.\nRole expressiveness How easy it is to see what does what. Like, in Ruby it\u0026rsquo;s difficult to see if something is a function call or a variable. thing.other. Other might be anything. Meanwhile in other languages it\u0026rsquo;s easy to see that thing() is a function.\nCloseness of Mapping How close your program is to the domain / problem that is solved.\nHard Mental Operations The code requires hard mental operations, such as, deciphering obscure syntax, or understanding hard idioms like monads and difficult to follow type systems. If your project requires hard mental operations, contributors are less likely to join it.\nSecondary Notation This one is weird. Second meaning to code, such as comments and named parameters.\nAbstraction Can users of your system create their own abstractions which are as powerful as built in abstractions. For example functions in a programming language. In Go I would say interfaces provide this abstraction since a user of a Library can create their own Interface over some functionality of a library and use that and pass in the libraries function.\nVisibility How easy is it to see parts of the system. Is your folder structure following your architecture layers?\nPlaying around with these and improving one or the other might improve the overall design of your project. But there are trade-offs for everything.\nHow to onboard new developers This chapter is all about the differences between senior and newcomers and ties nicely back into all of the research being done about cognitive load, short term vs long term memory, sensory overload and information overload. It\u0026rsquo;s an interesting read for sure if you do a lot of interviews I definitely encourage reading the whole thing in the book. I\u0026rsquo;m going to summarize what I\u0026rsquo;ve got out of it\u0026hellip;\nDon\u0026rsquo;t overload newcomers. They need to learn a LOT about your environment, group dynamic, team procedures, issue handling, break routines\u0026hellip; and I didn\u0026rsquo;t even begin talking about code yet\u0026hellip;\nOnce you master something you forget how difficult it was. This is a great point we tend to forget. You have a better view of the big picture. You know parts of the code better. Beginners tend to focus on detail more and don\u0026rsquo;t see the big picture yet. You tend to think that that stuff is \u0026ldquo;easy\u0026rdquo;. Since you already forgot how difficult it is/was.\nNoticing patterns. Even if you don\u0026rsquo;t immediately have an answer to a problem you\u0026rsquo;ll be faster in finding it. You can chunk code better, you can read code faster and spot certain patterns more efficiently since you already encountered them a hundred times over.\nSemantic Wave This one is a really interesting concept. It depicts the ideal learning curve of a newcomer. Coin by Karl Maton. Read about it here.\nHas three steps\u0026hellip;\n1: understanding - understand the generic concept\n2: unpacking - this is the low of the curve where the beginner is ready to learn the details about the thing\n3: repacking - get back to the generic concept on their own - meaning understand why the generic concept is useful and results in the concrete detail. This is when the information is actually internalized and ideally, completely remembered.\nFollowing this there are three anti-patterns when not regarding this curve.\n1: high flatline - only using abstract terms\n2: low flatline - too much detail, not enough high level view on the why\n3: funny enough this one doesn\u0026rsquo;t have a fancy name - starts with the abstract, goes to the detail but doesn\u0026rsquo;t allow time for the internalization, the repacking. Let\u0026rsquo;s call this one the rush.\nThe book has some more awesome suggestions and activities to follow with the newcomers, but I can spoil all the fun now can I.\nConclusions This has been it. Thank you for reading. I hope this was as fun to read as it was to write. It was a great journey reading this book and the citations and research that went into it.\nThanks for reading, Gergely.\n","permalink":"https://skarlso.github.io/2021/11/27/summary-of-programmers-brain/","summary":"Prologue Hello all.\nThis is a summary of the book Programmer\u0026rsquo;s Brain. Let me begin by saying the book is fantastic and you should definitely read it. The research put into it is phenomenal, and the many linked notes, data and reference make for an amazing and compelling read!\nNot to mention that it is fantastic that someone put actual effort and data into finding out how programmers operate, think and behave.","title":"Summary of Programmer's Brain"},{"content":"Reader\u0026rsquo;s Digest I thought it would a cool idea if I kept a summary of the things I\u0026rsquo;ve read or listened to on a monthly basis. Here is July of 2021 so far. Enjoy.\nUltimate Go This book is a culmination of Bill Kennedy\u0026rsquo;s Ultimate Go course and notes which were spawned from them by Hoanh An. Bill Kennedy set out to put everything together and create a notebook which can be read and followed like the personal notes of a student.\nIt contains a great many code examples which has been reviewed again and again ( by me too! ) to ensure that there are no bugs in them, and that they adhere to a high standard.\nThe book follows An as he follows the Ultimate Go course and takes notes from them. The course talks about the language intricacies, inner workings of the scheduler, the GC, memory and CPU profiles usage and many, many more things. It also touches up on the now incoming type parameters, aka generics, in Go 1.18. It\u0026rsquo;s a great touch in the book as it will eventually be a standard and better to begin understanding it sooner rather than later.\nThe first chapter sets up the reader\u0026rsquo;s mind frame to the unusual way the book is written ( in first person ). With a lovely and inspiring set of quotes from a great many people big in the tech industry.\nI encourage everyone to have a read of it!\nGo with Domain This book can be obtained by subscribing to ThreeDots\u0026rsquo; newsletter here.\nIt\u0026rsquo;s a lengthy book describing a journey the authors (Milosz Smolka, Robert Laszczak) took in order to improve software and therefor, the World. It\u0026rsquo;s a great journey, but it\u0026rsquo;s mostly about using DDD in a pragmatic way in Go.\nMy feelings about this book are mixed. On one hand, Go doesn\u0026rsquo;t like convoluted patterns, and DDD IS convoluted. On the other hand, patterns are there for a reason. They solve real problems in a generic way which has been already solved before us a hundred thousand times. And Go has patterns, just different ones than other languages. And that\u0026rsquo;s fine. Go promotes simple implementations and simple solutions.\nHowever, there is only so far that you can get with simple. Eventually, you\u0026rsquo;ll be in an enterprise environment working with a 100 other people and will try to put something together using poor communications, that\u0026rsquo;s bound to fail. DDD at least offers the ubiquitous language which provides common language across everyone who uses the product. That\u0026rsquo;s definitely a benefit. And Event storming is a good idea IMHO.\nI offer this. It\u0026rsquo;s a good read. It\u0026rsquo;s incomplete as of this writing, missing the last few chapters. Everyone who reads it should decide for themselves if the patterns offered make sense. But for sure, it should not be dismissed too hastily.\nThe authors are aware of the Go communities apprehension against bloated patterns and offer pragmatic solutions in many cases. I really like that. It\u0026rsquo;s not a 1:1 copy try of DDD, it\u0026rsquo;s a clever try in adapting it and molding it to Go.\nTexas Reckoners - Lux This one is again from Brandon Sanderson. I listened to it via an AudioBook. It was quiet enjoyable! I already listened to all three of the Steelheart Reckoners and it was awesome to hear some references to that. The end ties the timeline together, Calamity disappears from the sky, and it\u0026rsquo;s left open with a massive Cliff Hanger. I\u0026rsquo;m looking forward to listening to #2.\nThe story follows a group of Texas reckoners which is another cell that Prof created. A fresh recruit call Jax is taken into the care of this group and molded into a formidable Epic assassin. His brother is killed by an Epic call Lovestruck in the early days and his whole family died when in Steelheart the bomber Epic destroyed a city.\nHe is set out for revenge to take down Lux, a floating city governed by an Epic called Lifeforce. He has the ability to make anyone immortal. The floating city plunders around Texas, so the Reckoners set out to destroy it!\nConclusion That\u0026rsquo;s it for these months. Next month I\u0026rsquo;m planning on finishing two Go related books hopefully and will write some reviews about those.\nAnd as always, Thanks for reading, Gergely.\n","permalink":"https://skarlso.github.io/2021/07/31/readers-digest/","summary":"Reader\u0026rsquo;s Digest I thought it would a cool idea if I kept a summary of the things I\u0026rsquo;ve read or listened to on a monthly basis. Here is July of 2021 so far. Enjoy.\nUltimate Go This book is a culmination of Bill Kennedy\u0026rsquo;s Ultimate Go course and notes which were spawned from them by Hoanh An. Bill Kennedy set out to put everything together and create a notebook which can be read and followed like the personal notes of a student.","title":"Reader's Digest 2021-07"},{"content":"Reader\u0026rsquo;s Digest I thought it would a cool idea if I kept a summary of the things I\u0026rsquo;ve read or listened to on a monthly basis. Here is June of 2021 so far. Enjoy.\nHell Divers 6: Allegiance I love the Hell Divers series. I listened to this one on audible as always and it was fantastic, as always. King Xavier Rodriguez. That sounds as bad ass as it is. We follow King Xavier and Rhino, his trusted subordinate into battle with a new threat called Skin Walkers and of course the machines, the defectors which are trying to kill everyone. Also, there is now a signal from a possible group of people who are surviving on the surface for more than 200 years! Xavier hates being king but does anything to keep the peace and humanity alive. Sadly, not all of his people agree to that especially not after what they did to their people. The people of the metal island, the cannibals are harsh people. And they don\u0026rsquo;t get along nicely all the time.\nGo Typed Parameters Proposal The proposal can be found here and it\u0026rsquo;s quite lengthy.\nThe first example speaks worlds:\n// Print prints the elements of a slice. // It should be possible to call this with any slice value. func Print(s []T) { // Just an example, not the suggested syntax. for _, v := range s { fmt.Println(v) } } It is actually exciting that generics is coming to Go. And it\u0026rsquo;s even in my life time. The introduction of generics back in the old days to Java brought a lot of confusion into the land of Java but more importantly, it brought in the eagerness of using generics for EVERYTHING. I\u0026rsquo;m really hoping that this proposal will not affect the land of Go. But unfortunately, it probably will. It is up to us to take care and apply generics WHEN IT\u0026rsquo;S REALLY NECESSARY AND ONLY THEN!\nEven so, the proposal is really solid and has some pretty nice scenarios. And there is this issue: Add generic slice package to Go. Which talks about what the title says. It has some really amazing feedback already and a gazillion view and an \u0026ldquo;approve\u0026rdquo; from Rob Pike! Comment. Which just means he didn\u0026rsquo;t vehemently object. This is really happening. Which is insane and exciting at the same time!\nHorizon Zero Dawn This isn\u0026rsquo;t a book, but a game on PS4 which I spent most of my time instead of reading. I do not regret it, because the story is absolutely beautiful. When I play, I play for reading. Meaning I read every lore and listen to every story I encounter and start looking for them as well. Now, let\u0026rsquo;s step back, what is Horizon Zero Dawn?\nIf you\u0026rsquo;ve been living under a rock these past years, or are just not into games that much let me break it down for you. The year is\u0026hellip;. X. We have no idea but it\u0026rsquo;s somewhere around the 31st century. It\u0026rsquo;s been several decades after some kind of apocalypse ( what kind, we find out as we progress with the story ) which left the world in ruins. Small tribes of humanity survived and segregated into the Nora, Oseram, Banuk and Carja mostly. The ones we know about that is. Our protagonist is a Nora girl called Aloy.\nBut there is an interesting twist\u0026hellip; Instead of mostly animals, we have giant Robots, which are animals / perform the tasks animals perform. Like, hunting, scavenging, eating plant life, swimming in the waters\u0026hellip; Etc.\nAnd these people, hunt these machines. Usually, these machines are docile, but with time, they got more and more aggressive and more and more machines came around which were always aggressive and effectively started to hunt people.\nSPOILER WARNING: Now, our girl grows up as an outcast, because she actually came into the world, not from a mother but from the belly of a mountain called Mother\u0026rsquo;s Heart. Mother\u0026rsquo;s Heart is actually an ancient facility sealed shut, with a biometric security system which they call All Mother. The story is REALLY long, but eventually, we find out the following\u0026hellip;\nA guy called Faro creates a company called Faro Automated Solutions which creates a bunch of semi-sentient machines which are used as \u0026ldquo;peacekeeping\u0026rdquo; devices. They can self replicate and they \u0026ldquo;eat biomass\u0026rdquo; to sustain themselves indefinitely. And of course, as these things are, there is a glitch and they become something called a Swarm which devourers everything in their path. Until Dr. Elisabeth Sobeck comes along and saves the day with Project Zero Dawn.\nAnd here comes the twist. Sobeck knows that the planet is doomed. There is a cryptographic thing where they need hundreds of years to crack the machines encryption and shut them down. But humanity and anything that\u0026rsquo;s a biomass doesn\u0026rsquo;t have that long. So she proposes to create Gaia. Which is a powerful AI that has various subroutine helpers called Hades, Apollo and others. They contain the digitized version of everything living and after humanity and everything is gone, Gaia will crack the code eventually in an underground shelter and repopulate the Earth with life. And that\u0026rsquo;s where the robot animals come in, they are basically terraforming. Making life possible.\nBut as these things go, something went wrong and Apollo, which contained all knowledge on Earth, has been destroyed and the people reborn had no idea what\u0026rsquo;s going on, where they are and how they are alive. The initial people were created in tubes from zygotes.\nAnd here comes Aloy. So Gaia had a subroutine called Hades, to destroy everything if terraforming failed or there was a catastrophic event and the world needs resetting. Gaia can\u0026rsquo;t do that because she is a fully featured, feeling, sentient AI who is incapable of destruction and Hades is the opposite. It can take over, destroy, then give back control to Gaia. Of course, Hades was corrupted and didn\u0026rsquo;t want to give back control and started killing everything. Gaia created Aloy who is a clone of Elisabeth Sobeck so she could access facilities with biometric scanners all over the place and find out the truth about the world and fix Gaia and delete Hades.\nIt\u0026rsquo;s quite the story! Incredibly well written with likable characters all along the way. It was well worth the time spent on it, even if I didn\u0026rsquo;t catch up on some reading. I regret nothing.\nConclusion That\u0026rsquo;s it for these months. Next month I\u0026rsquo;m planning on finishing two Go related books hopefully and will write some reviews about those.\nAnd as always, Thanks for reading, Gergely.\n","permalink":"https://skarlso.github.io/2021/06/30/readers-digest/","summary":"Reader\u0026rsquo;s Digest I thought it would a cool idea if I kept a summary of the things I\u0026rsquo;ve read or listened to on a monthly basis. Here is June of 2021 so far. Enjoy.\nHell Divers 6: Allegiance I love the Hell Divers series. I listened to this one on audible as always and it was fantastic, as always. King Xavier Rodriguez. That sounds as bad ass as it is. We follow King Xavier and Rhino, his trusted subordinate into battle with a new threat called Skin Walkers and of course the machines, the defectors which are trying to kill everyone.","title":"Reader's Digest 2021-06"},{"content":"Blog Refactor Finally, I went back and fixed a lot of old posts and old code entries. I tried to fix and repair links and images, but some are lost forever on some obscure WordPress blog which I used to use.\nI\u0026rsquo;m glad though that the code is intact and I could re-read a lot of my old stuff. It\u0026rsquo;s interesting to see how much I evolved, how much my writing evolved. I used to write a lot of groovy and python and java and bash and ruby.\nI\u0026rsquo;ve been writing this blog for a long time now and I would like to write even more! For example, I\u0026rsquo;m planning on a new series called, Things for People in a hurry, where I\u0026rsquo;ll explain concepts and technologies in as less detail as possible, but still relevant and understandable. For people who just want to be in loop, but don\u0026rsquo;t care / have time for an in-depth read ATM.\nHopefully I learn a lot of things while writing those sections and I hope that people will enjoy them and give me stuff they are interested about but don\u0026rsquo;t have time to look up.\nI\u0026rsquo;m interested in all technology and concepts, such as Quantum computing too!\nIn any case, Thanks for staying with me all these years, and here\u0026rsquo;s to much much more!\nGergely.\n","permalink":"https://skarlso.github.io/2021/05/25/blog-refactor/","summary":"Blog Refactor Finally, I went back and fixed a lot of old posts and old code entries. I tried to fix and repair links and images, but some are lost forever on some obscure WordPress blog which I used to use.\nI\u0026rsquo;m glad though that the code is intact and I could re-read a lot of my old stuff. It\u0026rsquo;s interesting to see how much I evolved, how much my writing evolved.","title":"Blog refactor"},{"content":"Reader\u0026rsquo;s Digest I thought it would a cool idea if I kept a summary of the things I\u0026rsquo;ve read or listened to on a monthly basis. Here is April of 2021 so far. Enjoy.\nInvincible After seeing it air on Amazon Prime, I had to go and read the comic. It\u0026rsquo;s quite a lot, but I assure you it\u0026rsquo;s worth it. Some spoiler alerts\u0026hellip;\nOkay, so we follow this guy, Mark Grayson. He\u0026rsquo;s Invincible. He is also and alien, called a Viltrumite. I can hardly summaries over 3000 pages of comic books so I\u0026rsquo;ll try to be brief.\nThe Viltrumites are a race of warrior people who wants to conquer the whole galaxy. They also have the power to do so. They are virtually immortal, live for thousands of years and are very durable. They can fly, have super strength and a bunch of other things. The stories are insane. We follow all kinds of people across multiverses, a lot of villains and heroes. There is gore, sex, violance and immature jokes all around. It\u0026rsquo;s fantastic.\nThere are better episodes and there are boring episodes as it goes with these things. The one thing that bothered me a lot is that the Viltrumites, of course, have a weak spot. You have to remember that these are people who want to be eliminated by a lot of other people in the whole galaxy. There is a literal coalition of planets who want to kill them.\nAnd there are two main things which can kill / incapacitate them. The first one is a virus, which was developed by a traiter Viltrumite which killed like 99.9% of them. And the other is the same weakness as the things have in the movie called The quiet place. It\u0026rsquo;s specific frequency sound. Granted, some very specific frequency, but it\u0026rsquo;s sound. Because Viltrumites have a delicate equilibrium because of their flying ability, if there is a specific frequency sound being emitted in close proximity it can incapacitate or even kill a Viltrumite.\nWhich makes me wonder that for thousands of years in multiple, parallel universes and with thousands of alien races, nobody even thought of doing that? It had to be Earth and Humans ( and a Dinosaur ) who came up with it? That\u0026rsquo;s just implausible really. And after being used only a couple of times, they don\u0026rsquo;t use it again on a global scale!\nAnyways. The story is still incredible and it has a lot of amazing content so I encourage comic lovers to read it all!\nConclusion That\u0026rsquo;s it for this month. Some lengthy blog posts and Invincible pretty much took up my reading time.\nAnd as always, Thanks for reading, Gergely.\n","permalink":"https://skarlso.github.io/2021/04/21/readers-digest/","summary":"Reader\u0026rsquo;s Digest I thought it would a cool idea if I kept a summary of the things I\u0026rsquo;ve read or listened to on a monthly basis. Here is April of 2021 so far. Enjoy.\nInvincible After seeing it air on Amazon Prime, I had to go and read the comic. It\u0026rsquo;s quite a lot, but I assure you it\u0026rsquo;s worth it. Some spoiler alerts\u0026hellip;\nOkay, so we follow this guy, Mark Grayson.","title":"Reader's Digest 2021-04"},{"content":"Reader\u0026rsquo;s Digest I thought it would a cool idea if I kept a summary of the things I\u0026rsquo;ve read or listened to on a monthly basis. Here is March of 2021 so far. Enjoy.\nThe Aurora Database paper The paper about Aurora database from AWS can be found here: Paper. It details the design decision taken to support a highly available, fault tolerant, fast replicating database. They take the following approach\u0026hellip; They modified mysql database such as that they only send around the redo log and the redo log is enough to recover / replicate in order to achieve write and read consistency. They separate the data into Protected Groups and speed up terabytes of recovery by doing 10 Gigabyte segments in parallel. The database IS the logs. By only replicating the log instead of the data and the data page, they save millions in networks costs. The main gain however, is that the storage was modified to understand the application. Instead of using General store they use a storage which understand the data. In this case, decoupling storage from the database, as so many do, was actually a drawback.\nGCatch paper This paper is a static concurrency bug analyser for Go found here Paper.\nIt\u0026rsquo;s ingenious! It\u0026rsquo;s a static analyser which finds mostly blocking bugs using channels in Go. In Go, it\u0026rsquo;s really easy to write concurrent software using something called Channels. They are basically coroutines multiplexed onto kernel threads and thus you can have a million of them running around doing stuff. Go effectively made IO operators CPU bound with them. Coroutines aren\u0026rsquo;t new, however, it\u0026rsquo;s really easy to mess up code with channels in subtle ways. Analyzers exist, however, GCatch argues that they can\u0026rsquo;t find the most subtle of bugs, only some surface bugs really.\nThis paper proposes a tool which does inter-procedural, path-sensitive analysis and uses Z3 to find paths which can lead to deadlocks in code that uses locking primitives and channels. It also contains five other prominent tools. It converts mutexes into channels internally with buffer size zero and sends on it on Lock and reads from it on Unlock, then performs a bunch of path combinations and goes through those suspicious paths and performs its analysis.\nThey found a hundred and something bugs in Docker and Kubernetes. Things like, sending on a channel in select when in fact, a timeout already returned, thus that Go routine is not indefinitely stuck. Since it can\u0026rsquo;t send its output on the channel, the program didn\u0026rsquo;t quit so it\u0026rsquo;s not GC-d. A simple fix is to make the channel of size 1 so even if there is a chance that the scope quit it can still send and quit. Like Exec.\nIt\u0026rsquo;s an interesting read and the tool is awesome, however\u0026hellip;. It was written with Go 14 and it\u0026rsquo;s proving to be difficult to port to current version using modules. I would hate to see this tool getting left behind because it can\u0026rsquo;t be turned into a linter.\nRhythm of War - Brandon Sanderson Amazon.\nAn epic continuation of this saga with over a 1000 pages long and 54 hours of listening time on Audible. This story has been ongoing for a while now. Brandon Sanderson came out with the first book back in 2010. This is the continuation of the Stormlight Archive series. These are massive master pieces. I first came along Brandon Sanderson when I read the Mistborn series. That was another epic novel. I love reading Sanderson because he comes up with some unique ways of magic or magic like abilities which have some divine sense in the end, or have some interesting explanation. And their abilities are almost always used in interesting ways.\nFor example, a simple ability to pull or push metal. Turns out that results in things like, shooting coins, or literally flying as the person tosses a coin to the ground and pushes on it, pushing themselves upwards in the end.\nI could write many many pages about each and every fantastic novel, but I\u0026rsquo;m going to stick to this one expecting that people know about the series.\nI\u0026rsquo;ve listened to this one as I\u0026rsquo;m insane busy, I couldn\u0026rsquo;t have read a 1000 something pages book. The fantastic work of Micheal Kramer and Kate Reading is always a treat to listen too. They are both excellent readers always making the characters live through their words.\nSPOILERS:\nThis time we mostly follow Eshonai\u0026rsquo;s and Venli\u0026rsquo;s but we finally also get what we wanted all these years. Finally, Kaladin and Shallan face their inner demons. And even though they aren\u0026rsquo;t fully okay, Kaladin speaks his fourth oat and Shallan remembers her past. As much as I love this story, I don\u0026rsquo;t believe I would have been able to listen or read another 1000 pages without these two resolving their problems. You root for them so hard, it\u0026rsquo;s exhausting.\nI won\u0026rsquo;t spoil everything but the twist at the end left me dumbstruck! It was such an amazing finish.\nThe story follows the fused as they invade Urithiru. There is a side story for Navani and Jasna doing their own thing and we do root for Navani and her fantastic discoveries regarding light and powers, but Jasna is a side character in this story. Another main character is Witt. We finally get to know who he is and where he comes from. We also understand now that the Fused are actually from another planet in the same system and Odium just wants to get off this system and fight a holy war with some ancient Gods somewhere. A lot of things which made no sense are revealed finally. I recommend it if you have the time to listen or read it.\nHow to take smart notes Amazon.\nThis one\u0026rsquo;s review will be condensed because it would be rather lengthy otherwise. It\u0026rsquo;s basically talking about how to use the Zettelkasten system. But it does so much more then that. It challenges the way you think, the way you learn the way things are taught in school and the way you process and store information. Condensed I would say these are the main points:\nConnect new information to existing information. Information without connection isn\u0026rsquo;t worth much and will be remembered poorly or not at all. Always read with a pen in your hand and take notes about what you are reading. Always use your own words and never just copy blindly; by doing this, you will better understand what you just read. The same goes to things like, writing a blog in which you explain something you think you know. It reveals the black holes in your knowledge which you didn\u0026rsquo;t even know exist. Don\u0026rsquo;t try to group based on topics. That will result in forced connections and will leave you confined within that topic. Topics should emerge from your notes and then gathered into indexes which contain links to related notes and information. Tags are useful but don\u0026rsquo;t over do them. If you have a 1000 tags your information will be lost and hard to find because things that are unrelated will show up in the searches. So go easy on the tags Note taking is a chore. It\u0026rsquo;s not something that you just do and it just works. Good note taking requires effort. You take notes while you read then transcribe them into Zettelkasten and throw away the rest. Those are transient notes. Zettelkasten notes focus on the gist of things. On the meat! Conclusion And that\u0026rsquo;s all for this months. Rhythm of War, the papers and the note taking book pretty much took all my time away, so not much else got done since January. But I still think this is a nice finish. Especially considering Rhythm of War was such a huge epic.\nAnd as always, Thanks for reading, Gergely.\n","permalink":"https://skarlso.github.io/2021/03/23/readers-digest/","summary":"Reader\u0026rsquo;s Digest I thought it would a cool idea if I kept a summary of the things I\u0026rsquo;ve read or listened to on a monthly basis. Here is March of 2021 so far. Enjoy.\nThe Aurora Database paper The paper about Aurora database from AWS can be found here: Paper. It details the design decision taken to support a highly available, fault tolerant, fast replicating database. They take the following approach\u0026hellip; They modified mysql database such as that they only send around the redo log and the redo log is enough to recover / replicate in order to achieve write and read consistency.","title":"Reader's Digest 2021-03"},{"content":"Reader\u0026rsquo;s Digest I thought it would a cool idea if I kept a summary of the things I\u0026rsquo;ve read or listened to on a monthly basis. Here is January of 2021 so far. Enjoy.\nAll systems red - Murderbot This book is SHORT. It\u0026rsquo;s little over 3 hours of listening time. I\u0026rsquo;m listening at 1.30 so it\u0026rsquo;s just short of 2 hours. But it\u0026rsquo;s entertaining. The murderbot series is following a rouge security bot which hacked its own governor module and is self aware and free. But\u0026hellip; it kind of hates humans and interacting with them. It just calls itself murderbot but has no intention of killing all humans. Instead, all its wants to do is basically\u0026hellip; watch movies and various series on something called a Feed. In the first book of the series, this one, we follow Murderbot protect a few humans that it gets to short of like after an attempt on their lives.\nThe narrator, Kevin R. Free, is doing a great job of impersonating the robot and you can feel the anxiety from his words when inevitably, the robot has to interact with humans. Whether it likes it or not\u0026hellip;\nArtificial Condition - Murderbot Another short story following our Murderbot. This time, it wants to get to the bottom of a mystery involving its past. In his past, the Murderbot, when it hacked its governor module, it went berserk and killed 80 people in the process. The company who owned it, covered it all up. Or so it thought. During its journey to find out what happened it met a new friend, Art. Art is a huge vessel capable of massive computing capacity, and happens to also love watching series. They team up and help a rag-tag group of researchers while trying to find out what happened to Murderbot and those 80 people.\nRogue Protocol Another fantastic episode of Murderbot. You can sense that the bot is slowly evolving into a more caring bot. Even though it\u0026rsquo;s saying repeatedly that it doesn\u0026rsquo;t case, it starts to care. This book was an action packed one. Lot\u0026rsquo;s of tension and fear inducing moments. Silence then all out war! We also meet Micky, who is a \u0026ldquo;pet bot\u0026rdquo; for some humans. Their relationship starts off as rocky but after a while, Murderbot comes to appreciate Micky for another free soul. There are some open question in there once the story finishes.\nThe vexed generation - Magician 2.0 Being a programmer, I followed Magician 2.0 with an interest. I listen to all of the books in the series. It was fun at first, but then started to get a bit low in quality and repetitive. I don\u0026rsquo;t really care about the people in it, and I don\u0026rsquo;t really care about what\u0026rsquo;s happening to them. And since they are effectively immortal there is no real danger to them at all. In this episode however, there was real danger at the end. And while the protagonist kids were kind of annoying, and it could have been narrated better and I felt like some of the characters weren\u0026rsquo;t fully utilized, the story kind of still was fun to read. Definitely better than the previous one about dragons.\nHeaven\u0026rsquo;s River - Bobiverse The latest addition to the Bobiverse universe. This time there is civil war amongst the Bobs and, of course, there is a new species to explore. The species was interesting, and the talk about mega-structures was also interesting, but I found that the lack of coding, and fighting and technical stuff ( what caught me on the first couple of Bob adventures ) left me wanting for more and left me with an empty feeling at the end. I really missed the proves of Bob and couldn\u0026rsquo;t care less about Starfleet.\nArmada This one was interesting. It talks about the same premise as The Last Starfighter ( there is a reference to that in there ) which I found fascinating as a child. It is about the fact that an alien race uses video games to find the best soldier for a mission to save the universe. This time though the Earth is doing the recruiting and it is against an alien invasion. And much like Ender\u0026rsquo;s Game, it turns out that the threat is real and that all fighting on the video game that our protagonist did was preparing him for this situation. The twist was pretty good too.\nPrometheus Up And Running This one has a larger post incoming.\nThat\u0026rsquo;s all for this month. Thanks for reading, Gergely.\n","permalink":"https://skarlso.github.io/2021/02/01/readers-digest/","summary":"Reader\u0026rsquo;s Digest I thought it would a cool idea if I kept a summary of the things I\u0026rsquo;ve read or listened to on a monthly basis. Here is January of 2021 so far. Enjoy.\nAll systems red - Murderbot This book is SHORT. It\u0026rsquo;s little over 3 hours of listening time. I\u0026rsquo;m listening at 1.30 so it\u0026rsquo;s just short of 2 hours. But it\u0026rsquo;s entertaining. The murderbot series is following a rouge security bot which hacked its own governor module and is self aware and free.","title":"Reader's Digest 2021-01"},{"content":"Intro Welcome. This is a longer post about how to deploy a Go backend with a React frontend on Kubernetes as separate entities. Instead of the usual compiled together single binary Go application, we are going to separate the two. Why? Because usually a React frontend is just a \u0026ldquo;static\u0026rdquo; SPA app with very little requirements in terms of resources, while the Go backend does most of the leg work, requiring a lot more resources.\nPart two of this will contain scaling, utilization configuration, health probes, readiness probes, and how to make sure our application can run multiple instances without stepping on each other\u0026rsquo;s toes.\nNote: This isn\u0026rsquo;t going to be a Kubernetes guide. Some knowledge is assumed.\nSummary This post details a complex setup of an infrastructure with a second part coming on scaling and how to make your application scalable in the first place by doing idempotent transactions or dealing with locking and several instances of the same application not stepping on each other\u0026rsquo;s foot.\nThis, part one, details how to deploy traditional REST + Frontend based application in Go + React, but not bundled together as a single binary, instead having the backend separate from the frontend. They key in doing so is explained at the Ingress section when talking about routing specific URIs to the backend and frontend services.\nIf you are familiar with Kubernetes and infrastructure setup, feel free to skip ahead to that section. Otherwise, enjoy the drawings or the writing or both.\nTechnology The SPA app will be handled by Serve while the Go backend will use Echo. The database will be Postgres.\nWe are going to apply some best practices using Network Policies to cordon off traffic that we don\u0026rsquo;t want to go outside.\nWe will set up HTTPS using cert-manager and let\u0026rsquo;s encrypt. We\u0026rsquo;ll be using nginx as ingress provider.\nCode All, or most of the code, including the application can be found here:\nStaple. The application is a simple reading list manager with user handling, email sending and lots of database access.\nLet\u0026rsquo;s get to it then!\nKubernetes Provider Let\u0026rsquo;s start with the obvious one. Where do you would like to create your Kubernetes cluster?\nThere are four major providers now-a-days. AWS EKS, GCP GKE, Azure AKS and DigitalOcean DKE. Personally, I prefer DO because, it\u0026rsquo;s a lot cheaper than the others. The downside is that DO only provides ReadWriteOnce persistent volumes. This gets to be a problem when we are trying to update and the new Pod can\u0026rsquo;t mount the volume because it\u0026rsquo;s already taken by the existing one. This can be solved by a good ol NFS instance. But that\u0026rsquo;s another story.\nAWS\u0026rsquo; was late to the party and their solution is quite fragile and the API is terrible. GCP is best in terms of technicalities, api, handling, and updates. Azure is surprisingly good, however, the documentation is most of the times out of date or even plain incorrect at some places.\nSetup Basics To setup your Kubernetes instance, follow DigitalOcean\u0026rsquo;s Kubernetes Getting Started guide. It\u0026rsquo;s really simple. When you have access to the cluster via kubectl I highly recommend using this tool: k9s.\nIt\u0026rsquo;s a flexible and quite handy tool for quick observations, logs, shells to pods, edits and generally following what\u0026rsquo;s happening to your cluster.\nNow that we are all set with our own little cluster, it\u0026rsquo;s time to have some people move in. First, we are going to install cert-manager.\nNote: I\u0026rsquo;m not going to use Helm because I think it\u0026rsquo;s unnecessary in this setting. We aren\u0026rsquo;t going to install these things in a highly configurable way and updating with helm is a pain in the butt. For example, for cert-manager the update with helm takes several steps, whilst updating with a plain yaml file is just applying the next version of the yaml file.\nI\u0026rsquo;m not going to explain how to install cert-manager or nginx. I\u0026rsquo;ll link to their respective guides because frankly, they are simple to follow and work out of the box.\nTo install nginx, simply apply the yaml file located here: DigitalOcean Nginx.\nTo install cert-manager follow this guide: cert-manager. Follow the regular manifest install part, then ignore the Helm part and proceed with verification and then install your issuer. I used a simple ACME/http01 issuer from here: acme/http01\nNote: That acme configuration contains the staging url. This is to test that things are working. Once you are sure that everything is wired up correctly, switch that url to this one: https://acme-v02.api.letsencrypt.org/directory -\u0026gt; prod url. For example:\napiVersion: cert-manager.io/v1alpha2 kind: ClusterIssuer metadata: name: letsencrypt-prod spec: acme: # The ACME server URL server: https://acme-v02.api.letsencrypt.org/directory # Email address used for ACME registration email: your@email.com # Name of a secret used to store the ACME account private key privateKeySecretRef: name: letsencrypt-prod # Enable the HTTP-01 challenge provider solvers: - http01: ingress: class: nginx Note: I\u0026rsquo;m using a ClusterIssuer because I have multiple domains and multiple namespaces.\nThat\u0026rsquo;s it. Cert-manager and nginx should be up and running. Later on, we will create our own ingress rules.\nDomain Next, you\u0026rsquo;ll need a domain to bind too. There are a gazillion domain providers out there like no-ip, GoDaddy, HostGator, Shopify and so on. Choose one which is available to you or has the best prices.\nThere are some good guides on how to choose a domain and where to create it. For example: 5 things to watch out for when buying a domain.\nThe application Alright, let\u0026rsquo;s put together the application.\nStructure Every piece of our infrastructure will be laid out in yaml files. I believe in infrastructure as code. If you run a command you will most likely forget about it, unless it\u0026rsquo;s logged and / or is replayable.\nThis is the structure I\u0026rsquo;m using:\n. ├── LICENSE ├── README.md ├── certificate_request │ └── certificate_request.yml ├── configmaps │ └── staple_initdb_script.yaml ├── database │ ├── staple_db_deployment.yaml │ ├── staple_db_network_policy.yaml │ ├── staple_db_pvc.yaml │ └── staple_db_service.yaml ├── namespace │ └── staple_namespace.yaml ├── primer.sql ├── rbac ├── secrets │ ├── staple_db_password.yaml │ └── staple_mg_creds.yaml ├── staple-backend │ ├── staple_deployment.yaml │ └── staple_service.yaml └── staple-frontend ├── staple_deployment.yaml └── staple_service.yaml One other possible combination is, if you have multiple applications:\n. ├── README.md ├── applications │ ├── confluence │ │ ├── db │ │ │ ├── db_deployment.yaml │ │ │ └── db_service.yaml │ │ ├── deployment │ │ │ └── deployment.yaml │ │ ├── pvc │ │ │ └── confluence_app_pvc.yaml │ │ └── service │ │ └── service.yaml │ ├── gitea │ │ ├── config │ │ │ ├── app.ini │ │ │ └── gitea_config_map.yaml │ │ ├── db │ │ │ ├── gitea_db_deployment.yaml │ │ │ ├── gitea_db_network_policy.yaml │ │ │ ├── gitea_db_pvc.yaml │ │ │ └── gitea_db_service.yaml │ │ ├── deployment │ │ │ └── gitea_deployment.yaml │ │ ├── pvc │ │ │ └── gitea_app_pvc.yaml │ │ └── service │ │ └── gitea_service.yaml ├── cronjobs │ ├── cronjob1 │ │ ├── Dockerfile │ │ ├── README.md │ │ ├── go.mod │ │ ├── go.sum │ │ ├── cron.yaml │ │ └── main.go ├── ingress │ ├── example1 │ │ ├── example1_ingress_resource.yaml │ │ └── gitea_ssh_configmap.yaml │ ├── example2 │ │ └── example2_ingress_resource.yaml │ ├── lets-encrypt-issuer.yaml │ └── nginx │ ├── nginx-ingress-controller-deployment.yaml │ └── nginx-ingress-controller-service.yaml └── namespaces ├── example1_namespace.yaml ├── example2_namespace.yaml Namespace Before we begin, we\u0026rsquo;ll create a namespace for our application to properly partition all our entities.\nTo create a namespace we\u0026rsquo;ll use this yaml example_namespace.yaml:\napiVersion: v1 kind: Namespace metadata: name: example Apply this with kubectl -f apply example_namespace.yaml.\nThe Database Deploying a Postgres database on Kubernetes is actually really easy. You need five things to have a basic, but relatively secure installation.\nSecret The secret contains our password and our database user. In postgres, if you define a user using POSTGRES_USER postgres will create the user and a database with the user\u0026rsquo;s name. This could come from Vault too, but the Kubernetes secret is usually enough since it should be a closed environment anyways. But for important information I would definitely use an admission policy and some vault secret goodness. (Maybe another post?)\nOur secret looks like this: database_secret.yaml\napiVersion: v1 kind: Secret metadata: name: staple-db-password namespace: staple data: POSTGRES_PASSWORD: cGFzc3dvcmQxMjM= # This creates a user and a db with the same name. POSTGRES_USER: c3RhcGxl To generate the base64 code for a password and a user, use:\necho -n \u0026#34;password123\u0026#34; | base64 echo -n \u0026#34;username\u0026#34; | base64 \u0026hellip;and paste the result in the respective fields. Once done, apply with kubectl -f apply database_secret.yaml.\nDeployment The deployment which configures our database. Looks something like this (database_deployment.yaml):\napiVersion: apps/v1 kind: Deployment metadata: namespace: staple name: staple-db spec: replicas: 1 selector: matchLabels: app: staple-db template: metadata: name: staple-db labels: app: staple-db spec: containers: - name: postgres image: postgres:11 env: - name: POSTGRES_USER value: staple - name: POSTGRES_PASSWORD valueFrom: secretKeyRef: name: staple-db-password key: POSTGRES_PASSWORD volumeMounts: - mountPath: /var/lib/postgresql/data subPath: data # important so it gets mounted correctly name: staple-db-data - mountPath: /docker-entrypoint-initdb.d/staple_initdb.sql subPath: staple_initdb.sql name: bootstrap-script volumes: - name: staple-db-data persistentVolumeClaim: claimName: do-storage-staple-db - name: bootstrap-script configMap: name: staple-initdb-script Note the two volume mounts.\nThe first one makes sure that our data isn\u0026rsquo;t lost when the database pod itself restarts. It creates a mount to a persistent volume which is defined a few lines below by persistentVolumeClaim. subPath is important in this case otherwise you\u0026rsquo;ll end up with a lost\u0026amp;found folder.\nThe second mount is a postgres specific initialization file. Postgres will run that sql file when it starts up. I\u0026rsquo;m using it to create my application\u0026rsquo;s schema.\ncreate database staples; create table users (email varchar(255), password text, confirm_code text, max_staples int); create table staples (name varchar(255), id serial, content text, created_at timestamp, archived bool, user_email varchar(255)); And it comes from a configmap which looks like this:\napiVersion: v1 kind: ConfigMap metadata: name: staple-initdb-script namespace: staple labels: app: staple data: staple_initdb.sql: create table users (email varchar(255), password text, confirm_code text, max_staples int); create table staples (name varchar(255), id serial, content text, created_at timestamp, archived bool, user_email varchar(255)); Network Policy Network policies are important if you value your privacy. They restrict a PODs communication to a certain namespace OR even to between applications only. By default I like to deny all traffic and then slowly open the valve until everything works.\nKudos if you know who this is. (mind my terrible drawing capabilities)\nWe\u0026rsquo;ll use a basic network policy which will restrict the DB to talk to anything BUT the backend. Nothing else will be able to talk to this Pod.\napiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: staple-db-network-policy namespace: staple spec: podSelector: matchLabels: app: staple-db policyTypes: - Ingress - Egress ingress: - from: - podSelector: matchLabels: app: staple ports: - protocol: TCP port: 5432 egress: - to: - podSelector: matchLabels: app: staple ports: - protocol: TCP port: 5432 The important bit here is the podSelector part. The label will be the label used by the application deployment. This will restrict the Pod\u0026rsquo;s incoming and outgoing traffic to that of the application Pod including denying internet traffic.\nPVC The persistent volume claim definition is straight forward:\napiVersion: v1 kind: PersistentVolumeClaim metadata: namespace: staple name: do-storage-staple-db spec: accessModes: - ReadWriteOnce resources: requests: storage: 10Gi storageClassName: do-block-storage 10 gigs should be enough anything.\nService The service will expose the database deployment to our cluster.\nOur service is fairly basic:\nkind: Service apiVersion: v1 metadata: namespace: staple name: staple-db-service spec: ports: - port: 5432 selector: app: staple-db clusterIP: None That\u0026rsquo;s done with the database. Next up is the backend.\nThe backend The backend itself is written in a way that it doesn\u0026rsquo;t require a persistent storage so we can skip that part. It only needs three pieces. A secret, a deployment definition and the service exposing the deployment.\nSecret First, we create a secret which contains Mailgun credentials.\napiVersion: v1 kind: Secret metadata: name: staple-mg-creds namespace: staple data: MG_DOMAIN: cGFzc3dvcmQxMjM= MG_API_KEY: cGFzc3dvcmQxMjM= Database connection The connection settings are handled through the same secret which is used to spin up the DB itself. We have to only mount that here too and we are good.\nDeployment Which brings us to the deployment. This is a bit more involved.\napiVersion: apps/v1 kind: Deployment metadata: namespace: staple name: staple-app labels: app: staple spec: replicas: 1 selector: matchLabels: app: staple template: metadata: labels: app: staple app.kubernetes.io/name: staple app.kubernetes.io/instance: staple spec: containers: - name: staple image: skarlso/staple:v0.1.0 imagePullPolicy: IfNotPresent resources: requests: memory: \u0026#34;500Mi\u0026#34; cpu: \u0026#34;250m\u0026#34; limits: memory: \u0026#34;1000Mi\u0026#34; cpu: \u0026#34;500m\u0026#34; env: - name: POD_NAMESPACE valueFrom: fieldRef: fieldPath: metadata.namespace - name: DB_PASSWORD valueFrom: secretKeyRef: name: staple-db-password key: POSTGRES_PASSWORD - name: MG_DOMAIN valueFrom: secretKeyRef: name: staple-mg-creds key: MG_DOMAIN - name: MG_API_KEY valueFrom: secretKeyRef: name: staple-mg-creds key: MG_API_KEY args: - --staple-db-hostname=staple-db-service.cronohub.svc.cluster.local:5432 - --staple-db-username=staple - --staple-db-database=staple - --staple-db-password=$(DB_PASSWORD) - --mg-domain=$(MG_DOMAIN) - --mg-api-key=$(MG_API_KEY) ports: - name: staple-port containerPort: 9998 There are a few important points here and I won\u0026rsquo;t explain them all, like the resource restrictions, which you should be familiar with by now. I\u0026rsquo;m using a mix of 12factor app\u0026rsquo;s environment configuration and command line arguments for the application configuration. The app itself is not using os.Environ but the args.\nThe args point to the cluster local dns of the database, some db settings, and the mailgun credentials.\nIt also exposes the container port 9998 which is Echo\u0026rsquo;s default port.\nNow all we need is the service.\nService Without much fanfare:\nkind: Service apiVersion: v1 metadata: namespace: staple name: staple-service labels: app: staple app.kubernetes.io/name: staple app.kubernetes.io/instance: staple spec: selector: app: staple app.kubernetes.io/name: staple app.kubernetes.io/instance: staple ports: - name: service-port port: 9998 targetPort: staple-port And with this, the backend is done.\nThe frontend The frontend, similarly to the backend, does not require a persistent volume. We can skip that one too.\nIn fact it only needs two things, a deployment and a service, and that\u0026rsquo;s all. It uses serve to host the static files. Honestly, that could also be a Go application serving the static content or anything that can serve static files.\nDeployment apiVersion: apps/v1 kind: Deployment metadata: namespace: staple name: staple-frontend labels: app: staple-frontend spec: replicas: 1 selector: matchLabels: app: staple-frontend template: metadata: labels: app: staple-frontend app.kubernetes.io/name: staple-frontend app.kubernetes.io/instance: staple-frontend spec: containers: - name: staple-frontend image: skarlso/staple-frontend:v0.0.9 imagePullPolicy: IfNotPresent resources: requests: memory: \u0026#34;500Mi\u0026#34; cpu: \u0026#34;250m\u0026#34; limits: memory: \u0026#34;1000Mi\u0026#34; cpu: \u0026#34;500m\u0026#34; env: - name: POD_NAMESPACE valueFrom: fieldRef: fieldPath: metadata.namespace - name: REACT_APP_STAPLE_DEV_HOST value: \u0026#34;\u0026#34; ports: - name: staple-front containerPort: 5000 Service And the service:\nkind: Service apiVersion: v1 metadata: namespace: staple name: staple-front-service labels: app: staple-frontend app.kubernetes.io/name: staple-frontend app.kubernetes.io/instance: staple-frontend spec: selector: app: staple-frontend app.kubernetes.io/name: staple-frontend app.kubernetes.io/instance: staple-frontend ports: - name: staple-front port: 5000 targetPort: staple-front And with that the backend and frontend are wired together and ready to receive traffic.\nAll pods should be up and running without problems at this point. If you have any trouble deploying things, please don\u0026rsquo;t hesitate to leave a question in the comments.\nIngress Fantastic. Now, our application is running. We just need to expose it and route traffic to it. The backend has the api route /rest/api/v1/. The frontend has the route syntax /login, /register and a bunch of others. The key here is that all of them are under the same domain name but based on the URI we need to direct one request to the backend the other to the frontend.\nThis is done via nginx\u0026rsquo;s routing logic using regex. In an nginx config this would be the location part. It\u0026rsquo;s imperative that the order of the routing is from more specific towards more general Because we need to catch the specific URIs first.\nIngress Resource To do this, we will create something called an Ingress Resource. Note that this is Nginx\u0026rsquo;s ingress resource and not Kubernetes\u0026rsquo;. There is a difference.\nI suggest reading up on that link about the ingress resource because it reads quite well and will explain how it works and fits into the Kubernetes environment.\nGot it? Good. We\u0026rsquo;ll create one for staple.app domain:\napiVersion: extensions/v1beta1 kind: Ingress metadata: namespace: staple name: staple-app-ingress annotations: kubernetes.io/ingress.class: \u0026#34;nginx\u0026#34; cert-manager.io/cluster-issuer: \u0026#34;letsencrypt-prod\u0026#34; cert-manager.io/acme-challenge-type: http01 nginx.ingress.kubernetes.io/rewrite-target: /$1 # this is important spec: tls: - hosts: - staple.app secretName: staple-app-tls rules: - host: staple.app http: paths: - backend: serviceName: staple-service servicePort: ss-port # 9998 path: /(rest/api/1.*) - host: staple.app http: paths: - backend: serviceName: staple-front-service servicePort: sfs-port # 5000 path: /(.*) Let\u0026rsquo;s take a look at what\u0026rsquo;s going on here. The first thing to catch the eye are the annotations. These are configuration settings for nginx, cert-manager and Kubernetes. We have the cluster issuer\u0026rsquo;s name. The challenge type, which we decided should be http01, and the most important part, the rewrite-target setting. This will use the first capture group as a base after the host.\nWith this rewrite rule in place, the paths values need to provide a capture group. The first in line will see everything that goes to the urls like: staple.app/rest/api/1/token, staple.app/rest/api/1/staples, staple.app/rest/api/1/user, etc. The first part of the url is the host staple.app, second part is /(rest/api/1/.*) for which the result is that group number one ($1) will be rest/api/1/token. Nginx now sees that we have a backend route for that and will send this URI along to the service. Our service picks it up and will match that URI to the router configuration.\nIf there is a request like, staple.app/login, which is our frontend\u0026rsquo;s job to pick up, the first rule will not catch it because the regex isn\u0026rsquo;t matching, so it falls through to the second one, which is the frontend service that is using a \u0026ldquo;catch all\u0026rdquo; regex. Like ip tables, we go from specific to more general.\nEnding words And that\u0026rsquo;s it. If everything works correctly, then the certificate service wired up the https certs and we should be able ping the rest endpoint under https://staple.app/rest/api/1/token and log in to the app in the browser using https://staple.app.\nStay tuned for the second part where we\u0026rsquo;ll scale the thing up!\nThanks for reading! Gergely.\n","permalink":"https://skarlso.github.io/2020/07/23/kubernetes-deploy-golang-react-apps-separately-part1/","summary":"Intro Welcome. This is a longer post about how to deploy a Go backend with a React frontend on Kubernetes as separate entities. Instead of the usual compiled together single binary Go application, we are going to separate the two. Why? Because usually a React frontend is just a \u0026ldquo;static\u0026rdquo; SPA app with very little requirements in terms of resources, while the Go backend does most of the leg work, requiring a lot more resources.","title":"How to deploy a Go (Golang) backend with a React frontend separately on Kubernetes - Part One"},{"content":"Intro Hi folks.\nThis time, I would like to talk a little bit about code reviews.\nHow do you do code reviews? Don\u0026rsquo;t hesitate to share it in the comments.\nHow do I do code reviews? Well read on if you would like to know.\nThe Top Down approach If I\u0026rsquo;m dealing with a small code change, a couple of lines here and there in the odd file first, I\u0026rsquo;ll try to understand why the review is there? What was it trying to achieve? What\u0026rsquo;s the goal of the change? Is there a ticket/issue I can read for background info? Or an RFC?\nUnderstanding the goal of the change will let you know how to read the change. I usually also scribble down some notes and my expectations to see if the change meets them or does something completely different. And if it\u0026rsquo;s different, maybe my expectations were wrong.\nIn any case, I will have a framework to start with. It\u0026rsquo;s important to understand why the change is there in the first place. I cannot stress this enough.\nLogical follow If the change is large, the top down approach will simply not work. You will loose track of why the change is and your logical big picture image will fade into nothingness after a hundred lines.\nIn Github at least, what I would do to approach this, is close all views and just have a general sense first how big the change is, and what files changed (after I understand why the change is there and what is it trying to change and / or solve). Once I have a feel for the structure I would look for changes which are trivial. For example parameter changes of a function. I would expect that in that case there will be a lot of changes at places where that function was called. I would review those and then go on.\nIf there is any, I would look for an entry point into the change. Is there a new handler? A new API? A new method? Did an API change? If so, did that change propagate all the way through the API\u0026rsquo;s implementation?\nIf it\u0026rsquo;s a huge number of deletes, I would look for the deleted code in the whole codebase. Did they miss something? Was that code referenced in another section of the code or possibly in another service? In that case, do a search on the whole organization on all repositories if you believe that that makes sense.\nIf it\u0026rsquo;s concurrent code\u0026hellip; are they syncing it up at some point? Are they releasing the lock? Is the lock happening at the right place? In Go for example, you can get a lock and then defer w.Lock.Unlock() it. This makes for a convenient way of \u0026ldquo;forgetting\u0026rdquo; about the lock acquire. But this is counterproductive in some cases.\nImagine you have a function which acquires the lock in the begin. Then does a for loop which takes a couple of seconds but doesn\u0026rsquo;t actually use the map or the value you were trying to protect. In that case you are taking the lock but aren\u0026rsquo;t actually using it. There was no point in acquiring it at the beginning of the function.\nGeneral order There are a LOT of things one can review in a PR. Minute things and a myriad if small to big logical problems and ramifications. It\u0026rsquo;s not possible to list them all. So here are some general rules I would follow:\nSyntax The first thing I would do is look through the syntax and follow this mnemonic: BUD. B(ottleneck), U(nnecessary code), D(uplicate work). Spotting these is usually easy but it can happen that the change is subtle. Bottlenecks are often embedded loops in loops or a very sneaky recursion. Unnecessary code is sometimes harder to spot. This is duplicate code which could be extracted. It can be subtle because it\u0026rsquo;s likely that only a small thing changes and at first glance it\u0026rsquo;s not trivial how to extract the rest of the code around that small thing. Maybe it can be a function (if your language supports functions as first class citizens) which could close over a value and change it multiple times.\nDuplicate work is when a loop is calculating something over and over but it\u0026rsquo;s actually the same thing or we already have that information and it\u0026rsquo;s not likely that it would change so it can be reused. These kind of problems are solved through caching or simply just do it once, store the result, then pass it around. Candidates for this could be multiple calls to the same api for the same information which didn\u0026rsquo;t change in between.\nGeneral language guidelines General language syntax and guidelines adherence comes next. In Go this is trivial, since we have a plethora of tools available to us, devs, in the form of static analyzers like, fmt, golint, goimport etc. But in the absence there is usually a good guide at hand how a language is supposed to look like.\nWorkplace / Project guideline adherence This could arguably come before the general adherence. Whichever suits you better. Or maybe your workplace / environment the code is in (this could also be an open source project) is different from the general guidelines. That is okay, as long as it\u0026rsquo;s sensible. You could try changing it if you think it\u0026rsquo;s too far from how a language is supposed to look like but that usually doesn\u0026rsquo;t work. Especially if the in-place guidelines are already there for years.\nGenerally though, it\u0026rsquo;s better to follow whatever style/code/whim the current environment is doing. If changing something always look around how that looks like in the code you are working in and then follow that style. These could be things like, variable naming, comment semantics, logical flow of the code, structuring (like where the code should go and how it should look like (yes, look like(sometime aesthetics matter))).\nCould it be done concurrently As a cherry on top, I would try to determine if the work that is being done, could be done in a thread / go routine. In Go, go routines are cheap and very easy to make. It\u0026rsquo;s also easy to abuse them of course, but it doesn\u0026rsquo;t hurt to think asynchronously. Especially in a distributed environment. Which brings me to the next point.\nIn a distributed environment timing is key If this change is in an environment which has many services and is generally distributed your first though should immediately be, how those this affect the rest of the services and what timing issues could arise. If there is a delete operation, what about another service calling a create or a get on the same resource at the same time? What if it\u0026rsquo;s a create but another service also calls create with the same values? Is the data eventually consistent or strongly consistent? How does that affect the runtime? Is the change in a frequently called code segment which is usually under heavy load? Did the change change the way that is handled? Did it slow it down or speed it up? Did it trade the slowdown for strong consistency? Is strong consistency really needed in that service which would justify the slowdown?\nLike I said\u0026hellip; a myriad of things\u0026hellip;\nI\u0026rsquo;ll stop here for now.\nConclusion I hope this made sense. If you disagree with this approach or have a different guideline of reviewing, please don\u0026rsquo;t hesitate it to share it!\nAs always, Thanks for reading! Gergely.\n","permalink":"https://skarlso.github.io/2020/05/11/good-code-reviews/","summary":"Intro Hi folks.\nThis time, I would like to talk a little bit about code reviews.\nHow do you do code reviews? Don\u0026rsquo;t hesitate to share it in the comments.\nHow do I do code reviews? Well read on if you would like to know.\nThe Top Down approach If I\u0026rsquo;m dealing with a small code change, a couple of lines here and there in the odd file first, I\u0026rsquo;ll try to understand why the review is there?","title":"How to do a good code review"},{"content":"Intro Hi folks.\nToday I would like to share a quick \u0026ldquo;fix\u0026rdquo; for a problem I\u0026rsquo;ve seen popping up here and there.\nThat is, if you have a react frontend which is a SPA app but you still want refresh to work. What do I mean by that? Consider the following\u0026hellip;\nThe problem You have a SPA app with a react router which navigates the user around. The app calls to a backend api which serves content of some kind. You have the following routes\u0026hellip;. login, signup, reset, archive.\nIf your app is compiled with your backend, as it usually is, then something like: https://app.com/login will not work unless it\u0026rsquo;s also defined on the backend serving some content.\nSo but what should the content be in this case?\nThe structre For that, let\u0026rsquo;s first look at the strucute of the app. Consider the following directory tree:\n. ├── Dockerfile ├── LICENSE ├── Makefile ├── README.md ├── build ├── cmd │ └── root.go ├── frontend │ ├── LICENSE │ ├── README.md │ ├── build │ ├── package-lock.json │ ├── package.json │ ├── public │ ├── src │ └── yarn.lock ├── go.mod ├── go.sum ├── img ├── internal └── pkg For this, the frontend contains a build dir in which the generated react frontend static files plus compiled JavaScript libraries are. In this directory there also is a index.html file which does the actual heavy lifting in terms of routing.\nThe Go backend therefor must only route to index.html on certain endpoints.\nIn Go to build and deploy a single binary containing the static assets here in, you can use something like go.rice or assetfs which generate a Go file for you which contains all the data in an easily accessible way.\nI\u0026rsquo;ll be using go.rice.\nThe solution To summarize, all you have to do is route every route in your router.js file to index.html in Go. But how? Well, like this\u0026hellip;\nConsider this appliction: Staple. This is a react frontend go backend application which builds a frontend asset then packages it up with go.rice, builds a Docker container and deploys the whole thing to a Kubernetes cluster. But this is the interesting part which handles the index routing:\nIn routes.go (contains the mapped routes from under Router.js):\npackage pkg // These routes must match the routes under frontend/Routes.js var routes = []string{ \u0026#34;/login\u0026#34;, \u0026#34;/archive\u0026#34;, \u0026#34;/staples/new\u0026#34;, \u0026#34;/reset\u0026#34;, \u0026#34;/signup\u0026#34;, \u0026#34;/settings\u0026#34;, } Once we have a list of routes to map\u0026hellip;\nIn server.go (which is starting up the server and generates the handlers\u0026hellip;)\n// ... code which sets up the api routes... after every handler has been estabilished... // Setup front-end if not in production mode. if !config.Opts.DevMode { // This path needs to be relative from this files package\u0026#39;s location. staticAssets, err := rice.FindBox(\u0026#34;../frontend/build\u0026#34;) if err != nil { log.Fatal(\u0026#34;Cannot find assets in production\u0026#34;) return err } // Register handler for static assets assetHandler := http.FileServer(staticAssets.HTTPBox()) // Open the index.html file as a *File for reading the content out of it. // This is a virtual file handled by go.rice. index, err := staticAssets.Open(\u0026#34;index.html\u0026#34;) if err != nil { config.Opts.Logger.Error().Err(err).Msg(\u0026#34;Failed to find index.html content.\u0026#34;) return err } // Set up the main point as a static file server e.GET(\u0026#34;/\u0026#34;, echo.WrapHandler(assetHandler)) // Set up routes to index.html for all routes under Routes.js. Index.html will handle the routing any further. for _, r := range routes { e.GET(r, indexServer(r, index)) } e.GET(\u0026#34;/favicon.ico\u0026#34;, echo.WrapHandler(assetHandler)) e.GET(\u0026#34;/site.webmanifest\u0026#34;, echo.WrapHandler(assetHandler)) e.GET(\u0026#34;/static/css/*\u0026#34;, echo.WrapHandler(http.StripPrefix(\u0026#34;/\u0026#34;, assetHandler))) e.GET(\u0026#34;/static/js/*\u0026#34;, echo.WrapHandler(http.StripPrefix(\u0026#34;/\u0026#34;, assetHandler))) e.GET(\u0026#34;/static/media/*\u0026#34;, echo.WrapHandler(http.StripPrefix(\u0026#34;/\u0026#34;, assetHandler))) } What is indexServer in this you might ask? Well, fret no longer, I shall show you:\n// indexServer takes a name and the contents of the virtual file index.html gathered up by go.rice // and serves its content via http.ServeContent under the given name. func indexServer(name string, file *rice.File) echo.HandlerFunc { return func(c echo.Context) error { stat, _ := file.Stat() http.ServeContent(c.Response().Writer, c.Request(), name, stat.ModTime(), file) return nil } } The key points are the name, which will be the route and the file which is the index.html content which contains the logic to route based on the request. All that will be handled. And if a new route comes along, simple add it to the list, recompile and you are done!\nConclusion In summary, you let your index.html file handle the routing as you would normally do. Just you need to make your backend aware of that fact. Now refreshing the page will work as you\u0026rsquo;d expect.\nThank you for reading, Gergely.\n","permalink":"https://skarlso.github.io/2020/02/17/making-spa-refresh-work-with-go-backend/","summary":"Intro Hi folks.\nToday I would like to share a quick \u0026ldquo;fix\u0026rdquo; for a problem I\u0026rsquo;ve seen popping up here and there.\nThat is, if you have a react frontend which is a SPA app but you still want refresh to work. What do I mean by that? Consider the following\u0026hellip;\nThe problem You have a SPA app with a react router which navigates the user around. The app calls to a backend api which serves content of some kind.","title":"How to Make SPA refresh work with a Go backend"},{"content":"Intro Hi folks.\nThis is a continuation of the previous post about my Kubernetes infrastructure located here. The two remaining points are to deploy Athens Go proxy and setting up monitoring.\nAthens Let\u0026rsquo;s start with Athens.\nFirst of all if you are a helm user, Athens has an awesome set of helm charts which you can use to deploy it in your cluster. Located here.\nI prefer to deploy my own config files, but that\u0026rsquo;s me. So here is my preferred way of deploying Athens.\nSince this is also a subdomain of the previously created powerhouse namespace we are going to use that.\nPVC We are going to need a PersistentVolumeClaim for Athens so it can store all the things forever.\napiVersion: v1 kind: PersistentVolumeClaim metadata: namespace: powerhouse name: athens-storage spec: accessModes: - ReadWriteOnce resources: requests: storage: 10Gi storageClassName: do-block-storage Claim is very boring. Which means it just works.\nDeployment This is more interesting. Athens provides a lot of possibilities for the deployment. I\u0026rsquo;m just deploying the barest possible here. Which means, no user auth, no private repository support, ssh key configuration, etc\u0026hellip; It\u0026rsquo;s a plain proxy installation.\napiVersion: apps/v1 kind: Deployment metadata: namespace: powerhouse name: athens-app labels: app: athens-proxy spec: replicas: 1 selector: matchLabels: app: athens-proxy template: metadata: labels: app: athens-proxy app.kubernetes.io/name: athens-proxy app.kubernetes.io/instance: athens-proxy spec: containers: - name: athens-proxy image: gomods/athens:v0.6.0 livenessProbe: httpGet: path: \u0026#34;/healthz\u0026#34; port: 3000 readinessProbe: httpGet: path: \u0026#34;/readyz\u0026#34; port: 3000 env: - name: ATHENS_GOGET_WORKERS value: \u0026#34;3\u0026#34; - name: ATHENS_STORAGE_TYPE value: \u0026#34;disk\u0026#34; - name: ATHENS_DISK_STORAGE_ROOT value: /var/lib/athens ports: - containerPort: 3000 name: athens-http volumeMounts: - name: athens-data mountPath: /var/lib/athens subPath: athens volumes: - name: athens-data persistentVolumeClaim: claimName: athens-storage Fun fact. The name of the app must not be just plain athens because that will result in an error: too many colons in address.\nThe issue is here: https://github.com/gomods/athens/issues/1038#issuecomment-457145658 Basically it\u0026rsquo;s because of the name used for the environment properties inside the container.\nService Now, let\u0026rsquo;s expose it.\nkind: Service apiVersion: v1 metadata: namespace: powerhouse name: athens-service labels: app: athens-proxy app.kubernetes.io/name: athens-proxy app.kubernetes.io/instance: athens-proxy spec: selector: app: athens-proxy app.kubernetes.io/name: athens-proxy app.kubernetes.io/instance: athens-proxy ports: - port: 80 targetPort: 3000 Ingress I\u0026rsquo;m using port 80 here because it\u0026rsquo;s convenient. But if you use any other port, don\u0026rsquo;t forget to alter your ingress to forward to that port and service.\napiVersion: extensions/v1beta1 kind: Ingress ... spec: tls: ... - hosts: - athens.powerhouse.com secretName: athens-cronohub-tls rules: ... - host: athens.powerhouse.com http: paths: - backend: serviceName: athens-service servicePort: 1234 path: / And that\u0026rsquo;s it! If you now visit https://athens.powerhouse.com it should say \u0026quot;Welcome to The Athens Proxy\u0026quot;.\nNow, if you set this proxy with export GOPROXY=https://athens.powerhouse.com it should start to cache modules. It\u0026rsquo;s a fantastic proxy with a lot of capabilities. I encourage you to check it out and drop by it\u0026rsquo;s slack channel on Gopher slack called Athens.\nMonitoring Monitoring is a huge topic so I\u0026rsquo;m not going to talk about how to monitor or what. That is described in great many of posts. I especially recommend reading sysdig\u0026rsquo;s 6 part post on doing monitoring with Prometheus and Grafana and what to monitor and the four golden signals and whatnot. Starting here and here.\nPrometheus I\u0026rsquo;m going to deploy Prometheus. Prometheus is a monitoring tool which sits inside your cluster and gathers data about running pods, nodes, services, whatever you expose and wants to send data to it. It can also alert on things and can be integrated with tools like Graphana for nice front-end and metrics. Prometheus itself uses PromQL as its query language to gather data from different sources and do time series analytics and much much more.\nPlease visit the website and documentation for more details. It\u0026rsquo;s the defacto monitoring tool for Kubernetes. Again, I\u0026rsquo;m going to do a very basic installation of Prometheus. So basic in fact, that I don\u0026rsquo;t even have a PVC for it, because I don\u0026rsquo;t care at this point about retaining data.\nNamespace Let\u0026rsquo;s create it\u0026rsquo;s own namespace.\napiVersion: v1 kind: Namespace metadata: name: monitoring labels: name: monitoring Config Prometheus Server config is massive. I don\u0026rsquo;t expect you to pick up on everything in this thing, but I would encourage you to at least try to find out what these setting do\u0026hellip; Our config yaml file contains the configuration file for Prometheus which we\u0026rsquo;ll later set up via a command line argument. It\u0026rsquo;s called prometheus.yml.\napiVersion: v1 kind: ConfigMap metadata: name: prometheus-server-conf labels: name: prometheus-server-conf namespace: monitoring data: prometheus.yml: |- global: scrape_interval: 5s evaluation_interval: 5s scrape_configs: - job_name: \u0026#39;kubernetes-apiservers\u0026#39; kubernetes_sd_configs: - role: endpoints scheme: https tls_config: ca_file: /var/run/secrets/kubernetes.io/serviceaccount/ca.crt bearer_token_file: /var/run/secrets/kubernetes.io/serviceaccount/token relabel_configs: - source_labels: [__meta_kubernetes_namespace, __meta_kubernetes_service_name, __meta_kubernetes_endpoint_port_name] action: keep regex: default;kubernetes;https - job_name: \u0026#39;kubernetes-nodes\u0026#39; scheme: https tls_config: ca_file: /var/run/secrets/kubernetes.io/serviceaccount/ca.crt bearer_token_file: /var/run/secrets/kubernetes.io/serviceaccount/token kubernetes_sd_configs: - role: node relabel_configs: - action: labelmap regex: __meta_kubernetes_node_label_(.+) - target_label: __address__ replacement: kubernetes.default.svc:443 - source_labels: [__meta_kubernetes_node_name] regex: (.+) target_label: __metrics_path__ replacement: /api/v1/nodes/${1}/proxy/metrics - job_name: \u0026#39;kubernetes-pods\u0026#39; kubernetes_sd_configs: - role: pod relabel_configs: - source_labels: [__meta_kubernetes_pod_annotation_prometheus_io_scrape] action: keep regex: true - source_labels: [__meta_kubernetes_pod_annotation_prometheus_io_path] action: replace target_label: __metrics_path__ regex: (.+) - source_labels: [__address__, __meta_kubernetes_pod_annotation_prometheus_io_port] action: replace regex: ([^:]+)(?::\\d+)?;(\\d+) replacement: $1:$2 target_label: __address__ - action: labelmap regex: __meta_kubernetes_pod_label_(.+) - source_labels: [__meta_kubernetes_namespace] action: replace target_label: kubernetes_namespace - source_labels: [__meta_kubernetes_pod_name] action: replace target_label: kubernetes_pod_name - job_name: \u0026#39;kubernetes-cadvisor\u0026#39; scheme: https tls_config: ca_file: /var/run/secrets/kubernetes.io/serviceaccount/ca.crt bearer_token_file: /var/run/secrets/kubernetes.io/serviceaccount/token kubernetes_sd_configs: - role: node relabel_configs: - action: labelmap regex: __meta_kubernetes_node_label_(.+) - target_label: __address__ replacement: kubernetes.default.svc:443 - source_labels: [__meta_kubernetes_node_name] regex: (.+) target_label: __metrics_path__ replacement: /api/v1/nodes/${1}/proxy/metrics/cadvisor - job_name: \u0026#39;kubernetes-service-endpoints\u0026#39; kubernetes_sd_configs: - role: endpoints relabel_configs: - source_labels: [__meta_kubernetes_service_annotation_prometheus_io_scrape] action: keep regex: true - source_labels: [__meta_kubernetes_service_annotation_prometheus_io_scheme] action: replace target_label: __scheme__ regex: (https?) - source_labels: [__meta_kubernetes_service_annotation_prometheus_io_path] action: replace target_label: __metrics_path__ regex: (.+) - source_labels: [__address__, __meta_kubernetes_service_annotation_prometheus_io_port] action: replace target_label: __address__ regex: ([^:]+)(?::\\d+)?;(\\d+) replacement: $1:$2 - action: labelmap regex: __meta_kubernetes_service_label_(.+) - source_labels: [__meta_kubernetes_namespace] action: replace target_label: kubernetes_namespace - source_labels: [__meta_kubernetes_service_name] action: replace target_label: kubernetes_name Mostly it\u0026rsquo;s just setting up what Prometheus should monitor and how. The important bits are the labels. How this is going to work is, that we will annotate the resources we want Prometheus to see. Which is pretty cool. Basically we will just alter a pod to include an annotation and it will begin monitoring it. No need to install anything anywhere or restart anything. Just add an annotation and bamm, you\u0026rsquo;re done.\nRBAC Prometheus needs permissions to access resources in the cluster such as API end-points and gathering data about the cluster itself. We will provide it with this permission through Role Based Access Control.\nWe\u0026rsquo;ll create a service account which Prometheus can use. We want it to access the whole cluster so we\u0026rsquo;ll use a ClusterRole.\napiVersion: rbac.authorization.k8s.io/v1beta1 kind: ClusterRole metadata: name: prometheus rules: - apiGroups: [\u0026#34;\u0026#34;] resources: - nodes - nodes/proxy - services - endpoints - pods verbs: [\u0026#34;get\u0026#34;, \u0026#34;list\u0026#34;, \u0026#34;watch\u0026#34;] - apiGroups: - extensions resources: - ingresses verbs: [\u0026#34;get\u0026#34;, \u0026#34;list\u0026#34;, \u0026#34;watch\u0026#34;] - nonResourceURLs: [\u0026#34;/metrics\u0026#34;] verbs: [\u0026#34;get\u0026#34;] --- apiVersion: rbac.authorization.k8s.io/v1beta1 kind: ClusterRoleBinding metadata: name: prometheus roleRef: apiGroup: rbac.authorization.k8s.io kind: ClusterRole name: prometheus subjects: - kind: ServiceAccount name: default namespace: monitoring This will give access to monitor the following resources: nodes, nodes/proxy, services, endpoints and pods. The action are get, list, watch. No modifications.\nWe\u0026rsquo;ll also allow Prometheus to watch ingresses for data traffic and allow it to do get requests to non-resource endpoint /metrics.\nDeployment Now, the deployment is actually pretty easy.\napiVersion: extensions/v1beta1 kind: Deployment metadata: name: prometheus-deployment namespace: monitoring spec: replicas: 1 template: metadata: labels: app: prometheus-server spec: containers: - name: prometheus image: prom/prometheus:v2.2.1 args: - \u0026#34;--config.file=/etc/prometheus/prometheus.yml\u0026#34; - \u0026#34;--storage.tsdb.path=/prometheus/\u0026#34; ports: - containerPort: 9090 volumeMounts: - name: prometheus-config-volume mountPath: /etc/prometheus/ - name: prometheus-storage-volume mountPath: /prometheus/ volumes: - name: prometheus-config-volume configMap: defaultMode: 420 name: prometheus-server-conf - name: prometheus-storage-volume emptyDir: {} The two interesting things here are the two arguments. The config file, which we include through the configMap and the storage. Which I\u0026rsquo;m not bind mounting.\nService Let\u0026rsquo;s expose Prometheus. Now, this may come as a surprise if you don\u0026rsquo;t know anything about Prometheus, but this is an in cluster monitoring tool. It\u0026rsquo;s usually not supposed to be accessed directly, but through tools like Graphana or used by tools like Alerting or traefik as a reverse proxy. As such, Prometheus does not support authentication or authorization or user management of any kind. That is usually taken care of by a reverse proxy or other means written about here and here.\nAs such, we can do a number of things. We can expose it as a NodePort service for example:\napiVersion: v1 kind: Service metadata: name: prometheus-service namespace: monitoring annotations: prometheus.io/scrape: \u0026#39;true\u0026#39; prometheus.io/port: \u0026#39;9090\u0026#39; spec: selector: app: prometheus-server type: NodePort ports: - port: 8080 targetPort: 9090 nodePort: 30000 Or we just port forward the pod like this:\nk port-forward pods/prometheus-deployment-6bf45557bd-qc6t6 9090:9090 -n monitoring And access it by simply opening the url: http://127.0.0.1:9090.\nPrometheus Once you open it, you should see something like this, after running a small query:\nAdding in Resources to monitor In order to add a resource to monitor simply insert these annotations:\nannotations: prometheus.io/scrape: \u0026#39;true\u0026#39; prometheus.io/port: \u0026#39;9090\u0026#39; Done.\nBonus Round \u0026ndash; Graphana We deployed Athens and Prometheus to monitor our cluster. We don\u0026rsquo;t have anything before Prometheus that would be fancy, but installing Graphana is actually pretty easy. You can follow the instructions here.\nA very easy way of looking at some nice metrics without worrying about anything like users and such, is running a Graphana instance in docker on your local machine with:\ndocker run -d -p 3000:3000 grafana/grafana \u0026hellip; and while you are forwarding the Prometheus end-point you navigate to your Graphana instance by opening 127.0.0.1:3000 and install a Prometheus data-point like this:\nAfter that navigate to a new dashboard and select a simple PromQL metric to see if it\u0026rsquo;s working. You should see something like this:\nNow you can create a new dashboard add a PVC to our Prometheus instance and enjoy all the metrics you can store!\nConclusion And this is it folks. Everything is installed and we can monitor things now. If you give Prometheus a PVC you can build some pretty awesome time series graphs too and see how your cluster behaves over time.\nThank you for reading! Gergely.\n","permalink":"https://skarlso.github.io/2019/10/15/kubernetes-cluster-part2/","summary":"Intro Hi folks.\nThis is a continuation of the previous post about my Kubernetes infrastructure located here. The two remaining points are to deploy Athens Go proxy and setting up monitoring.\nAthens Let\u0026rsquo;s start with Athens.\nFirst of all if you are a helm user, Athens has an awesome set of helm charts which you can use to deploy it in your cluster. Located here.\nI prefer to deploy my own config files, but that\u0026rsquo;s me.","title":"Using a Kubernetes based Cluster for Various Services with auto HTTPS - Part 2"},{"content":"Intro Hi folks.\nSo there is this workshop from Dave Cheney.\nAnd I thought I\u0026rsquo;d draw a sort of summary of that workshop.\nRight-click-\u0026gt;Open Image for higher resolution.\nCheers, Gergely.\n","permalink":"https://skarlso.github.io/2019/10/10/practical-go-summary/","summary":"Intro Hi folks.\nSo there is this workshop from Dave Cheney.\nAnd I thought I\u0026rsquo;d draw a sort of summary of that workshop.\nRight-click-\u0026gt;Open Image for higher resolution.\nCheers, Gergely.","title":"Summary of Practical Go workshop from Dave Cheney"},{"content":"Intro One morning I woke up and tried to access my gitea just to find that it wasn\u0026rsquo;t running.\nI checked my cluster and found that the whole thing was dead as meat. I quickly jumped in and ran k get pods -A to see what\u0026rsquo;s going on. None of my services worked.\nWhat immediately struck my eye was a 100+ pods of my fork_updater cronjob. The fork_updater cronjob which runs once a month, looks like this:\napiVersion: batch/v1beta1 kind: CronJob metadata: name: fork-updater namespace: fork-updater spec: schedule: \u0026#34;* * 1 * *\u0026#34; jobTemplate: spec: template: spec: volumes: - name: fork-updater-ssh-key secret: secretName: fork-updater-ssh-key defaultMode: 256 # yaml spec does not support octal mode containers: - name: fork-updater imagePullPolicy: IfNotPresent image: skarlso/repo-updater:1.0.4 env: - name: GIT_TOKEN valueFrom: secretKeyRef: name: fork-updater-secret key: GIT_TOKEN volumeMounts: - name: fork-updater-ssh-key mountPath: \u0026#34;/etc/secret\u0026#34; readOnly: true restartPolicy: OnFailure Inherently there is nothing wrong with this at first glance. But on a second glance, the problem is restartPolicy: Always. For whatever the reason, the cronjob died when it started up. The restart policy then\u0026hellip; restarted the cronjob, which failed again really fast. Then it scheduled a new one and a new one and a new one\u0026hellip; and I had 100+ containers pending and running and creating.\nAt that point the cluster was basically DDOSd into oblivion. Once the other resources started to die ( since this was a private cluster and I didn\u0026rsquo;t bother to set up restrictions on resources ) the cronjob hogged even more and it basically blocked everything else from being able to run. It overwhelmed the scheduler.\nLovevly that.\nThis is how you could potentionally kill a cluster which doesn\u0026rsquo;t have any resource limits and restrictions set up.\nGergely.\n","permalink":"https://skarlso.github.io/2019/10/01/killing-kubernetes-cluster/","summary":"Intro One morning I woke up and tried to access my gitea just to find that it wasn\u0026rsquo;t running.\nI checked my cluster and found that the whole thing was dead as meat. I quickly jumped in and ran k get pods -A to see what\u0026rsquo;s going on. None of my services worked.\nWhat immediately struck my eye was a 100+ pods of my fork_updater cronjob. The fork_updater cronjob which runs once a month, looks like this:","title":"How I killed my entire Kubernetes cluster"},{"content":"Intro Hi folks.\nToday, I would like to show you how my infrastructure is deployed and managed. Spoiler alert, I\u0026rsquo;m using Kubernetes to do that.\nI know\u0026hellip; What a twist!\nLet\u0026rsquo;s get to it.\nWhat What services am I running exactly? Here is a list I\u0026rsquo;m running at the time of this writing:\nAthens Go Proxy Gitea The Lounge (IRC bouncer) Two CronJobs Fork Updater IDLE RPG online checker My WebSite (gergelybrautigam.com) Monitoring And it\u0026rsquo;s really simple to add more.\nWhere My cluster is deployed at DigitalOcean using two droplets each 1vCPU and 2GB RAM.\nWhat Not This isn\u0026rsquo;t going to be a production grade cluster. What I don\u0026rsquo;t include in here:\nRBAC for various services and users Since I\u0026rsquo;m the only user of my cluster I didn\u0026rsquo;t create any kind of access limits / users or such. You are free to create them though. The only role based auth that\u0026rsquo;s going on is for Prometheus.\nI\u0026rsquo;m not using any third party things which require access to the API.\nResource limitation I\u0026rsquo;m the sole user of my things. I\u0026rsquo;m not really scaling my gitea up or down based on usage and as such, I did not define things like:\nResource limits Nodes with certain capabilities Affinities and Taints \u0026ndash; which means, everything can run anywhere Readiness Liveliness Most of by deploys and services don\u0026rsquo;t have these except for Athens.\nHow Okay, with that out of the way, let\u0026rsquo;s get into the hows of things\u0026hellip;\nBeginning The most important thing that you need to do in order to use Kubernetes is Containerizing all the things.\nSince Kubernetes is a container orchestration tool, without containers it\u0026rsquo;s pretty useless.\nAs a driver, I\u0026rsquo;m going to use Docker. Kubernetes can use anything that\u0026rsquo;s OCI compatible, which means if you would like to use runc as a container engine, you can do that. I\u0026rsquo;d like to keep my sanity though.\nExample To show you what I mean\u0026hellip; I have a cronjob which is running every month. It gathers all my forks on github and updates them with the latest from their parents. This a small ruby script located here: Fork Updater. How do we run this? It requires two things. First, a token. We pass that currently as an environment property. It could be in a file in a vault or a secret mounted in as a file it doesn\u0026rsquo;t matter. Currently, it\u0026rsquo;s an environment property. The second thing is more subtle.\nI\u0026rsquo;m pushing the changes back into my remote forks. I\u0026rsquo;m doing this via SSH. So, we need a key in there too. How we\u0026rsquo;ll get that in there, I\u0026rsquo;ll talk about later when we are talking about how to set this cron job up. For now though, the container needs to look for a key in a specific location because we don\u0026rsquo;t want to over-mount /root/.ssh/ and we also don\u0026rsquo;t want to use an initContainer to copy over an SSH key (because it\u0026rsquo;s mounted in as a symlink (but that\u0026rsquo;s a different issue all together)). Also, we certianly do NOT want to have a key in the container.\nTo achieve this, we simply set up a config file for SSH like this one:\nHost github.com IdentityFile /etc/secret/id_rsa /etc/secret will be the destination of the ssh key we create.\nAnd we also need to have a known_hosts file, otherwise git clone will complain. We also bake this into the container. Why? Why not generate that on the fly? Because I want it to fail in case there is something wrong or there is a MIMA going on etc.\nAll this translated into a Dockerfile looks like this:\n# We are using alpine for a minimalistic image FROM alpine:latest RUN apk --no-cache add ca-certificates RUN apk update # Openssh is needed for the SSH command RUN apk --no-cache add ruby vim curl git build-base ruby-dev openssh openssh-client # Setup dependencies for the fork ruby file RUN gem install octokit logger multi_json json --no-ri --no-rdoc RUN mkdir /data WORKDIR /data # Setup some data about the committer RUN git config --global user.name \u0026#34;Fork Updater\u0026#34; RUN git config --global user.email \u0026#34;email@email.com\u0026#34; RUN mkdir -p /root/.ssh # Get the host config for github.com RUN ssh-keyscan github.com \u0026gt;\u0026gt; /root/.ssh/known_hosts # Setup the SSH config COPY ./config /root/.ssh COPY ./fork_updater.rb . CMD [\u0026#34;ruby\u0026#34;, \u0026#34;/data/fork_updater.rb\u0026#34;] That\u0026rsquo;s it. Now our updater is containerized and ready to be deployed as a cronjob on a kube cluster. Oh, and we also need to create the SSH key like this:\nkubectl create secret generic ssh-key-secret --from-file=ssh-privatekey=/path/to/.ssh/id_rsa Before we Begin There are two things we will need though to set up for our cluster before we even begin adding the first service. And that\u0026rsquo;s an ingress with a load-balancer and cert-manager.\nCert-Manager Now, you have the option of installing cert-manager via helm, or via the provided kube config yaml file. I STRONGLY recommend using the config yaml file because the upgrading process with helm is a hell of a lot dirtier / failure prone than simply applying a new yaml file with a different version in it.\nEither way, to install cert-manager follow this simple guide: Cert-manager Install Manual.\nIngress An Ingress is a must. This is the component which manages external access to the services which we will define. Like a proxy before your http server. This component will handle the hostname based routing between our services.\nI\u0026rsquo;m using nginx ingress, although there are a couple of implementations out there.\nTo install nginx ingress, follow their guide here: Installing Nginx-Ingress.\nFrom Easy to Complicated Alright. Now that we have the prereqs out of the way, let\u0026rsquo;s get our hands dirty. I\u0026rsquo;ll start with the easiest of them all, my web site, and then will progress towards the more complicated ones, like Gitea and Athens, which require a lot more fiddling and have more moving parts.\nMy Website The site, located here: Gergely\u0026rsquo;s Domain; is a really simple, static, Hugo based website. It contains nothing fancy, no real Javascript magic, has a simple list of things I\u0026rsquo;ve done and who I am.\nIt\u0026rsquo;s powered / served by an nginx instance running on port 9090 define by a very simple Dockerfile:\nFROM golang:latest as builder RUN apt-get update \u0026amp;\u0026amp; apt install -y git make vim hugo RUN mkdir -p /opt/website RUN git clone https://github.com/Skarlso/gergelybrautigam /opt/website WORKDIR /opt/website RUN make FROM nginx:latest RUN mkdir -p /var/www/html/gergelybrautigam WORKDIR /var/www/html/gergelybrautigam COPY --from=builder /opt/website/public . COPY 01_gergelybrautigam /etc/nginx/sites-available/ RUN mkdir -p /etc/nginx/sites-enabled/ RUN ln -s /etc/nginx/sites-available/01_gergelybrautigam /etc/nginx/sites-enabled/01_gergelybrautigam Easy as goblin pie. Nginx has a command set like this CMD [\u0026quot;nginx\u0026quot;, \u0026quot;-g\u0026quot;, \u0026quot;daemon off;\u0026quot;] and exposes port 80.\nThe deployment In order to deploy this in the cluster, I created a deployment as follows:\napiVersion: apps/v1 kind: Deployment metadata: name: gb-deployment namespace: gergely-brautigam labels: app: gergelybrautigam annotations: prometheus.io/scrape: \u0026#39;true\u0026#39; prometheus.io/port: \u0026#39;9090\u0026#39; spec: replicas: 1 selector: matchLabels: app: gergelybrautigam template: metadata: labels: app: gergelybrautigam annotations: prometheus.io/scrape: \u0026#39;true\u0026#39; prometheus.io/port: \u0026#39;9090\u0026#39; spec: containers: - name: gergelybrautigam image: skarlso/gergelybrautigam:v0.0.26 ports: - containerPort: 9090 The metadata section defines information about the deployment. It\u0026rsquo;s name is gb-deployment. The namespace in which this sits is called gergely-brautigam and it has some labels to it so Prometheus monitoring tool can discover the pod.\nIt\u0026rsquo;s running a single replica, has a bunch of more metadata and template settings, and finally the container spec which defines the image, and the exposed container port on which the application is running.\nNow we need a service to expose this deployment.\nThe service The service is also simple. It looks like this:\nkind: Service apiVersion: v1 metadata: namespace: gergely-brautigam name: gb-service spec: selector: app: gergelybrautigam ports: - port: 80 targetPort: 9090 Again, nothing fancy here, just a simple service exposing a port to a different port on the front-end side. This service will be picked up by our previously created routing facility.\nIngress Now that we have the service we need to expose it to the domain. I have the domain gergelybrautigam.com and I already pointed it at the LoadBalancer\u0026rsquo;s IP which was created by the nginx ingress controller.\nWe only want one LoadBalancer, but we have multiple hostnames. We can achieve that by creating an Ingress resource in the namespace our service is in like this:\napiVersion: extensions/v1beta1 kind: Ingress metadata: namespace: gergely-brautigam name: gergely-brautigam-ingress annotations: kubernetes.io/ingress.class: \u0026#34;nginx\u0026#34; certmanager.k8s.io/cluster-issuer: \u0026#34;letsencrypt-prod\u0026#34; certmanager.k8s.io/acme-challenge-type: http01 nginx.ingress.kubernetes.io/rewrite-target: / spec: tls: - hosts: - gergelybrautigam.com secretName: gergelybrautigam-tls rules: - host: gergelybrautigam.com http: paths: - backend: serviceName: gb-service servicePort: 80 Remember, we already have the nginx ingress resource in the default namespace when we installed the controller previously. That is the main entrypoint. We are taking advantage of the rewrite-target annotation. That is our key to success nginx.ingress.kubernetes.io/rewrite-target: /. The rest is basic routing. We\u0026rsquo;ll have something like this in the other namespace to.\nAnd with that, our website is done and it should be working under HTTPS. Cert-manager should have picked it up and generated a certificate for it. Let\u0026rsquo;s check.\nRunning k get certs -n gergely-brautigam you should see something like this:\n$ k get certs -n gergely-brautigam NAME READY SECRET AGE gergelybrautigam-tls True gergelybrautigam-tls 86d If there is a problem, just describe the cert resource and look for the generated challenge and if it was successful or not. The challenge contains mostly good error messages.\nIRC bouncer That wasn\u0026rsquo;t too bad, right? Let\u0026rsquo;s do something a bit more complex this time. We are going to deploy The lounge irc bouncer.\nIt\u0026rsquo;s actually quite easy to do but can be daunting to look at at first.\nThe container Lucky for us, the bouncer already provides a container located here: The Lounge Docker Hub.\nWe just need two things. To expose the port 9000 and to give it something called a PersistentVolume. What\u0026rsquo;s a persistent volume? Well, look it up here: Kubernetes Persistent Volumes.\nTL;DR: We need to preserve data. Containers are ephemeral in nature. Meaning if there is a problem we usually just delete the pod. Which means that all data will be lost. But we need persistence in this case because we\u0026rsquo;ll have user data and user information which we would like to persist between pods. That\u0026rsquo;s what a volume is for.\nIt will be mounted into the pod so we can point the bouncer to use that location for data management.\nPVC With that, this is how our PersistentVolumeClaim will look like:\napiVersion: v1 kind: PersistentVolumeClaim metadata: namespace: powerhouse name: do-storage-irc spec: accessModes: - ReadWriteOnce resources: requests: storage: 5Gi storageClassName: do-block-storage DigitalOcean provides a block storage implementation for this claim so we use that storage class do-block-storage.\nDeployment With that, this is how the deployment will look like:\napiVersion: apps/v1 kind: Deployment metadata: namespace: powerhouse name: irc-app labels: app: irc spec: replicas: 1 selector: matchLabels: app: irc template: metadata: labels: app: irc app.kubernetes.io/name: irc app.kubernetes.io/instance: irc spec: containers: - name: irc image: thelounge/thelounge:3.1.1 ports: - containerPort: 9000 name: irc-http volumeMounts: - mountPath: /var/opt/thelounge subPath: thelounge name: irc-data readOnly: false volumes: - name: irc-data persistentVolumeClaim: claimName: do-storage-irc Short and sweet. The important bits are the labels, those are used by cert-manager and ingress to find the right deployment, and the volumeMounts. We mount into the /var/opt/thelounge folder because that\u0026rsquo;s the main configuration location. The subPath is important for a correct mounting.\nThe service Alright, with the deployment in place, let\u0026rsquo;s take a look at the service.\nkind: Service apiVersion: v1 metadata: namespace: powerhouse name: irc labels: app: irc app.kubernetes.io/name: irc app.kubernetes.io/instance: irc spec: selector: app: irc app.kubernetes.io/name: irc app.kubernetes.io/instance: irc ports: - name: http port: 9000 targetPort: irc-http Again, very boring stuff. Boring is good. Boring is predictable. We expose port 9000 to the named targetPort called irc-http which we defined in the above deployment.\nNow, I have a domain in which these things are running, let\u0026rsquo;s call it powerhouse.com (because I\u0026rsquo;m tired of example.com). And I have multiple services in this namespace too, so I\u0026rsquo;ll call the namespace here, powerhouse and put this irc service in there. This also means that the ingress resource for this namespace will contain a couple more routings, because my powerhouse namespace will also contain my gitea and Athens proxy installation.\nWe can, however, take a peak at the ingress resource here and now\u0026hellip; because I hate suspense.\napiVersion: extensions/v1beta1 kind: Ingress metadata: namespace: powerhouse name: powerhouse-ingress annotations: kubernetes.io/ingress.class: \u0026#34;nginx\u0026#34; certmanager.k8s.io/cluster-issuer: \u0026#34;letsencrypt-prod\u0026#34; certmanager.k8s.io/acme-challenge-type: http01 nginx.ingress.kubernetes.io/rewrite-target: / spec: tls: - hosts: - irc.powerhouse.com secretName: irc-powerhouse-tls - hosts: - gitea.powerhouse.com secretName: gitea-powerhouse-tls - hosts: - athens.powerhouse.com secretName: athens-powerhouse-tls rules: - host: irc.powerhouse.com http: paths: - backend: serviceName: irc servicePort: 9000 path: / - host: gitea.powerhouse.com http: paths: - backend: serviceName: gitea servicePort: 3000 path: / - host: athens.powerhouse.com http: paths: - backend: serviceName: athens-service servicePort: 80 path: / We can see that I have multiple paths pointing to three different subdomains with different ports. These ports will be routed to by nginx ingress. Meaning you DO NOT OPEN THESE ON YOUR LOADBALANCER. These will all be accessible from 443/HTTPS. Expect for gitea\u0026rsquo;s SSH port later on.\nWith these in place, cert-manager should pick it up and provide a certificate for it.\nSide track \u0026ndash; debugging If there is a problem and we can\u0026rsquo;t reach TheLounge we need to debug. I use the following tool to access Kubernetes resources: K9S. It\u0026rsquo;s a neat CLI tool to look at kube resources in an interactive way and not having to type in a bunch of commands. Never the less, I will also paste those in here.\nTo look at the pods that should have been created, type:\nk get pods -n powerhouse Should see something like this:\nNAME READY STATUS RESTARTS AGE athens-app-857749c59c-lmjnb 1/1 Running 0 6d3h gitea-app-6974fb995b-pn2vv 1/1 Running 0 9d gitea-db-59758fbcd9-4562c 1/1 Running 0 9d irc-app-5f87688f98-dqsvb 1/1 Running 0 9d You can see that my other services are running fine. And there is IRC as well. Now if there would be any kind of problem we could access the Pods information be describing the pod with:\nk describe pod/irc-app-5f87688f98-dqsvb -n powerhouse Which will provide a bunch of information about the pod. But the pod could be absolutely fine, yet our service could be down. (We didn\u0026rsquo;t define any liveliness or readiness probs after all).\nWe can verify that by taking a peak in the container (also, check if our mounting was successful). Since this is just a container, exec works similar to docker exec.\n$ k exec -it irc-app-5f87688f98-dqsvb -n powerhouse /bin/bash root@irc-app-5f87688f98-dqsvb:/# Should give us a prompt. We can now look at logs, check out the configuration folder etc.\nIn k9s you would simply select the right namespace, select the pod, hit d for describe or s for shell. Done.\nGitea Now, we have IRC running. Let\u0026rsquo;s try deploying Gitea. This takes a tiny bit more fiddling though.\nRequirements Gitea requires the following things to be present:\nThe gitea app configuration file (this can be done via environment properties though) A DB A PersistentVolume SSH Port for SSH based git clones instead of simple https DB We shall begin with the simplest of them, the DB. At this point we could go with the DigitalOcean managed Postgres installation, but I didn\u0026rsquo;t want to put that on the bill as well. So I choose to simply put my DB into a container and deploy it within the cluster.\nThis is actually quite simple. The DB will be a separate deployment / application in the same namespace as the Gitea app. It will also contain a network policy, since the DB doesn\u0026rsquo;t need internet access and the internet shouldn\u0026rsquo;t be able to access it.\nIn fact the only thing that should be able to access the DB is the Gitea application itself which we will be able to restrict via the usage of\u0026hellip; Labels!\nDeployment But first, take a look at the deployment of a Postgres 11 pod:\napiVersion: apps/v1 kind: Deployment metadata: namespace: powerhouse name: gitea-db spec: replicas: 1 selector: matchLabels: app: gitea-db template: metadata: name: gitea-db labels: app: gitea-db spec: containers: - name: postgres image: postgres:11 env: - name: POSTGRES_USER value: gitea - name: POSTGRES_PASSWORD valueFrom: secretKeyRef: name: gitea-db-password key: password - name: POSTGRES_DB value: gitea volumeMounts: - mountPath: /var/lib/postgresql/data subPath: data # important so it gets mounted properly name: git-db-data volumes: - name: git-db-data persistentVolumeClaim: claimName: do-storage-gitea-db Okay, there are a lot of things going on here, but the three things we need to note are the following:\nlabels: app: gitea-db Our network policy will look for this label to identify the pods which fell under its rule.\n- name: POSTGRES_PASSWORD valueFrom: secretKeyRef: name: gitea-db-password key: password The database password will come from a secret.\nvolumeMounts: - mountPath: /var/lib/postgresql/data subPath: data # important so it gets mounted properly name: git-db-data volumes: - name: git-db-data persistentVolumeClaim: claimName: do-storage-gitea-db We also need a persistent volume otherwise the data will be lost on each pod restart.\n--- apiVersion: v1 kind: PersistentVolumeClaim metadata: namespace: powerhouse name: do-storage-gitea-db spec: accessModes: - ReadWriteOnce resources: requests: storage: 10Gi storageClassName: do-block-storage Service We also need a Service so Gitea will be able to reach it. This isn\u0026rsquo;t public though so a NodePort is enough with no clusterIP.\nkind: Service apiVersion: v1 metadata: namespace: powerhouse name: gitea-db-service spec: ports: - port: 5432 selector: app: gitea-db clusterIP: None In order to reach this DB we can use a URL like this now from the Gitea app: gitea-db-service.powerhouse.svc.cluster.local:5432.\nNetworkPolicy We want the Gitea app to be able to reach it. Which means in-out to the Gitea app and nothing else.\napiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: gitea-db-network-policy namespace: powehouse spec: podSelector: matchLabels: app: gitea-db policyTypes: - Ingress - Egress ingress: - from: - podSelector: matchLabels: app: gitea ports: - protocol: TCP port: 5432 egress: - to: - podSelector: matchLabels: app: gitea ports: - protocol: TCP port: 5432 We can test this now by exec-ing into the Pod of the DB deployment and trying to ping google.com for example. It should be denied. Yet later, when we deploy our Gitea app, that should be able to talk to the DB instance.\nSecret Finally, we have a Secret which contains our db password base64 encoded.\napiVersion: v1 kind: Secret metadata: namespace: cronohub name: gitea-db-password type: Opaque data: password: Z2l0ZWE= That says password123. To get it, you can run something like echo -n \u0026quot;password123\u0026quot; | base64.\nGitea App ini Huh, with that done, we can go on with the application ini file. This can be configured via environment properties but once you get over a dozen configuration entries, it\u0026rsquo;s just easier to use an app.ini. My app ini is large, so I won\u0026rsquo;t post it here. I could mount it in as a file, but that proved to be difficult or not work at all properly because Gitea is running under a different user than root. Also, once the mount happened the fact the gitea was trying to write into it caused problems. Mounting as a different user didn\u0026rsquo;t work out either, so I\u0026rsquo;m using an InitContainer to do the job. They are there for that reason. And it was actually a hell of a lot simpler than doing file mounting.\nThe app.ini is defined as a ConfigMap like this:\nkubectl create configmap gitea-app-ini --from-file=app.ini --namespace powerhouse This was done from the folder where my app.ini was residing.\nDeployment Now comes the big gun. The Gitea deployment file. This is how it looks like in all its glory:\napiVersion: apps/v1 kind: Deployment metadata: namespace: cronohub name: gitea-app labels: app: gitea spec: replicas: 1 selector: matchLabels: app: gitea template: metadata: labels: app: gitea app.kubernetes.io/name: gitea app.kubernetes.io/instance: gitea spec: initContainers: - name: init-disk image: busybox:latest command: - /bin/chown - 1000:1000 # we set the gid and uid of the user for gitea. - /data volumeMounts: - name: git-data mountPath: \u0026#34;/data\u0026#34; readOnly: false - name: init-app-ini image: busybox:latest command: [\u0026#39;sh\u0026#39;, \u0026#39;-c\u0026#39;, \u0026#39;mkdir -p /data/gitea/conf/; cp /data/app.ini /data/gitea/conf\u0026#39;] volumeMounts: - name: git-data mountPath: \u0026#34;/data\u0026#34; readOnly: false - name: gitea-app-ini-conf mountPath: /data/app.ini subPath: app.ini readOnly: false containers: - name: gitea image: gitea/gitea:1.9.2 env: - name: DB_PASSWD valueFrom: secretKeyRef: name: gitea-db-password key: password - name: DB_TYPE valueFrom: configMapKeyRef: name: gitea-config-map key: DB_TYPE - name: DB_HOST valueFrom: configMapKeyRef: name: gitea-config-map key: DB_HOST - name: DB_NAME valueFrom: configMapKeyRef: name: gitea-config-map key: DB_NAME - name: DB_USER valueFrom: configMapKeyRef: name: gitea-config-map key: DB_USER ports: - containerPort: 3000 name: gitea-http - containerPort: 22 name: gitea-ssh volumeMounts: - mountPath: /data name: git-data readOnly: false volumes: - name: git-data persistentVolumeClaim: claimName: do-storage-gitea - name: gitea-app-ini-conf configMap: name: gitea-app-ini The important bit is the initContainer section. What\u0026rsquo;s happening here? We mount the app.ini file to the init container under /data. The awesome part about the initContainer is that the real container will have access to the file system the init container created.\nSo we take that file, fix the permissions on it and copy it to the right location under /data/gitea/conf for the Gitea app to work with.\nDone!\nAnd the configMap is simple:\napiVersion: v1 kind: ConfigMap metadata: namespace: powerhouse name: gitea-config-map data: APP_COLOR: blue APP_MOD: prod DB_TYPE: postgres DB_HOST: \u0026#34;gitea-db-service.cronohub.svc.cluster.local:5432\u0026#34; DB_NAME: gitea DB_USER: gitea SSH Normally, Ingress only allows HTTP based traffic control. But what would an ingress be without also regular TCP based routing?\nBut it\u0026rsquo;s not trivial. Nginx Ingress provides a documentation for this here: Exposing TCP and UDP services. What does that mean in practice?\nYou see we are also exposing port 22 on the container:\n- containerPort: 22 name: gitea-ssh I choose to differentiate my SSH port for Gitea from port 22 because that\u0026rsquo;s just cumbersome to get done right. Gitea provides an explanation on how to do port 22 forwarding in a docker container with a custom git command which forwards commands to the container itself. This is all just plain too much to worry about.\nI have this in the app.ini:\nSSH_PORT = \u0026lt;port of my choosing\u0026gt; And then this in the Service definition:\nkind: Service apiVersion: v1 metadata: namespace: powerhouse name: gitea labels: app: gitea app.kubernetes.io/name: gitea app.kubernetes.io/instance: gitea spec: selector: app: gitea app.kubernetes.io/name: gitea app.kubernetes.io/instance: gitea ports: - name: http port: 3000 targetPort: gitea-http - name: ssh port: \u0026lt;port of my choosing\u0026gt; targetPort: gitea-ssh protocol: TCP And then, we edit the nginx-controller deployment like this:\nkubectl edit deployment.apps/nginx-ingress-controller And add this line --tcp-services-configmap=cronohub/gitea-ssh-service to the container\u0026rsquo;s args field:\ncontainers: - args: - /nginx-ingress-controller - --default-backend-service=default/nginx-ingress-default-backend - --election-id=ingress-controller-leader - --ingress-class=nginx - --configmap=default/nginx-ingress-controller - --tcp-services-configmap=powerhouse/gitea-ssh-service One more thing is that we have to open that port on the load balancer as well to get traffic to it. To that end, edit the nginx ingress service as well:\nkubectl edit services/nginx-ingress-controller And add the exposed port:\n- name: ssh port: \u0026lt;port of my choosing\u0026gt; protocol: TCP targetPort: \u0026lt;port of my choosing\u0026gt; There will probably be a nodePort section in there on the other ports. Ignore that for your change.\nAlso, if you are doing the nginx installation by hand, just add this or save the yaml file from those deployments like this:\nkubectl get service/nginx-ingress-controller -o yaml \u0026gt; nginx-ingress-controller.yaml So you can deploy / modify it later on.\nFinished Gitea And with that, visit gitea.powerhouse.com and it should work including HTTPS and SSH!\nYou can now clone repositories like this: git clone ssh://git@gitea.powerhouse.com:1234/user/awesome_project.git after you created your user.\nUser creation is done by using the gitea admin CLI tool described here: Gitea Documentation.\nIt is important to note that we don\u0026rsquo;t use latest anywhere. It\u0026rsquo;s just not good if you are trying to update a service later on. We could set ImagePolicy to AlwaysPull but that\u0026rsquo;s just not a good thing to do if you have a 2 gig image. Always use version and policy imagePullPolicy: IfNotPresent to save yourself some bandwidth.\nIdle Checker Let\u0026rsquo;s create a last resource, then we\u0026rsquo;ll call it a day.\nThe idle RPG is a cool little game that you play by\u0026hellip; not playing. At all. If you play, you get penalties. Here is a cool resource to start: Idle RPG. It looks something like this:\n21:56 \u0026lt;@IdleBot\u0026gt; Verily I say unto thee, the Heavens have burst forth, and the blessed hand of God carried ganome 0 days, 03:52:11 toward level 45. 21:56 \u0026lt;@IdleBot\u0026gt; ganome reaches next level in 0 days, 01:49:16. 22:02 \u0026lt;@IdleBot\u0026gt; himuraken, the level 77 Mage Of BitFlips, is now online from nickname himuraken. Next level in 11 days, 10:35:53. 22:14 \u0026lt;@IdleBot\u0026gt; Nechayev, Sundance, and simple [2011/2347] have team battled HeavyPodda, Sixbierehomme, and L [1417/2717] and won! 0 days, 06:14:54 is removed from their clocks. 22:18 \u0026lt;@IdleBot\u0026gt; canton7 saw an episode of Ally McBeal. This terrible calamity has slowed them 0 days, 05:10:53 from level 85. 22:18 \u0026lt;@IdleBot\u0026gt; canton7 reaches next level in 2 days, 00:21:36. 22:26 \u0026lt;@IdleBot\u0026gt; Tor [4/1142] has challenged Brainiac [232/817] in combat and lost! 3 days, 23:06:05 is added to Tor\u0026#39;s clock. 22:26 \u0026lt;@IdleBot\u0026gt; Tor reaches next level in 39 days, 23:39:35. It could happen that by some misfortune the bouncer gets restarted and it doesn\u0026rsquo;t log you back in. Or you simply just lose connection and you don\u0026rsquo;t re-connect. That is unacceptable because the point is to be present. Otherwise you don\u0026rsquo;t play. So you need an early warning in case you are offline. Luckily, IdleRPG provides an XML based endpoint to get which contains your status.\nFrom there, I\u0026rsquo;m using mailgun with a registered domain to send me an email in case my status is offline. For that, here is a small Go program IdleRPG Checker Go Code.\nTo put that into a Docker container, here is a Dockerfile:\nFROM golang:latest as build RUN go get -v github.com/sirupsen/logrus \u0026amp;\u0026amp; \\ go get -v github.com/mailgun/mailgun-go COPY ./main.go /code/ WORKDIR /code RUN CGO_ENABLED=0 GOOS=linux go build -a -installsuffix cgo -o /idlerpg-checker . FROM alpine:latest RUN apk --no-cache add ca-certificates COPY --from=build /idlerpg-checker /idlerpg-checker RUN echo \u0026#34;v0.0.1\u0026#34; \u0026gt;\u0026gt; .version ENTRYPOINT [\u0026#34;/idlerpg-checker\u0026#34;] And the corresponding cronjob resource definition:\napiVersion: batch/v1beta1 kind: CronJob metadata: name: idle-checker namespace: idle-checker spec: schedule: \u0026#34;*/20 * * * *\u0026#34; jobTemplate: spec: template: spec: containers: - name: idle-checker image: skarlso/idle-checker imagePullPolicy: IfNotPresent env: - name: MG_API_KEY valueFrom: secretKeyRef: name: idle-rpg-secret key: MG_API_KEY - name: MG_DOMAIN valueFrom: secretKeyRef: name: idle-rpg-secret key: MG_DOMAIN args: [\u0026#39;-username\u0026#39;, \u0026#39;username\u0026#39;, \u0026#39;-email\u0026#39;, \u0026#39;user@powerhouse.com\u0026#39;] restartPolicy: OnFailure Aaaand, the secret for the API key:\napiVersion: v1 kind: Secret metadata: namespace: idle-checker name: idle-rpg-secret type: Opaque data: MG_API_KEY: asdf= MG_DOMAIN: asdf== Done. Huh. This will run every 20 minutes and check if the user with username username is online. If not, it will send an email to the given email address. Your levels are safe.\nClosing words Phew. This has been quite the ride. The post is now really long, so I will split the rest out into a Part 2. That is, Athens and Monitoring.\nThank you for reading this far!\nCheers, Gergely.\n","permalink":"https://skarlso.github.io/2019/09/21/kubernetes-cluster/","summary":"Intro Hi folks.\nToday, I would like to show you how my infrastructure is deployed and managed. Spoiler alert, I\u0026rsquo;m using Kubernetes to do that.\nI know\u0026hellip; What a twist!\nLet\u0026rsquo;s get to it.\nWhat What services am I running exactly? Here is a list I\u0026rsquo;m running at the time of this writing:\nAthens Go Proxy Gitea The Lounge (IRC bouncer) Two CronJobs Fork Updater IDLE RPG online checker My WebSite (gergelybrautigam.","title":"Using a Kubernetes based Cluster for Various Services with auto HTTPS"},{"content":"I had a lot of fun using Procreate to re-draw the architecture image I\u0026rsquo;ve drawn for my distribute face recognition application detailed in this post Distributed Face-Recognition App.\nWithout much fanfare, here is the drawing:\nThanks, Gergely.\n","permalink":"https://skarlso.github.io/2019/09/19/updated-face-recog-drawing/","summary":"I had a lot of fun using Procreate to re-draw the architecture image I\u0026rsquo;ve drawn for my distribute face recognition application detailed in this post Distributed Face-Recognition App.\nWithout much fanfare, here is the drawing:\nThanks, Gergely.","title":"Updated Face-recog architecture drawing"},{"content":"Intro Hi folks!\nToday I would like to write about a metric that I read in a book called Clean Architecture from Robert Cecil Martin ( Uncle Bob ).\nAbstract The metrics I mean are Efferent and Afferent coupling in packages. So you, dear reader, don\u0026rsquo;t have to navigate away from this page, here are the descriptions pasted in:\nAfferent couplings (Ca): The number of classes in other packages that depend upon classes within the package is an indicator of the package\u0026rsquo;s responsibility. Afferent couplings signal inward. (Affected by this package) (Fan-In).\nEfferent couplings (Ce): The number of classes in other packages that the classes in this package depend upon is an indicator of the package\u0026rsquo;s dependence on externalities. Efferent couplings signal outward. (Effecting this package) (Fan-Out).\nThese metrics used together will indicate the stability / instability of each package in a project.\nMetric Usage What does it mean if the package is stable vs. unstable? Let\u0026rsquo;s take a closer look.\nUnstable If the instability metric comes out as 1 or close to 1, that means that the package is unstable. It means that there are only packages which this package is depending upon and nothing, or only 1 or 2, packages depend on it. This infers two things:\nThe package is easy to change since there is nothing depending on the behavior explicitly The package is volatile since it depends on a lot of out side things The first one is self-explanatory. The second one has ramifications. These ramifications are that there are a lot of packages that could cause bugs in this package. Ideally, a package with instability 1 or high, requires a large test coverage to ensure that no bugs seep in.\nStable On the other spectrum lies the indicator for a stable package. If this metric is 0 or close to 0, the package is said to be stable. A stable package resists change because it has a lot of depending packages. The depending packages lock this package in place, meaning we can\u0026rsquo;t change the package easily. Ideally this is the package that would contain business logic for example, or code which does not change often.\nAppliance in Go ecosystem The book was using mostly Java or C/C++ for examples and dealt with classes describing these metrics. Especially the Abstractness of a package which calculates as ratio of abstract classes + interfaces vs concrete classes and implementations. This isn\u0026rsquo;t that easy to define in Go. Not impossible though and we could still get something close enough. Something like, count interfaces + structs vs implementations of said interfaces with function receivers and functions.\nThe easier of these is the coupling metrics. I think we can define them since Go also has import statements. Go doesn\u0026rsquo;t have classes, but it\u0026rsquo;s enough if we calculate the number of packages that said package depends upon and are depended upon by. Should be close enough.\nTool If there is a project with a lot of packages and files, it would be quite difficult to calculate things using your hands\u0026hellip; Hence, Effrit. This tool, at the writing of this post, only calculates the stability metric for now. If given a parameter like -p effrit it will only calculate the Fan-Out metrics considering project packages. If no project name is given, it will also calculate not project packages (for example cobra or aws sdk) as Efferent. Usage is really simple. Navigate to the root of the project and run effrit scan -p \u0026lt;projectname\u0026gt;.\nApplying the tool Let\u0026rsquo;s see with a real example on using the tool and what to do with the metrics it provides.\nI have a project called Furnace. Running the tool on it I get the following stats:\n.\nWhat do these means?\nIt means, that hopefully, command packages have a high coverage and that config packages don\u0026rsquo;t require change that often. The coverage count for aws command package is:\ncoverage: 74.7% of statements\nThat is pretty good. I think it\u0026rsquo;s covered well enough for now.\nOn to the config package. This is the whole file:\npackage config import ( \u0026#34;os/user\u0026#34; \u0026#34;path/filepath\u0026#34; \u0026#34;github.com/go-furnace/go-furnace/handle\u0026#34; ) // Spinners is a collection os spinner types var Spinners = []string{`←↖↑↗→↘↓↙`, `▁▃▄▅▆▇█▇▆▅▄▃`, `┤┘┴└├┌┬┐`, `◰◳◲◱`, `◴◷◶◵`, `◐◓◑◒`, `⣾⣽⣻⢿⡿⣟⣯⣷`, `|/-\\`} // WAITFREQUENCY global wait frequency default. var WAITFREQUENCY = 1 // STACKNAME is the default name for a stack. var STACKNAME = \u0026#34;FurnaceStack\u0026#34; // SPINNER is the index of which spinner to use. Defaults to 7. var SPINNER = 7 // Path retrieves the main configuration path. func Path() string { // Get configuration path usr, err := user.Current() handle.Error(err) return filepath.Join(usr.HomeDir, \u0026#34;.config\u0026#34;, \u0026#34;go-furnace\u0026#34;) } Not a lot of stuff in there. But it\u0026rsquo;s using the handle package. Hence the 0.2. Luckily, we also have some coverage to take care of that.\nThe handle is pretty stable. Let\u0026rsquo;s take a peak inside:\npackage handle import \u0026#34;log\u0026#34; // LogFatalf is used to define the fatal error handler function. In unit tests, this is used to // mock out fatal errors so we can test for them. var LogFatalf = log.Fatalf // Error extracts the if err != nil check. If the given error is not nil it will call // the defined fatal error handler function. func Error(err error) { if err != nil { Fatal(\u0026#34;Error occurred:\u0026#34;, err) } } // Fatal is a wrapper for LogFatalf function. It\u0026#39;s used to throw a Fatal in case it needs to. func Fatal(s string, err error) { LogFatalf(s, err) } Basic logic to take care of errors in Furnace. Last time I changed this file was\u0026hellip; a year ago. Yeah, I think it\u0026rsquo;s doing fine.\nConclusion And that\u0026rsquo;s it. Hopefully this is an interesting metric to use to define what packages may need refactoring, or need to be repurposed because they are too rigid. If a packages is stable, aka. hard to change but must undergo changes frequently, it may be time to refactor and introduce a mediator or a liaison package. If a package is unstable and has a lot of bugs, we might want to refactor it and inverse it\u0026rsquo;s dependencies. This is called the Dependency Inversion Principle, DIP. Which is also described in the same book. However it\u0026rsquo;s not always bad if a package is unstable. Maybe it contains code which needs to change frequently. It\u0026rsquo;s a database schema code. Or an algorithm which requires constant tweaking. And that is fine. Just make sure it\u0026rsquo;s covered well enough.\nThe principles that these metrics are based on are: SAP and SDP. Stable Abstraction Principle and Stable Dependencies Principle. These are also described in the same book, Clean Architecture. A highly recommend it. Applying these principles could help maintain the project\u0026rsquo;s stability and it\u0026rsquo;s dependencies.\nThank you for reading, Gergely.\n","permalink":"https://skarlso.github.io/2019/04/21/efferent-and-afferent-metrics-in-go/","summary":"Intro Hi folks!\nToday I would like to write about a metric that I read in a book called Clean Architecture from Robert Cecil Martin ( Uncle Bob ).\nAbstract The metrics I mean are Efferent and Afferent coupling in packages. So you, dear reader, don\u0026rsquo;t have to navigate away from this page, here are the descriptions pasted in:\nAfferent couplings (Ca): The number of classes in other packages that depend upon classes within the package is an indicator of the package\u0026rsquo;s responsibility.","title":"Efferent and Afferent metrics in Go"},{"content":"Hi folks!\nToday’s post is a retrospective. I would like to gather some thoughts about living with the new parser that I wrote for JsonPath.\nAfter a little over a year, some interesting problems surfaced that I thought I’d share for people who also would like to endeavor on this path. Let’s begin.\nPreviously About, two years ago, I took over managing / fixing / improving this ruby gem: Json Parser. It\u0026rsquo;s a json parser in ruby. Amongst other problems, it used eval in the background to evaluate expressions. It was a security risk to use this gem to its full extent. Something had to be done about that.\nI proceeded to write a semi-language parser which replaced eval that can be found here: Parser. The basic intention was to replace the bare minimum of the eval behavior, and so, it was lacking some serious logic. That got improved as time went by.\nThis is a one year retrospective on living with a self-written parser. Enjoy some of the quirks I faced so you don\u0026rsquo;t have to.\nAST AST is short for Abstract Syntax Tree. It’s a data structure that is ideal for representing and parsing language syntax. All major lexers use some kind of AST in the background like this old Ruby language parser gem: Whitequark Parser. This parser is used by projects like Rubocop and line coverage reports. It\u0026rsquo;s usage is not trivial right out of the box. But as you move along you get a firm grasp of true potential.\nI decided to not use that parser a year ago mainly because I thought it’s too much for what I’m trying to accomplish. Maybe I was right, maybe not. I tried to play with Parser recently but it’s none trivial nature and lack of documentation makes it cumbersome to use.\nThe first problems What was then the first trouble that arose after I replaced eval? The parser back then was dumbed down a lot. The bug I faced was a simple infinite loop. The parser works like a lexer. It identifies tokens of certain type and tries to parse them into variables. This lexing had an error.\n- elsif t = scanner.scan(/(\\s+)?\u0026#39;?(\\w+)?[.,]?(\\w+)?\u0026#39;?(\\s+)?/) # @TODO: At this point I should trim somewhere... + elsif t = scanner.scan(/(\\s+)?\u0026#39;?.*\u0026#39;?(\\s+)?/) It was caught by this Json Path:\n$.acceptNewTasks.[?(@.taskEndpoint == \u0026#34;mps/awesome\u0026#34;)].lastTaskPollTime The culprit was the / character. The tokenizer wasn’t prepared…\nEval would have no problem but the parser is using strict regex-s. This is where an AST would have had more luck.\nNumbers The second problem was the fact that the parser is using strings. Who would have thought that the string 2.0 in fact does not equal to string 2? In Ruby the simplest way of making sure a variable is a Number is by casting the variable to Number or Float. In case it’s not a Number we rescue and move on.\nel = Float(el) rescue el Incidentally this also solved the problem where the json path contained a number but since everything is a string this, also did not equal: '1' == 1.\nSince first the string needed to be a Number.\nSupporting regexes Next came supported operators. The parser only supported the basic operators: \u0026lt;\u0026gt;=. It was missing =~ from this. Which meant people who would use regexes to filter JSON would no longer be able to do so. This was only a tiny modification actually:\nFirst, the operator filter needed to be aware\u0026hellip;\n- elsif t = scanner.scan(/(\\s+)?[\u0026lt;\u0026gt;=][=\u0026lt;\u0026gt;]?(\\s+)?/) + elsif t = scanner.scan(/(\\s+)?[\u0026lt;\u0026gt;=][=~]?(\\s+)?/) With that done, we just .to_regexp it with the power of ruby and send would automatically pick it up. And of course test coverage.\nRegression Once the parser was introduced I knew that it would create problems, since eval did many things that the parser could not handle. And they started to arrive slowly. One-by-one.\nBooleans Aka, the story of true == 'true'\u0026hellip; Inherently working with strings here makes it difficult to detect when the type boolean is meant or a string which happens to say true. This one was easy to solve as well in the end:\noperand = if t == \u0026#39;true\u0026#39; true elsif t == \u0026#39;false\u0026#39; false else operator.to_s.strip == \u0026#39;=~\u0026#39; ? t.to_regexp : t.gsub(%r{^\u0026#39;|\u0026#39;$}, \u0026#39;\u0026#39;).strip # We also handle regexp here. end Ignoring the regex part, this was all it needed.\nSyntax Some smaller tid-bits here and there also started to crop up. Things that eval did not mind at all, but my poor Parser couldn\u0026rsquo;t handle. The regex started out tightly tied. This meant that certain characters weren\u0026rsquo;t properly detected. Characters like the underscore, or @ or /\u0026hellip; All these weren\u0026rsquo;t picked up by my tight regexp. I had to widen it a bit using .* at certain places.\nNumber formatting Formatting and comparing numbers gave me a lot of headache. I had to detect whether I’m dealing with a number or a string parsed as a number or a number but that was converted into string or a string that happened to be a number. Geez…\nI ended up making it simple like this:\nel = Float(el) rescue el operand = Float(operand) rescue operand Basically everything is a number. Doesn’t matter where it came from, what it was in the past… It’s a number if it can be converted. This, of course, also means that a test like this one fails:\ndef test_number_match json = { channels:[ { elem: 1, }, { elem: \u0026#39;1\u0026#39; } ] }.to_json assert_equal [{ \u0026#39;elem\u0026#39; =\u0026gt; 1 }], JsonPath.on(json, \u0026#34;$..channels[?(@.elem == 1)]\u0026#34;) end Both will match… Even though you’d expect it only to match one. Luckily though… this is exactly how http://jsonpath.com/ works as well. An AST would detect that it’s a number type… But since I’m parsing strings here, that would be almost impossible a feat to accomplish in a nice manner.\nGroups And finally, the biggest one… Groups in conditions. A query like this one for example:\n$..book[?((@[\u0026#39;author\u0026#39;] == \u0026#39;Evelyn Waugh\u0026#39; || @[\u0026#39;author\u0026#39;] == \u0026#39;Herman Melville\u0026#39; \u0026amp;\u0026amp; (@[\u0026#39;price\u0026#39;] == 33 || @[\u0026#39;price\u0026#39;] == 9))] Something like this was never parsed correctly. Since the parser didn’t understand grouping and order of evaluation. Let’s break it down. How do we get from a monstrous like that one above to something that can be handled? We take it one group at a time.\nParentheses As a first step, we make sure that the parentheses match. It’s possible that someone didn’t pay attention and left out a closing parentheses. Now, there are a couple of way of doing that in Ruby, but I went for the most plain blatant one.\ndef check_parenthesis_count(exp) return true unless exp.include?(\u0026#34;(\u0026#34;) depth = 0 exp.chars.each do |c| if c == \u0026#39;(\u0026#39; depth += 1 elsif c == \u0026#39;)\u0026#39; depth -= 1 end end depth == 0 end A basic depth counter. We do this first, to avoid parsing an invalid query.\nBreaking it down Next we break down this complex thing into a query that makes more sense to the parser. To do that, we take each group and extract the operation in them and replace it with the value they provide. Meaning a query like the one above essentially should look like this:\n((false || false) \u0026amp;\u0026amp; (false || true)) Neat. This is handled by this code segment: Parser.\nThe parsing function is called over and over again until there are no parentheses left in the expression. Aka, a single true or false or number remains.\nNow, who can spot an issue with that? The function bool_or_exp is there to return a float or a boolean value. If it returns a float, we still \u0026amp;\u0026amp;= -it together with the result\u0026hellip; Thus, if there is a query like this one for example:\n$..book[?(@.length-5 \u0026amp;\u0026amp; @.type == \u0026#39;asdf\u0026#39;)] This would fail horribly. Which means, asking for a specific index in a json in a grouped expression is not supported at the moment.\nReturn Value The parser doesn’t just return a bool value and call it a day. It also returns indexes like you read above. Indexes in cases when there is a query that returns the location of an item in the node and not if the node contains something or matches some data. For example:\n$..book[(@.length-5)] Returns the length-5-th book.\nOutstanding issues Right now there are two outstanding issues. The one mentioned above, where you can’t nest indexes and true/false notations. And the other is a submitted issue in which it’s described that it’s not possible to use something like this:\n$.phoneNumbers[?(@[0].type == \u0026#39;home\u0026#39;)] Which basically boils down to the fact that Jsonpath can’t handle nested lists like these:\n{ \u0026#34;phoneNumbers\u0026#34;: [ [{ \u0026#34;type\u0026#34; : \u0026#34;iPhone\u0026#34;, \u0026#34;number\u0026#34;: \u0026#34;0123-4567-8888\u0026#34; }], [{ \u0026#34;type\u0026#34; : \u0026#34;home\u0026#34;, \u0026#34;number\u0026#34;: \u0026#34;0123-4567-8910\u0026#34; }] ] } That isn’t actually the problem of the parser, but Jsonpath itself.\nConclusion Like a good marriage, living with a Parser is a lot of compromise and ironing out edges and working on making it better for both parties involved. I have no doubt that there are more bugs in this code, but I\u0026rsquo;m trying to keep it concise and clear to read as much as possible.\nI hope this was as fun to read as it was to write.\nThank you for reading,\nGergely.\n","permalink":"https://skarlso.github.io/2019/04/12/living-with-a-parser/","summary":"Hi folks!\nToday’s post is a retrospective. I would like to gather some thoughts about living with the new parser that I wrote for JsonPath.\nAfter a little over a year, some interesting problems surfaced that I thought I’d share for people who also would like to endeavor on this path. Let’s begin.\nPreviously About, two years ago, I took over managing / fixing / improving this ruby gem: Json Parser.","title":"Living with a new Parser for a year"},{"content":"Intro Hi folks.\nToday I thought I show you how you can use Github Actions to deploy a hugo based blog like this one.\nLet\u0026rsquo;s dive in.\nActions What are actions? If you read the above linked document they are basically steps performed in containers based on some events that happened with your repository. Events can be such as pushing, creating a PR or creating/closing an issue etc.\nWe need an even on a push.\nActions is in beta right now so much of the documentation has some gaps but they are fairly okay. I recommend reading through this one carefully: Developer Guide. This describes for example accessing the environment. That is important because we will need to access the generated content from one action in the next action.\nDockerfile Each action requires a Dockerfile which will be used to create a container to run this particular action in. The Dockerfile uses LABELS to mark a container. It is recommended to create an ENTRYPOINT in the Dockerfile that can work with CMDs passed in from the action.\nFor example my pusher container has the ability to push into any repository thanks to using arguments for the entrypoint.sh script.\nWe\u0026rsquo;ll see that later on.\nBlog actions Let\u0026rsquo;s look at the two actions in detail which we\u0026rsquo;ll be using.\nBuilder First, we need to build the blog. This is accomplished pretty much the same as I wrote earlier in the travis blog part but with a little extra information.\nThis is the Dockerfile:\nFROM golang:latest LABEL \u0026#34;name\u0026#34;=\u0026#34;Hugo Builder\u0026#34; LABEL \u0026#34;maintainer\u0026#34;=\u0026#34;Gergely Brautigam \u0026lt;gergely@gergelybrautigam.com\u0026gt;\u0026#34; LABEL \u0026#34;version\u0026#34;=\u0026#34;0.1.0\u0026#34; LABEL \u0026#34;com.github.actions.name\u0026#34;=\u0026#34;Go Builder\u0026#34; LABEL \u0026#34;com.github.actions.description\u0026#34;=\u0026#34;Build a hugo blog\u0026#34; LABEL \u0026#34;com.github.actions.icon\u0026#34;=\u0026#34;package\u0026#34; LABEL \u0026#34;com.github.actions.color\u0026#34;=\u0026#34;#E0EBF5\u0026#34; RUN \\ apt-get update \u0026amp;\u0026amp; \\ apt-get install -y ca-certificates openssl git \u0026amp;\u0026amp; \\ update-ca-certificates \u0026amp;\u0026amp; \\ rm -rf /var/lib/apt RUN go get github.com/gohugoio/hugo COPY entrypoint.sh /entrypoint.sh ENTRYPOINT [\u0026#34;/entrypoint.sh\u0026#34;] Pretty simple. The entrypoint script looks like this:\n#!/bin/bash set -e set -x set -o pipefail if [[ -z \u0026#34;$GITHUB_WORKSPACE\u0026#34; ]]; then echo \u0026#34;Set the GITHUB_WORKSPACE env variable.\u0026#34; exit 1 fi if [[ -z \u0026#34;$GITHUB_REPOSITORY\u0026#34; ]]; then echo \u0026#34;Set the GITHUB_REPOSITORY env variable.\u0026#34; exit 1 fi root_path=\u0026#34;$GITHUB_WORKSPACE\u0026#34; echo \u0026#34;Root path is: ${root_path}\u0026#34; blog_path=\u0026#34;$GITHUB_WORKSPACE/.blog\u0026#34; echo \u0026#34;Blog path is: ${blog_path}\u0026#34; mkdir -p \u0026#34;$blog_path\u0026#34; mkdir -p \u0026#34;$root_path\u0026#34; cd \u0026#34;$root_path\u0026#34; echo \u0026#34;Preparing to build blog\u0026#34; hugo --theme hermit echo \u0026#34;Building is done. Copying over generated files\u0026#34; cp -R public/* \u0026#34;$blog_path\u0026#34;/ echo \u0026#34;Copy is done.\u0026#34; exit 0 The interesting parts here are GITHUB_WORKSPACE and GITHUB_REPOSITORY. The workspace is where the repository is located at.\nThis is the place where we will copy our built blog files. Since this is a mount basically on the local build machine the next action which comes along will see the folder .blog. This is how we pass artifacts between actions.\nThis action can be found here: Hugo Blog Builder Action.\nPublisher Once the building finishes successfully we can push it to the new location.\nDockerfile is similar to the one above in every regard. Except for the name and that it doesn\u0026rsquo;t need Hugo and the command\u0026hellip;\nFROM golang:latest LABEL \u0026#34;name\u0026#34;=\u0026#34;Hugo Pusher\u0026#34; LABEL \u0026#34;maintainer\u0026#34;=\u0026#34;Gergely Brautigam \u0026lt;gergely@gergelybrautigam.com\u0026gt;\u0026#34; LABEL \u0026#34;version\u0026#34;=\u0026#34;0.1.0\u0026#34; LABEL \u0026#34;com.github.actions.name\u0026#34;=\u0026#34;Go Pusher\u0026#34; LABEL \u0026#34;com.github.actions.description\u0026#34;=\u0026#34;Push a hugo blog\u0026#34; LABEL \u0026#34;com.github.actions.icon\u0026#34;=\u0026#34;package\u0026#34; LABEL \u0026#34;com.github.actions.color\u0026#34;=\u0026#34;#E0EBF5\u0026#34; RUN \\ apt-get update \u0026amp;\u0026amp; \\ apt-get install -y ca-certificates openssl git \u0026amp;\u0026amp; \\ update-ca-certificates \u0026amp;\u0026amp; \\ rm -rf /var/lib/apt COPY entrypoint.sh /entrypoint.sh ENTRYPOINT [\u0026#34;/entrypoint.sh\u0026#34;] CMD [\u0026#34;Skarlso/skarlso.github.io.git\u0026#34;] Why do we require the CMD? Let\u0026rsquo;s take a look at the script.\n#!/bin/bash set -e set -x if [[ -z \u0026#34;$GITHUB_WORKSPACE\u0026#34; ]]; then echo \u0026#34;Set the GITHUB_WORKSPACE env variable.\u0026#34; exit 1 fi if [[ -z \u0026#34;$GITHUB_REPOSITORY\u0026#34; ]]; then echo \u0026#34;Set the GITHUB_REPOSITORY env variable.\u0026#34; exit 1 fi setup_git() { repo=$1 git config --global user.email \u0026#34;bot@github.com\u0026#34; git config --global user.name \u0026#34;Github Actions\u0026#34; git init echo \u0026#34;Starting to clone blog repository\u0026#34; git remote add origin https://\u0026#34;${PUSH_TOKEN}\u0026#34;@github.com/\u0026#34;${repo}\u0026#34; \u0026gt; /dev/null 2\u0026gt;\u0026amp;1 git pull origin master echo \u0026#34;Cloning is done\u0026#34; ls -l } commit_website_files() { git add . git commit -am \u0026#34;Github Action Build ${GITHUB_SHA}\u0026#34; } upload_files() { git push --quiet --set-upstream origin master } echo \u0026#34;Beginning publishing workflow\u0026#34; repo=$1 if [ -z \u0026#34;${repo}\u0026#34; ]; then echo \u0026#34;Repo must be defined.\u0026#34; exit 1 fi echo \u0026#34;Using repository ${repo} to push to\u0026#34; mkdir /opt/publish \u0026amp;\u0026amp; cd /opt/publish blog_path=\u0026#34;$GITHUB_WORKSPACE/.blog\u0026#34; echo \u0026#34;Blog is located at: ${blog_path}\u0026#34; ls -l \u0026#34;${blog_path}\u0026#34; echo \u0026#34;Setting up git\u0026#34; setup_git \u0026#34;${repo}\u0026#34; cp -R \u0026#34;${blog_path}\u0026#34;/* . echo \u0026#34;Copied over generated content from blog path. Committing.\u0026#34; commit_website_files echo \u0026#34;Committed. Pushing.\u0026#34; upload_files echo \u0026#34;All done.\u0026#34; exit 0 Now this is a lot more involved. I\u0026rsquo;m leaving as many echos in here as possible for esae of debugging.\nThe interesting part in here is the repo=$1. This is why we need CMD specified. But this is what makes this Action a bit more flexible too. It can push anywhere it has access to.\nThis action can be found here: Hugo Blog Publisher Action.\nThe Workflow file How does this all fit together? You have to create a workflow file which looks something like this:\nworkflow \u0026#34;Publish Blog\u0026#34; { on = \u0026#34;push\u0026#34; resolves = [\u0026#34;blog-publisher\u0026#34;] } action \u0026#34;blog-builder\u0026#34; { uses = \u0026#34;skarlso/blog-builder@master\u0026#34; secrets = [\u0026#34;GITHUB_TOKEN\u0026#34;] } action \u0026#34;blog-publisher\u0026#34; { uses = \u0026#34;skarlso/blog-publisher@master\u0026#34; needs = [\u0026#34;blog-builder\u0026#34;] secrets = [\u0026#34;GITHUB_TOKEN\u0026#34;, \u0026#34;PUSH_TOKEN\u0026#34;] } This is located in your repositroy under .github/main.workdflow. Notice the secrets. GITHUB_TOKEN is created for you by Github. This is a basic token which lets you access the github API. But it can\u0026rsquo;t be used for pushing code. Thus, we need another token. This can be defined under your repository / settings / secrets. Once you have a token, add a new secret called PUSH_TOKEN and\u0026hellip; done.\nEverything should be ready to go.\nLocation of the actions Now, I read the doc and should have been possible to have these actions in the repositroy itself. However, I faced some problems with that setup so I ended up having actions in their respectice repository. That\u0026rsquo;s why uses is set up to be skarlso/\u0026lt;action-name\u0026gt;@branch.\nConclusion On a push now the blog is built and published. If a step fails it won\u0026rsquo;t be published. It\u0026rsquo;s actually a lot faster than my travis build was.\nThank you for reading,\nGergely.\n","permalink":"https://skarlso.github.io/2019/03/19/deploy-hugo-blog-github-actions/","summary":"Intro Hi folks.\nToday I thought I show you how you can use Github Actions to deploy a hugo based blog like this one.\nLet\u0026rsquo;s dive in.\nActions What are actions? If you read the above linked document they are basically steps performed in containers based on some events that happened with your repository. Events can be such as pushing, creating a PR or creating/closing an issue etc.\nWe need an even on a push.","title":"Deploy a Hugo Blog Github Actions"},{"content":"Intro Good afternoon folks.\nToday, I would like to talk a little bit about Cronohub. It\u0026rsquo;s a Python application which you can use to archive anything from anywhere to anywhere. It uses plugins to archive this versatility.\nLet me show you some of its features.\nMain Usage Cronohub is a python application which uses the power and ease of usage of Python to give the user a framework. This Framework can then be used to implement concrete functionality in the form of plugins.\nThe plugins provide the essential working logic for Cronohub. Cronohub itself, is basically a Hub for these plugins.\nWhat can Cronohub be actually used for? Say, you have a gazillion Github repositories you would like to archive to a S3 bucket. Or SCP to another server. Or to ownCloud\u0026hellip; You would use cronohub as such:\n❯ cronohub -s {github,gitlab} -t {s3,owncloud,scp} It is this simple. What\u0026rsquo;s going on here then? -s tells Cronohub to use a source plugin called github where as -t tells it to use a target plugin called s3 or owncloud or an scp operation.\nUnder the hood What happens then is that the source plugin downloads the repositories for a given user. The plugins themselves can require certain configuration options to be provided. Like environment properties. To get the Help of a plugin you can simply ask Cronohub like this:\n❯ cronohub help --source-help github Help (github source plugin): - Environment Property: CRONO_GITHUB_TOKEN: a token with access to listing repositories for a given user. - File that filters the list of repositories to archive. If not present, all will be archived. ~/.config/cronohub/configurations/github/.repo_list It will display help information for that plugin.\nOnce the source plugin finished downloading the requested repositories to a given location it will pass on a list of files to the target plugin for archiving. The target plugin takes this list of files and will add a timestamp to the file and upload them with the requested operation.\nThe plugins take care of parallelization or threading if this makes it faster. For example the github plugin downloads at most 5 archive files concurrently.\nPlugins What are plugins then? The plugins adhere to an ABC. An Abstract Base Class. This class defines the abilities and structure of a plugin. It looks like this:\nfrom abc import ABCMeta, abstractmethod class CronohubSourcePlugin(metaclass=ABCMeta): \u0026#34;\u0026#34;\u0026#34; This is the basic definition of a CronoHub plugin. \u0026#34;\u0026#34;\u0026#34; @abstractmethod def validate(self): ... @abstractmethod def help(self): ... @abstractmethod def fetch(self): \u0026#34;\u0026#34;\u0026#34; Returns a tuple (str, str) where there first parameter is the name of the archive and the second is the location as a full path. Exp: (\u0026#34;my-project-12345\u0026#34;, \u0026#34;/home/user/projects/my-project/my-project.tar.gz\u0026#34;) \u0026#34;\u0026#34;\u0026#34; ... Validation will be called before the plugin can be used. This method can be used to validate settings for a plugin, for example if a token is provided for the github plugin. Or a bucket name is defined for the S3 plugin etc.\nHelp will display information just like we saw above and fetch will actually perform the downloading or fetching of files to later archive.\nPlugins are located in this repository: Cronohub plugins.\nHopefully, at some point I\u0026rsquo;ll finish https://cronohub.org and then there will be an online repository for these.\nPlugins are located at ~/.config/cronohub/plugins/{target,source}. Each plugin must take care of its own dependencies via a requirements.txt file.\nRight now, there are only a few plugins available.\nSource Plugins Target Plugins Github S3 Gitlab SCP Local ownCloud No-Op More are hopefully on the way. Local is simply gathering a list of files from a folder. And no-op is what it says. It\u0026rsquo;s good for debugging a source plugin as it doesn\u0026rsquo;t do anything else but displays the files it got from the source plugin.\nInstallation Installing is dead trivial. Simply run:\npip install cronohub \u0026hellip; and that\u0026rsquo;s it. It\u0026rsquo;s published on pypi.org.\nContribution Plugin contributions are heartily welcomed!\nAnd that\u0026rsquo;s it.\nThank you for reading,\nGergely.\n","permalink":"https://skarlso.github.io/2019/03/19/cronohub/","summary":"Intro Good afternoon folks.\nToday, I would like to talk a little bit about Cronohub. It\u0026rsquo;s a Python application which you can use to archive anything from anywhere to anywhere. It uses plugins to archive this versatility.\nLet me show you some of its features.\nMain Usage Cronohub is a python application which uses the power and ease of usage of Python to give the user a framework. This Framework can then be used to implement concrete functionality in the form of plugins.","title":"Cronohub: Archive from anywhere to anywhere"},{"content":"Intro Hi folks.\nI\u0026rsquo;ve been using the Hugo build for wercker for a long time now. Recent problems occurred though where I did not understand at first what the problem was. It was quite difficult to debug since I did not have too much insight on the wercker build itself. Turned out that I deleted the GITHUB token that the process was using. However, the error message was telling me that a function failed to load some other function. Which was totally unrelated.\nThus, I thought that I\u0026rsquo;m going to shift away from this outside medium to a different one that I\u0026rsquo;m already familiar with and have greater control over.\nHence, Travis. Incidentally, since I will no longer be dependend on a third party component (which was the image wercker was using), I\u0026rsquo;ll be able to switch away from this build platform easily. For example, to CircleCI.\nI\u0026rsquo;m using github pages, but without the whole convoluted submodule init, different branch stuff. I find that that simply adds unnecessary complexity to the whole thing. I\u0026rsquo;m keeping the source and the website in a different repository.\nThe steps are simple:\nGet the source Generate the content locally using hugo Setup Git Get the source for the generated web site Copy in the newly generated code Push the code up to git Sounds simple\u0026hellip; In fact it\u0026rsquo;s so simple, it\u0026rsquo;s three files.\nTravis The travis modification is such:\nlanguage: go install: - go get github.com/gohugoio/hugo - sudo apt-get install -y git script: - .travis/build.sh after_success: - cd ${TRAVIS_BUILD_DIR} \u0026amp;\u0026amp; .travis/push.sh Easy, it\u0026rsquo;s a standard Go based travis file. There are two things here which stand out. The scripts section and the after_success section. Why after_success? Because if we made a mistake, we don\u0026rsquo;t want to destroy the website. Thus we only push in case build.sh was successful.\nBuilding In this light, building the blog is simple. In fact the whole script is such:\n#!/bin/sh set -e set -x mkdir /opt/blog git clone --recurse-submodules https://github.com/Skarlso/blogsource.git /opt/app echo Build started on `date` cd /opt/app hugo --theme hermit cp -R public/* /opt/blog For clone, --recurse-submodules is required because the theme is a submodule. Once this script runs successfull, we can push the new version of the site.\nPushing Pushing is a bit more involved. There are four steps involved in this process.\nSetup git First, we set up git to use some specific name so we know where the push came from.\nsetup_git() { git config --global user.email \u0026#34;travis@travis-ci.org\u0026#34; git config --global user.name \u0026#34;Travis CI\u0026#34; git init git remote add origin https://${GITHUB_TOKEN}@github.com/Skarlso/skarlso.github.io.git \u0026gt; /dev/null 2\u0026gt;\u0026amp;1 git pull origin master } Github token is a secret environment property. We also pull the blog source in this step.\nCopy Then copy everything from the built site\u0026rsquo;s public folder (which was we already copied to /opt/blog) to this folder.\ncp -R /opt/blog/* . Commit the changes commit_website_files() { git add . git commit -am \u0026#34;Travis build: $TRAVIS_BUILD_NUMBER\u0026#34; } This is extracted for clarity.\nPushing the changes upload_files() { git push --quiet --set-upstream origin master } The script in it\u0026rsquo;s entirety here: push.sh\nAnd that\u0026rsquo;s it. The site is changed and updated. This can be executed in any environment and the only requirement is hugo and git being present. If you still prefer the branch method of Github pages, this is easily altered to checkout the right branch and push the changes from there.\nNo dependency on anything. Just how I like my build processes.\nThanks for reading!\nGergely.\nAppendix push.sh #!/bin/sh set -e set -x setup_git() { git config --global user.email \u0026#34;travis@travis-ci.org\u0026#34; git config --global user.name \u0026#34;Travis CI\u0026#34; git init git remote add origin https://${GITHUB_TOKEN}@github.com/Skarlso/skarlso.github.io.git \u0026gt; /dev/null 2\u0026gt;\u0026amp;1 git pull origin master } commit_website_files() { git add . git commit -am \u0026#34;Travis build: $TRAVIS_BUILD_NUMBER\u0026#34; } upload_files() { git push --quiet --set-upstream origin master } mkdir /opt/publish \u0026amp;\u0026amp; cd /opt/publish setup_git cp -R /opt/blog/* . commit_website_files upload_files ","permalink":"https://skarlso.github.io/2019/03/18/hugo-blog-with-travis-deployment/","summary":"Intro Hi folks.\nI\u0026rsquo;ve been using the Hugo build for wercker for a long time now. Recent problems occurred though where I did not understand at first what the problem was. It was quite difficult to debug since I did not have too much insight on the wercker build itself. Turned out that I deleted the GITHUB token that the process was using. However, the error message was telling me that a function failed to load some other function.","title":"Deploy a Hugo Blog with Travis on Git Push"},{"content":"Hi folks.\nFollowing a long search and reading lots of debates and possibilities of doing SSH within Go, I was shocked to see that not a great many tools and people use SSH with host key verification. What I usually see is this:\nHostKeyCallback: ssh.InsecureIgnoreHostKey() This is terrible. Now, I realise that doing HostKeyVerification can be tedious, but don\u0026rsquo;t fear. It\u0026rsquo;s actually easy now that the Go team provided the knownhosts subpackage in their crypto SSH package located here: KnownHosts.\nThis part in particular is interesting: New.\nUsing new with a known_hosts file a code can be written like this one to verify host keys:\npackage main import ( \u0026#34;bytes\u0026#34; \u0026#34;fmt\u0026#34; \u0026#34;io/ioutil\u0026#34; \u0026#34;log\u0026#34; \u0026#34;golang.org/x/crypto/ssh\u0026#34; kh \u0026#34;golang.org/x/crypto/ssh/knownhosts\u0026#34; ) func main() { user := \u0026#34;user\u0026#34; address := \u0026#34;192.168.0.17\u0026#34; command := \u0026#34;uptime\u0026#34; port := \u0026#34;9999\u0026#34; key, err := ioutil.ReadFile(\u0026#34;/Users/user/.ssh/id_rsa\u0026#34;) if err != nil { log.Fatalf(\u0026#34;unable to read private key: %v\u0026#34;, err) } // Create the Signer for this private key. signer, err := ssh.ParsePrivateKey(key) if err != nil { log.Fatalf(\u0026#34;unable to parse private key: %v\u0026#34;, err) } hostKeyCallback, err := kh.New(\u0026#34;/Users/user/.ssh/known_hosts\u0026#34;) if err != nil { log.Fatal(\u0026#34;could not create hostkeycallback function: \u0026#34;, err) } config := \u0026amp;ssh.ClientConfig{ User: user, Auth: []ssh.AuthMethod{ // Add in password check here for moar security. ssh.PublicKeys(signer), }, HostKeyCallback: hostKeyCallback, } // Connect to the remote server and perform the SSH handshake. client, err := ssh.Dial(\u0026#34;tcp\u0026#34;, address+\u0026#34;:\u0026#34;+port, config) if err != nil { log.Fatalf(\u0026#34;unable to connect: %v\u0026#34;, err) } defer client.Close() ss, err := client.NewSession() if err != nil { log.Fatal(\u0026#34;unable to create SSH session: \u0026#34;, err) } defer ss.Close() // Creating the buffer which will hold the remotly executed command\u0026#39;s output. var stdoutBuf bytes.Buffer ss.Stdout = \u0026amp;stdoutBuf ss.Run(command) // Let\u0026#39;s print out the result of command. fmt.Println(stdoutBuf.String()) } Here is the whole thing as a Gist.\nPlease try and avoid using Insecure host keys. It is easier, but can harm so much. Software like these: Man in The Middle Proxy thrive in an environment that doesn\u0026rsquo;t do it, or doesn\u0026rsquo;t in other ways mitigate this problem.\nBe wise and be safe. Thanks for reading, Gergely.\n","permalink":"https://skarlso.github.io/2019/02/17/go-ssh-with-host-key-verification/","summary":"Hi folks.\nFollowing a long search and reading lots of debates and possibilities of doing SSH within Go, I was shocked to see that not a great many tools and people use SSH with host key verification. What I usually see is this:\nHostKeyCallback: ssh.InsecureIgnoreHostKey() This is terrible. Now, I realise that doing HostKeyVerification can be tedious, but don\u0026rsquo;t fear. It\u0026rsquo;s actually easy now that the Go team provided the knownhosts subpackage in their crypto SSH package located here: KnownHosts.","title":"Go SSH with Host Key Verification"},{"content":"Intro If you don\u0026rsquo;t know what go-plugin is, don\u0026rsquo;t worry, here is a small introduction on the subject matter:\nBack in the old days when Go didn\u0026rsquo;t have the plugin package, HashiCorp was desperately looking for a way to use plugins.\nIn the old days, Lua plus Go wasn\u0026rsquo;t really a thing yet, and to be honest, nobody wants to write Lua ( joking!).\nAnd thus Mitchell had this brilliant idea of using RPC over the local network to serve a local interface as something that could easily be implemented with any other language that supported RPC. This sounds convoluted but has many benefits! For example, your code will never crash because of a plugin and the ability to use any language to implement a plugin. Not just Go.\nIt has been a battle-hardened solution for years now and is being actively used by Terraform, Vault, Consule, and especially Packer. All using go-plugin in order to provide a much needed flexibility. Writing a plugin is easy. Or so they say.\nIt can get complicated quickly, for example, if you are trying to use GRPC. You can lose sight of what exactly you\u0026rsquo;ll need to implement, where and why; or utilizing various languages or using go-plugins in your own project and extending your CLI with pluggable components.\nThese are all nothing to sneeze at. Suddenly you\u0026rsquo;ll find yourself with hundreds of lines of code pasted from various examples and yet nothing works. Or worse, it DOES work but you have no idea how. Then you find yourself needing to extend it with a new capability, or you find an elusive bug and can\u0026rsquo;t trace its origins.\nFear not. I\u0026rsquo;ll try to demystify things and draw a clear picture about how it works and how the pieces fit together.\nLet\u0026rsquo;s start at the beginning.\nBasic plugin Let\u0026rsquo;s start by writing a simple Go GRPC plugin. In fact, we can go through the basic example in the go-plugin’s repository which can be quite confusing when first starting out. We\u0026rsquo;ll go step-by-step, and the switch to GRPC will be much easier!\nBasic concepts Server In the case of plugins, the Server is the one serving the plugin\u0026rsquo;s implementation. This means the server will have to provide the implementation to an interface.\nClient The Client calls the server in order to execute the desired behaviour. The underlying logic will connect to the server running on localhost on a random higher port, call the wanted function’s implementation and wait for a response. Once the response is received provide that back to the calling Client.\nImplementation The main function Logger The plugins defined here use stdout in a special way. If you aren\u0026rsquo;t writing a Go based plugin, you will have to do that yourself by outputting something like this:\n1|1|tcp|127.0.0.1:1234|grpc We\u0026rsquo;ll come back to this later. Suffice to say the framework will pick this up and will connect to the plugin based on the output. In order to get some output back, we must define a special logger:\n// Create an hclog.Logger logger := hclog.New(\u0026amp;hclog.LoggerOptions{ Name: \u0026#34;plugin\u0026#34;, Output: os.Stdout, Level: hclog.Debug, }) NewClient // We\u0026#39;re a host! Start by launching the plugin process. client := plugin.NewClient(\u0026amp;plugin.ClientConfig{ HandshakeConfig: handshakeConfig, Plugins: pluginMap, Cmd: exec.Command(\u0026#34;./plugin/greeter\u0026#34;), Logger: logger, }) defer client.Kill() What is happening here? Let\u0026rsquo;s see one by one:\nHandshakeConfig: handshakeConfig,: This part is the handshake configuration of the plugin. It has a nice comment as well.\n// handshakeConfigs are used to just do a basic handshake between // a plugin and host. If the handshake fails, a user friendly error is shown. // This prevents users from executing bad plugins or executing a plugin // directory. It is a UX feature, not a security feature. var handshakeConfig = plugin.HandshakeConfig{ ProtocolVersion: 1, MagicCookieKey: \u0026#34;BASIC_PLUGIN\u0026#34;, MagicCookieValue: \u0026#34;hello\u0026#34;, } The ProtocolVersion here is used in order to maintain compatibility with your current plugin versions. It\u0026rsquo;s basically like an API version. If you increase this, you will have two options. Don\u0026rsquo;t accept lower protocol versions nor switch to the version number and use a different client implementation for a lower version than for a higher version. This way you will maintain backwards compatibility.\nThe MagicCookieKey and MagicCookieValue are used for a basic handshake which the comment is talking about. You have to set this ONCE for your application. Never change it again, for if you do, your plugins will no longer work. For uniqueness sake, I suggest using UUID.\nCmd is one of the most important parts about a plugin. Basically how plugins work is that they boil down to a compiled binary which is executed and starts an RPC server. This is where you will have to define the binary which will be executed and does all this. Since this is all happening locally, (please keep in mind that Go-plugins only support localhost, and for a good reason), these binaries will most likely sit next to your application\u0026rsquo;s binary or in a pre-configured global location. Something like: ~/.config/my-app/plugins. This is individual for each plugin of course. The plugins can be autoloaded via a discovery function given a path and a glob.\nAnd last but not least is the Plugins map. This map is used in order to identify a plugin called Dispense. This map is globally available and must stay consistent in order for all the plugins to work:\n// pluginMap is the map of plugins we can dispense. var pluginMap = map[string]plugin.Pluglin\t\u0026#34;greeter\u0026#34;: \u0026amp;example.GreeterPlugin{}, } You can see that the key is the name of the plugin and the value is the plugin.\nWe then proceed to create an RPC client:\n// Connect via RPC rpcClient, err := client.Client() if err != nil { log.Fatal(err) } Nothing fancy about this one\u0026hellip;\nNow comes the interesting part:\n// Request the plugin raw, err := rpcClient.Dispense(\u0026#34;greeter\u0026#34;) if err != nil { log.Fatal(err) } What\u0026rsquo;s happening here? Dispense will look in the above created map and search for the plugin. If it cannot find it, it will throw an error at us. If it does find it, it will cast this plugin to an RPC or a GRPC type plugin. Then proceed to create an RPC or a GRPC client out of it.\nThere is no call yet. This is just creating a client and parsing it to a respective representation.\nNow comes the magic:\n// We should have a Greeter now! This feels like a normal interface // implementation but is in fact over an RPC connection. greeter := raw.(example.Greeter) fmt.Println(greeter.Greet()) Here we are type asserting our raw GRPC client into our own plugin type. This is so we can call the respective function on the plugin! Once that\u0026rsquo;s done we will have a {client,struct,implementation} that can be called like a simple function.\nThe implementation right now comes from greeter_impl.go, but that will change once protoc makes an appearance.\nBehind the scenes, go-plugin will do a bunch of hat tricks with multiplexing TCP connections as well as a remote procedure call to our plugin. Our plugin then will run the function, generate some kind of output, and will then send that back for the waiting client.\nThe client will then proceed to parse the message into a given response type and will then return it back to the client’s callee.\nThis concludes main.go for now.\nThe Interface Now let’s investigate the Interface. The interface is used to provide calling details. This interface will be what defines our plugins’ capabilities. How does our Greeter look like?\n// Greeter is the interface that we\u0026#39;re exposing as a plugin. type Greeter interface { Greet() string } This is pretty simple. It defines a function which will return a string typed value.\nNow, we will need a couple of things for this to work. Firstly we need something which defines the RPC workings. go-plugin is working with net/http inside. It also uses something called Yamux for connection multiplexing, but we needn’t worry about this detail.\nImplementing the RPC details looks like this:\n// Here is an implementation that talks over RPC type GreeterRPC struct { client *rpc.Client } func (g *GreeterRPC) Greet() string { var resp string err := g.client.Call(\u0026#34;Plugin.Greet\u0026#34;, new(interface{}), \u0026amp;resp) if err != nil { // You usually want your interfaces to return errors. If they don\u0026#39;t, // there isn\u0026#39;t much other choice here. panic(err) } return resp } Here the GreeterRPC struct is an RPC specific implementation that will handle communication over RPC. This is Client in this setup.\nIn case of gRPC, this would look something like this:\n// GRPCClient is an implementation of KV that talks over RPC. type GreeterGRPC struct{ client proto.GreeterClient } func (m *GreeterGRPC) Greet() (string, error) { s, err := m.client.Greet(context.Background(), \u0026amp;proto.Empty{}) return s, err } What is happening here? What\u0026rsquo;s Proto and what is GreeterClient? GRPC uses Google\u0026rsquo;s protoc library to serialize and unserialize data. proto.GreeterClient is generated Go code by protoc. This code is a skeleton for which implementation detail will be replaced on run time. Well, the actual result will be used and not replaced as such.\nBack to our previous example. The RPC client calls a specific Plugin function called Greet for which the implementation will be provided by a Server that will be streamed back over the RPC protocol.\nThe server is pretty easy to follow:\n// Here is the RPC server that GreeterRPC talks to, conforming to // the requirements of net/rpc type GreeterRPCServer struct { // This is the real implementation Impl Greeter } Impl is the concrete implementation that will be called in the Server\u0026rsquo;s implementation of the Greet plugin. Now we must define Greet on the RPCServer in order for it to be able to call the remote code. This looks like this:\nfunc (s *GreeterRPCServer) Greet(args interface{}, resp *string) error { *resp = s.Impl.Greet() return nil } This is all still boilerplate for the RPC works. Now comes plugin. For this, the comment is actually quite good too:\n// This is the implementation of plugin.Plugin so we can serve/consume this // // This has two methods: Server must return an RPC server for this plugin // type. We construct a GreeterRPCServer for this. // // Client must return an implementation of our interface that communicates // over an RPC client. We return GreeterRPC for this. // // Ignore MuxBroker. That is used to create more multiplexed streams on our // plugin connection and is a more advanced use case. type GreeterPlugin struct { // Impl Injection Impl Greeter } func (p *GreeterPlugin) Server(*plugin.MuxBroker) (interface{}, error) { return \u0026amp;GreeterRPCServer{Impl: p.Impl}, nil } func (GreeterPlugin) Client(b *plugin.MuxBroker, c *rpc.Client) (interface{}, error) { return \u0026amp;GreeterRPC{client: c}, nil } What does this mean? So, remember: GreeterRPCServer is the one calling the actual implementation while Client is receiving the result of that call. The GreeterPlugin has the Greeter interface embedded just like the RPCServer. We will use the GreeterPlugin as a struct in the plugin map. This is the plugin that we will actually use.\nThis is all still common stuff. These things will need to be visible for both. The plugin\u0026rsquo;s implementation will use the interface to see what it needs to implement. The Client will use it see what to call and what API is available. Like, Greet.\nHow does the implementation look like?\nThe Implementation In a completely separate package, but which still has access to the interface definition, this plugin could be something like this:\n// Here is a real implementation of Greeter type GreeterHello struct { logger hclog.Logger } func (g *GreeterHello) Greet() string { g.logger.Debug(\u0026#34;message from GreeterHello.Greet\u0026#34;) return \u0026#34;Hello!\u0026#34; } We create a struct and then add the function to it which is defined by the plugin\u0026rsquo;s interface. This interface, since it\u0026rsquo;s required by both parties, could well sit in a common package outside of both programs. Something like a SDK. Both code could import it and use it as a common dependency. This way we have separated the interface from the plugin and the calling client.\nThe main function could look something like this:\nlogger := hclog.New(\u0026amp;hclog.LoggerOptions{ Level: hclog.Trace, Output: os.Stderr, JSONFormat: true, }) greeter := \u0026amp;GreeterHello{ logger: logger, } // pluginMap is the map of plugins we can dispense. var pluginMap = map[string]plugin.Plugin{ \u0026#34;greeter\u0026#34;: \u0026amp;example.GreeterPlugin{Impl: greeter}, } logger.Debug(\u0026#34;message from plugin\u0026#34;, \u0026#34;foo\u0026#34;, \u0026#34;bar\u0026#34;) plugin.Serve(\u0026amp;plugin.ServeConfig{ HandshakeConfig: handshakeConfig, Plugins: pluginMap, }) Notice two things that we need. One is the handshakeConfig. You can either define it here, with the same cookie details as you defined in the client code, or you can extract the handshake information into the SDK. This is up to you.\nThen the next interesting thing is the plugin.Serve method. This is where the magic happens. The plugins open up a RPC communication socket and over a hijacked stdout, broadcasts its availability to the calling Client in this format:\nCORE-PROTOCOL-VERSION | APP-PROTOCOL-VERSION | NETWORK-TYPE | NETWORK-ADDR | PROTOCOL For Go plugins, you don\u0026rsquo;t have to concern yourself with this. go-plugin takes care of all this for you. For non-Go versions, we must take this into account. And before calling serve, we need to output this information to stdout.\nFor example, a Python plugin must deal with this himself. Like this:\n# Output information print(\u0026#34;1|1|tcp|127.0.0.1:1234|grpc\u0026#34;) sys.stdout.flush() For GRPC plugins, it\u0026rsquo;s also mandatory to implement a HealthChecker.\nHow would all this look like with GRPC?\nIt gets slightly more complicated but not too much. We need to use protoc to create a protocol description for our implementation, and then we will call that. Let\u0026rsquo;s look at this now by converting the basic greeter example into GRPC.\nGRPC Basic plugin The example that\u0026rsquo;s under GRPC is quite elaborate and perhaps you don\u0026rsquo;t need the Python part. I will focus on the basic RPC example into a GRPC example. That should not be a problem.\nThe API First and foremost, you will need to define an API to implement with protoc. For our basic example, the protoc file could look like this:\nsyntax = \u0026#34;proto3\u0026#34;; package proto; message GreetResponse { string message = 1; } message Empty {} service GreeterService { rpc Greet(Empty) returns (GreetResponse); } The syntax is quite simple and readable. What this defines is a message, which is a response, that will contain a message with the type string. The service defines a service which has a method called Greet. The service definition is basically an interface for which we will be providing the concrete implementation through the plugin.\nTo read more about protoc, visit this page: Google Protocol Buffer.\nGenerate the code Now, with the protoc definition in hand, we need to generate the stubs that the local client implementation can call. That client call will then, through the remote procedure call, call the right function on the server which will have the concrete implementation at the ready. Run it and return the result in the specified format. Because the stub needs to be available by both parties, (the client AND the server), this needs to live in a shared location.\nWhy? Because the client is calling the stub and the server is implementing the stub. Both need it in order to know what to call/implement.\nTo generate the code, run this command:\nprotoc -I proto/ proto/greeter.proto --go_out=plugins=grpc:proto I encourage you to read the generated code. Much will make little sense at first. It will have a bunch of structs and defined things that the GRPC package will use in order to server the function. The interesting bits and pieces are:\nfunc (m *GreetResponse) GetMessage() string { if m != nil { return m.Message } return \u0026#34;\u0026#34; } Which will get use the message inside the response.\ntype GreeterServiceClient interface { Greet(ctx context.Context, in *Empty, opts ...grpc.CallOption) (*GreetResponse, error) } This is our ServiceClient interface which defines the Greet function’s topology.\nAnd lastly, this guy:\nfunc RegisterGreeterServiceServer(s *grpc.Server, srv GreeterServiceServer) { s.RegisterService(\u0026amp;_GreeterService_serviceDesc, srv) } Which we will need in order to register our implementation for the server. We can ignore the rest.\nThe interface Much like the RPC, we need to define an interface for the client and server to use. This must be in a shared place as both the server and the client need to know about it. You could put this into an SDK and your peers could just get the SDK and implement some function for define and done. The interface definition in the GRPC land could look something like this:\n// Greeter is the interface that we\u0026#39;re exposing as a plugin. type Greeter interface { Greet() string } // This is the implementation of plugin.GRPCPlugin so we can serve/consume this. type GreeterGRPCPlugin struct { // GRPCPlugin must still implement the Plugin interface plugin.Plugin // Concrete implementation, written in Go. This is only used for plugins // that are written in Go. Impl Greeter } func (p *GreeterGRPCPlugin) GRPCServer(broker *plugin.GRPCBroker, s *grpc.Server) error { proto.RegisterGreeterServer(s, \u0026amp;GRPCServer{Impl: p.Impl}) return nil } func (p *GreeterGRPCPlugin) GRPCClient(ctx context.Context, broker *plugin.GRPCBroker, c *grpc.ClientConn) (interface{}, error) { return \u0026amp;GRPCClient{client: proto.NewGreeterClient(c)}, nil } With this we have the Plugin\u0026rsquo;s implementation for hashicorp what needed to be done. The plugin will call the underlying implementation and serve/consume the plugin. We can now write the GRPC part of it.\nPlease note that proto is a shared library too where the protocol stubs reside. That needs to be somewhere on the path or in a separate SDK of some sort, but it must be visible.\nWriting the GRPC Client Firstly we define the grpc client struct:\n// GRPCClient is an implementation of Greeter that talks over RPC. type GRPCClient struct{ client proto.GreeterClient } Then we define how the client will call the remote function:\nfunc (m *GRPCClient) Greet() string { ret, _ := m.client.Greet(context.Background(), \u0026amp;proto.Empty{}) return ret.Message } This will take the client in the GRPCClient and will call the method on it. Once that\u0026rsquo;s done we will return to the result Message property which will be Hello!. proto.Empty is an empty struct; we use this if there is no parameter for a defined method or no return value. We can\u0026rsquo;t just leave it blank. protoc needs to be told explicitly that there is no parameter or return value.\nWriting the GRPC Server The server implementation will also be similar. We call Impl here which will have our concrete plugin implementation.\n// Here is the gRPC server that GRPCClient talks to. type GRPCServer struct { // This is the real implementation Impl Greeter } func (m *GRPCServer) Greet( ctx context.Context, req *proto.Empty) *proto.GreeterResponse { v := m.Impl.Greet() return \u0026amp;proto.GreeterResponse{Message: v} } And we will use the protoc defined message response. v will have the response from Greet which will be Hello! provided by the concrete plugin\u0026rsquo;s implementation. We then transform that into a protoc type by setting the Message property on the GreeterResponse struct provided by the automatically generated protoc stub code.\nEasy, right?\nWriting the plugin itself The whole thing looks much like the RPC implementation with just a few small modifications and changes. This can sit completely outside of everything, or can even be provided by a third party implementor.\n// Here is a real implementation of KV that writes to a local file with // the key name and the contents are the value of the key. type Greeter struct{} func (Greeter) Greet() error { return \u0026#34;Hello!\u0026#34; } func main() { plugin.Serve(\u0026amp;plugin.ServeConfig{ HandshakeConfig: shared.Handshake, Plugins: map[string]plugin.Plugin{ \u0026#34;greeter\u0026#34;: \u0026amp;shared.GreeterGRPCPlugin{Impl: \u0026amp;Greeter{}}, }, // A non-nil value here enables gRPC serving for this plugin... GRPCServer: plugin.DefaultGRPCServer, }) } Calling it all in the main Once all that is done, the main function looks the same as RPC\u0026rsquo;s main but with some small modifications.\n// We\u0026#39;re a host. Start by launching the plugin process. client := plugin.NewClient(\u0026amp;plugin.ClientConfig{ HandshakeConfig: shared.Handshake, Plugins: shared.PluginMap, Cmd: exec.Command(\u0026#34;./plugin/greeter\u0026#34;), AllowedProtocols: []plugin.Protocol{plugin.ProtocolGRPC}, }) The NewClient now defines AllowedProtocols to be ProtocolGRPC. The rest is the same as before calling Dispense and value hinting the plugin to the correct type then calling Greet().\nConclusion This is it. We made it! Now our plugin works over GRPC with a defined API by protoc. The plugin\u0026rsquo;s implementation can live where ever we want it to, but it needs some shared data. These are:\nThe generated code by protoc The defined plugin interface The GRPC Server and Client These need to be visible by both the Client and the Server. The Server here is the plugin. If you are planning on making people be able to extend your application with go-plugin, you should make these available as a separate SDK. So people won\u0026rsquo;t have to include your whole project just to implement an interface and use protoc. In fact, you could also extract the protoc definition into a separate repository so that your SDK can also pull it in.\nYou will have three repositories:\nYour application; The SDK providing the interface and the GRPC Server and Client implementation; The protoc definition file and generated skeleton ( for Go based plugins). Other languages will have to generate their own protoc code, and includ it into the plugin; like the Python implementation example located here: Go-plugin Python Example. Also, read this documentation carefully: non-go go-plugin. This document will also clarify what 1|1|tcp|127.0.0.1:1234|grpc means and will dissipate the confusion around how plugins work.\nLastly, if you would like to have an in-depth explanation about how go-plugin came to be, watch this video by Mitchell:\ngo-plugin explanation video.\nI must warn you though- it\u0026rsquo;s an hour long. But worth the watch!\nThat\u0026rsquo;s it. I hope this has helped to clear the confusion around how to use go-plugin.\nHappy plugging!\nGergely.\n","permalink":"https://skarlso.github.io/2018/10/29/go-plugin-tutorial/","summary":"Intro If you don\u0026rsquo;t know what go-plugin is, don\u0026rsquo;t worry, here is a small introduction on the subject matter:\nBack in the old days when Go didn\u0026rsquo;t have the plugin package, HashiCorp was desperately looking for a way to use plugins.\nIn the old days, Lua plus Go wasn\u0026rsquo;t really a thing yet, and to be honest, nobody wants to write Lua ( joking!).\nAnd thus Mitchell had this brilliant idea of using RPC over the local network to serve a local interface as something that could easily be implemented with any other language that supported RPC.","title":"Extensive tutorial on go-plugin."},{"content":"Hi.\nA quick update, but a very important and interesting one hopefully. Furnace just got a massive boost to its plugin system.\nI\u0026rsquo;m using HashiCorp\u0026rsquo;s Go-Plugins system now to handle plugins. This means one of two things that are interesting to the plugin author.\nOne, plugins can be written in any language which is supported by Furnace and supports GRPC. Currently this means that plugins can be written in the following languages:\nGo\nPython\nRuby\nAdding new plugins is easy and I\u0026rsquo;m open for suggestions in which language to provide next if the need arrises.\nTo find out more, please read the README on Furnace about plugins located here: Furnace Plugin System.\nI hope to see a bunch of nice plugins pop up here and there if please are interested in writing them. I\u0026rsquo;m listing a couple of possibilities like, notification after create, or resource cleanup or even preventing the stack from creating in the first place with a pre-create check for permissions / resource availability / funds constraints.\nHave fun writing plugins and making Furnace more powerful then ever.\nI\u0026rsquo;m planning on providing some basic plugins that could be used out of the box. Those will probably be in Go though.\nThanks, Gergely.\n","permalink":"https://skarlso.github.io/2018/09/17/furnace-plugin-update/","summary":"Hi.\nA quick update, but a very important and interesting one hopefully. Furnace just got a massive boost to its plugin system.\nI\u0026rsquo;m using HashiCorp\u0026rsquo;s Go-Plugins system now to handle plugins. This means one of two things that are interesting to the plugin author.\nOne, plugins can be written in any language which is supported by Furnace and supports GRPC. Currently this means that plugins can be written in the following languages:","title":"Furnace with a new Plugin System"},{"content":"Hi.\nToday, I would like to write about a little tool I put together in Rust.\nIt\u0026rsquo;s called gotp. I\u0026rsquo;m calling it gotp mainly because of crates.io. I published it there as well, you can find it under this link: crates.io/gotp.\nThe purpose is clear. It\u0026rsquo;s a totp generator I wrote a while ago in C++ but now it\u0026rsquo;s in rust. It can generate a token and save it into an account file that is AES encrypted. The password is never saved, so it\u0026rsquo;s secure enough to use it.\nOne of it\u0026rsquo;s properties it will have over the c++ implementation is it\u0026rsquo;s safe, it uses a proper IV and once I\u0026rsquo;m done, it will also support encryption via PGP.\nThat way a password will no longer be asked, but the gpg-agent will be used instead.\nThis will give a much needed usability boost in which a password will no longer be asked for constantly.\nThere is also a possibility to place the account file into DropBox or Google Drive and share it between your own devices. This way your home laptop will also have the same account as your work laptop making it essentially an Authy like service on the CLI.\nEnjoy, and keep an eye out for the PGP update. For more information in usage, please read the README.\nThank you! Gergely.\n","permalink":"https://skarlso.github.io/2018/09/13/gotp/","summary":"Hi.\nToday, I would like to write about a little tool I put together in Rust.\nIt\u0026rsquo;s called gotp. I\u0026rsquo;m calling it gotp mainly because of crates.io. I published it there as well, you can find it under this link: crates.io/gotp.\nThe purpose is clear. It\u0026rsquo;s a totp generator I wrote a while ago in C++ but now it\u0026rsquo;s in rust. It can generate a token and save it into an account file that is AES encrypted.","title":"TOTP generator with account handling for multiple tokens"},{"content":"Hi folks.\nToday\u0026rsquo;s is a quick tip for keeping your forks updated.\nIf you are like me, and have at least a 100 forks in your repository because: * You would like to contribute at some point * Save it for yourself because you are afraid that it disappears * Would like to make modifications for your own benefit * Whatever the reason\n\u0026hellip;then you probably have a lot of trouble keeping them updated and making sure you always see the latest change.\nUpstream can change a lot especially if it\u0026rsquo;s a busy repository.\nFret not. Help is here. This little ruby script will solve your troubles:\n#!/usr/bin/env ruby require \u0026#39;octokit\u0026#39; require \u0026#39;logger\u0026#39; @logger = Logger.new(\u0026#34;output.log\u0026#34;) def update_fork(repo) repo_name = repo.name # clone the repository -- octokit doesn\u0026#39;t provide this feature as it\u0026#39;s a github api library @logger.info(\u0026#34;cloning into #{repo.ssh_url}\u0026#34;) system(\u0026#34;git clone #{repo.ssh_url} #{repo_name}\u0026#34;) # setup upstream for updating @logger.info(\u0026#34;setup upstream to #{repo.parent.ssh_url}\u0026#34;) system(\u0026#34;cd #{repo_name} \u0026amp;\u0026amp; git remote add upstream #{repo.parent.ssh_url}\u0026#34;) # do the update @logger.info(\u0026#34;doing the update with push\u0026#34;) system(\u0026#34;cd #{repo_name} \u0026amp;\u0026amp; git fetch upstream \u0026amp;\u0026amp; git rebase upstream/master \u0026amp;\u0026amp; git push origin\u0026#34;) ensure # ensure that the folder is cleaned up @logger.info(\u0026#34;cleanup: removing the repository folder\u0026#34;) system(\u0026#34;rm -fr #{repo_name}\u0026#34;) end client = Octokit::Client.new(:access_token =\u0026gt; ENV[\u0026#39;GIT_TOKEN\u0026#39;], per_page: 100) repos = client.repos({}, query: {type: \u0026#39;owner\u0026#39;, sort: \u0026#39;asc\u0026#39;}) # Go through all the pages and add them to the list of repositories. repos.concat(client.last_response.rels[:next].get.data) repos = repos.select{ |r| r.fork } @logger.info(\u0026#34;going to update \u0026#39;#{repos.length}\u0026#39; repositories\u0026#34;) repos.each do |repo| # get the repositories information @logger.info(\u0026#34;updating #{repo.name}\u0026#34;) r = client.repository(repo.id) update_fork(r) end This script is also available as a Gist located here.\nPut this into a cron job, or a Jenkins job on a schedule and you should be good to go.\nNote two things: First: ENV['GIT_TOKEN'] this should be set to a token which you can acquire by navigating to tokens. Add a token which has repo access.\nSecond: Obviously this script will push to your local repository. So wherever you run this, make sure git is set-up and can push to your repository via SSH. This script is using ssh_url for the repositories. It won\u0026rsquo;t ask for a username or a password.\nThat\u0026rsquo;s it. Enjoy and keep updating.\nThanks for reading\nGergely.\n","permalink":"https://skarlso.github.io/2018/06/08/fork-updater/","summary":"Hi folks.\nToday\u0026rsquo;s is a quick tip for keeping your forks updated.\nIf you are like me, and have at least a 100 forks in your repository because: * You would like to contribute at some point * Save it for yourself because you are afraid that it disappears * Would like to make modifications for your own benefit * Whatever the reason\n\u0026hellip;then you probably have a lot of trouble keeping them updated and making sure you always see the latest change.","title":"Keep your git forks updated all the time"},{"content":"Intro Alright folks. Settle in and get comfortable. This is going to be a long, but hopefully, fun ride.\nI\u0026rsquo;m going to deploy a distributed application with Kubernetes. I attempted to create an application that I thought resembled a real world app. Obviously I had to cut some corners due to time and energy constraints.\nMy focus will be on Kubernetes and deployment.\nShall we delve right in?\nThe Application TL;DR The application itself consists of six parts. The repository can be found here: Kube Cluster Sample.\nIt’s a face recognition service which identifies images of people, comparing them to known individuals. A simple frontend displays a table of these images whom they belong to. This happens by sending a request to a receiver. The request contains a path to an image. This image can sit on an NFS somewhere. The receiver stores this path in the DB (MySQL) and sends a processing request to a queue. The queue uses: NSQ. The request contains the ID of the saved image.\nAn Image Processing service is constantly monitoring the queue for jobs to do. The processing consists of the following steps: taking the ID; loading the image; and finally, sending the image to a face recognition backend written in Python via gRPC. If the identification is successful, the backend will return the name of the image corresponding to that person. The image_processor then updates the image’s record with the person’s ID and marks the image as “processed successfully”. If identification is unsuccessful, the image will be left as “pending”. If there was a failure during identification, the image will be flagged as “failed”.\nFailed images can be retried with a cron job, for example:\nSo how does this all work? Let\u0026rsquo;s check it out .\nReceiver The receiver service is the starting point of the process. It\u0026rsquo;s an API which receives a request in the following format:\ncurl -d \u0026#39;{\u0026#34;path\u0026#34;:\u0026#34;/unknown_images/unknown0001.jpg\u0026#34;}\u0026#39; http://127.0.0.1:8000/image/post In this instance, the receiver stores the path using a shared database cluster. The entity will then receive an ID from the database service. This application is based on the model where unique identification for Entity Objects is provided by the persistence layer. Once the ID is procured, the receiver will send a message to NSQ. At this point in the process, the receiver\u0026rsquo;s job is done.\nImage Processor Here is where the excitement begins. When Image Processor first runs it creates two Go routines. These are\u0026hellip;\nConsume This is an NSQ consumer. It has three integral jobs. Firstly, it listens for messages on the queue. Secondly, when there is a message, it appends the received ID to a thread safe slice of IDs that the second routine processes. And lastly, it signals the second routine that there is work to be do. It does this through sync.Condition.\nProcessImages This routine processes a slice of IDs until the slice is drained completely. Once the slice is drained, the routine suspends instead of sleep-waiting on a channel. The processing of a single ID can be seen in the following linear steps:\nEstablish a gRPC connection to the Face Recognition service (explained under Face Recognition) Retrieve the image record from the database Setup two functions for the Circuit Breaker Function 1: The main function which runs the RPC method call Function 2: A health check for the Ping of the circuit breaker Call Function 1 which sends the path of the image to the face recognition service. This path should be accessible by the face recognition service. Preferably something shared like an NFS If this call fails, update the image record as FAILED PROCESSING If it succeeds, an image name should come back which corresponds to a person in the db. It runs a joined SQL query which gets the corresponding person\u0026rsquo;s ID Update the Image record in the database with PROCESSED status and the ID of the person that image was identified as This service can be replicated. In other words, more than one can run at the same time.\nCircuit Breaker A system in which replicating resources requires little to no effort, there still can be cases where, for example, the network goes down, or there are communication problems of any kind between two services. I like to implement a little circuit breaker around the gRPC calls for fun.\nThis is how it works:\nAs you can see, once there are 5 unsuccessful calls to the service, the circuit breaker activates, not allowing any more calls to go through. After a configured amount of time, it will send a Ping call to the service to see if it\u0026rsquo;s back up. If that still errors out, it will increase the timeout. If not, it opens the circuit, allowing traffic to proceed.\nFront-End This is only a simple table view with Go\u0026rsquo;s own html/template used to render a list of images.\nFace Recognition Here is where the identification magic happens. I decided to make this a gRPC based service for the sole purpose of its flexibility. I started writing it in Go but decided that a Python implementation would be much sorter. In fact, excluding the gRPC code, the recognition part is approximately 7 lines of Python code. I\u0026rsquo;m using this fantastic library which contains all the C bindings to OpenCV. Face Recognition. Having an API contract here means that I can change the implementation anytime as long as it adheres to the contract.\nPlease note that there exist a great Go library OpenCV. I was about to use it but they had yet to write the C bindings for that part of OpenCV. It\u0026rsquo;s called GoCV. Check them out! They have some pretty amazing things, like real-time camera feed processing that only needs a couple of lines of code.\nThe python library is simple in nature. Have a set of images of people you know. I have a folder with a couple of images named, hannibal_1.jpg, hannibal_2.jpg, gergely_1.jpg, john_doe.jpg. In the database I have two tables named, person, person_images. They look like this:\n+----+----------+ | id | name | +----+----------+ | 1 | Gergely | | 2 | John Doe | | 3 | Hannibal | +----+----------+ +----+----------------+-----------+ | id | image_name | person_id | +----+----------------+-----------+ | 1 | hannibal_1.jpg | 3 | | 2 | hannibal_2.jpg | 3 | +----+----------------+-----------+ The face recognition library returns the name of the image from the known people which matches the person on the unknown image. After that, a simple joined query -like this- will return the person in question.\nselect person.name, person.id from person inner join person_images as pi on person.id = pi.person_id where image_name = \u0026#39;hannibal_2.jpg\u0026#39;; The gRPC call returns the ID of the person which is then used to update the image\u0026rsquo;s ‘person` column.\nNSQ NSQ is a nice little Go based queue. It can be scaled and has a minimal footprint on the system. It also has a lookup service that consumers use to receive messages, and a daemon that senders use when sending messages.\nNSQ\u0026rsquo;s philosophy is that the daemon should run with the sender application. That way, the sender will send to the localhost only. But the daemon is connected to the lookup service, and that\u0026rsquo;s how they achieve a global queue.\nThis means that there are as many NSQ daemons deployed as there are senders. Because the daemon has a minuscule resource requirement, it won\u0026rsquo;t interfere with the requirements of the main application.\nConfiguration In order to be as flexible as possible, as well as making use of Kubernetes\u0026rsquo;s ConfigSet, I\u0026rsquo;m using .env files in development to store configurations like the location of the database service, or NSQ\u0026rsquo;s lookup address. In production- and that means the Kubernetes’s environment- I\u0026rsquo;ll use environment properties.\nConclusion for the Application And that\u0026rsquo;s all there is to the architecture of the application we are about to deploy. All of its components are changeable and coupled only through the database, a queue and gRPC. This is imperative when deploying a distributed application due to how updating mechanics work. I will cover that part in the Deployment section.\nDeployment with Kubernetes Basics What is Kubernetes?\nI\u0026rsquo;m going to cover some of the basics here. I won\u0026rsquo;t go too much into detail- that would require a whole book like this one: Kubernetes Up And Running. Also, if you’re daring enough, you can have a look through this documentation: Kubernetes Documentation.\nKubernetes is a containerized service and application manager. It scales easily, employs a swarm of containers, and most importantly, it\u0026rsquo;s highly configurable via yaml based template files. People often compare Kubernetes to Docker swarm, but Kubernetes does way more than that! For example: it\u0026rsquo;s container agnostic. You could use LXC with Kubernetes and it would work the same way as you using it with Docker. It provides a layer above managing a cluster of deployed services and applications. How? Let\u0026rsquo;s take a quick look at the building blocks of Kubernetes.\nIn Kubernetes, you’ll describe a desired state of the application and Kubernetes will do what it can to reach that state. States could be something such as deployed; paused; replicated twice; and so on and so forth.\nOne of the basics of Kubernetes is that it uses Labels and Annotations for all of its components. Services, Deployments, ReplicaSets, DaemonSets, everything is labelled. Consider the following scenario. In order to identify what pod belongs to what application, a label is used called app: myapp. Let’s assume you have two containers of this application deployed; if you would remove the label app from one of the containers, Kubernetes would only detect one and thus would launch a new instance of myapp.\nKubernetes Cluster For Kuberenetes to work, a Kubernetes cluster needs to be present. Setting that up might be a tad painful, but luckily, help is on hand. Minikube sets up a cluster for us locally with one Node. And AWS has a beta service running in the form of a Kubernetes cluster in which the only thing you need to do is request nodes and define your deployments. The Kubernetes cluster components are documented here: Kubernetes Cluster Components.\nNodes A Node is a worker machine. It can be anything- from a vm to a physical machine- including all sorts of cloud provided vms.\nPods Pods are a logically grouped collection of containers, meaning one Pod can potentially house a multitude of containers. A Pod gets its own DNS and virtual IP address after it has been created so Kubernetes can load balancer traffic to it. You rarely need to deal with containers directly. Even when debugging, (like looking at logs), you usually invoke kubectl logs deployment/your-app -f instead of looking at a specific container. Although it is possible with -c container_name. The -f does a tail on the log.\nDeployments When creating any kind of resource in Kubernetes, it will use a Deployment in the background. A deployment describes a desired state of the current application. It\u0026rsquo;s an object you can use to update Pods or a Service to be in a different state, do an update, or rollout new version of your app. You don\u0026rsquo;t directly control a ReplicaSet, (as described later), but control the deployment object which creates and manages a ReplicaSet.\nServices By default a Pod will get an IP address. However, since Pods are a volatile thing in Kubernetes, you\u0026rsquo;ll need something more permanent. A queue, mysql, or an internal API, a frontend; these need to be long running and behind a static, unchanging IP or preferably a DNS record.\nFor this purpose, Kubernetes has Services for which you can define modes of accessibility. Load Balanced, simple IP or internal DNS.\nHow does Kubernetes know if a service is running correctly? You can configure Health Checks and Availability Checks. A Health Check will check whether a container is running, but that doesn\u0026rsquo;t mean that your service is running. For that, you have the availability check which pings a different endpoint in your application.\nSince Services are pretty important, I recommend that you read up on them later here: Services. Advanced warning though, this document is quite dense. Twenty four A4 pages of networking, services and discovery. It\u0026rsquo;s also vital to decide whether you want to seriously employ Kubernetes in production.\nDNS / Service Discovery If you create a service in the cluster, that service will get a DNS record in Kubernetes provided by special Kubernetes deployments called kube-proxy and kube-dns. These two provide service discover inside a cluster. If you have a mysql service running and set clusterIP: none, then everyone in the cluster can reach that service by pinging mysql.default.svc.cluster.local. Where:\nmysql \u0026ndash; is the name of the service default \u0026ndash; is the namespace name svc \u0026ndash; is services cluster.local \u0026ndash; is a local cluster domain The domain can be changed via a custom definition. To access a service outside the cluster, a DNS provider has to be used, and Nginx (for example), to bind an IP address to a record. The public IP address of a service can be queried with the following commands:\nNodePort \u0026ndash; kubectl get -o jsonpath=\u0026quot;{.spec.ports[0].nodePort}\u0026quot; services mysql LoadBalancer \u0026ndash; kubectl get -o jsonpath=\u0026quot;{.spec.ports[0].LoadBalancer}\u0026quot; services mysql Template Files Like Docker Compose, TerraForm or other service management tools, Kubernetes also provides infrastructure describing templates. What that means is that you rarely need to do anything by hand.\nFor example, consider the following yaml template which describes an nginx Deployment:\napiVersion: apps/v1 kind: Deployment #(1) metadata: #(2) name: nginx-deployment labels: #(3) app: nginx spec: #(4) replicas: 3 #(5) selector: matchLabels: app: nginx template: metadata: labels: app: nginx spec: containers: #(6) - name: nginx image: nginx:1.7.9 ports: - containerPort: 80 This is a simple deployment in which we do the following:\n(1) Define the type of the template with kind (2) Add metadata that will identify this deployment and every resource that it would create with a label (3) (4) Then comes the spec which describes the desired state (5) For the nginx app, have 3 replicas (6) This is the template definition for the containers that this Pod will contain nginx named container nginx:1.7.9 image (docker in this case) exposed ports ReplicaSet A ReplicaSet is a low level replication manager. It ensures that the correct number of replicates are running for a application. However, Deployments are at a higher level and should always manage ReplicaSets. You rarely need to use ReplicaSets directly unless you have a fringe case in which you want to control the specifics of replication.\nDaemonSet Remember how I said Kubernetes is using Labels all the time? A DaemonSet is a controller that ensures that at daemonized application is always running on a node with a certain label.\nFor example: you want all the nodes labelled with logger or mission_critical to run an logger / auditing service daemon. Then you create a DaemonSet and give it a node selector called logger or mission_critical. Kubernetes will look for a node that has that label. Always ensure that it will have an instance of that daemon running on it. Thus everyone running on that node will have access to that daemon locally.\nIn case of my application, the NSQ daemon could be a DaemonSet. Make sure it\u0026rsquo;s up on a node which has the receiver component running by labelling a node with receiver and specifying a DaemonSet with a receiver application selector.\nThe DaemonSet has all the benefits of the ReplicaSet. It\u0026rsquo;s scalable and Kubernetes manages it; which means, all life cycle events are handled by Kube ensuring it never dies, and when it does, it will be immediately replaced.\nScaling It\u0026rsquo;s trivial to scale in Kubernetes. The ReplicaSets take care of the number of instances of a Pod to run- as seen in the nginx deployment with the setting replicas:3. It\u0026rsquo;s up to us to write our application in a way that allows Kubernetes to run multiple copies of it.\nOf course the settings are vast. You can specify which replicates must run on what Nodes, or on various waiting times as to how long to wait for an instance to come up. You can read more on this subject here: Horizontal Scaling and here: Interactive Scaling with Kubernetes and of course the details of a ReplicaSet which controls all the scaling made possible in Kubernetes.\nConclusion for Kubernetes It\u0026rsquo;s a convenient tool to handle container orchestration. Its unit of work are Pods and it has a layered architecture. The top level layer is Deployments through which you handle all other resources. It\u0026rsquo;s highly configurable. It provides an API for all calls you make, so potentially, instead of running kubectl you can also write your own logic to send information to the Kubernetes API.\nIt provides support for all major cloud providers natively by now and it\u0026rsquo;s completely open source. Feel free to contribute! And check the code if you would like to have a deeper understanding on how it works: Kubernetes on Github.\nMinikube I\u0026rsquo;m going to use Minikube. Minikube is a local Kubernetes cluster simulator. It\u0026rsquo;s not great in simulating multiple nodes though, but for starting out and local play without any costs, it\u0026rsquo;s great. It uses a VM that can be fine tuned if necessary using VirtualBox and the likes.\nAll of the kube template files that I\u0026rsquo;ll be using can be found here: Kube files.\nNOTE If, later on, you would like to play with scaling but notice that the replicates are always in Pending state, remember that minikube employs a single node only. It might not allow multiple replicas on the same node, or just plainly ran out of resources to use. You can check available resources with the following command:\nkubectl get nodes -o yaml Building the containers Kubernetes supports most of the containers out there. I\u0026rsquo;m going to use Docker. For all the services I\u0026rsquo;ve built, there is a Dockerfile included in the repository. I encourage you to study them. Most of them are simple. For the go services, I\u0026rsquo;m using a multi stage build that has been recently introduced. The Go services are Alpine Linux based. The Face Recognition service is Python. NSQ and MySQL are using their own containers.\nContext Kubernetes uses namespaces. If you don\u0026rsquo;t specify any, it will use the default namespace. I\u0026rsquo;m going to permanently set a context to avoid polluting the default namespace. You do that like this:\n❯ kubectl config set-context kube-face-cluster --namespace=face Context \u0026#34;kube-face-cluster\u0026#34; created. You have to also start using the context once it\u0026rsquo;s created, like so:\n❯ kubectl config use-context kube-face-cluster Switched to context \u0026#34;kube-face-cluster\u0026#34;. After this, all kubectl commands will use the namespace face.\nDeploying the Application Overview of Pods and Services:\nMySQL The first Service I\u0026rsquo;m going to deploy is my database.\nI\u0026rsquo;m using the Kubernetes example located here Kube MySQL which fits my needs. Please note that this file is using a plain password for MYSQL_PASSWORD. I\u0026rsquo;m going to employ a vault as described here Kubernetes Secrets.\nI\u0026rsquo;ve created a secret locally as described in that document using a secret yaml:\napiVersion: v1 kind: Secret metadata: name: kube-face-secret type: Opaque data: mysql_password: base64codehere I created the base64 code via the following command:\necho -n \u0026#34;ubersecurepassword\u0026#34; | base64 And, this is what you\u0026rsquo;ll see in my deployment yaml file:\n... - name: MYSQL_ROOT_PASSWORD valueFrom: secretKeyRef: name: kube-face-secret key: mysql_password ... Another thing worth mentioning: It\u0026rsquo;s using a volume to persist the database. The volume definition is as follows:\n... volumeMounts: - name: mysql-persistent-storage mountPath: /var/lib/mysql ... volumes: - name: mysql-persistent-storage persistentVolumeClaim: claimName: mysql-pv-claim ... presistentVolumeClain is key here. This tells Kubernetes that this resource requires a persistent volume. How it\u0026rsquo;s provided is abstracted away from the user. You can be sure that Kubernetes will provide a volume that will always be there. It is similar to Pods. To read up on the details, check out this document: Kubernetes Persistent Volumes.\nDeploying the mysql Service is done with the following command:\nkubectl apply -f mysql.yaml apply vs create. In short, apply is considered a declarative object configuration command while create is imperative. What this means for now is that ‘create’ is usually for a one of tasks, like running something or creating a deployment. While, when using apply, the user doesn\u0026rsquo;t define the action to be taken. That will be defined by Kubernetes based on the current status of the cluster. Thus, when there is no service called mysql and I\u0026rsquo;m calling apply -f mysql.yaml it will create the service. When running again, Kubernetes won\u0026rsquo;t do anything. But if I would run create again it will throw an error saying the service is already created.\nFor more information, check out the following docs: Kubernetes Object Management, Imperative Configuration, Declarative Configuration.\nTo see progress information, run:\n# Describes the whole process kubectl describe deployment mysql # Shows only the pod kubectl get pods -l app=mysql Output should be similar to this:\n... Type Status Reason ---- ------ ------ Available True MinimumReplicasAvailable Progressing True NewReplicaSetAvailable OldReplicaSets: \u0026lt;none\u0026gt; NewReplicaSet: mysql-55cd6b9f47 (1/1 replicas created) ... Or in case of get pods:\nNAME READY STATUS RESTARTS AGE mysql-78dbbd9c49-k6sdv 1/1 Running 0 18s To test the instance, run the following snippet:\nkubectl run -it --rm --image=mysql:5.6 --restart=Never mysql-client -- mysql -h mysql -pyourpasswordhere GOTCHA: If you change the password now, it\u0026rsquo;s not enough to re-apply your yaml file to update the container. Since the DB is persisted, the password will not be changed. You have to delete the whole deployment with kubectl delete -f mysql.yaml.\nYou should see the following when running a show databases.\nIf you don\u0026#39;t see a command prompt, try pressing enter. mysql\u0026gt; mysql\u0026gt; mysql\u0026gt; show databases; +--------------------+ | Database | +--------------------+ | information_schema | | kube | | mysql | | performance_schema | +--------------------+ 4 rows in set (0.00 sec) mysql\u0026gt; exit Bye You\u0026rsquo;ll also notice that I’ve mounted a file located here: Database Setup SQL into the container. MySQL container automatically executes these. That file will bootstrap some data and the schema I\u0026rsquo;m going to use.\nThe volume definition is as follows:\nvolumeMounts: - name: mysql-persistent-storage mountPath: /var/lib/mysql - name: bootstrap-script mountPath: /docker-entrypoint-initdb.d/database_setup.sql volumes: - name: mysql-persistent-storage persistentVolumeClaim: claimName: mysql-pv-claim - name: bootstrap-script hostPath: path: /Users/hannibal/golang/src/github.com/Skarlso/kube-cluster-sample/database_setup.sql type: File To check if the bootstrap script was successful, run this:\n~/golang/src/github.com/Skarlso/kube-cluster-sample/kube_files master* ❯ kubectl run -it --rm --image=mysql:5.6 --restart=Never mysql-client -- mysql -h mysql -uroot -pyourpasswordhere kube If you don\u0026#39;t see a command prompt, try pressing enter. mysql\u0026gt; show tables; +----------------+ | Tables_in_kube | +----------------+ | images | | person | | person_images | +----------------+ 3 rows in set (0.00 sec) mysql\u0026gt; This concludes the database service setup. Logs for this service can be viewed with the following command:\nkubectl logs deployment/mysql -f NSQ Lookup The NSQ Lookup will run as an internal service. It doesn\u0026rsquo;t need access from the outside, so I\u0026rsquo;m setting clusterIP: None which will tell Kubernetes that this service is a headless service. This means that it won\u0026rsquo;t be load balanced, and it won\u0026rsquo;t be a single IP service. The DNS will be based upon service selectors.\nOur NSQ Lookup selector is:\nselector: matchLabels: app: nsqlookup Thus, the internal DNS will look like this: nsqlookup.default.svc.cluster.local.\nHeadless services are described in detail here: Headless Service.\nBasically it\u0026rsquo;s the same as MySQL, just with slight modifications. As stated earlier, I\u0026rsquo;m using NSQ\u0026rsquo;s own Docker Image called nsqio/nsq. All nsq commands are there, so nsqd will also use this image just with a different command. For nsqlookupd, the command is:\ncommand: [\u0026#34;/nsqlookupd\u0026#34;] args: [\u0026#34;--broadcast-address=nsqlookup.default.svc.cluster.local\u0026#34;] What\u0026rsquo;s the --broadcast-address for, you might ask? By default, nsqlookup will use the hostname as broadcast address. When the consumer runs a callback it will try to connect to something like: http://nsqlookup-234kf-asdf:4161/lookup?topics=image. Please note that nsqlookup-234kf-asdf is the hostname of the container. By setting the broadcast-address to the internal DNS, the callback will be: http://nsqlookup.default.svc.cluster.local:4161/lookup?topic=images. Which will work as expected.\nNSQ Lookup also requires two ports forwarded: One for broadcasting and one for nsqd callback. These are exposed in the Dockerfile, and then utilized in the Kubernetes template. Like this:\nIn the container template:\nports: - containerPort: 4160 hostPort: 4160 - containerPort: 4161 hostPort: 4161 In the service template:\nspec: ports: - name: tcp protocol: TCP port: 4160 targetPort: 4160 - name: http protocol: TCP port: 4161 targetPort: 4161 Names are required by Kubernetes.\nTo create this service, I\u0026rsquo;m using the same command as before:\nkubectl apply -f nsqlookup.yaml This concludes nsqlookupd. Two of the major players are in the sack!\nReceiver This is a more complex one. The receiver will do three things:\nCreate some deployments; Create the nsq daemon; Expose the service to the public. Deployments The first deployment it creates is its own. The receiver’s container is skarlso/kube-receiver-alpine.\nNsq Daemon The receiver starts an nsq daemon. As stated earlier, the receiver runs an nsqd with it-self. It does this so talking to it can happen locally and not over the network. By making the receiver do this, they will end up on the same node.\nNSQ daemon also needs some adjustments and parameters.\nports: - containerPort: 4150 hostPort: 4150 - containerPort: 4151 hostPort: 4151 env: - name: NSQLOOKUP_ADDRESS value: nsqlookup.default.svc.cluster.local - name: NSQ_BROADCAST_ADDRESS value: nsqd.default.svc.cluster.local command: [\u0026#34;/nsqd\u0026#34;] args: [\u0026#34;--lookupd-tcp-address=$(NSQLOOKUP_ADDRESS):4160\u0026#34;, \u0026#34;--broadcast-address=$(NSQ_BROADCAST_ADDRESS)\u0026#34;] You can see that the lookup-tcp-address and the broadcast-address are set. Lookup tcp address is the DNS for the nsqlookupd service. And the broadcast address is necessary, just like with nsqlookupd, so the callbacks are working properly.\nPublic facing Now, this is the first time I\u0026rsquo;m deploying a public facing service. There are two options. I could use a LoadBalancer since this API will be under heavy load. And if this would be deployed anywhere in production, then it should be using one.\nI\u0026rsquo;m doing this locally though- with one node- so something called a NodePort is enough. A NodePort exposes a service on each node\u0026rsquo;s IP at a static port. If not specified, it will assign a random port on the host between 30000-32767. But it can also be configured to be a specific port, using nodePort in the template file. To reach this service, use \u0026lt;NodeIP\u0026gt;:\u0026lt;NodePort\u0026gt;. If more than one node is configured, a LoadBalancer can multiplex them to a single IP.\nFor further information, check out this document: Publishing Services.\nPutting this all together, we\u0026rsquo;ll get a receiver-service for which the template for is as follows:\napiVersion: v1 kind: Service metadata: name: receiver-service spec: ports: - protocol: TCP port: 8000 targetPort: 8000 selector: app: receiver type: NodePort For a fixed nodePort on 8000 a definition of nodePort must be provided:\napiVersion: v1 kind: Service metadata: name: receiver-service spec: ports: - protocol: TCP port: 8000 targetPort: 8000 selector: app: receiver type: NodePort nodePort: 8000 Image processor The Image Processor is where I\u0026rsquo;m handling passing off images to be identified. It should have access to nsqlookupd, mysql and the gRPC endpoint of the face recognition service. This is actually quite a boring service. In fact, it\u0026rsquo;s not even a service at all. It doesn\u0026rsquo;t expose anything, and thus it\u0026rsquo;s the first deployment only component. For brevity, here is the whole template:\n--- apiVersion: apps/v1 kind: Deployment metadata: name: image-processor-deployment spec: selector: matchLabels: app: image-processor replicas: 1 template: metadata: labels: app: image-processor spec: containers: - name: image-processor image: skarlso/kube-processor-alpine:latest env: - name: MYSQL_CONNECTION value: \u0026#34;mysql.default.svc.cluster.local\u0026#34; - name: MYSQL_USERPASSWORD valueFrom: secretKeyRef: name: kube-face-secret key: mysql_userpassword - name: MYSQL_PORT # TIL: If this is 3306 without \u0026#34; kubectl throws an error. value: \u0026#34;3306\u0026#34; - name: MYSQL_DBNAME value: kube - name: NSQ_LOOKUP_ADDRESS value: \u0026#34;nsqlookup.default.svc.cluster.local:4161\u0026#34; - name: GRPC_ADDRESS value: \u0026#34;face-recog.default.svc.cluster.local:50051\u0026#34; The only interesting points in this file are the multitude of environment properties that are used to configure the application. Note the nsqlookupd address and the grpc address.\nTo create this deployment, run:\nkubectl apply -f image_processor.yaml Face - Recognition The face recognition service does have a service. It\u0026rsquo;s a simple one. Only needed by image-processor. It\u0026rsquo;s template is as follows:\napiVersion: v1 kind: Service metadata: name: face-recog spec: ports: - protocol: TCP port: 50051 targetPort: 50051 selector: app: face-recog clusterIP: None The more interesting part is that it requires two volumes. The two volumes are known_people and unknown_people. Can you guess what they will contain? Yep, images. The known_people volume contains all the images associated to the known people in the database. The unknown_people volume will contain all new images. And that\u0026rsquo;s the path we will need to use when sending images from the receiver; that is wherever the mount point points too, which in my case is /unknown_people. Basically, the path needs to be one that the face recognition service can access.\nNow, with Kubernetes and Docker, this is easy. It can be a mounted S3 or some kind of nfs or a local mount from host to guest. The possibilities are endless (around a dozen or so). I\u0026rsquo;m going to use a local mount for the sake of simplicity.\nMounting a volume is done in two parts. Firstly, the Dockerfile has to specify volumes:\nVOLUME [ \u0026#34;/unknown_people\u0026#34;, \u0026#34;/known_people\u0026#34; ] Secondly, the Kubernetes template needs add volumeMounts as seen in the MySQL service; the difference being hostPath instead of claimed volume:\nvolumeMounts: - name: known-people-storage mountPath: /known_people - name: unknown-people-storage mountPath: /unknown_people volumes: - name: known-people-storage hostPath: path: /Users/hannibal/Temp/known_people type: Directory - name: unknown-people-storage hostPath: path: /Users/hannibal/Temp/ type: Directory We also need to set the known_people folder config setting for the face recognition service. This is done via an environment property:\nenv: - name: KNOWN_PEOPLE value: \u0026#34;/known_people\u0026#34; Then the Python code will look up images, like this:\nknown_people = os.getenv(\u0026#39;KNOWN_PEOPLE\u0026#39;, \u0026#39;known_people\u0026#39;) print(\u0026#34;Known people images location is: %s\u0026#34; % known_people) images = self.image_files_in_folder(known_people) Where image_files_in_folder is:\ndef image_files_in_folder(self, folder): return [os.path.join(folder, f) for f in os.listdir(folder) if re.match(r\u0026#39;.*\\.(jpg|jpeg|png)\u0026#39;, f, flags=re.I)] Neat.\nNow, if the receiver receives a request (and sends it off further down the line) similar to the one below\u0026hellip;\ncurl -d \u0026#39;{\u0026#34;path\u0026#34;:\u0026#34;/unknown_people/unknown220.jpg\u0026#34;}\u0026#39; http://192.168.99.100:30251/image/post \u0026hellip;it will look for an image called unknown220.jpg under /unknown_people, locate an image in the known_folder that corresponds to the person in the unknown image and return the name of the image that matches.\nLooking at logs, you should see something like this:\n# Receiver ❯ curl -d \u0026#39;{\u0026#34;path\u0026#34;:\u0026#34;/unknown_people/unknown219.jpg\u0026#34;}\u0026#39; http://192.168.99.100:30251/image/post got path: {Path:/unknown_people/unknown219.jpg} image saved with id: 4 image sent to nsq # Image Processor 2018/03/26 18:11:21 INF 1 [images/ch] querying nsqlookupd http://nsqlookup.default.svc.cluster.local:4161/lookup?topic=images 2018/03/26 18:11:59 Got a message: 4 2018/03/26 18:11:59 Processing image id: 4 2018/03/26 18:12:00 got person: Hannibal 2018/03/26 18:12:00 updating record with person id 2018/03/26 18:12:00 done And that concludes all of the services that we need to deploy.\nFrontend Lastly, there is a small web-app which displays the information in the db for convenience. This is also a public facing service with the same parameters as the receiver.\nIt looks like this:\nRecap We are now at the point in which I’ve deployed a bunch of services. A recap off the commands I’ve used so far:\nkubectl apply -f mysql.yaml kubectl apply -f nsqlookup.yaml kubectl apply -f receiver.yaml kubectl apply -f image_processor.yaml kubectl apply -f face_recognition.yaml kubectl apply -f frontend.yaml These could be in any order since the application does not allocate connections on start. (Except for image_processor\u0026rsquo;s NSQ consumer. But that re-tries.)\nQuery-ing kube for running pods with kubectl get pods should show something like this if there were no errors:\n❯ kubectl get pods NAME READY STATUS RESTARTS AGE face-recog-6bf449c6f-qg5tr 1/1 Running 0 1m image-processor-deployment-6467468c9d-cvx6m 1/1 Running 0 31s mysql-7d667c75f4-bwghw 1/1 Running 0 36s nsqd-584954c44c-299dz 1/1 Running 0 26s nsqlookup-7f5bdfcb87-jkdl7 1/1 Running 0 11s receiver-deployment-5cb4797598-sf5ds 1/1 Running 0 26s Running minikube service list:\n❯ minikube service list |-------------|----------------------|-----------------------------| | NAMESPACE | NAME | URL | |-------------|----------------------|-----------------------------| | default | face-recog | No node port | | default | kubernetes | No node port | | default | mysql | No node port | | default | nsqd | No node port | | default | nsqlookup | No node port | | default | receiver-service | http://192.168.99.100:30251 | | kube-system | kube-dns | No node port | | kube-system | kubernetes-dashboard | http://192.168.99.100:30000 | |-------------|----------------------|-----------------------------| Rolling update What happens during a rolling update?\nAs it happens during software development, change is requested/needed to some parts of the system. So what happens to our cluster if I change one of its components without breaking the others whilst also maintaining backwards compatibility with no disruption to user experience? Thankfully Kubernetes can help with that.\nWhat I don\u0026rsquo;t like is that the API only handles one image at a time. Unfortunately there is no bulk upload option.\nCode Currently, we have the following code segment dealing with a single image:\n// PostImage handles a post of an image. Saves it to the database // and sends it to NSQ for further processing. func PostImage(w http.ResponseWriter, r *http.Request) { ... } func main() { router := mux.NewRouter() router.HandleFunc(\u0026#34;/image/post\u0026#34;, PostImage).Methods(\u0026#34;POST\u0026#34;) log.Fatal(http.ListenAndServe(\u0026#34;:8000\u0026#34;, router)) } We have two options: Add a new endpoint with /images/post and make the client use that, or modify the existing one.\nThe new client code has the advantage in that it can fall back to submitting the old way if the new endpoint isn\u0026rsquo;t available. The old client code, however, doesn\u0026rsquo;t have this advantage so we can\u0026rsquo;t change the way our code works right now. Consider this: You have 90 servers and you do a slow paced rolling update that will take out servers one step at a time whilst doing an update. If an update lasts around a minute, the whole process will take around one and a half hours to complete, (not counting any parallel updates).\nDuring this time, some of your servers will run the new code and some will run the old one. Calls are load balanced, thus you have no control over which servers will be hit. If a client is trying to do a call the new way but hits an old server, the client will fail. The client can try and fallback, but since you eliminated the old version it will not succeed unless it, by mere chance, hits a server with the new code (assuming no sticky sessions are set).\nAlso, once all your servers are updated, an old client will not be able to use your service any longer.\nNow, you can argue that you don\u0026rsquo;t want to keep old versions of your code forever. And that’s true in a sense. That\u0026rsquo;s why we are going to modify the old code to simply call the new one with some slight augmentations. This way, once all clients have been migrated, the code can simply be deleted without any problems.\nNew Endpoint Let\u0026rsquo;s add a new route method:\n... router.HandleFunc(\u0026#34;/images/post\u0026#34;, PostImages).Methods(\u0026#34;POST\u0026#34;) ... Updating the old one to call the new one with a modified body looks like this:\n// PostImage handles a post of an image. Saves it to the database // and sends it to NSQ for further processing. func PostImage(w http.ResponseWriter, r *http.Request) { var p Path err := json.NewDecoder(r.Body).Decode(\u0026amp;p) if err != nil { fmt.Fprintf(w, \u0026#34;got error while decoding body: %s\u0026#34;, err) return } fmt.Fprintf(w, \u0026#34;got path: %+v\\n\u0026#34;, p) var ps Paths paths := make([]Path, 0) paths = append(paths, p) ps.Paths = paths var pathsJSON bytes.Buffer err = json.NewEncoder(\u0026amp;pathsJSON).Encode(ps) if err != nil { fmt.Fprintf(w, \u0026#34;failed to encode paths: %s\u0026#34;, err) return } r.Body = ioutil.NopCloser(\u0026amp;pathsJSON) r.ContentLength = int64(pathsJSON.Len()) PostImages(w, r) } Well, the naming could be better, but you should get the basic idea. I\u0026rsquo;m modifying the incoming single path by wrapping it into the new format and sending it over to the new endpoint handler. And that\u0026rsquo;s it! There are a few more modifications. To check them out, take a look at this PR: Rolling Update Bulk Image Path PR.\nNow, the receiver can be called in two ways:\n# Single Path: curl -d \u0026#39;{\u0026#34;path\u0026#34;:\u0026#34;unknown4456.jpg\u0026#34;}\u0026#39; http://127.0.0.1:8000/image/post # Multiple Paths: curl -d \u0026#39;{\u0026#34;paths\u0026#34;:[{\u0026#34;path\u0026#34;:\u0026#34;unknown4456.jpg\u0026#34;}]}\u0026#39; http://127.0.0.1:8000/images/post Here, the client is curl. Normally, if the client is a service, I would modify it that in case the new end-point throws a 404 it would try the old one next.\nFor brevity, I\u0026rsquo;m not modifying NSQ and the others to handle bulk image processing; they will still receive it one by one. I\u0026rsquo;ll leave that up to you as homework ;)\nNew Image To perform a rolling update, I must create a new image first from the receiver service.\ndocker build -t skarlso/kube-receiver-alpine:v1.1 . Once this is complete, we can begin rolling out the change.\nRolling update In Kubernetes, you can configure your rolling update in multiple ways:\nManual Update If I was using a container version in my config file called v1.0, then doing an update is simply calling:\nkubectl rolling-update receiver --image:skarlso/kube-receiver-alpine:v1.1 If there is a problem during the rollout we can always rollback.\nkubectl rolling-update receiver --rollback It will set back the previous version. No fuss, no muss.\nApply a new configuration file The problem with by-hand updates is that they aren\u0026rsquo;t in source control.\nConsider this: Something has changed, A couple of servers got updated by hand to do a quick “patch fix”, but nobody witnessed it and it wasn’t documented. A new person comes along and does a change to the template and applies the template to the cluster. All the servers are updated, and then all of a sudden there is a service outage.\nLong story short, the servers which got updated are written over because the template doesn’t reflect what has been done manually.\nThe recommended way is to change the template in order to use the new version, and than apply the template with the apply command.\nKubernetes recommends that a Deployment with ReplicaSets should handle a rollout. This means there must be at least two replicates present for a rolling update. If less than two replicates are present then the update won\u0026rsquo;t work (unless maxUnavailable is set to 1). I increase the replica count in yaml. I also set the new image version for the receiver container.\nreplicas: 2 ... spec: containers: - name: receiver image: skarlso/kube-receiver-alpine:v1.1 ... Looking at the progress, this is what you should see :\n❯ kubectl rollout status deployment/receiver-deployment Waiting for rollout to finish: 1 out of 2 new replicas have been updated... You can add in additional rollout configuration settings by specifying the strategy part of the template like this:\nstrategy: type: RollingUpdate rollingUpdate: maxSurge: 1 maxUnavailable: 0 Additional information on rolling update can be found in the below documents: Deployment Rolling Update, Updating a Deployment, Manage Deployments, Rolling Update using ReplicaController.\nNOTE MINIKUBE USERS: Since we are doing this on a local machine with one node and 1 replica of an application, we have to set maxUnavailable to 1; otherwise Kubernetes won\u0026rsquo;t allow the update to happen, and the new version will remain in Pending state. That’s because we aren’t allowing for a services to exist with no running containers; which basically means service outage.\nScaling Scaling is dead easy with Kubernetes. Since it\u0026rsquo;s managing the whole cluster, you basically just need to put a number into the template of the desired replicas to use.\nThis has been a great post so far, but it\u0026rsquo;s getting too long. I\u0026rsquo;m planning on writing a follow-up where I will be truly scaling things up on AWS with multiple nodes and replicas; plus deploying a Kubernetes cluster with Kops. So stay tuned!\nCleanup kubectl delete deployments --all kubectl delete services -all Final Words And that’s it ladies and gentlemen. We wrote, deployed, updated and scaled (well, not yet really) a distributed application with Kubernetes.\nIf you have any questions, please feel free to chat in the comments below. I\u0026rsquo;m happy to answer.\nI hope you’ve enjoyed reading this. I know it\u0026rsquo;s quite long; I was thinking of splitting it up multiple posts, but having a cohesive, one page guide is useful and makes it easy to find, save, and print.\nThank you for reading, Gergely.\n","permalink":"https://skarlso.github.io/2018/03/15/kubernetes-distributed-application/","summary":"Intro Alright folks. Settle in and get comfortable. This is going to be a long, but hopefully, fun ride.\nI\u0026rsquo;m going to deploy a distributed application with Kubernetes. I attempted to create an application that I thought resembled a real world app. Obviously I had to cut some corners due to time and energy constraints.\nMy focus will be on Kubernetes and deployment.\nShall we delve right in?\nThe Application TL;DR The application itself consists of six parts.","title":"Kubernetes distributed application deployment with sample Face Recognition App"},{"content":"Intro So I was at Go Budapest Meetup yesterday, where the brilliant Johan Brandhorst gave a talk about his project based on gRPC using gRPC-web + GopherJS + protobuf. He also has some Go contributions and check out his project here: Protobuf. It\u0026rsquo;s GopherJS Bindings for ProtobufJS and gRPC-Web.\nIt was interesting to see where these projects could lead and I see the potential in them. I liked the usage of Protobuf and gRPC, I don\u0026rsquo;t have THAT much experience with them. However after yesterday, I\u0026rsquo;m eager to find an excuse to do something with these libraries. I used gRPC indirectly, well, the result of it, when dealing with Google Cloud Platform\u0026rsquo;s API. Which is largely generated code through gRPC and protobuf.\nHe also presented a bi-directional stream communication between the gRPC-web client and the server which was an interesting feat to produce. It did involve the use of errgroup. Which is nice.\nI didn\u0026rsquo;t look THAT much into WebAssembly however, again, after yesterday, I will. He gave a shout out to WebAssembly developers that he is ready to tackle the Go bindings for WASM!\nIt was a good change of pace to look at some Go code being written, I\u0026rsquo;ll be sure to visit the meetup again, in about three months when the next one will come.\nMaybe, I\u0026rsquo;ll even give a talk if they are looking for speakers. ;)\nA huge thank you to Emarsys Budapest for organizing the event and bringing Johan to us for his talk.\nThanks, Gergely\n","permalink":"https://skarlso.github.io/2018/02/06/go-budapest-meetup/","summary":"Intro So I was at Go Budapest Meetup yesterday, where the brilliant Johan Brandhorst gave a talk about his project based on gRPC using gRPC-web + GopherJS + protobuf. He also has some Go contributions and check out his project here: Protobuf. It\u0026rsquo;s GopherJS Bindings for ProtobufJS and gRPC-Web.\nIt was interesting to see where these projects could lead and I see the potential in them. I liked the usage of Protobuf and gRPC, I don\u0026rsquo;t have THAT much experience with them.","title":"Go Budapest Meetup"},{"content":"Intro Hi folks.\nToday, I would like demonstrate how to use Ansible in order to construct a server hosting multiple HTTPS domains with Nginx and LetsEncrypt. Are you ready? Let\u0026rsquo;s dive in.\nTL;DR What you will need There is really only one thing you need in order for this to work and that is Ansible. If you would like to run local tests without a remote server, than you will need Vagrant and VirtualBox. But those two are optional.\nWhat We Are Going To Set Up The setup is as follows:\nNagios We are going to have a Nagios with a custom check for pending security updates. That will run under nagios.example.com.\nHugo Website The main web site is going to be a basic Hugo site. Hugo is a static Go based web site generator. This Blog is run by it.\nWe are also going to setup NoIP which will provide the DNS for the sites.\nWiki The wiki is a plain, basic DokuWiki.\nHTTPS + Nginx And all the above will be hosted by Nginx with HTTPS provided by letsencrypt. We are going to set all these up with Ansible on top so it will be idempotent.\nRepository All of the playbooks and the whole thing together can be viewed here: Github Ansible Server Setup.\nAnsible I won\u0026rsquo;t be writing everything down to the basics about Ansible. For that you will need to go and read its documentation. But I will provide ample of clarification for using what I\u0026rsquo;ll be using.\nSome Basics Ansible is a configuration management tool which, unlike chef or puppet, isn\u0026rsquo;t master - slave based. It\u0026rsquo;s using SSH to run a set of instructions on a target machine. The instructions are written in yaml files and look something like this:\n--- # tasks file for ssh - name: Copy sshd_config copy: content=\u0026#34;{{sshd_config}}\u0026#34; dest=/etc/ssh/sshd_config notify: - SSHD Restart This is a basic Task which copies over an sshd_config file overwriting the one already being there. It can execute in priviliged mode if root password is provided or the user has sudo rights.\nIt works from so called hosts files where the server details are described. This is how a basic host file would look like:\n[local] 127.0.0.1 [webserver1] 1.23.4.5 Ansible will use these settings to try and access the server. To test if the connection is working, you can send a ping task like this:\nansible all -m ping Ansible uses variables for things that change. They are defined under each task\u0026rsquo;s subfolder called vars. Please feel free to change the varialbes there to your liking.\nSSH Access You can either define SSH information per host or per group or globally. In this example I have it under the groups wars called webserver1 like this (vars.yaml):\n--- # SSH sudo keys and pass ansible_become_pass: \u0026#39;{{vault_ansible_become_pass}}\u0026#39; ansible_ssh_port: \u0026#39;{{vault_ansible_ssh_port}}\u0026#39; ansible_ssh_user: \u0026#39;{{vault_ansible_ssh_user}}\u0026#39; ansible_ssh_private_key_file: \u0026#39;{{vault_ansible_ssh_private_key_file}}\u0026#39; home_dir: /root Further reading Further readings are:\nServers For Hackers Ansible docs Vault The vault is the place where we can keep secure information. This file is called vault and usually lives under either group_vars or host_vars. The preference is up to you.\nThis file is encrypted using a password you specify. You can have the vault password stored in the following ways:\nStore it on a secure drive which is encrypted and only mounted when the playbook is executed Store it on Keybase Store it on an encrypted S3 bucket Store it in a file next to the playbook which is never commited into source control Either way, in the end, ansible will look for a file called .vault_password for when it\u0026rsquo;s trying to decrypt the file. You can define a different file in the ansible.cfg file using the vault_password_file option.\nYou can create a vault like this:\nansible-vault create vault If you are following along, you are going to need these variables in the vault:\nvault_ansible_become_pass: \u0026lt;your_sudo_password\u0026gt; # if applicable vault_ansible_ssh_user: \u0026lt;ssh_user\u0026gt; vault_ansible_ssh_private_key_file: /Users/user/.ssh/ida_rsa vault_nagios_password: supersecurenagiosadminpassword vault_nagios_username: nagiosadmin vault_noip_username: youruser@gmail.com vault_noip_password: \u0026#34;SuperSecureNoIPPassword\u0026#34; vault_nginx_user: \u0026lt;localuser\u0026gt; You can always edit the vault later on with:\nansible-vault edit group_vars/webserver1/vault --vault-password-file=.vault_pass Tasks The following are a collection of tasks which execute in order. The end task, which is letsencrypt, relies on all the hosts being present and configured under Nginx. Otherwise it will throw an error that the host you are trying to configure HTTPS for, isn\u0026rsquo;t defined.\nNo-IP I\u0026rsquo;m choosing No-ip as a DNS provider because it\u0026rsquo;s cheap and the sync tool is easy to automate. To automate the CLI of No-IP, I\u0026rsquo;m using a package called expect. This looks something like this:\ncd {{home_dir}} wget http://www.no-ip.com/client/linux/noip-duc-linux.tar.gz mkdir -p noip tar zxf noip-duc-linux.tar.gz -C noip cd noip/* make /usr/bin/expect \u0026lt;\u0026lt;END_SCRIPT spawn make install expect \u0026#34;Please enter the login/email*\u0026#34; { send \u0026#34;{{noip_username}}\\r\u0026#34; } expect \u0026#34;Please enter the password for user*\u0026#34; { send \u0026#34;{{noip_password}}\\r\u0026#34; } expect { \u0026#34;Do you wish to have them all updated*\u0026#34; { send \u0026#34;y\u0026#34; exp_continue } } expect \u0026#34;Please enter an update interval*\u0026#34; { send \u0026#34;30\\r\u0026#34; } expect \u0026#34;Do you wish to run something at successful update*\u0026#34; {send \u0026#34;N\u0026#34; } END_SCRIPT The interesting part is the command running expect. Basically, it\u0026rsquo;s expecting some kind of output which is outlined there. And has canned answers for those which it sends to the waiting command.\nTo Util or Not To Util So, there are small tasks, like installing vim and wget and such which could warrant the existance of a utils task. Utils task would install the packages that are used as convinience and don\u0026rsquo;t really relate to a singe task.\nYet I settled for the following. Each of my tasks has a dependency part. The given tasks takes care of all the packages it needs so they can be executed on their own as well as in unison.\nThis looks like this:\n# Install dependencies - name: Install dependencies apt: pkg=\u0026#34;{{item}}\u0026#34; state=installed with_items: - \u0026#34;{{deps}}\u0026#34; For which the deps variable is defined as follows:\n# Defined dependencies for letsencrypt task. deps: [\u0026#39;git\u0026#39;, \u0026#39;python-dev\u0026#39;, \u0026#39;build-essential\u0026#39;, \u0026#39;libpython-dev\u0026#39;, \u0026#39;libpython2.7\u0026#39;, \u0026#39;augeas-lenses\u0026#39;, \u0026#39;libaugeas0\u0026#39;, \u0026#39;libffi-dev\u0026#39;, \u0026#39;libssl-dev\u0026#39;, \u0026#39;python-virtualenv\u0026#39;, \u0026#39;python3-virtualenv\u0026#39;, \u0026#39;virtualenv\u0026#39;] This is much cleaner. And if a task is no longer needed, it\u0026rsquo;s dependencies will no longer be needed either in most of the cases.\nNagios I\u0026rsquo;m using Nagios 4 which is a real pain in the butt to install. Luckily, thanks to Ansiblei, I only ever had to figure it out once. Now I have a script for that. Installing Nagios demands several, smaller components to be installed. Thus our task uses import from outside tasks like this:\n- name: Install Nagios block: - include: create_users.yml # creates the Nagios user - include: install_dependencies.yml # installs Nagios dependencies - include: core_install.yml # Installs Nagios Core - include: plugin_install.yml # Installs Nagios Plugins - include: create_htpasswd.yml # Creates a password for Nagios\u0026#39; admin user - include: setup_custom_check.yml # Adds a custom check which is to check how many security updates are pending when: st.stat.exists == False The when is a check for a variable created by a file check.\n- stat: path: /usr/local/nagios/bin/nagios register: st It checks if Nagios is installed or not. If yes, skip.\nI\u0026rsquo;m not going to paste in here all the subtasks because that would be huge. You can check those out in the repository under Nagios.\nHugo Hugo is easy to install. Its sole requirement is Go. To install hugo you simply run apt-get install hugo. Setting up the site for me was just checking out the git repo and than execute hugo from the root folder like this:\nhugo server --bind=127.0.0.1 --port=8080 --baseUrl=https://example.com --appendPort=false --logFile hugo.log --verboseLog --verbose -v \u0026amp; Wiki I used DokuWiki because it\u0026rsquo;s a file based wiki so installation is basically just downloading the archive, extracting it and done. The only thing that\u0026rsquo;s needed for it, is php-fpm to run it and a few php modules which I\u0026rsquo;ll outline in the ansible playbook.\nThe VHOST file for DokuWiki is provided by them and looks like this:\nserver { server_name {{ wiki_server_name }}; root {{ wiki_root }}; index index.php index.html index.htm; client_max_body_size 2M; client_body_buffer_size 128k; location / { index doku.php; try_files $uri $uri/ @dokuwiki; } location @dokuwiki { rewrite ^/_media/(.*) /lib/exe/fetch.php?media=$1 last; rewrite ^/_detail/(.*) /lib/exe/detail.php?media=$1 last; rewrite ^/_export/([^/]+)/(.*) /doku.php?do=export_$1\u0026amp;id=$2 last; rewrite ^/(.*) /doku.php?id=$1 last; } location ~ \\.php$ { try_files $uri =404; fastcgi_pass unix:/var/run/php5-fpm.sock; fastcgi_index index.php; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; include fastcgi_params; } location ~ /\\.ht { deny all; } location ~ /(data|conf|bin|inc)/ { deny all; } } Nginx Nginx install is through apt as well. Here, however, there is a bit of magic going on with templates. The templates provide the vhost files for the three hosts we will be running. This looks as follows:\n- name: Install vhosts block: - template: src=01_example.com.j2 dest=/etc/nginx/vhosts/01_example.com notify: - Restart Nginx - template: src=02_wiki.example.com.j2 dest=/etc/nginx/vhosts/02_wiki_example.com notify: - Restart Nginx - template: src=03_nagios.example.com.j2 dest=/etc/nginx/vhosts/03_nagios.example.com notify: - Restart Nginx Now, you might be wondering what notify is? It\u0026rsquo;s basically a handler that gets notified to restart nginx. The great part about it is that it does this only once, even if it was called multiple times. The handler looks like this:\n- name: Restart Nginx service: name: nginx state: restarted And lives under handlers sub-folder.\nWith this, Nginx is done and should be providing our sites under plain HTTP.\nLetsEncrypt Now comes the part where we enable HTTPS for all these three domains. Which is as follows:\nexample.com wiki.example.com nagios.example.com This is actually quiet simple now-a-days with certbot-auto. In fact, it will insert the configurations we need all by itself. The only thing for us to do is to specify what domains we have and what our challenge would be. Also, we have to pass in some variables for certbot-auto to run in a non-interactive mode. This looks as follows:\n- name: Generate Certificate for Domains shell: ./certbot-auto --authenticator standalone --installer nginx -d \u0026#39;{{ domain_example }}\u0026#39; -d \u0026#39;{{ domain_wiki }}\u0026#39; -d \u0026#39;{{ domain_nagios }}\u0026#39; --email example@gmail.com --agree-tos -n --no-verify-ssl --pre-hook \u0026#34;sudo systemctl stop nginx\u0026#34; --post-hook \u0026#34;sudo systemctl start nginx\u0026#34; --redirect args: chdir: /opt/letsencrypt And that\u0026rsquo;s that. The interesting and required part here is the pre-hook and post-hook. Without those it wouldn\u0026rsquo;t work because the ports that certbot is performing the challenge on would be taken already. This stops nginx, performs the challenge and generates the certs, and starts nginx again. Also note --redirect. This will force HTTPS on the sites and disables plain HTTP.\nIf all went well our sites should contain information like this:\nlisten 443 ssl; # managed by Certbot ssl_certificate /etc/letsencrypt/live/example.com-0001/fullchain.pem; # managed by Certbot ssl_certificate_key /etc/letsencrypt/live/example.com-0001/privkey.pem; # managed by Certbot include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot Test Run using Vagrant If you don\u0026rsquo;t want to run all this on a live server to test out, you can do either of these two things:\nUse a remote dedicated test server Use a local virtual machine with Vagrant Here, I\u0026rsquo;m giving you an option for the later.\nIt\u0026rsquo;s possible for most of the things to be tested on a local Vagrant machine. Most of the time a Vagrant box is enough to test out installing things. A sample Vagrant file looks like this:\n# encoding: utf-8 # -*- mode: ruby -*- # vi: set ft=ruby : # Box / OS VAGRANT_BOX = \u0026#39;ubuntu/xenial64\u0026#39; VM_NAME = \u0026#39;ansible-practice\u0026#39; Vagrant.configure(2) do |config| # Vagrant box from Hashicorp config.vm.box = VAGRANT_BOX # Actual machine name config.vm.hostname = VM_NAME # Set VM name in Virtualbox config.vm.provider \u0026#39;virtualbox\u0026#39; do |v| v.name = VM_NAME v.memory = 2048 end # Ansible provision config.vm.provision \u0026#39;ansible_local\u0026#39; do |ansible| ansible.limit = \u0026#39;all\u0026#39; ansible.inventory_path = \u0026#39;hosts\u0026#39; ansible.playbook = \u0026#39;local.yml\u0026#39; end end This interesting part here is the ansible provision section. It\u0026rsquo;s running a version of Ansible that is called ansible_local. It\u0026rsquo;s local, becuase it will be only on the VirtualBox. Meaning, you don\u0026rsquo;t have to have Ansible installed to test it on a vagrant box. Neat, huh?\nTo test your playbook, simply run vagrant up and you should see the provisioning happening.\nRoom for improvement And that should be all. Note that this setup isn\u0026rsquo;t quiet enterprise ready. I would add the following things:\nTests and Checks A ton of tests and checks if the commands that we are using are actually successful or not. If they aren\u0026rsquo;t make them report the failure.\nMultiple Domains If you happen to have a ton of domain names to set up, this will not be the most effective way. Right now letsencrypt creates a single certificate file for those three domains with -d and that\u0026rsquo;s not what you want with potentially hundreds of domains.\nIn that case, have a list to go through with with_items. Note that you\u0026rsquo;ll have to restart nginx on each line, because you don\u0026rsquo;t want one of them fail and stop the process entirely. Rather have a few fail but the rest still work.\nConclusion That\u0026rsquo;s it folks. Have fun setting up servers all over the place and enjoy the power of nginx and letsencrypt and not having to worry about adding another server into the bunch.\nThank you for reading, Gergely.\n","permalink":"https://skarlso.github.io/2018/01/23/nginx-certbot-ansible/","summary":"Intro Hi folks.\nToday, I would like demonstrate how to use Ansible in order to construct a server hosting multiple HTTPS domains with Nginx and LetsEncrypt. Are you ready? Let\u0026rsquo;s dive in.\nTL;DR What you will need There is really only one thing you need in order for this to work and that is Ansible. If you would like to run local tests without a remote server, than you will need Vagrant and VirtualBox.","title":"Ansible + Nginx + LetsEncrypt + Wiki + Nagios"},{"content":"Intro Hi folks.\nIn the past couple of months I\u0026rsquo;ve been slowly updating Furnace.\nThere are three major changes that happened. Let\u0026rsquo;s take a look at them, shall we?\nGoogle Cloud Platform Furnace now supports Google Cloud Platform (GCP). It provides the same API to handle GCP resource as with AWS. Namely, create, delete, status, update. I opted to leave out push because Google mostly works with git based repositories, meaning a push is literary just a push, than Google handles distributing the new code by itself.\nAll the rest of the commands should work the same way as AWS.\nDeployment Manager GCP has a similar service to AWS CloudFormations called Deployment Manager. The documentation is fairly detailed with a Bookshelf example app to deploy. Code and Templates can be found in their Git repositroy here: Deployment Manager Git Repository.\nSetting up GCP As the README of Furnace outlines\u0026hellip;\nPlease carefully read and follow the instruction outlined in this document: Google Cloud Getting Started. It will describe how to download and install the SDK and initialize cloud to a Project ID.\nTake special attention to these documents:\nInitializing GCloud Tools Authorizing Tools\nFurnace uses a Google Key-File to authenticate with your Google Cloud Account and Project. In the future, Furnace assumes these things are properly set up and in working order.\nTo initialize the client, it uses the following code:\nctx := context.Background() client, err := google.DefaultClient(ctx, dm.NdevCloudmanScope) The DefaultClient in turn, does the following:\n// FindDefaultCredentials searches for \u0026#34;Application Default Credentials\u0026#34;. // // It looks for credentials in the following places, // preferring the first location found: // // 1. A JSON file whose path is specified by the // GOOGLE_APPLICATION_CREDENTIALS environment variable. // 2. A JSON file in a location known to the gcloud command-line tool. // On Windows, this is %APPDATA%/gcloud/application_default_credentials.json. // On other systems, $HOME/.config/gcloud/application_default_credentials.json. // 3. On Google App Engine it uses the appengine.AccessToken function. // 4. On Google Compute Engine and Google App Engine Managed VMs, it fetches // credentials from the metadata server. // (In this final case any provided scopes are ignored.) func FindDefaultCredentials(ctx context.Context, scope ...string) (*DefaultCredentials, error) { Take note on the order. This is how Google will authenticate your requests.\nRunning GCP Running gcp is largely similar to AWS. First, you create the necessary templates to your infrastructure. This is done via the Deployment Manager and it\u0026rsquo;s templating engine. The GCP templates are Python JINJA files. Examples are provided in the template directory. It\u0026rsquo;s a bit more complicated than the CloudFormation templates in that it uses outside templates plus schema files to configure dynamic details.\nIt\u0026rsquo;s all explained in these documents: Creating a Template Step-by-step and Creating a Basic Template.\nIt\u0026rsquo;s not trivial however. And using the API can also be confusing. The Google Code is just a generated Go code file using gRPC. But studying it may provide valuable insigth into how the API is structured. I\u0026rsquo;m also providing some basic samples that I gathered together and the readme does a bit more explaining on how to use them.\nYour First Stack Once you have everything set-up you\u0026rsquo;ll need a configuration file for Furnace. The usage is outlined more here YAML Configuration. The configuration file for GCP looks like this:\nmain: project_name: testplatform-1234 spinner: 1 gcp: template_name: google_template.yaml stack_name: test-stack Where project_name is the name you generate for your first billable Google Cloud Platform project. Template lives next to this yaml file and stack name must be DNS complient.\nOnce you have a project and a template setup, it\u0026rsquo;s as simple as calling ./furnace-gcp create or ./furnace-gcp create mycustomstack.\nDeleting Deleting happens with ./furnace-gcp delete or ./furnace-gcp delete mycustomstack. Luckily, as with AWS, this means that every resource created with the DeploymentManager will be deleted leaving no need for search and cleanup.\nProject Name vs. Project ID Unlike with AWS Google requires your stack name and project id to be DNS complient. This is most likely because all API calls and such contain that information.\nSeparate Binaries In order to mitigate some of Furnace\u0026rsquo;s size, I\u0026rsquo;m providing separate binaries for each service it supports.\nThe AWS binaries can be found in aws folder, and respectively, the Google Cloud Platform is located in gcp. Both are build-able by running make.\nIf you would like to run both with a single command, a top level make file is provided for your convinience. Just run make from the root. That will build all binaries. Later on, Digital Oceans will join the ranks.\nYAML Configuration Last but not least, Furnace now employs YAML files for configuration. However, it isn\u0026rsquo;t JUST using YAML files. It also employs a smart configuration pattern which works as follows.\nSince Furnace is a distributed binary file which could be running from any given location at any time. Because of that, at first I opted for a global configuration directory.\nNow, however, furnace uses a furnace configuration file named with the following pattern: .stackalias.furnace. Where stackname, or stack is the name of a custom stack you would like to create for a project. The content of this file is a single entry, which is the location, relative to this file, of the YAML configuration files for the given stack. For example:\nstacks/mydatabasestack.yaml This means, that in the directory called stacks there will a yaml configuration file for your database stack. The AWS config file looks like this:\nmain: stackname: FurnaceStack spinner: 1 aws: code_deploy_role: CodeDeployServiceRole region: us-east-1 enable_plugin_system: false template_name: cloud_formation.template app_name: furnace_app code_deploy: # Only needed in case S3 is used for code deployment code_deploy_s3_bucket: furnace_code_bucket # The name of the zip file in case it\u0026#39;s on a bucket code_deploy_s3_key: furnace_deploy_app # In case a Git Repository is used for the application, define these two settings git_account: Skarlso/furnace-codedeploy-app git_revision: b89451234... The important part is the template_name. The template has to be next to this yaml file. To use this file, you simply call any of the AWS or GCP commands with an extra, optional parameter like this:\n./furnace-aws create mydatabase Note that mydatabase will translate to .mydatabase.furnace.\nThe intelligent part is, that this file could be placed anywhere in the project folder structure; because furnace, when looking for a config file, traverses backwards from the current execution directory up until /. Where root is not included in the search.\nConsider the following directory tree:\n├── docs │ ├── furnace-aws status mydatabase ├── stacks │ ├── mystack.template │ └── mystack.yaml └── .mydatabase.furnace\nYou are currently in your docs directory and would like to ask for the status of your database. You don\u0026rsquo;t have to move to the location of the setting file, just simply run the command from where you are. This only works if you are above the location of the file. If you would be below, furnace would say it can\u0026rsquo;t find the file. Because it only traverses upwards.\n.mydatabase.furnace here contains only a single entry stacks/mystack.yaml. And that\u0026rsquo;s it. This way, you could have multiple furnace files, for example a .database.furnace, .front-end.furnace and a .backend.furnace. All three would work in unison, and if want needs updating, simply run ./furnace-aws update backend. And done!\nClosing words As always, contributions are welcomed in the form of issues or pull requests. Questions anything, I tend to answer as soon as I can.\nAlways run the tests before submitting.\nThank you for reading. Gergely.\n","permalink":"https://skarlso.github.io/2018/01/13/furnace-massive-update/","summary":"Intro Hi folks.\nIn the past couple of months I\u0026rsquo;ve been slowly updating Furnace.\nThere are three major changes that happened. Let\u0026rsquo;s take a look at them, shall we?\nGoogle Cloud Platform Furnace now supports Google Cloud Platform (GCP). It provides the same API to handle GCP resource as with AWS. Namely, create, delete, status, update. I opted to leave out push because Google mostly works with git based repositories, meaning a push is literary just a push, than Google handles distributing the new code by itself.","title":"Huge Furnace Update"},{"content":"Intro Hi All.\nToday I would like to write about an AWS finger practice.\nPreviously, I wrote about how I build and deploy my blog with Wercker. Since, I\u0026rsquo;m a cloud engineer and I dislike Oracle and it\u0026rsquo;s ever expending tenctacles into the abyss, I wanted to switch to use something else.\nMy build and deploy cycle is simple.\nCommit to Blogsource Repo -\u0026gt; Wercker WebHook -\u0026gt; Builds my blog using Hugo -\u0026gt; Pushed to a Different Repository which my Github Blog.\nThat\u0026rsquo;s all.\nIt\u0026rsquo;s quiet possible to reproduce this on AWS without infering costs. Unless you publish like\u0026hellip; a couple 100 posts / week.\nI\u0026rsquo;m going to use the following services: CloudFormation, AWS Lambda, CodeBuild, S3.\nTo deploy the below describe architecture in your account in us-east-1 region simply click this button: BEFORE doing that though you need the following created:\nHave a bucket for your lambda function. The lambda function can be found here:\nLambda Repository.\nZip up the lambda folder contents by doing this:\ncd lambda zip -r gitpusher.zip * aws s3 cp gitpusher.zip s3://your-lambda-bucket That\u0026rsquo;s it.\nTo read a description of the stack, please continue.\nTL;DR; The architecture I\u0026rsquo;m about to lay out is simple in its use and design. I tried not to complicate things, because I think the simpler something is, the less prone to failure it will be.\nIn its most basic form the flow is as follows:\n.\nYou push something into a repository you provide. CodeBuild has a webhook to this repository so on each commit it starts to build the blog. The build will use a so called buildspec.yaml file which describes how your blog should be built. Mine looks like this:\nversion: 0.2 phases: install: commands: - echo Installing required packages and Hugo - apt-get update - apt-get install -y git golang wget - wget -q https://github.com/gohugoio/hugo/releases/download/v0.31/hugo_0.31_Linux-64bit.deb -O /tmp/hugo.dep - dpkg -i /tmp/hugo.dep pre_build: commands: - echo Downloading source code - git clone https://github.com/Skarlso/blogsource.git /opt/app build: commands: - echo Build started on `date` - cd /opt/app \u0026amp;\u0026amp; hugo --theme purehugo post_build: commands: - echo Build completed on `date` artifacts: files: - /opt/app/public/**/* When it\u0026rsquo;s finished, CodeBuild will upload everything in the public folder as a zip to a bucket. The bucket has a lambda attached which triggers on putObject event with the extension .zip. It downloads the archive, extracts it and pushes it to another repository, which is the repository for the blog.\nAnd done! That\u0026rsquo;s it. For an architecture overview, please read on.\nArchitecture Now, we are going to use CloudFormation stack to deploy these resources. Because we aren\u0026rsquo;t animals to create them by hand, yes?\nAn overview of my current architecture is best shown by this image:\n.\nLet\u0026rsquo;s go over these components one - by - one.\nLambda Role This is the Role which allows the Lambda to access things in your account. It needs the following service access: s3, logs, lambda; and the following permissions: logs:Create*, logs:PutLogEvents, s3:GetObject, s3:ListBucket.\nCode Build Role This is the role which allows CodeBuild to have access to services it needs. These services are the following: s3, logs, ssm, codebuild. CodeBuild also needs the following actions allowed: logs:Create*, logs:PutLogEvents, s3:GetObject, s3:PutObject, ssm:GetParameters.\nBuild Bucket This is the bucket in which CodeBuild will push the generated build artifact.\nBlog Pusher Function This is the heart of this project. It contains the logic to download the zipped artifact, extract it, create a hollow repository from the extracted archive and push the changes to the repository. And just the changes.\nThis is achieve by a short Python 3.6 script which can be found in the linked repository.\nParameters The stack requires you to provide a couple of parameters which are described in the template. Like, bucket name, github repository, git token and such. Please refer to the template for a full description of each.\nCharges I recently push a couple of builds to test this configuration and I inferred 0.2 USD in charges. But that was like 10-15 builds a day.\nDeploying In order to deploy this you can use Furnace to easily manage the template and it\u0026rsquo;s parameters. Once you copy the template to the target directory, simply run furnace aws create and provide the necessary parameters.\nConclusion And that is all. A nice little stack which does the same as Wercker without costs but the leisure of simply pushing up some change to a repository of your choosing.\nI hope you enjoyed this little write up as much as I enjoyed creating it.\nAs always, Thanks for reading! Gergely.\n","permalink":"https://skarlso.github.io/2017/12/04/commit-build-deploy/","summary":"Intro Hi All.\nToday I would like to write about an AWS finger practice.\nPreviously, I wrote about how I build and deploy my blog with Wercker. Since, I\u0026rsquo;m a cloud engineer and I dislike Oracle and it\u0026rsquo;s ever expending tenctacles into the abyss, I wanted to switch to use something else.\nMy build and deploy cycle is simple.\nCommit to Blogsource Repo -\u0026gt; Wercker WebHook -\u0026gt; Builds my blog using Hugo -\u0026gt; Pushed to a Different Repository which my Github Blog.","title":"Commit-Build-Deploy With AWS CodeBuild and Lambda"},{"content":"Hi there folks.\nJust a quick post, of how I went on and created an IKEA manual about Furnace.\nPage 1: . Page 2: .\nI drew these using Krita. I mostly used a mouse but I also used a Wacom Bamboo drawing tabled, for sketches and such.\nThanks, Gergely.\n","permalink":"https://skarlso.github.io/2017/11/06/furnace-ikea-manual/","summary":"Hi there folks.\nJust a quick post, of how I went on and created an IKEA manual about Furnace.\nPage 1: . Page 2: .\nI drew these using Krita. I mostly used a mouse but I also used a Wacom Bamboo drawing tabled, for sketches and such.\nThanks, Gergely.","title":"Furnace Ikea Manual"},{"content":"Hey folks.\nQuick note. Furnace now comes pre-compiled easy to access binaries which you can download and use out of the box.\nNo need to install anything, or compile the source. Just download, unzip and use.\nHere is the website: Furnace Website.\nEnjoy, Cheers, Gergely.\n","permalink":"https://skarlso.github.io/2017/09/03/furnace-binaries/","summary":"Hey folks.\nQuick note. Furnace now comes pre-compiled easy to access binaries which you can download and use out of the box.\nNo need to install anything, or compile the source. Just download, unzip and use.\nHere is the website: Furnace Website.\nEnjoy, Cheers, Gergely.","title":"Furnace Binaries"},{"content":" ","permalink":"https://skarlso.github.io/2017/05/31/notetaking/","summary":" ","title":"Notetaking"},{"content":"Intro A while ago, I was added as a curator for a Gem called JsonPath. It\u0026rsquo;s a small but very useful and brilliant gem. It had a couple of problems which I fixed, but the hardest to eliminate proved to be a series of evals throughout the code.\nYou could opt in using eval with a constructor parameter, but generally, it was considered to be unsafe. Thus, normally when a project was using it, like Huginn they had to opt out by default, thus missing out on sweet parsing like this: $..book[?(@['price'] \u0026gt; 20)].\nEval In order to remove eval, first I had to understand what it is actually doing. I had to take it apart.\nAfter much digging and understanding the code, I found, all it does is perform the given operations on the current node. And if the operation is true, it will select that node, otherwise, return false, and ignore that node.\nFor example $..book[?(@['price'] \u0026gt; 20)] could be translated to:\nreturn @_current_node[\u0026#39;price\u0026#39;] \u0026gt; 20 Checking first if 'price' is even a key in @_current_node. Once I\u0026rsquo;ve understood this part, I set on trying to fix eval.\nSAFE = 4 In ruby, you could extract the part where you Eval and put it into its own proc and set SAFE = 4 which will disable some things like system calls.\nproc do SAFE = 4 eval(some_expression) end.call SAFE levels:\n$SAFE\tDescription 0\tNo checking of the use of externally supplied (tainted) data is performed. This is Ruby\u0026rsquo;s default mode.\n= 1\tRuby disallows the use of tainted data by potentially dangerous operations. = 2\tRuby prohibits the loading of program files from globally writable locations. = 3\tAll newly created objects are considered tainted. = 4\tRuby effectively partitions the running program in two. None - tainted objects may not be modified. Typically, this will be used to create a sandbox: the program sets up an environment using a lower $SAFE level, then resets $SAFE to 4 to prevent subsequent changes to that environment.\nThis has the disadvantage that anything below 4 is just, meh. But nothing above 1 will actually work with JsonPath so\u0026hellip; scratch that.\nSandboxing We could technically try and sandbox eval into it\u0026rsquo;s own process with a PID and whitelist methods which are allowed to be called.\nNot bad, and there are a few gems out there which are trying to do that like SafeRuby. But all of these project have been abandoned years ago for a good reason.\nObject.send Object.send is the best way to get some flexibility while still being safe. You basically just call methods on objects by describing said method on an object and giving parameters to it, like:\n1.send(:+, 2) =\u0026gt; 3 This is a very powerful tool in our toolbox which we will exploit immensely.\nSo let\u0026rsquo;s get to it.\nWriting a parser Writing a parser in Ruby is a very fluid experience. It has nice tools which support that, and the one I used is StringScanner. It has the ability to track where you are currently at in a string and move a pointer along with regex matches. In fact, JsonPath already employs this method when parsing a json expression. So reusing that logic was in fact\u0026hellip; elementary.\nThe expression How do we get from this:\n$..book[?(@[\u0026#39;price\u0026#39;] \u0026lt; 20)] To this:\n@_current_node[\u0026#39;price\u0026#39;] \u0026lt; 20 Well. By simple elimination. There are a couple of problems along the way of course. Because this wouldn\u0026rsquo;t be a parser if it couldn\u0026rsquo;t handle ALL the other cases\u0026hellip;\nRemoving Clutter Some of this we don\u0026rsquo;t need. Like, $..book part.\nThe other things we don\u0026rsquo;t need are all the '[]?()\nOnce this is done, we can move to isolating the important bits.\nBreakDown Elements How does an expression actually look like?\nLet\u0026rsquo;s break it down.\nSo, this is a handful. Operations can be \u0026lt;=,\u0026gt;=,\u0026lt;,\u0026gt;,==,!= and operands can be either numbers, or words, and element accessor can be nested since something like this is perfectly valid: $..book[?(@.written.year == 1997)].\nTo avoid being overwhelmed, ruby has our back with a method called dig.\nThis, basically lets us pass in some parameters into a dig function on a hash or an array with variadic parameters, which will go on and access those elements in order how they were supplied. Until it either returns a nil or an end result.\nFor example:\n2.3.1 :001 \u0026gt; a = {a: {b: \u0026#39;c\u0026#39;}} =\u0026gt; {:a=\u0026gt;{:b=\u0026gt;\u0026#34;c\u0026#34;}} 2.3.1 :002 \u0026gt; a.dig(:a, :b) =\u0026gt; \u0026#34;c\u0026#34; Easy. However\u0026hellip; Dig was only added after ruby 2.3 thus, I had to write my own dig for now, until I stop supporting anything below 2.3.\nAt first, I wanted to add it to the hash class, but it proved to be a futile attempt if I wanted to do it nicely, thus the parser got it as a private method.\ndef dig(keys, hash) return hash unless hash.is_a? Hash return nil unless hash.key?(keys.first) return hash.fetch(keys.first) if keys.size == 1 prev = keys.shift dig(keys, hash.fetch(prev)) end And the corresponding regex behind getting a multitude of elements is as follows:\n... if t = scanner.scan(/\\[\u0026#39;\\w+\u0026#39;\\]+/) ... Operator Selecting the operator is another interesting part as it can be a single one or multiple and all sorts. Until I realized that no\u0026hellip; it can actually be only a couple.\nAlso, after a bit of fiddling and doing and doing a silly case statement first:\ncase op when \u0026#39;\u0026gt;\u0026#39; dig(@_current_node, *elements) \u0026gt; operand when \u0026#39;\u0026lt;\u0026#39; dig(@_current_node, *elements) \u0026gt; operand ... end \u0026hellip;I promptly saw that this is not how it should be done.\nAnd here comes Object.send.\nThis gave me the opportunity to write this:\ndig(elements, @_current_node).send(operator, operand) Much better. Now I could send all the things in the way of a node.\nParsing an op be like:\nelsif t = scanner.scan(/\\s+[\u0026lt;\u0026gt;=][\u0026lt;\u0026gt;=]?\\s+?/) Operand Now comes the final piece. The value which we are comparing. This could either be a simple integer, a floating number, or a word. Hah. So coming up with a regex which fits this tightly took a little fiddling, but eventually I ended up with this:\nelsif t = scanner.scan(/(\\s+)?\u0026#39;?(\\w+)?[.,]?(\\w+)?\u0026#39;?(\\s+)?/) Without StackOverflow I would say this is fine ((although I need to remove all those space check, shees)). What are all the question marks? Basically, everything is optional. Because an this expression $..book[?(@.price)] is valid. Which is basically just asserting if a given node has a price element.\nLogical Operators The last thing that remains is logical operators, which if you are using eval, is pretty straight forward. It takes care of anything that you might add in like \u0026amp;\u0026amp;, ||, |, \u0026amp;, ^ etc etc.\nNow, that\u0026rsquo;s something I did with a case though. Until I find a nicer solution. Since we can already parse a single expression it\u0026rsquo;s just a question of breaking down a multi structure expression as the following one: $..book[?(@['price'] \u0026gt; 20 \u0026amp;\u0026amp; @.written.year == 1998)].\nexps = exp.split(/(\u0026amp;\u0026amp;)|(\\|\\|)/) This splits up the string by either \u0026amp;\u0026amp; or || and the usage of groups () also includes the operators. Than I evaluate the expressions and save the whole thing in an array like [true, '\u0026amp;\u0026amp;', false]. You know what could immediately resolve this? Yep\u0026hellip;\n.\nI\u0026rsquo;d rather just parse it although technically an eval at this stage wouldn\u0026rsquo;t be that big of a problem\u0026hellip;\ndef parse(exp) exps = exp.split(/(\u0026amp;\u0026amp;)|(\\|\\|)/) ret = parse_exp(exps.shift) exps.each_with_index do |item, index| case item when \u0026#39;\u0026amp;\u0026amp;\u0026#39; ret \u0026amp;\u0026amp;= parse_exp(exps[index + 1]) when \u0026#39;||\u0026#39; ret ||= parse_exp(exps[index + 1]) end end ret end Closing words That\u0026rsquo;s it folks. The parser is done. And there is no eval being used. There are some more things here that are interesting. Like, array indexing is allowed in jsonpath which is solved by sending .length to a current node. For example:\nif scanner.scan(/\\./) sym = scanner.scan(/\\w+/) op = scanner.scan(/./) num = scanner.scan(/\\d+/) return @_current_node.send(sym.to_sym).send(op.to_sym, num.to_i) end If an expression begins with a .. So you see that using send will help a lot, and understanding what eval is trying to evaluate and rather writing your own parser, isn\u0026rsquo;t that hard at all using ruby.\nI hope you enjoyed reading this little tid-bit as much as I enjoyed writing and drawing it. Leave a comment if your liked the drawings or if you did not and I should never do them again (( I don\u0026rsquo;t really care, this is my blog haha. )). Note to self: I shouldn\u0026rsquo;t draw on the other side of the drawing because of bleed-through.\nThank you! Gergely.\n","permalink":"https://skarlso.github.io/2017/05/28/replace-eval-with-object-send-and-a-parser/","summary":"Intro A while ago, I was added as a curator for a Gem called JsonPath. It\u0026rsquo;s a small but very useful and brilliant gem. It had a couple of problems which I fixed, but the hardest to eliminate proved to be a series of evals throughout the code.\nYou could opt in using eval with a constructor parameter, but generally, it was considered to be unsafe. Thus, normally when a project was using it, like Huginn they had to opt out by default, thus missing out on sweet parsing like this: $.","title":"Replacing Eval with Object.send and a self written Parser"},{"content":"Intro Hi folks.\nPreviously on this blog: Part 1. Part 2. Part 3.\nIn this part we are going to talk about Unit Testing Furnace and how to work some magic with AWS and Go.\nMock Stub Fake Dummy Canned Unit testing in Go usually follows the Dependency Injection model of dealing with Mocks and Stubs.\n## DI\nDependency Inject in short is one object supplying the dependencies of another object. In a longer description, it\u0026rsquo;s ideal to be used for removing the lock on a third party library, like the AWS client. Imaging having code which solely depends on the AWS client. How would you unit test that code without having to ACTUALLY connect to AWS? You couldn\u0026rsquo;t. Every time you try to test the code it would run the live code and it would try and connect to AWS and perform the operations it\u0026rsquo;s design to do. The Ruby library with it\u0026rsquo;s metaprogramming allows you to set the client globally to stub responses, but, alas, this is not the world of Ruby.\nHere is where DI comes to the rescue. If you have control over the AWS client on a very high level, and would pass it around as a function parameter, or create that client in an init() function and have it globally defined; you would be able to implement your own client, and have your code use that with stubbed responses which your tests need. For example, you would like a CreateApplication call to fail, or you would like a DescribeStack which returns an aws.Error(\u0026ldquo;StackAlreadyExists\u0026rdquo;).\nFor this, however, you need the API of the AWS client. Which is provided by AWS.\nAWS Client API In order for DI to work, the injected object needs to be of a certain type for us to inject our own. Luckily, AWS provides an Interface for all of it\u0026rsquo;s clients. Meaning, we can implement our own version for all of the clients, like S3, CloudFormation, CodeDeploy etc.\nFor each client you want to mock out, an *iface package should be present like this:\n\u0026#34;github.com/aws/aws-sdk-go/service/cloudformation/cloudformationiface\u0026#34; In this package you find and use the interface like this:\ntype fakeCloudFormationClient struct { cloudformationiface.CloudFormationAPI err error } And with this, we have our own CloudFormation client. The real code uses the real clients as function parameters, like this:\n// Execute defines what this command does. func (c *Create) Execute(opts *commander.CommandHelper) { log.Println(\u0026#34;Creating cloud formation session.\u0026#34;) sess := session.New(\u0026amp;aws.Config{Region: aws.String(config.REGION)}) cfClient := cloudformation.New(sess, nil) client := CFClient{cfClient} createExecute(opts, \u0026amp;client) } We can\u0026rsquo;t test Execute itself, as it\u0026rsquo;s using the real client here (or you could have a global from some library, thus allowing you to tests even Execute here) but there is very little logic in this function for this very reason. All the logic is in small functions for which the main starting point and our testing opportunity is, createExecute.\nStubbing Calls Now, that we have our own client, and with the power of Go\u0026rsquo;s interface embedding as seen above with CloudFormationAPI, we have to only stub the functions which we are actually using, instead of every function of the given interface. This looks like this:\ncfClient := new(CFClient) cfClient.Client = \u0026amp;fakeCloudFormationClient{err: nil} Where cfClient is a struct like this:\n// CFClient abstraction for cloudFormation client. type CFClient struct { Client cloudformationiface.CloudFormationAPI } And a stubbed call can than be written as follows:\nfunc (fc *fakeCreateCFClient) WaitUntilStackCreateComplete(input *cloudformation.DescribeStacksInput) error { return nil } This can range from a very trivial example, like the one above, to intricate ones as well, like this gem:\nfunc (fc *fakePushCFClient) ListStackResources(input *cloudformation.ListStackResourcesInput) (*cloudformation.ListStackResourcesOutput, error) { if \u0026#34;NoASG\u0026#34; == *input.StackName { return \u0026amp;cloudformation.ListStackResourcesOutput{ StackResourceSummaries: []*cloudformation.StackResourceSummary{ { ResourceType: aws.String(\u0026#34;NoASG\u0026#34;), PhysicalResourceId: aws.String(\u0026#34;arn::whatever\u0026#34;), }, }, }, fc.err } return \u0026amp;cloudformation.ListStackResourcesOutput{ StackResourceSummaries: []*cloudformation.StackResourceSummary{ { ResourceType: aws.String(\u0026#34;AWS::AutoScaling::AutoScalingGroup\u0026#34;), PhysicalResourceId: aws.String(\u0026#34;arn::whatever\u0026#34;), }, }, }, fc.err } This ListStackResources stub lets us test two scenarios based on the stackname. If the test stackname is \u0026lsquo;NoASG\u0026rsquo; it will return a result which equals to a result containing no AutoScaling Group. Otherwise, it will return the correct ResourceType for an ASG.\nIt is a common practice to line up several scenario based stubbed responses in order to test the robustness of your code.\nUnfortunately, this also means that your tests will be a bit cluttered with stubs and mock structs and whatnots. For that, I\u0026rsquo;m partially using a package available struct file in which I\u0026rsquo;m defining most of the mock structs at least. And from there on, the tests will only contain specific stubs for that particular file. This can be further fine grained by having defaults and than only override in case you need something else.\nTesting fatals Now, the other point which is not really AWS related, but still comes to mind when dealing with Furnace, is testing error scenarios.\nBecause Furnace is a CLI application it uses Fatals to signal if something is wrong and it doesn\u0026rsquo;t want to continue or recover because, frankly it can\u0026rsquo;t. If AWS throws an error, that\u0026rsquo;s it. You can retry, but in 90% of the cases, it\u0026rsquo;s usually something that you messed up.\nSo, how do we test for a fatal or an os.Exit? There are a number of points on that if you do a quick search. You may end up on this talk: GoTalk 2014 Testing Slide #23. Which does an interesting thing. It calls the test binary in a separate process and tests the exit code.\nOthers, and me as well, will say that you have to have your own logger implemented and use a different logger / os.Exit in your test environment.\nOthers others will tell you to not to have tests around os.Exit and fatal things, rather return an error and only the main should pop a world ending event. I leave it up to you which you want to use. Either is fine.\nIn Furnace, I\u0026rsquo;m using a global logger in my error handling util like this:\n// HandleFatal handler fatal errors in Furnace. func HandleFatal(s string, err error) { LogFatalf(s, err) } And LogFatalf is an exported variable var LogFatalf = log.Fatalf. Than in a test, I just override this variable with a local anonymous function:\nfunc TestCreateExecuteEmptyStack(t *testing.T) { failed := false utils.LogFatalf = func(s string, a ...interface{}) { failed = true } config.WAITFREQUENCY = 0 client := new(CFClient) stackname := \u0026#34;EmptyStack\u0026#34; client.Client = \u0026amp;fakeCreateCFClient{err: nil, stackname: stackname} opts := \u0026amp;commander.CommandHelper{} createExecute(opts, client) if !failed { t.Error(\u0026#34;expected outcome to fail during create\u0026#34;) } } It can get even more granular by testing for the error message to make sure that it actually fails at the point we think we are testing:\nfunc TestCreateStackReturnsWithError(t *testing.T) { failed := false expectedMessage := \u0026#34;failed to create stack\u0026#34; var message string utils.LogFatalf = func(s string, a ...interface{}) { failed = true if err, ok := a[0].(error); ok { message = err.Error() } } config.WAITFREQUENCY = 0 client := new(CFClient) stackname := \u0026#34;NotEmptyStack\u0026#34; client.Client = \u0026amp;fakeCreateCFClient{err: errors.New(expectedMessage), stackname: stackname} config := []byte(\u0026#34;{}\u0026#34;) create(stackname, config, client) if !failed { t.Error(\u0026#34;expected outcome to fail\u0026#34;) } if message != expectedMessage { t.Errorf(\u0026#34;message did not equal expected message of \u0026#39;%s\u0026#39;, was:%s\u0026#34;, expectedMessage, message) } } Conclusion This is it. That\u0026rsquo;s all it took to write Furnace. I hope you enjoyed reading it as much as I enjoyed writing all these thoughts down.\nI hope somebody might learn from my journey and also improve upon it.\nAny comments are much appreciated and welcomed. Also, PRs and Issues can be submitted on the GitHub page of Furnace.\nThank you for reading! Gergely.\n","permalink":"https://skarlso.github.io/2017/04/16/building-furnace-part-4/","summary":"Intro Hi folks.\nPreviously on this blog: Part 1. Part 2. Part 3.\nIn this part we are going to talk about Unit Testing Furnace and how to work some magic with AWS and Go.\nMock Stub Fake Dummy Canned Unit testing in Go usually follows the Dependency Injection model of dealing with Mocks and Stubs.\n## DI\nDependency Inject in short is one object supplying the dependencies of another object.","title":"Furnace - The building of an AWS CLI Tool for CloudFormation and CodeDeploy - Part 4"},{"content":"Intro Hi folks.\nPreviously on this blog: Part 1. Part 2. Part 4.\nIn this part, I\u0026rsquo;m going to talk about the experimental plugin system of Furnace.\nGo Experimental Plugins Since Go 1.8 was released, an exciting and new feature was introduced called a Plug-in system. This system works with dynamic libraries built with a special switch to go build. These libraries, .so or .dylib (later), are than loaded and once that succeeds, specific functions can be called from them (symbol resolution).\nWe will see how this works. For package information, visit the plugin packages Go doc page here.\nFurnace Plugins So, what does furnace use plugins for? Furnace uses plugins to execute arbitery code in, currently, four given locations / events.\nThese are: pre_create, post_create, pre_delete, post_delete. These events are called, as their name suggests, before and after the creation and deletion of the CloudFormation stack. It allows the user to execute some code without having to rebuild the whole project. It does that by defining a single entry point for the custom code called RunPlugin. Any number of functions can be implemented, but the plugin MUST provide this single, exported function. Otherwise it will fail and ignore that plugin.\nUsing Plugins It\u0026rsquo;s really easy to implement, and use these plugins. I\u0026rsquo;m not going into the detail of how to load them, because that is done by Furnace, but only how to write and use them.\nTo use a plugin, create a go file called: 0001_mailer.go. The 0001 before it will define WHEN it\u0026rsquo;s executed. Having multiple plugins is completely okay. Execution of order however, depends on the names of the files.\nNow, in 0001_mailer.post_create we would have something like this:\npackage main import \u0026#34;log\u0026#34; // RunPlugin runs the plugin. func RunPlugin() { log.Println(\u0026#34;My Awesome Pre Create Plugin.\u0026#34;) } Next step is the build this file to be a plugin library. Note: Right now, this only works on Linux!\nTo build this file run the following:\ngo build -buildmode=plugin -o 0001_mailer.pre_create 0001_mailer.go The important part here is the extension of the file specified with -o. It\u0026rsquo;s important because that\u0026rsquo;s how Furnace identifies what plugins it has to run.\nFinally, copy this file to ~/.config/go-furnace/plugins and you are all set.\nSlack notification Plugin To demonstrate how a plugin could be used is if you need some kind of notification once a Stack is completed. For example, you might want to send a message to a Slack room. To do this, your plugin would look something like this:\npackage main import ( \u0026#34;fmt\u0026#34; \u0026#34;os\u0026#34; \u0026#34;github.com/nlopes/slack\u0026#34; ) func RunPlugin() { stackname := os.Getenv(\u0026#34;FURNACE_STACKNAME\u0026#34;) api := slack.New(\u0026#34;YOUR_TOKEN_HERE\u0026#34;) params := slack.PostMessageParameters{} channelID, timestamp, err := api.PostMessage(\u0026#34;#general\u0026#34;, fmt.Sprintf(\u0026#34;Stack with name \u0026#39;%s\u0026#39; is Done.\u0026#34;, stackname), params) if err != nil { fmt.Printf(\u0026#34;%s\\n\u0026#34;, err) return } fmt.Printf(\u0026#34;Message successfully sent to channel %s at %s\u0026#34;, channelID, timestamp) } Currently, Furnace has no ability to share information of the stack with an outside plugin. Thus \u0026lsquo;Done\u0026rsquo; could be anything from Rollback to Failed to CreateComplete.\nClosing Words That\u0026rsquo;s it for plugins. Thanks very much for reading! Gergely.\n","permalink":"https://skarlso.github.io/2017/03/22/building-furnace-part-3/","summary":"Intro Hi folks.\nPreviously on this blog: Part 1. Part 2. Part 4.\nIn this part, I\u0026rsquo;m going to talk about the experimental plugin system of Furnace.\nGo Experimental Plugins Since Go 1.8 was released, an exciting and new feature was introduced called a Plug-in system. This system works with dynamic libraries built with a special switch to go build. These libraries, .so or .dylib (later), are than loaded and once that succeeds, specific functions can be called from them (symbol resolution).","title":"Furnace - The building of an AWS CLI Tool for CloudFormation and CodeDeploy - Part 3"},{"content":"Intro Hi folks.\nPreviously on this blog: Part 1, Part 3, Part 4\nIn this part, I\u0026rsquo;m going to talk about the AWS Go SDK and begin do dissect the intricacies of Furnace.\nAWS SDK Fortunately, the Go SDK for AWS is quiet verbose and littered with examples of all sorts. But that doesn\u0026rsquo;t make it less complex and less cryptic at times. I\u0026rsquo;m here to lift some of the early confusions, in hopes that I can help someone to avoid wasting time.\nGetting Started and Developers Guide As always, and common from AWS, the documentation is top notch. There is a 141 pages long developer\u0026rsquo;s guide on the SDK containing a getting started section and an API reference. Go check it out. I\u0026rsquo;ll wait. AWS Go SDK DG PDF. I will only talk about some gotchas and things I encountered, not the basics of the SDK.\naws.String and other types Something which is immediately visible once we take a look at the API is that everything is a pointer. Now, there are a tremendous amount of discussions about this, but I\u0026rsquo;m with Amazon. There are various reasons for it, but to list the most prominent ones: - Type completion and compile time type safety. - Values for AWS API calls have valid zero values, in addition to being optional, i.e. not being provided at all. - Other option, like, empty interfaces with maps, or using zero values, or struct wrappers around every type, made life much harder rather than easier or not possible at all. - The AWS API is volatile. You never know when something gets to be optional, or required. Pointers made that decision easy.\nThere are good number of other discussions around this topic, for example: AWS Go GitHub #363.\nIn order to use primitives, AWS has helper functions like aws.String. Because \u0026amp;\u0026ldquo;asdf\u0026rdquo; is not allowed, you would have to create a variable and use its address in situations where a string pointer is needed, for example, name of the stack. These primitive helpers will make in-lining possible. We\u0026rsquo;ll see later that they are used to a great extent. Pointers, however, make life a bit difficult when constructing Input structs and make for poor aesthetics.\nThis is something I\u0026rsquo;m returning in a test for stubbing a client call:\nreturn \u0026amp;cloudformation.ListStackResourcesOutput{ StackResourceSummaries: []*cloudformation.StackResourceSummary{ { ResourceType: aws.String(\u0026#34;NoASG\u0026#34;), PhysicalResourceId: aws.String(\u0026#34;arn::whatever\u0026#34;), }, }, } This doesn\u0026rsquo;t look so appealing, but one gets used to it quickly.\nError handling Errors also have their own types. An AWS error looks like this:\nif err != nil { if awsErr, ok := err.(awserr.Error); ok { } } First, we check if error is nil, than we type check if the error is an AWS error or something different. In the wild, this will look something like this:\nif err != nil { if awsErr, ok := err.(awserr.Error); ok { if awsErr.Code() != codedeploy.ErrCodeDeploymentGroupAlreadyExistsException { log.Println(awsErr.Code()) return err } log.Println(\u0026#34;DeploymentGroup already exists. Nothing to do.\u0026#34;) return nil } return err } If it\u0026rsquo;s an AWS error, we can check further for the error code that it returns in order to identify what to handle, or what to throw on to the caller to a potential fatal. Here, I\u0026rsquo;m ignoring the AlreadyExistsException because, if it does, we just go on to a next action.\nExamples Luckily the API doc is very mature. In most of the cases, they provide an example to an API call. These examples, however, from time to time provide more confusion than clarity. Take CloudFormation. For me, when I first glanced upon the description of the API it wasn\u0026rsquo;t immediately clear that the TemplateBody was supposed to be the whole template, and that the rest of the fields were almost all optional settings. Or provided overrides in special cases.\nAnd since the template is not an ordinary JAML or JSON file, I was looking for something that parses it into that the Struct I was going to use. After some time, and digging, I realized that I didn\u0026rsquo;t need that, and that I just need to read in the template, define some extra parameters, and give the TemplateBody the whole of the template. The parameters defined by the CloudFormation template where extracted for me by ValidateTemplate API call which returned all of them in a convenient []*cloudformation.Parameter slice. These things are not described in the document or visible from the examples. I mainly found them through playing with the API and focused experimentation.\nWaiters From other SDK implementations, we got used to Waiters. These handy methods wait for a service to become available or for certain situations to take in effect, like a Stage being CREATE_COMPLETE. The Go waiters, however, don\u0026rsquo;t allow for callback to be fired, or for running blocks, like the ruby SDK does. For this, I wrote a handy little waiter for myself, which outputs a spinner to see that we are currently waiting for something and not frozen in time. This waiter looks like this:\n// WaitForFunctionWithStatusOutput waits for a function to complete its action. func WaitForFunctionWithStatusOutput(state string, freq int, f func()) { var wg sync.WaitGroup wg.Add(1) done := make(chan bool) go func() { defer wg.Done() f() done \u0026lt;- true }() go func() { counter := 0 for { counter = (counter + 1) % len(Spinners[config.SPINNER]) fmt.Printf(\u0026#34;\\r[%s] Waiting for state: %s\u0026#34;, yellow(string(Spinners[config.SPINNER][counter])), red(state)) time.Sleep(time.Duration(freq) * time.Second) select { case \u0026lt;-done: fmt.Println() break default: } } }() wg.Wait() } And I\u0026rsquo;m calling it with the following method:\nutils.WaitForFunctionWithStatusOutput(\u0026#34;DELETE_COMPLETE\u0026#34;, config.WAITFREQUENCY, func() { cfClient.Client.WaitUntilStackDeleteComplete(describeStackInput) }) This would output these lines to the console:\n[\\] Waiting for state: DELETE_COMPLETE The spinner can be configured to be one of the following types:\nvar Spinners = []string{`←↖↑↗→↘↓↙`, `▁▃▄▅▆▇█▇▆▅▄▃`, `┤┘┴└├┌┬┐`, `◰◳◲◱`, `◴◷◶◵`, `◐◓◑◒`, `⣾⣽⣻⢿⡿⣟⣯⣷`, `|/-\\`} Handy.\nAnd with that, let\u0026rsquo;s dive into the basics of Furnace.\nFurnace Directory Structure and Packages Furnace is divided into three main packages.\ncommands Commands package is where the gist of Furnace lies. These commands represent the commands which are used through the CLI. Each file has the implementation for one command. The structure is devised by this library: Yitsushi\u0026rsquo;s Command Library. As of the writing of this post, the following commands are available:\ncreate - Creates a stack using the CloudFormation template file under ~/.config/go-furnace delete - Deletes the created Stack. Doesn\u0026rsquo;t do anything if the stack doesn\u0026rsquo;t exist push - Pushes an application to a stack status - Displays information about the stack delete-application - Deletes the CodeDeploy application and deployment group created by push These commands represent the heart of furnace. I would like to keep these to a minimum, but I do plan on adding more, like update and rollout. Further details and help messages on these commands can be obtained by running: ./furnace help or ./furnace help create.\n❯ ./furnace help push Usage: furnace push appName [-s3] Push a version of the application to a stack Examples: furnace push furnace push appName furnace push appName -s3 furnace push -s3 config Contains the configuration loader and some project wide defaults which are as follows:\nEvents for the plugin system - pre-create, post-create, pre-delete, post-delete. CodeDeploy role name - CodeDeployServiceRole. This is used if none is provided to locate the CodeDeploy IAM role. Wait frequency - Is the setting which controls how long the waiter should sleep in between status updates. Default is 1s. Spinner - Is just the number of the spinner to use. Plugin registry - Is a map of functions to run for the above events. Further more, config loads the CloudFormation template and checks if some necessary settings are present in the environment, exp: the configuration folder under ~/.config/go-furnace.\nutils These are some helper functions which are used throughout the project. To list them:\nerror_handler - Is a simple error handler. I\u0026rsquo;m thinking of refactoring this one to some saner version. spinner - Sets up which spinner to use in the waiter function. waiter - Contains the verbose waiter introduced above under Waiters. Configuration and Environment variables Furnace is a Go application, thus it doesn\u0026rsquo;t have the luxury of Ruby or Python where the configuration files are usually bundled with the app. But, it does have a standard for it. Usually, configurations reside in either of these two locations. Environment Properties or|and configuration files under a fixed location ( i.e. HOME/.config/app-name ). Furnace employs both.\nSettings like, region, stack name, enable plugin system, are under environment properties ( though this can change ), while the CloudFormation template lives under ~/.config/go-furnace/. Lastly it assumes some things, like the Deployment IAM role just exists under the used AWS account. All these are loaded and handled by the config package described above.\nUsage A typical scenario for Furnace would be the following:\nSetup your CloudFormation template or use the one provided. The one provided sets up a highly available and self healing setting using Auto-Scaling and Load-Balancing with a single application instance. Edit this template to your liking than copy it to ~/.config/go-furnace. Create the configured stack with ./furnace create. Create will ask for the parameters defined in the template. If defaults are setup, simply hitting enter will use these defaults. Take note, that the provided template sets up SSH access via a provided key. If that key is not present in CF, you won\u0026rsquo;t be able to SSH into the created instance. Once the stack is completed, the application is ready to be pushed. To do this, run: ./furnace push. This will locate the appropriate version of the app from S3 or GitHub and push that version to the instances in the Auto-Scaling group. To all of them. General Practices Applied to the Project Commands For each command the main entry point is the execute function. These functions are usually calling out the small chunks of distributed methods. Logic was kept to a bare minimum ( probably could be simplified even further ) in the execute functions mostly for testability and the likes. We will see that in a followup post.\nErrors Errors are handled immediately and usually through a fatal. If any error occurs than the application is halted. In followup versions this might become more granular. I.e. don\u0026rsquo;t immediately stop the world, maybe try to recover, or create a Poller or Re-Tryer, which tries a call again for a configured amount of times.\nOutput colors Not that important, but still\u0026hellip; Aesthetics. Displaying data to the console in a nice way gives it some extra flare.\nMakefile This project works with a Makefile for various reasons. Later on, once the project might become more complex, a Makefile makes it really easy to handle different ways of packaging the application. Currently, for example, it provides a linux target which will make Go build the project for Linux architecture on any other Architecture i.e. cross-compiling.\nIt also provides an easy way to run unit tests with make test and installing with make \u0026amp;\u0026amp; make install.\nClosing Words That is all for Part 2. Join me in Part 3 where I will talk about the experimental Plugin system that Furnace employs.\nThank you for reading! Gergely.\n","permalink":"https://skarlso.github.io/2017/03/19/building-furnace-part-2/","summary":"Intro Hi folks.\nPreviously on this blog: Part 1, Part 3, Part 4\nIn this part, I\u0026rsquo;m going to talk about the AWS Go SDK and begin do dissect the intricacies of Furnace.\nAWS SDK Fortunately, the Go SDK for AWS is quiet verbose and littered with examples of all sorts. But that doesn\u0026rsquo;t make it less complex and less cryptic at times. I\u0026rsquo;m here to lift some of the early confusions, in hopes that I can help someone to avoid wasting time.","title":"Furnace - The building of an AWS CLI Tool for CloudFormation and CodeDeploy - Part 2"},{"content":"Testing.\n","permalink":"https://skarlso.github.io/2017/03/17/test-new-hugo/","summary":"Testing.","title":"Testing new Hugo if posts are generated properly"},{"content":"Other posts: Part 2, Part 3, Part 4.\nBuilding Furnace: Part 1 Intro Hi folks.\nThis is the first part of a 4 part series which talks about the process of building a middlish sized project in Go, with AWS. Including Unit testing and a experimental plugin feature.\nThe first part will talk about the AWS services used in brief and will contain a basic description for those who are not familiar with them. The second part will talk about the Go SDK and the project structure itself, how it can be used, improved, and how it can help in everyday life. The third part will talk about the experimental plugin system, and finally, we will tackle unit testing AWS in Go.\nLet\u0026rsquo;s begin, shall we?\nAWS CloudFormation If you haven\u0026rsquo;t yet read about, or know off, AWS\u0026rsquo; CloudFormation service, you can either go ahead and read the Documentation or read on for a very quick summary. If you are familiar with CF, you should skip ahead to CodeDeploy section.\nCF is a service which bundles together other AWS services (for example: EC2, S3, ELB, ASG, RDS) into one, easily manageable stack. After a stack has been created, all the resources can be handled as one, located, tagged and used via CF specific console commands. It\u0026rsquo;s also possible to define any number of parameters, so a stack can actually be very versatile. A parameter can be anything, from SSH IP restriction to KeyPair names and list of tags to create or in what region the stack will be in.\nTo describe how these parts fit together, one must use a CloudFormation Template file which is either in JSON or in YAML format. A simple example looks like this:\nParameters: KeyName: Description: The EC2 Key Pair to allow SSH access to the instance Type: AWS::EC2::KeyPair::KeyName Resources: Ec2Instance: Type: AWS::EC2::Instance Properties: SecurityGroups: - Ref: InstanceSecurityGroup - MyExistingSecurityGroup KeyName: Ref: KeyName ImageId: ami-7a11e213 InstanceSecurityGroup: Type: AWS::EC2::SecurityGroup Properties: GroupDescription: Enable SSH access via port 22 SecurityGroupIngress: - IpProtocol: tcp FromPort: \u0026#39;22\u0026#39; ToPort: \u0026#39;22\u0026#39; CidrIp: 0.0.0.0/0 There are a myriad of these template samples here.\nI\u0026rsquo;m not going to explain this in too much detail. Parameters define the parameters, and resources define all the AWS services which we would like to configure. Here we can see, that we are creating an EC2 instance with a custom Security Group plus and already existing security group. ImageId is the AMI which will be used for the EC2 instance. The InstanceSecurityGroup is only defining some SSH access to the instance.\nThat is pretty much it. This can become bloated relatively quickly once, VPCs, ELBs, and ASGs come into play. And CloudFormation templates can also contain simple logical switches, like, conditions, ref for variables, maps and other shenanigans.\nFor example consider this part in the above example:\nKeyName: Ref: KeyName Here, we use the KeyName parameter as a Reference Value which will be interpolated to the real value, or the default one, as the template gets processed.\nCodeDeploy If you haven\u0026rsquo;t heard about CodeDeploy yet, please browse the relevant Documentation or follow along for a \u0026ldquo;quick\u0026rdquo; description.\nCodeDeploy just does what the name says. It deploys code. Any kind of code, as long as the deployment process is described in a file called appspec.yml. It can be easy as coping a file to a specific location or incredibly complex with builds of various kinds.\nFor a simple example look at this configuration:\nversion: 0.0 os: linux files: - source: /index.html destination: /var/www/html/ - source: /healthy.html destination: /var/www/html/ hooks: BeforeInstall: - location: scripts/install_dependencies timeout: 300 runas: root - location: scripts/clean_up timeout: 300 runas: root - location: scripts/start_server timeout: 300 runas: root ApplicationStop: - location: scripts/stop_server timeout: 300 runas: root CodeDeploy applications have hooks and life-cycle events which can be used to control the deployment process of an like, starting the WebServer; making sure files are in the right location; copying files, running configuration management software like puppet, ansible or chef; etc, etc.\nWhat can be done in an appspec.yml file is described here: Appspec Reference Documentation.\nDeployment happens in one of two ways:\nGitHub If the preferred way to deploy the application is from GitHub a commit hash must be used to identify which \u0026ldquo;version\u0026rdquo; of the application is to be deployed. For example:\nrev = \u0026amp;codedeploy.RevisionLocation{ GitHubLocation: \u0026amp;codedeploy.GitHubLocation{ CommitId: aws.String(\u0026#34;kajdf94j0f9k309klksjdfkj\u0026#34;), Repository: aws.String(\u0026#34;Skarlso/furnace-codedeploy-app\u0026#34;), }, RevisionType: aws.String(\u0026#34;GitHub\u0026#34;), } Commit Id is the hash of the latest release and repository is the full account/repository pointing to the application.\nS3 The second way is to use an S3 bucket. The bucket will contain an archived version of the application with a given extension. I\u0026rsquo;m saying given extension, because it has to be specified like this (and can be either \u0026lsquo;zip\u0026rsquo;, or \u0026rsquo;tar\u0026rsquo; or \u0026rsquo;tgz\u0026rsquo;):\nrev = \u0026amp;codedeploy.RevisionLocation{ S3Location: \u0026amp;codedeploy.S3Location{ Bucket: aws.String(\u0026#34;my_codedeploy_bucket\u0026#34;), BundleType: aws.String(\u0026#34;zip\u0026#34;), Key: aws.String(\u0026#34;my_awesome_app\u0026#34;), Version: aws.String(\u0026#34;VersionId\u0026#34;), }, RevisionType: aws.String(\u0026#34;S3\u0026#34;), } Here, we specify the bucket name, the extension, the name of the file and an optional version id, which can be ignored.\nDeploying So how does code deploy get either of the applications to our EC2 instances? It uses an agent which is running on all of the instances that we create. In order to do this, the agent needs to be present on our instance. For linux this can be achieved with the following UserData (UserData in CF is the equivalent of a bootsrap script):\n\u0026#34;UserData\u0026#34; : { \u0026#34;Fn::Base64\u0026#34; : { \u0026#34;Fn::Join\u0026#34; : [ \u0026#34;\\n\u0026#34;, [ \u0026#34;#!/bin/bash -v\u0026#34;, \u0026#34;sudo yum -y update\u0026#34;, \u0026#34;sudo yum -y install ruby wget\u0026#34;, \u0026#34;cd /home/ec2-user/\u0026#34;, \u0026#34;wget https://aws-codedeploy-eu-central-1.s3.amazonaws.com/latest/install\u0026#34;, \u0026#34;chmod +x ./install\u0026#34;, \u0026#34;sudo ./install auto\u0026#34;, \u0026#34;sudo service codedeploy-agent start\u0026#34;, ] ] } } A simple user data configuration in the CloudFormation template will make sure that every instance that we create will have the CodeDeploy agent running and waiting for instructions. This agent is self updating. Which can cause some trouble if AWS releases a broken agent. However unlikely, it can happen. Never the less, once installed, it\u0026rsquo;s no longer a concern to be bothered with.\nIt communications on HTTPS port 443.\nCodeDeploy identifies instances which need to be updated according to our preferences, by tagging the EC2 and Auto Scaling groups. Tagging happens in the CloudFormation template through the AutoScalingGroup settings like this:\n\u0026#34;Tags\u0026#34; : [ { \u0026#34;Key\u0026#34; : \u0026#34;fu_stage\u0026#34;, \u0026#34;Value\u0026#34; : { \u0026#34;Ref\u0026#34;: \u0026#34;AWS::StackName\u0026#34; }, \u0026#34;PropagateAtLaunch\u0026#34; : true } ] This will give the EC2 instance a tag called fu_stage with value equaling to the name of the stack. Once this is done, CodeDeploy looks like this:\nparams := \u0026amp;codedeploy.CreateDeploymentInput{ ApplicationName: aws.String(appName), IgnoreApplicationStopFailures: aws.Bool(true), DeploymentGroupName: aws.String(appName + \u0026#34;DeploymentGroup\u0026#34;), Revision: revisionLocation(), TargetInstances: \u0026amp;codedeploy.TargetInstances{ AutoScalingGroups: []*string{ aws.String(\u0026#34;AutoScalingGroupPhysicalID\u0026#34;), }, TagFilters: []*codedeploy.EC2TagFilter{ { Key: aws.String(\u0026#34;fu_stage\u0026#34;), Type: aws.String(\u0026#34;KEY_AND_VALUE\u0026#34;), Value: aws.String(config.STACKNAME), }, }, }, UpdateOutdatedInstancesOnly: aws.Bool(false), } CreateDeploymentInput is the entire parameter list that is needed in order to identify instances to deploy code to. We can see here that it looks for an AutoScalingGroup by Physical Id and the tag labeled fu_stage. Once found, it will use UpdateOutdatedInstancesOnly to determine if an instance needs to be updated or not. Set to false means, it always updates.\nFurnace Where does Furnace fit in, in all of this? Furnace provides a very easy mechanism to create, delete and push code to a CloudFormation stack using CodeDeploy, and a couple of environment properties. Furnace create will create a CloudFormation stack according to the provided template, all the while asking for the parameters defined in it for flexibility. delete will remove the stack and all affiliated resources except for the created CodeDeploy application. For that, there is delete-application. status will display information about the stack: Outputs, Parameters, Id, Name, and status. Something like this:\n2017/03/16 21:14:37 Stack state is: { Capabilities: [\u0026#34;CAPABILITY_IAM\u0026#34;], CreationTime: 2017-03-16 20:09:38.036 +0000 UTC, DisableRollback: false, Outputs: [{ Description: \u0026#34;URL of the website\u0026#34;, OutputKey: \u0026#34;URL\u0026#34;, OutputValue: \u0026#34;http://FurnaceSt-ElasticL-ID.eu-central-1.elb.amazonaws.com\u0026#34; }], Parameters: [ { ParameterKey: \u0026#34;KeyName\u0026#34;, ParameterValue: \u0026#34;UserKeyPair\u0026#34; }, { ParameterKey: \u0026#34;SSHLocation\u0026#34;, ParameterValue: \u0026#34;0.0.0.0/0\u0026#34; }, { ParameterKey: \u0026#34;CodeDeployBucket\u0026#34;, ParameterValue: \u0026#34;None\u0026#34; }, { ParameterKey: \u0026#34;InstanceType\u0026#34;, ParameterValue: \u0026#34;t2.nano\u0026#34; } ], StackId: \u0026#34;arn:aws:cloudformation:eu-central-1:9999999999999:stack/FurnaceStack/asdfadsf-adsfa3-432d-a-fdasdf\u0026#34;, StackName: \u0026#34;FurnaceStack\u0026#34;, StackStatus: \u0026#34;CREATE_COMPLETE\u0026#34; } ( This will later be improved to include created resources as well. )\nOnce the stack is CREATE_COMPLETE a simple push will deliver our application on each instance in the stack. We will get into more detail about how these commands are working in Part 2 of this series.\nFinal Words This is it for now.\nJoin me next time when I will talk about the AWS Go SDK and its intricacies and we will start to look at the basics of Furnace.\nAs always, Thanks for reading! Gergely.\n","permalink":"https://skarlso.github.io/2017/03/16/building-furnace-part-1/","summary":"Other posts: Part 2, Part 3, Part 4.\nBuilding Furnace: Part 1 Intro Hi folks.\nThis is the first part of a 4 part series which talks about the process of building a middlish sized project in Go, with AWS. Including Unit testing and a experimental plugin feature.\nThe first part will talk about the AWS services used in brief and will contain a basic description for those who are not familiar with them.","title":"Furnace - The building of an AWS CLI Tool for CloudFormation and CodeDeploy - Part 1"},{"content":"Hi folks.\nJust a quick headsup, that older posts and images, may have been lost unfortunately, because I made the terrible mistake, when I migrated over from my old blog, that I forgot to download all the images from the remote host.\nFor lack of options, I deleted the images. :/ Sorry for the inconvencience!\nGergely.\n","permalink":"https://skarlso.github.io/2017/03/03/images-on-old-posts/","summary":"Hi folks.\nJust a quick headsup, that older posts and images, may have been lost unfortunately, because I made the terrible mistake, when I migrated over from my old blog, that I forgot to download all the images from the remote host.\nFor lack of options, I deleted the images. :/ Sorry for the inconvencience!\nGergely.","title":"Images on older posts"},{"content":"Intro Hi folks.\nToday, I would like to write about how to do HTTPS for a website, without the need to buy a certificate and set it up via your DNS provider. Let\u0026rsquo;s begin.\nAbstract What you will achieve by the end of this post:\nEvery call to HTTP will be redirected to HTTPS via haproxy. HTTPS will be served with Haproxy and LetsEncrypt as the Certificate provider. Automatically update the certificate before its expiration. No need for IPTable rules to route 8080 to 80. Traffic to and from your page will be encrypted. This all will cost you nothing. I will use a static website generator for this called Hugo which, if you know me, is my favorite generator tool. These instructions are for haproxy and hugo, if you wish to use apache and nginx for example, you\u0026rsquo;ll have to dig for the corresponding settings for letsencrypt and certbot.\nWhat You Will Need Hugo You will need hugo, which can be downloaded from here: Hugo. A simple website will be enough. For themes, you can take a look at the humongous list located here: HugoThemes.\nHaproxy Haproxy can be found here: Haproxy. There are a number of options to install haproxy. I chose a simple apt-get install haproxy.\nLet\u0026rsquo;s Encrypt Information about Let\u0026rsquo;s Encrypt can be found on their website here: Let\u0026rsquo;s Encrypt. Let\u0026rsquo;s Encrypt\u0026rsquo;s client is now called Certbot which is used to generate the certificates. To get the latest code you either clone the repository Certbot, or use an auto downloader:\nuser@webserver:~$ wget https://dl.eff.org/certbot-auto user@webserver:~$ chmod a+x ./certbot-auto user@webserver:~$ ./certbot-auto --help Either way, I\u0026rsquo;m using the current latest version: v0.11.1.\nSudo This goes without saying, but that these operations will require you to have sudo privileges. I suggest staying in sudo for ease of use. This means that the commands, I\u0026rsquo;ll write here, will assume you are in sudo su mode thus no sudo prefix will be used.\nPortforwarding In order for your website to work under https this guide assumes that you have port 80 and 443 open on your router / network security group.\nSetup Single Server Environment It is possible for haproxy, certbot and your website to run on designated servers. Haproxy\u0026rsquo;s abilities allows to define multiple server sources. In this guide, my haproxy, website and certbot will all run on the same server; thus redirecting to 127.0.0.1 and local ips. This is more convenient, because otherwise the haproxy IP would have to be a permanent local/remote ip. Or an automated script would have to be setup which is notified upon IP change and updates the ip records.\nCreating a Certificate Diving in, the first thing you will require is a certificate. A certificate will allow for encrypted traffic and an authenticated website. Let\u0026rsquo;s Encrypt which is basically functioning as an independent, free, automated CA (Certificate Authority). Usually, the process would be to pay a CA to give you a signed, generated certificate for your website, and you would have to set that up with your DNS provider. Let\u0026rsquo;s Encrypt has that all automated, and free of any charge. Neat.\nCertbot So let\u0026rsquo;s get started. Clone the repository into /opt/letsencrypt for further usage.\ngit clone https://github.com/certbot/certbot /opt/letsencrypt Generating the certificate Make sure that there is nothing listening on ports: 80, 443. To list usage:\nnetstat -nlt | grep \u0026#39;:80\\s\u0026#39; netstat -nlt | grep \u0026#39;:443\\s\u0026#39; Kill everything that might be on these ports, like apache2 and httpd. These will be used by haproxy and certbot for challenges and redirecting traffic.\nYou will be creating a standalone certificate. This is the reason we need port 80 and 443 open. Run certbot by defining the certonly and --standalone flags. For domain validation you are going to use port 443, tls-sni-01 challenge. The whole command looks like this:\ncd /opt/letsencrypt ./certbot-auto certonly --standalone -d example.com -d www.example.com If this displays something like, \u0026ldquo;couldn\u0026rsquo;t connect\u0026rdquo; you probably still have something running on a port it tries to use. The generated certificate will be located under /etc/letsencrypt/archive and /etc/letsencrypt/keys while /etc/letsencrypt/live is a symlink to the latest version of the cert. It\u0026rsquo;s wise to not copy these away from here, since the live link is always updated to the latest version. Our script will handle haproxy, which requires one cert file made from privkey + fullchain|.pem files.\nSetup Auto-Renewal Let\u0026rsquo;s Encrypt issues short lived certificates (90 days). In order to not have to do this procedure every 89 days, certbot provides a nifty command called renew. However, for the cert to be generated, the port 443 has to be open. This means, haproxy needs to be stopped before doing the renew. Now, you COULD write a script which stops it, and after the certificate has been renewed, starts it again, but certbot has you covered again in that department. It provides hooks called pre-hook and post-hook. Thus, all you have to write is the following:\n#!/bin/bash cd /opt/letsencrypt ./certbot-auto renew --pre-hook \u0026#34;service haproxy stop\u0026#34; --post-hook \u0026#34;service haproxy start\u0026#34; DOMAIN=\u0026#39;example.com\u0026#39; sudo -E bash -c \u0026#39;cat /etc/letsencrypt/live/$DOMAIN/fullchain.pem /etc/letsencrypt/live/$DOMAIN/privkey.pem \u0026gt; /etc/haproxy/certs/$DOMAIN.pem\u0026#39; If you would like to test it first, just include the switch --dry-run.\nIn case of success you should see something like this:\nroot@raspberrypi:/opt/letsencrypt# ./certbot-auto renew --pre-hook \u0026#34;service haproxy stop\u0026#34; --post-hook \u0026#34;service haproxy start\u0026#34; --dry-run Saving debug log to /var/log/letsencrypt/letsencrypt.log ------------------------------------------------------------------------------- Processing /etc/letsencrypt/renewal/example.com.conf ------------------------------------------------------------------------------- Cert not due for renewal, but simulating renewal for dry run Running pre-hook command: service haproxy stop Renewing an existing certificate Performing the following challenges: tls-sni-01 challenge for example.com Waiting for verification... Cleaning up challenges Generating key (2048 bits): /etc/letsencrypt/keys/0002_key-certbot.pem Creating CSR: /etc/letsencrypt/csr/0002_csr-certbot.pem ** DRY RUN: simulating \u0026#39;certbot renew\u0026#39; close to cert expiry ** (The test certificates below have not been saved.) Congratulations, all renewals succeeded. The following certs have been renewed: /etc/letsencrypt/live/example.com/fullchain.pem (success) ** DRY RUN: simulating \u0026#39;certbot renew\u0026#39; close to cert expiry ** (The test certificates above have not been saved.) Running post-hook command: service haproxy start Put this script into a crontab to run every 89 days like this:\ncrontab -e # Open crontab for edit and paste in this line * * */89 * * /root/renew-cert.sh And you should be all set. Now we move on the configure haproxy to redirect and to use our newly generated certificate.\nHaproxy Like I said, haproxy requires a single file certificate in order to encrypt traffic to and from the website. To do this, we need to combine privkey.pem and fullchain.pem. As of this writing, there are a couple of solutions to automate this via a post hook on renewal. And also, there is an open ticket with certbot to implement a simpler solution located here: https://github.com/certbot/certbot/issues/1201. I, for now, have chosen to simply concatenate the two files together with cat like this:\nDOMAIN=\u0026#39;example.com\u0026#39; sudo -E bash -c \u0026#39;cat /etc/letsencrypt/live/$DOMAIN/fullchain.pem /etc/letsencrypt/live/$DOMAIN/privkey.pem \u0026gt; /etc/haproxy/certs/$DOMAIN.pem\u0026#39; It will create a combined cert under /etc/haproxy/certs/example.com.pem.\nHaproxy configuration If haproxy happens to be running, stop it with service haproxy stop.\nFirst, save the default configuration file: cp /etc/haproxy/haproxy.cfg /etc/haproxy/haproxy.cfg.old. Now, overwrite the old one with this new one (comments about what each setting does, are in-lined; they are safe to copy):\nglobal daemon # Set this to your desired maximum connection count. maxconn 2048 # https://cbonte.github.io/haproxy-dconv/configuration-1.5.html#3.2-tune.ssl.default-dh-param # bit setting for Diffie - Hellman key size. tune.ssl.default-dh-param 2048 defaults option forwardfor option http-server-close log global mode http option httplog option dontlognull timeout connect 5000 timeout client 50000 timeout server 50000 errorfile 400 /etc/haproxy/errors/400.http errorfile 403 /etc/haproxy/errors/403.http errorfile 408 /etc/haproxy/errors/408.http errorfile 500 /etc/haproxy/errors/500.http errorfile 502 /etc/haproxy/errors/502.http errorfile 503 /etc/haproxy/errors/503.http errorfile 504 /etc/haproxy/errors/504.http # In case it\u0026#39;s a simple http call, we redirect to the basic backend server # which in turn, if it isn\u0026#39;t an SSL call, will redirect to HTTPS that is # handled by the frontend setting called \u0026#39;www-https\u0026#39;. frontend www-http # Redirect HTTP to HTTPS bind *:80 # Adds http header to end of end of the HTTP request reqadd X-Forwarded-Proto:\\ http # Sets the default backend to use which is defined below with name \u0026#39;www-backend\u0026#39; default_backend www-backend # If the call is HTTPS we set a challenge to letsencrypt backend which # verifies our certificate and than direct traffic to the backend server # which is the running hugo site that is served under https if the challenge succeeds. frontend www-https # Bind 443 with the generated letsencrypt cert. bind *:443 ssl crt /etc/haproxy/certs/skarlso.com.pem # set x-forward to https reqadd X-Forwarded-Proto:\\ https # set X-SSL in case of ssl_fc \u0026lt;- explained below http-request set-header X-SSL %[ssl_fc] # Select a Challenge acl letsencrypt-acl path_beg /.well-known/acme-challenge/ # Use the challenge backend if the challenge is set use_backend letsencrypt-backend if letsencrypt-acl default_backend www-backend backend www-backend # Redirect with code 301 so the browser understands it is a redirect. If it\u0026#39;s not SSL_FC. # ssl_fc: Returns true when the front connection was made via an SSL/TLS transport # layer and is locally deciphered. This means it has matched a socket declared # with a \u0026#34;bind\u0026#34; line having the \u0026#34;ssl\u0026#34; option. redirect scheme https code 301 if !{ ssl_fc } # Server for the running hugo site. server www-1 192.168.0.17:8080 check backend letsencrypt-backend # Lets encrypt backend server server letsencrypt 127.0.0.1:54321 Save this, and start haproxy with services haproxy start. If you did everything right, it should say nothing. If, however, there went something wrong with starting the proxy, it usually displays something like this:\nJob for haproxy.service failed. See \u0026#39;systemctl status haproxy.service\u0026#39; and \u0026#39;journalctl -xn\u0026#39; for details. You can also gather some more information on what went wrong from less /var/log/haproxy.log.\nStarting the Server Everything should be ready to go. Hugo has the concept of a baseUrl. Everything that it loads, and tries to access will be prefixed with it. You can either set it through it\u0026rsquo;s config.yaml file, or from the command line.\nTo start the server, call this from the site\u0026rsquo;s root folder:\nhugo server --bind=192.168.x.x --port=8080 --baseUrl=https://example.com --appendPort=false Interesting thing here to note is https and the port. The IP could be 127.0.0.1 as well. I experienced problems though with not binding to network IP when I was debugging the site from a different laptop on the same network.\nOnce the server is started, you should be able to open up your website from a different browser, not on your local network, and see that it has a valid certificate installed. In Chrome you should see a green icon telling you that the cert is valid.\nLast Words And that is all. The site should be up and running and the proxy should auto-renew your site\u0026rsquo;s certificate. If you happened to change DNS or change the server, you\u0026rsquo;ll have to reissue the certificate.\nThanks for reading! Any questions or trouble setting something up, please feel free to leave a comment.\nCheers, Gergely.\n","permalink":"https://skarlso.github.io/2017/02/15/how-to-https-with-hugo-letsencrypt-haproxy/","summary":"Intro Hi folks.\nToday, I would like to write about how to do HTTPS for a website, without the need to buy a certificate and set it up via your DNS provider. Let\u0026rsquo;s begin.\nAbstract What you will achieve by the end of this post:\nEvery call to HTTP will be redirected to HTTPS via haproxy. HTTPS will be served with Haproxy and LetsEncrypt as the Certificate provider. Automatically update the certificate before its expiration.","title":"How to HTTPS with Hugo LetsEncrypt and HAProxy"},{"content":"Intro Hi Folks.\nThis is a follow up on my previous post about Google Sign-In. In this post we will discover what to do with the information retrieved in the first encounter, which you can find here: Google Sign-In Part 1.\nForewords The Project Everything I did in the first post, and that I\u0026rsquo;m going to do in this example, can be found in this project: Google-OAuth-Go-Sample.\nJust to recap, we left off previously on the point where we successfully obtained information about the user, with a secure token and a session initiated with them. Google nicely enough provided us with some details which we can use. This information was in JSON format and looked something like this:\n{ \u0026#34;sub\u0026#34;: \u0026#34;1111111111111111111111\u0026#34;, \u0026#34;name\u0026#34;: \u0026#34;Your Name\u0026#34;, \u0026#34;given_name\u0026#34;: \u0026#34;Your\u0026#34;, \u0026#34;family_name\u0026#34;: \u0026#34;Name\u0026#34;, \u0026#34;profile\u0026#34;: \u0026#34;https://plus.google.com/1111111111111111111111\u0026#34;, \u0026#34;picture\u0026#34;: \u0026#34;https://lh3.googleusercontent.com/asdfadsf/AAAAAAAAAAI/Aasdfads/Xasdfasdfs/photo.jpg\u0026#34;, \u0026#34;email\u0026#34;: \u0026#34;your@gmail.com\u0026#34;, \u0026#34;email_verified\u0026#34;: true, \u0026#34;gender\u0026#34;: \u0026#34;male\u0026#34; } In my example, to keep things simple, I will use the email address since that has to be unique in the land of Google. You could assign an ID to the user, and you could complicate things even further, but my goal is not to write an academic paper about cryptography here.\nImplementation Making something useful out of the data In order for the app to recognise a user it must save some data about the user. I\u0026rsquo;m doing that in MongoDB right now, but that could be any form of persistence layer, like, SQLite3, BoltDB, PostgresDB, etc.\nAfter successful user authorization Once the user used google to provide us with sufficient information about him/herself, we can retrieve data about that user from our records. The data could be anything that is linked to our unique identifier like: Character Profile, Player Information, Status, Last Logged-In, etcetc. For this, there are two things that need to happen after authorization: Save/Load user information and initiate a session.\nThe session can be in the form of a cookie, or a Redis storage, or URL re-writing. I\u0026rsquo;m choosing a cookie here.\nSave / Load user information All I\u0026rsquo;m doing is a simple, returning / new user handling. The concept is simple. If the email isn\u0026rsquo;t saved, we save it. If it\u0026rsquo;s saved, we set a logic to our page render to greet the returning user.\nIn the AuthHandler I\u0026rsquo;m doing the following:\n... seen := false db := database.MongoDBConnection{} if _, mongoErr := db.LoadUser(u.Email); mongoErr == nil { seen = true } else { err = db.SaveUser(\u0026amp;u) if err != nil { log.Println(err) c.HTML(http.StatusBadRequest, \u0026#34;error.tmpl\u0026#34;, gin.H{\u0026#34;message\u0026#34;: \u0026#34;Error while saving user. Please try again.\u0026#34;}) return } } c.HTML(http.StatusOK, \u0026#34;battle.tmpl\u0026#34;, gin.H{\u0026#34;email\u0026#34;: u.Email, \u0026#34;seen\u0026#34;: seen}) ... Let\u0026rsquo;s break this down a bit. There is a db connection here, which calls a function that either returns an error, or it doesn\u0026rsquo;t. If it doesn\u0026rsquo;t, that means we have our user. If it does, it means we have to save the user. This is a very simple case (disregard for now, that the error could be something else as well (If you can\u0026rsquo;t get passed that, you could type check the error or check if the returned record contains the requested user information instead of checking for an error.)).\nThe template is than rendered depending on the seen boolean like this:\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;link rel=\u0026#34;icon\u0026#34; type=\u0026#34;image/png\u0026#34; href=\u0026#34;/img/favicon.ico\u0026#34; /\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/css/main.css\u0026#34;\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; {{if .seen}} \u0026lt;h1\u0026gt;Welcome back to the battlefield \u0026#39;{{ .email }}\u0026#39;.\u0026lt;/h1\u0026gt; {{else}} \u0026lt;h1\u0026gt;Welcome to the battlefield \u0026#39;{{ .email }}\u0026#39;.\u0026lt;/h1\u0026gt; {{end}} \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; You can see here, that if seen is true the header message will say: \u0026ldquo;Welcome back\u0026hellip;\u0026rdquo;.\nInitiating a session When the user is successfully authenticated, we activate a session so that the user can access pages that require authorization. Here, I have to mention that I\u0026rsquo;m using Gin, so restricted end-points are made with groups which require a middleware.\nAs I mentioned earlier, I\u0026rsquo;m using cookies as session handlers. For this, a new session store has to be created with some secure token. This is achieved with the following code fragments ( note that I\u0026rsquo;m using a Gin session middleware which uses gorilla\u0026rsquo;s session handler located here: Gin-Gonic(Sessions)):\n// RandToken in handlers.go: // RandToken generates a random @l length token. func RandToken(l int) string { b := make([]byte, l) rand.Read(b) return base64.StdEncoding.EncodeToString(b) } // quest.go: // Create the cookie store in main.go. store := sessions.NewCookieStore([]byte(handlers.RandToken(64))) store.Options(sessions.Options{ Path: \u0026#34;/\u0026#34;, MaxAge: 86400 * 7, }) // using the cookie store: router.Use(sessions.Sessions(\u0026#34;goquestsession\u0026#34;, store)) After this gin.Context lets us access this session store by doing session := sessions.Default(c). Now, create a session variable called user-id like this:\nsession.Set(\u0026#34;user-id\u0026#34;, u.Email) err = session.Save() if err != nil { log.Println(err) c.HTML(http.StatusBadRequest, \u0026#34;error.tmpl\u0026#34;, gin.H{\u0026#34;message\u0026#34;: \u0026#34;Error while saving session. Please try again.\u0026#34;}) return } Don\u0026rsquo;t forget to save the session. ;) That is it. If I restart the server, the cookie won\u0026rsquo;t be usable any longer, since it will generate a new token for the cookie store. The user will have to log in again. Note: It might be that you\u0026rsquo;ll see something like this, from session: [sessions] ERROR! securecookie: the value is not valid. You can ignore this error.\nRestricting access to certain end-points with the auth Middleware™ Now, that our session is alive, we can use it to restrict access to some part of the application. With Gin, it looks like this:\nauthorized := router.Group(\u0026#34;/battle\u0026#34;) authorized.Use(middleware.AuthorizeRequest()) { authorized.GET(\u0026#34;/field\u0026#34;, handlers.FieldHandler) } This creates a grouping of end-points under /battle. Which means, everything under /battle will only be accessible if the middleware passed to the Use function calls the next handler in the chain. If it aborts the call chain, the end-point will not be accessible. My middleware is pretty simple, but it gets the job done:\n// AuthorizeRequest is used to authorize a request for a certain end-point group. func AuthorizeRequest() gin.HandlerFunc { return func(c *gin.Context) { session := sessions.Default(c) v := session.Get(\u0026#34;user-id\u0026#34;) if v == nil { c.HTML(http.StatusUnauthorized, \u0026#34;error.tmpl\u0026#34;, gin.H{\u0026#34;message\u0026#34;: \u0026#34;Please log in.\u0026#34;}) c.Abort() } c.Next() } } Note, that this only check if user-id is set or not. That\u0026rsquo;s certainly not enough for a secure application. Its only supposed to be a simple example of the mechanics of the auth middleware. Also, the session usually contains more than one parameter. It\u0026rsquo;s more likely that it contains several variables, which describe the user including a state for CORS protection. For CORS I\u0026rsquo;d recommend using rs/cors.\nIf you would try to access http://127.0.0.1:9090/battle/field without logging in, you\u0026rsquo;d be redirected to an error.tmpl with the message: Please log in..\nFinal Words That\u0026rsquo;s pretty much it. Important parts are:\nSaving the right information Secure cookie store CORS for sessions Checks of the users details in the cookie Authorised end-points Session handling Any questions, remarks, ideas, are very welcomed in the comment section. There are plenty of very nice Go frameworks which do Google OAuth2 out of the box. I recommend using them, as they save you a lot of legwork.\nThank you for reading! Gergely.\n","permalink":"https://skarlso.github.io/2016/11/02/google-signin-with-go-part2/","summary":"Intro Hi Folks.\nThis is a follow up on my previous post about Google Sign-In. In this post we will discover what to do with the information retrieved in the first encounter, which you can find here: Google Sign-In Part 1.\nForewords The Project Everything I did in the first post, and that I\u0026rsquo;m going to do in this example, can be found in this project: Google-OAuth-Go-Sample.\nJust to recap, we left off previously on the point where we successfully obtained information about the user, with a secure token and a session initiated with them.","title":"How to do Google Sign-In with Go - Part 2"},{"content":"Intro Hey folks.\nSo, there is this project called Huginn which I absolutely love.\nBut the thing is, that for a couple of scrappers ( at least for me ), I don\u0026rsquo;t want to spin up a whole rails app.\nHence, I\u0026rsquo;ve come up with RScrap. Which is a bunch of Ruby scripts run as cron jobs on a raspberry pi. And because I dislike emails as well, and most of the time, I don\u0026rsquo;t read them, I opted for a nicer solution. Enter the world of Telegram. They provide you with the ability to create bots. You basically get an API key, and than using that key, you can send private messages, or even create an interactive bot which you can send messages too.\nIn my simple example, I\u0026rsquo;m using it to send private messages to myself, but I could just as well, make it interactive and than tell it to run one of the scripts.\nThe Code Let\u0026rsquo;s take a look at what we got.\nThe main scraper The main scraper, is simply bunch of convenience methods that wrap handling and working with the database and the telegram bot. That\u0026rsquo;s all. It\u0026rsquo;s very simple. Very short. The Telegram part is just this bit:\ndef send_message(text) Telegram::Bot::Client.run(@token) do |bot| bot.api.send_message(chat_id: @id, text: text) end end Straightforward. Creating an interactive bot, would look something like this:\n#!/usr/bin/env ruby require \u0026#39;telegram/bot\u0026#39; token = \u0026#39;YOUR_TELEGRAM_BOT_API_TOKEN\u0026#39; Telegram::Bot::Client.run(token) do |bot| bot.listen do |message| case message.text when \u0026#39;/start\u0026#39; bot.api.send_message(chat_id: message.chat.id, text: \u0026#34;Hello, #{message.from.first_name}\u0026#34;) when \u0026#39;/stop\u0026#39; bot.api.send_message(chat_id: message.chat.id, text: \u0026#34;Bye, #{message.from.first_name}\u0026#34;) end end end Basically, it will listen, and than you can send it messages and based on the parsed message.text you can define functions to call. For example, for rscrap I could define something like run_script(script). And the command would be: /run reddit. Which will execute my reddit script. The possibilities are endless.\nThe scripts The scripts use nokogiri to parse a web page, and than return a URL which will be sent by the TelegramBot. They are also saved in the database so that when a new comic strip comes out, I know that it\u0026rsquo;s new. For reddit, I\u0026rsquo;m saving a timestamp as well, and I collect everything after that timestamp through the reddit API as JSON, and send it as a bundled message with shortified links to the posts using bit.ly.\nThe scraping is most of the times the same for every comic. Thus, there is a helper method for it. The script itself, is very short. For example, lets look at gunnerkrigg court.\nrequire_relative \u0026#39;../rscrap\u0026#39; require \u0026#39;nokogiri\u0026#39; require \u0026#39;open-uri\u0026#39; url = \u0026#39;http://www.gunnerkrigg.com\u0026#39; scrap = Rscrap.new page = Nokogiri::HTML(open(url)) comic_id = page.css(\u0026#39;img.comic_image\u0026#39;)[0].select { |e| e if e[0] == \u0026#39;src\u0026#39; }[0][1] new_comic = \u0026#34;#{url}#{comic_id}\u0026#34; scrap.send_new_comic(url, new_comic) The interesting part of it is this bit: comic_id = page.css('img.comic_image')[0].select { |e| e if e[0] == 'src' }[0][1]. It extracts the URL for the comic image, and stores it as an \u0026ldquo;id\u0026rdquo; of the comic. This than, is sent as a message which Telegram will embed. There is no need to visit the web page, the image is in your feed and you can view it directly. Just like an RSS ready.\nCron These scripts are best used in a cron job. The comics are usually running with a daily frequency, where as the reddit gatherer is running with an hour frequency. Basically, I\u0026rsquo;m receiving updates on an hourly basis if there are new posts by then. Running ruby from cron was a bit tricky. I\u0026rsquo;m using bundler for the environment, and came up with this:\n0 6-23 * * * /bin/bash -l -c \u0026#39;cd /home/\u0026lt;youruser\u0026gt;/rubyproj/rscrap \u0026amp;\u0026amp; bundle exec ruby scripts/reddit.rb\u0026#39; 0 8,22 * * * /bin/bash -l -c \u0026#39;cd /home/\u0026lt;youruser\u0026gt;/rubyproj/rscrap \u0026amp;\u0026amp; bundle exec ruby scripts/gunnerkrigg.rb\u0026#39; 0 8,22 * * * /bin/bash -l -c \u0026#39;cd /home/\u0026lt;youruser\u0026gt;/rubyproj/rscrap \u0026amp;\u0026amp; bundle exec ruby scripts/aws_blog.rb\u0026#39; 0 5,23 * * * /bin/bash -l -c \u0026#39;cd /home/\u0026lt;youruser\u0026gt;/rubyproj/rscrap \u0026amp;\u0026amp; bundle exec ruby scripts/goblinscomic.rb\u0026#39; 0 6,20 * * * /bin/bash -l -c \u0026#39;cd /home/\u0026lt;youruser\u0026gt;/rubyproj/rscrap \u0026amp;\u0026amp; bundle exec ruby scripts/xkcd.rb\u0026#39; 0 7,19 * * * /bin/bash -l -c \u0026#39;cd /home/\u0026lt;youruser\u0026gt;/rubyproj/rscrap \u0026amp;\u0026amp; bundle exec ruby scripts/commitstrip.rb\u0026#39; 0 8 * * * /bin/bash -l -c \u0026#39;cd /home/\u0026lt;youruser\u0026gt;/rubyproj/rscrap \u0026amp;\u0026amp; bundle exec ruby scripts/sequiential_art.rb\u0026#39; And a telegram message for all these things, looks like this: Reddit: Comics: Conclusion That\u0026rsquo;s it folks. Adding a new scraper is easy. I added the aws blog as a new entry as well by just copying the comics scripts. And I\u0026rsquo;m also getting Weather Reports delivered every morning to me.\nHave fun. Any questions, please feel free to leave a comment!\nThanks, Gergely.\n","permalink":"https://skarlso.github.io/2016/10/06/rscrap-ruby-scraping-with-cronjob-scripts/","summary":"Intro Hey folks.\nSo, there is this project called Huginn which I absolutely love.\nBut the thing is, that for a couple of scrappers ( at least for me ), I don\u0026rsquo;t want to spin up a whole rails app.\nHence, I\u0026rsquo;ve come up with RScrap. Which is a bunch of Ruby scripts run as cron jobs on a raspberry pi. And because I dislike emails as well, and most of the time, I don\u0026rsquo;t read them, I opted for a nicer solution.","title":"RScrap scraper"},{"content":"Intro Hello folks.\nToday, I would like to tell you about my configuration for a low budget Home Theater setup.\nMy tools are as follows:\nFLIRC Raspberry Pi 2 500G SSD An a good \u0026lsquo;ol wifi TL;DR Use Flirc for remote control, omxplayer for streaming the movie from an SSD on a headless PI controller via SSH and enjoy a nice, cold Lemon - Menta beer.\nFlirc First, the remote control. So, I like to sit in my couch and watch the movie from there. I hate getting up, or having a keyboard at arm length to control the pi. Flirc is a very easy way of doing just that with a simple remote control.\nIt costs ~$22 and is easy to setup. Works with any kind of remote control. Setting up key bindings for the control, is as simple as starting the Flirc software and pressing buttons on the remote to map to keyboard keys. Now, my pi is running headless, and the Flirc binary isn\u0026rsquo;t quite working with raspbian; so to do the binding, I just did that on my main machine. When I was done, I just plugged in the Flirc, and proceeded to setup the pi.\nRaspberry Pi 2 The pi 2 is a small powerhouse. However, the SD card on which it sits is simply not fast enough. From time to time, I experienced lateness in sound, or stutter in video. So, instead of having the movie on the pi, I\u0026rsquo;m streaming through a faster SSD with SSHFS. For playing, I\u0026rsquo;m using omxplayer. With omxplayer, I had a few problems, because sound was not coming through the HDMI cable. A little bit of research lead me to this change in the pi\u0026rsquo;s boot config. Uncomment this line:\n#hdmi_driver=2 After rebooting, I also, did this thing:\nsudo apt-get install alsa-utils sudo modprobe snd_bcm2835 sudo amixer -c 0 cset numid=3 2 This saved my bacon. The whole answer can be found here: Stackoverflow.\nOnce SSHFS was working, and HDMI received sound, I just executed this command: omxplayer -o hdmi /media/stream/my_movie.mkv. This told omxplayer to use the local HDMI connection for video output.\nAll this was from my computer through an SSH session so I never controlled the pi directly. Once done, I proceeded to sit down with a nice, cold Lemon - Menta beer and a remote control.\nOnce little gotcha \u0026ndash; omxplayer is controlled through the buttons + (volume up), - (volume down), (stop, play), and q for quitting. Flirc is able to map any key combinations on a keyboard as well to any button on the remote. Combinations can be done by selecting a control key and pressing another key. So mapping + to the volume up button was by pressing shift and then \u0026lsquo;=\u0026rsquo;.\nWrapping Up I enjoyed the movie while being able to adjust the volume, or pause it, when my popcorn was ready, and close the player when the movie was done. There are a number of other ways to do this, like using kodi + yatse. Which lets you remote control a media software with your mobile phone. But I\u0026rsquo;m using the pi for a number of other things and the GUI is rather resource heavy.\nThere you have it folks. Might not be the easiest setup, but it\u0026rsquo;s pretty awesome anyways.\nCheers, Gergely.\n","permalink":"https://skarlso.github.io/2016/09/17/simple-hometheater-with-remote-and-flirc/","summary":"Intro Hello folks.\nToday, I would like to tell you about my configuration for a low budget Home Theater setup.\nMy tools are as follows:\nFLIRC Raspberry Pi 2 500G SSD An a good \u0026lsquo;ol wifi TL;DR Use Flirc for remote control, omxplayer for streaming the movie from an SSD on a headless PI controller via SSH and enjoy a nice, cold Lemon - Menta beer.\nFlirc First, the remote control.","title":"Budget Home Theather with a Headless Raspberry Pi and Flirc for Remote Controlling"},{"content":"Update: This post ignored the fact that this works for utf-8 characters only. Characters which are stored on more than 1 byte will cause trouble. Look at this Effective Go Example.\nfor pos, char := range \u0026#34;日本\\x80語\u0026#34; { // \\x80 is an illegal UTF-8 encoding fmt.Printf(\u0026#34;character %#U starts at byte position %d\\n\u0026#34;, char, pos) } Prints:\ncharacter U+65E5 \u0026#39;日\u0026#39; starts at byte position 0 character U+672C \u0026#39;本\u0026#39; starts at byte position 3 character U+FFFD \u0026#39;�\u0026#39; starts at byte position 6 character U+8A9E \u0026#39;語\u0026#39; starts at byte position 7 Keep this in mind when working with strings.\nAnother quick reminder\u0026hellip; Always go with []byte if possible. I said it before, and I\u0026rsquo;m going to say it over and over again. It\u0026rsquo;s crucial.\nHere is a little code from exercism.io. First, with strings:\npackage igpay import ( \u0026#34;strings\u0026#34; ) // PigLatin translates reguler old English into awesome pig-latin. func PigLatin(in string) (ret string) { for _, v := range strings.Fields(in) { ret += pigLatin(v) + \u0026#34; \u0026#34; } return strings.Trim(ret, \u0026#34; \u0026#34;) } func pigLatin(in string) (ret string) { if strings.IndexAny(in, \u0026#34;aeiou\u0026#34;) == 0 { ret += in + \u0026#34;ay\u0026#34; return } for i := 0; i \u0026lt; len(in); i++ { vowelPos := strings.IndexAny(in, \u0026#34;aeiou\u0026#34;) if (in[0] == \u0026#39;y\u0026#39; || in[0] == \u0026#39;x\u0026#39;) \u0026amp;\u0026amp; vowelPos \u0026gt; 1 { vowelPos = 0 ret = in } if vowelPos != 0 { adjustPosition := vowelPos if in[adjustPosition] == \u0026#39;u\u0026#39; \u0026amp;\u0026amp; in[adjustPosition - 1] == \u0026#39;q\u0026#39; { adjustPosition++ } ret = in[adjustPosition:] + in[:adjustPosition] } } ret += \u0026#34;ay\u0026#34; return } Than with []byte:\npackage igpay import ( // \u0026#34;fmt\u0026#34; \u0026#34;bytes\u0026#34; ) // PigLatin translates reguler old English into awesome pig-latin. func PigLatin(in string) (ret string) { inBytes := []byte(in) var retBytes [][]byte for _, v := range bytes.Fields(inBytes) { v2 := make([]byte, len(v)) copy(v2, v) retBytes = append(retBytes, pigLatin(v2)) } ret = string(bytes.Join(retBytes, []byte(\u0026#34; \u0026#34;))) return } func pigLatin(in []byte) (ret []byte) { if bytes.IndexAny(in, \u0026#34;aeiou\u0026#34;) == 0 { ret = append(in, []byte(\u0026#34;ay\u0026#34;)...) return } for i := 0; i \u0026lt; len(in); i++ { vowelPos := bytes.IndexAny(in, \u0026#34;aeiou\u0026#34;) if (in[0] == \u0026#39;y\u0026#39; || in[0] == \u0026#39;x\u0026#39;) \u0026amp;\u0026amp; vowelPos \u0026gt; 1 { vowelPos = 0 ret = in } if vowelPos != 0 { adjustPosition := vowelPos if in[adjustPosition] == \u0026#39;u\u0026#39; \u0026amp;\u0026amp; in[adjustPosition - 1] == \u0026#39;q\u0026#39; { adjustPosition++ } in = append(in[adjustPosition:], in[:adjustPosition]...) ret = in // fmt.Printf(\u0026#34;%s\\n\u0026#34;, ret) } } ret = append(ret, []byte(\u0026#34;ay\u0026#34;)...) return } And than,the benchmarks of course:\nBenchmarkPigLatin-8 200000\t10688 ns/op BenchmarkPigLatinStrings-8 100000\t15211 ns/op PASS The improvement is not massive in this case, but it\u0026rsquo;s more than enough to matter. And in a bigger, more complicated program, string concatenation will take a LOT of time away.\nIn Go, the bytes package has a 1-1 map compared to the strings packages, so chances are, if you are doing strings concatenations you will be able to port that piece of code easily to []byte.\nThat\u0026rsquo;s all folks.\nHappy coding, Gergely.\n","permalink":"https://skarlso.github.io/2016/08/19/always-go-with-bytes/","summary":"Update: This post ignored the fact that this works for utf-8 characters only. Characters which are stored on more than 1 byte will cause trouble. Look at this Effective Go Example.\nfor pos, char := range \u0026#34;日本\\x80語\u0026#34; { // \\x80 is an illegal UTF-8 encoding fmt.Printf(\u0026#34;character %#U starts at byte position %d\\n\u0026#34;, char, pos) } Prints:\ncharacter U+65E5 \u0026#39;日\u0026#39; starts at byte position 0 character U+672C \u0026#39;本\u0026#39; starts at byte position 3 character U+FFFD \u0026#39;�\u0026#39; starts at byte position 6 character U+8A9E \u0026#39;語\u0026#39; starts at byte position 7 Keep this in mind when working with strings.","title":"Always Go with []byte"},{"content":"Quick reminder. If you have a never changing regex in Go, do NOT put it into a frequently called function. ALWAYS put it into a global variable. I\u0026rsquo;ll show you why.\nBenchmark for code with a variable in a frequently called function:\nBenchmarkNumber-8 30000\t41633 ns/op BenchmarkAreaCode-8 50000\t27736 ns/op BenchmarkFormat-8 50000\t29263 ns/op PASS ok _/phone-number\t5.110s Benchmark for code with the same variable outside in a global scope:\nBenchmarkNumber-8 300000\t5618 ns/op BenchmarkAreaCode-8 500000\t3884 ns/op BenchmarkFormat-8 300000\t4696 ns/op PASS ok _/phone-number\t5.197s Notice the magnitude change in ns/op! That\u0026rsquo;s something to keep an eye out for.\nThanks for reading! Cheers, Gergely.\n","permalink":"https://skarlso.github.io/2016/08/16/never-changing-regex/","summary":"Quick reminder. If you have a never changing regex in Go, do NOT put it into a frequently called function. ALWAYS put it into a global variable. I\u0026rsquo;ll show you why.\nBenchmark for code with a variable in a frequently called function:\nBenchmarkNumber-8 30000\t41633 ns/op BenchmarkAreaCode-8 50000\t27736 ns/op BenchmarkFormat-8 50000\t29263 ns/op PASS ok _/phone-number\t5.110s Benchmark for code with the same variable outside in a global scope:","title":"Global variable for never changing regex"},{"content":"Hi folks.\nQuick gotcha, when working with Drupal. If you just freshly installed it, and everything seems to work fine, and yet you are experiencing things like, the admin toolbar is randomly disappearing, or configuration is not saved; than you might not have modrewrite enabled on your apache server.\nBecause, by default, Drupal has clean url enabled, that needs URL rewriting on apache.\nSo, step one.\nHave this in your .htaccess file:\n\u0026lt;IfModule mod_rewrite.c\u0026gt; RewriteEngine on ... # and than a bunch of rewrite rules according to your leisure Than look up this line in your httpd.conf file and remove the prefix \u0026lsquo;#\u0026rsquo;.\n#LoadModule rewrite_module libexec/apache2/mod_rewrite.so That is all. From there on, everything should work. If, you don\u0026rsquo;t want the clean url setting, yet you can\u0026rsquo;t disable it, and don\u0026rsquo;t want to restart the server and edit the settings.php file; use drush like this:\ndrush vset clean_url 0 --yes This should disable it and bust the cache in the process so it\u0026rsquo;s immediately visible.\nThat is all folks.\nCheers, Gergely.\n","permalink":"https://skarlso.github.io/2016/08/13/drupal-missing-toolbar-and-settings-not-saving/","summary":"Hi folks.\nQuick gotcha, when working with Drupal. If you just freshly installed it, and everything seems to work fine, and yet you are experiencing things like, the admin toolbar is randomly disappearing, or configuration is not saved; than you might not have modrewrite enabled on your apache server.\nBecause, by default, Drupal has clean url enabled, that needs URL rewriting on apache.\nSo, step one.\nHave this in your .","title":"Drupal missing ToolBar and settings not saving"},{"content":"Hi folks.\nI wanted to take the time to share with you a talk that I recently did.\nThe slides and the source I used, can be found here: Github.\nAnd then, there is also a docker image which contains all the plugins, job configurations and all the practices which I did during the talk. Please feel free to have a go with it. DockerHub - Jenkins Best Practices.\nFor easy access and reading, here are the slides on Slideshare: Jenkins Best Practices Slides.\nI, gladly answer any questions which should arise.\nThanks! Gergely.\n","permalink":"https://skarlso.github.io/2016/07/28/jenkins-best-practices/","summary":"Hi folks.\nI wanted to take the time to share with you a talk that I recently did.\nThe slides and the source I used, can be found here: Github.\nAnd then, there is also a docker image which contains all the plugins, job configurations and all the practices which I did during the talk. Please feel free to have a go with it. DockerHub - Jenkins Best Practices.\nFor easy access and reading, here are the slides on Slideshare: Jenkins Best Practices Slides.","title":"Jenkins Best Practices Talk"},{"content":"Though it could be done better, I\u0026rsquo;m sure, but I\u0026rsquo;m actually pretty satisfied with this one. It loops only twice as opposed to filtered ranges and whatnot other solutions to the sieve. I was thinking of rather creating a list and deleting elements from it, but that\u0026rsquo;s already three loops.\nMaybe I\u0026rsquo;ll do a benchmark later on more solutions.\n# Sieve contains a function to return a set of primes class Sieve def initialize(n) @n = n end # Returns a list of primes up to a certain limit # @param n limit # @return list of primes def primes marked = [] primes = [] (2..@n).each do |e| unless marked.include?(e) primes.push e (e..@n).step(e) { |s| marked.push s } end end primes end end Cheers, Gergely.\n","permalink":"https://skarlso.github.io/2016/07/12/ruby-sieve/","summary":"Though it could be done better, I\u0026rsquo;m sure, but I\u0026rsquo;m actually pretty satisfied with this one. It loops only twice as opposed to filtered ranges and whatnot other solutions to the sieve. I was thinking of rather creating a list and deleting elements from it, but that\u0026rsquo;s already three loops.\nMaybe I\u0026rsquo;ll do a benchmark later on more solutions.\n# Sieve contains a function to return a set of primes class Sieve def initialize(n) @n = n end # Returns a list of primes up to a certain limit # @param n limit # @return list of primes def primes marked = [] primes = [] (2.","title":"Ruby Sieve"},{"content":"Hi folks.\nThis is but a simple git hook to run a test in order to ensure you can push. It also ignores the vendor folder if you happen to have on in your directory.\nEdit the file under .git/hooks/pre-push.sample and add this at the end before the exit 0.\ngo test $(go list ./... |grep -v vendor) RESULT=$? if [ $RESULT -ne 0 ]; then echo \u0026#34;Failed test run. Disallowing push.\u0026#34; exit 1 fi After this, rename the file to pre-push removing the .sample from it.\nIf you now, mess something up, you should see something like this before your push:\n# github.com/Skarlso/goprogressquest ./create.go:40: undefined: sha1 in sha1.Sum ./create.go:41: undefined: fmt in fmt.Sprintf ./create.go:115: undefined: json in json.Unmarshal ./create.go:130: undefined: json in json.Unmarshal FAIL\tgithub.com/Skarlso/goprogressquest [build failed] Failed test run. Disallowing push. error: failed to push some refs to \u0026#39;git@github.com:Skarlso/goprogressquest.git\u0026#39; That is all.\nCheers, Gergely.\n","permalink":"https://skarlso.github.io/2016/07/12/simple-hook-to-rid-of-trouble/","summary":"Hi folks.\nThis is but a simple git hook to run a test in order to ensure you can push. It also ignores the vendor folder if you happen to have on in your directory.\nEdit the file under .git/hooks/pre-push.sample and add this at the end before the exit 0.\ngo test $(go list ./... |grep -v vendor) RESULT=$? if [ $RESULT -ne 0 ]; then echo \u0026#34;Failed test run. Disallowing push.","title":"Simple hook to rid of trouble"},{"content":"Hi folks.\nToday, I would like to write up a step - by - step guide with a sample web app on how to do Google Sign-In and authorization.\nLet\u0026rsquo;s get started.\nEDIT: A sample project of this, and Part 2, can be found here or here.\nSetup Google OAuth token First what you need is, to register your application with Google, so you\u0026rsquo;ll get a Token that you can use to authorize later calls to Google services.\nYou can do that here: Google Developer Console. You\u0026rsquo;ll have to create a new project. Once it\u0026rsquo;s done, click on Credentials and create an OAuth token. You should see something like this: \u0026ldquo;To create an OAuth client ID, you must first set a product name on the consent screen.\u0026rdquo;. Go through the questions, like, what type your application is, and once you arrive at stage where it\u0026rsquo;s asking for your application\u0026rsquo;s name \u0026ndash; there is a section asking for redirect URLs; there, write the url you wish to use when authorising your user. If you don\u0026rsquo;t know this yet, don\u0026rsquo;t fret, you can come back and change it later. Do NOT use localhost. If you are running on your own, use http://127.0.0.1:port/whatever.\nThis will get you a client ID and a client secret. I\u0026rsquo;m going to save these into a file which will sit next to my web app. It could be stored more securely, for example, in a database or a mounted secure, encrypted drive, and so and so forth.\nYour application can now be identified through Google services.\nThe Application Libraries Google has a nice library to use with OAuth 2.0. The library is available here: Google OAth 2.0. It\u0026rsquo;s a bit cryptic at first, but not to worry. After a bit of fiddling you\u0026rsquo;ll understand fast what it does. I\u0026rsquo;m also using Gin, and Gin\u0026rsquo;s session handling middleware Gin-Session.\nSetup - Credentials Let\u0026rsquo;s create a setup which configures your credentials from the file you saved earlier. This is pretty straightforward.\n// Credentials which stores google ids. type Credentials struct { Cid string `json:\u0026#34;cid\u0026#34;` Csecret string `json:\u0026#34;csecret\u0026#34;` } func init() { var c Credentials file, err := ioutil.ReadFile(\u0026#34;./creds.json\u0026#34;) if err != nil { fmt.Printf(\u0026#34;File error: %v\\n\u0026#34;, err) os.Exit(1) } json.Unmarshal(file, \u0026amp;c) } Once you have the creds loaded, you can now go on to construct the OAuth client.\nSetup - OAuth client Construct the OAuth config like this:\nconf := \u0026amp;oauth2.Config{ ClientID: c.Cid, ClientSecret: c.Csecret, RedirectURL: \u0026#34;http://localhost:9090/auth\u0026#34;, Scopes: []string{ \u0026#34;https://www.googleapis.com/auth/userinfo.email\u0026#34;, // You have to select your own scope from here -\u0026gt; https://developers.google.com/identity/protocols/googlescopes#google_sign-in }, Endpoint: google.Endpoint, } It will give you a struct which you can then use to Authorize the user in the google domain. Next, all you need to do is call AuthCodeURL on this config. It will give you a URL which redirects to a Google Sign-In form. Once the user fills that out and clicks \u0026lsquo;Allow\u0026rsquo;, you\u0026rsquo;ll get back a TOKEN in the code query parameter and a state which helps protect against CSRF attacks. Always check if the provided state is the same which you provided with AuthCodeURL. This will look something like this http://127.0.0.1:9090/auth?code=4FLKFskdjflf3343d4f\u0026amp;state=lhfu3f983j;asdf. Small function for this:\nfunc getLoginURL(state string) string { // State can be some kind of random generated hash string. // See relevant RFC: http://tools.ietf.org/html/rfc6749#section-10.12 return conf.AuthCodeURL(state) } Construct a button which the user can click and be redirected to the Google Sign-In form. When constructing the url, we must do one more thing. Create a secure state token and save it in the form of a cookie for the current user.\nRandom State and Button construction Small piece of code random token:\nfunc randToken() string { b := make([]byte, 32) rand.Read(b) return base64.StdEncoding.EncodeToString(b) } Storing it in a session and constructing the button:\nfunc loginHandler(c *gin.Context) { state = randToken() session := sessions.Default(c) session.Set(\u0026#34;state\u0026#34;, state) session.Save() c.Writer.Write([]byte(\u0026#34;\u0026lt;html\u0026gt;\u0026lt;title\u0026gt;Golang Google\u0026lt;/title\u0026gt; \u0026lt;body\u0026gt; \u0026lt;a href=\u0026#39;\u0026#34; + getLoginURL() + \u0026#34;\u0026#39;\u0026gt;\u0026lt;button\u0026gt;Login with Google!\u0026lt;/button\u0026gt; \u0026lt;/a\u0026gt; \u0026lt;/body\u0026gt;\u0026lt;/html\u0026gt;\u0026#34;)) } It\u0026rsquo;s not the nicest button I ever come up with, but it will have to do.\nUser Information After you got the token, you can construct an authorised Google HTTP Client, which let\u0026rsquo;s you call Google related services and retrieve information about the user.\nGetting the Client Before we construct a client, we must check if the retrieved state is still the same compared to the one we provided. I\u0026rsquo;m doing this before constructing the client. Together this looks like this:\nfunc authHandler(c *gin.Context) { // Check state validity. session := sessions.Default(c) retrievedState := session.Get(\u0026#34;state\u0026#34;) if retrievedState != c.Query(\u0026#34;state\u0026#34;) { c.AbortWithError(http.StatusUnauthorized, fmt.Errorf(\u0026#34;Invalid session state: %s\u0026#34;, retrievedState)) return } // Handle the exchange code to initiate a transport. tok, err := conf.Exchange(oauth2.NoContext, c.Query(\u0026#34;code\u0026#34;)) if err != nil { c.AbortWithError(http.StatusBadRequest, err) return } // Construct the client. client := conf.Client(oauth2.NoContext, tok) ... Obtaining information Our next step is to retrieve information about the user. To achieve this, call Google\u0026rsquo;s API with the authorised client. The code for that is:\n... resp, err := client.Get(\u0026#34;https://www.googleapis.com/oauth2/v3/userinfo\u0026#34;) if err != nil { c.AbortWithError(http.StatusBadRequest, err) return } defer resp.Body.Close() data, _ := ioutil.ReadAll(resp.Body) log.Println(\u0026#34;Resp body: \u0026#34;, string(data)) ... And this will yield a body like this:\n{ \u0026#34;sub\u0026#34;: \u0026#34;1111111111111111111111\u0026#34;, \u0026#34;name\u0026#34;: \u0026#34;Your Name\u0026#34;, \u0026#34;given_name\u0026#34;: \u0026#34;Your\u0026#34;, \u0026#34;family_name\u0026#34;: \u0026#34;Name\u0026#34;, \u0026#34;profile\u0026#34;: \u0026#34;https://plus.google.com/1111111111111111111111\u0026#34;, \u0026#34;picture\u0026#34;: \u0026#34;https://lh3.googleusercontent.com/asdfadsf/AAAAAAAAAAI/Aasdfads/Xasdfasdfs/photo.jpg\u0026#34;, \u0026#34;email\u0026#34;: \u0026#34;your@gmail.com\u0026#34;, \u0026#34;email_verified\u0026#34;: true, \u0026#34;gender\u0026#34;: \u0026#34;male\u0026#34; } Parse it, and you\u0026rsquo;ve got an email which you can store somewhere for registration purposes. At this point, your user is not yet Authenticated. For that, I\u0026rsquo;m going to post a second post, which describes how to go on. Retrieving the stored email address, and user session handling with Gin and MongoDB.\nPutting it all together package main import ( \u0026#34;crypto/rand\u0026#34; \u0026#34;encoding/base64\u0026#34; \u0026#34;encoding/json\u0026#34; \u0026#34;io/ioutil\u0026#34; \u0026#34;fmt\u0026#34; \u0026#34;log\u0026#34; \u0026#34;os\u0026#34; \u0026#34;net/http\u0026#34; \u0026#34;github.com/gin-gonic/contrib/sessions\u0026#34; \u0026#34;github.com/gin-gonic/gin\u0026#34; \u0026#34;golang.org/x/oauth2\u0026#34; \u0026#34;golang.org/x/oauth2/google\u0026#34; ) // Credentials which stores google ids. type Credentials struct { Cid string `json:\u0026#34;cid\u0026#34;` Csecret string `json:\u0026#34;csecret\u0026#34;` } // User is a retrieved and authentiacted user. type User struct { Sub string `json:\u0026#34;sub\u0026#34;` Name string `json:\u0026#34;name\u0026#34;` GivenName string `json:\u0026#34;given_name\u0026#34;` FamilyName string `json:\u0026#34;family_name\u0026#34;` Profile string `json:\u0026#34;profile\u0026#34;` Picture string `json:\u0026#34;picture\u0026#34;` Email string `json:\u0026#34;email\u0026#34;` EmailVerified string `json:\u0026#34;email_verified\u0026#34;` Gender string `json:\u0026#34;gender\u0026#34;` } var cred Credentials var conf *oauth2.Config var state string var store = sessions.NewCookieStore([]byte(\u0026#34;secret\u0026#34;)) func randToken() string { b := make([]byte, 32) rand.Read(b) return base64.StdEncoding.EncodeToString(b) } func init() { file, err := ioutil.ReadFile(\u0026#34;./creds.json\u0026#34;) if err != nil { log.Printf(\u0026#34;File error: %v\\n\u0026#34;, err) os.Exit(1) } json.Unmarshal(file, \u0026amp;cred) conf = \u0026amp;oauth2.Config{ ClientID: cred.Cid, ClientSecret: cred.Csecret, RedirectURL: \u0026#34;http://127.0.0.1:9090/auth\u0026#34;, Scopes: []string{ \u0026#34;https://www.googleapis.com/auth/userinfo.email\u0026#34;, // You have to select your own scope from here -\u0026gt; https://developers.google.com/identity/protocols/googlescopes#google_sign-in }, Endpoint: google.Endpoint, } } func indexHandler(c *gin.Context) { c.HTML(http.StatusOK, \u0026#34;index.tmpl\u0026#34;, gin.H{}) } func getLoginURL(state string) string { return conf.AuthCodeURL(state) } func authHandler(c *gin.Context) { // Handle the exchange code to initiate a transport. session := sessions.Default(c) retrievedState := session.Get(\u0026#34;state\u0026#34;) if retrievedState != c.Query(\u0026#34;state\u0026#34;) { c.AbortWithError(http.StatusUnauthorized, fmt.Errorf(\u0026#34;Invalid session state: %s\u0026#34;, retrievedState)) return } tok, err := conf.Exchange(oauth2.NoContext, c.Query(\u0026#34;code\u0026#34;)) if err != nil { c.AbortWithError(http.StatusBadRequest, err) return } client := conf.Client(oauth2.NoContext, tok) email, err := client.Get(\u0026#34;https://www.googleapis.com/oauth2/v3/userinfo\u0026#34;) if err != nil { c.AbortWithError(http.StatusBadRequest, err) return } defer email.Body.Close() data, _ := ioutil.ReadAll(email.Body) log.Println(\u0026#34;Email body: \u0026#34;, string(data)) c.Status(http.StatusOK) } func loginHandler(c *gin.Context) { state = randToken() session := sessions.Default(c) session.Set(\u0026#34;state\u0026#34;, state) session.Save() c.Writer.Write([]byte(\u0026#34;\u0026lt;html\u0026gt;\u0026lt;title\u0026gt;Golang Google\u0026lt;/title\u0026gt; \u0026lt;body\u0026gt; \u0026lt;a href=\u0026#39;\u0026#34; + getLoginURL(state) + \u0026#34;\u0026#39;\u0026gt;\u0026lt;button\u0026gt;Login with Google!\u0026lt;/button\u0026gt; \u0026lt;/a\u0026gt; \u0026lt;/body\u0026gt;\u0026lt;/html\u0026gt;\u0026#34;)) } func main() { router := gin.Default() router.Use(sessions.Sessions(\u0026#34;goquestsession\u0026#34;, store)) router.Static(\u0026#34;/css\u0026#34;, \u0026#34;./static/css\u0026#34;) router.Static(\u0026#34;/img\u0026#34;, \u0026#34;./static/img\u0026#34;) router.LoadHTMLGlob(\u0026#34;templates/*\u0026#34;) router.GET(\u0026#34;/\u0026#34;, indexHandler) router.GET(\u0026#34;/login\u0026#34;, loginHandler) router.GET(\u0026#34;/auth\u0026#34;, authHandler) router.Run(\u0026#34;127.0.0.1:9090\u0026#34;) } } This is it folks. I hope this helped. Any comments or advices are welcomed.\nGoogle API Documentation The documentation to this whole process, and MUCH more information can be found here: Google API Docs.\nThanks for reading, Gergely.\n","permalink":"https://skarlso.github.io/2016/06/12/google-signin-with-go/","summary":"\u003cp\u003eHi folks.\u003c/p\u003e\n\u003cp\u003eToday, I would like to write up a step - by - step guide with a sample web app on how to do Google Sign-In and authorization.\u003c/p\u003e","title":"How to do Google sign-in with Go"},{"content":"Hi folks.\nGot an update for the backup script. This time, you\u0026rsquo;ll have the ability to implement your own upload capabilities. I provide a mock implementation for the required functions.\nHere is the script again, now modified and a bit cleaned up. I hope it\u0026rsquo;s helpful.\n#!/bin/bash if [[ -t 1 ]]; then colors=$(tput colors) if [[ $colors ]]; then RED=\u0026#39;\\033[0;31m\u0026#39; LIGHT_GREEN=\u0026#39;\\033[1;32m\u0026#39; NC=\u0026#39;\\033[0m\u0026#39; fi fi if [[ -z ${MINECRAFT_BUCKET} ]]; then printf \u0026#34;Please set the env variable %bMINECRAFT_BUCKET%b to the s3 archive bucket name.\\n\u0026#34; \u0026#34;${RED}\u0026#34; \u0026#34;${NC}\u0026#34; exit 1 fi if [[ -z ${MINECRAFT_ARCHIVE_LIMIT} ]]; then printf \u0026#34;Please set the env variable %bMINECRAFT_ARCHIVE_LIMIT%b to limit the number of archives to keep.\\n\u0026#34; \u0026#34;${RED}\u0026#34; \u0026#34;${NC}\u0026#34; exit 1 fi if [[ -z ${MINECRAFT_WORLD} ]]; then printf \u0026#34;Please set the env variable %bMINECRAFT_WORLD%b to specify what world to back-up.\\n\u0026#34; \u0026#34;${RED}\u0026#34; \u0026#34;${NC}\u0026#34; exit 1 fi backup_world=${MINECRAFT_WORLD} backup_bucket=${MINECRAFT_BUCKET} backup_limit=${MINECRAFT_ARCHIVE_LIMIT} archive_name=\u0026#34;${backup_world}-$(date +\u0026#34;%H-%M-%S-%m-%d-%Y\u0026#34;).zip\u0026#34; function create_archive { printf \u0026#34;Creating archive of %b${backup_world}%b\\n\u0026#34; \u0026#34;${RED}\u0026#34; \u0026#34;${NC}\u0026#34; zip -r $archive_name $backup_world } function amazon_bak { create_archive printf \u0026#34;Checking if bucket has more than %b${backup_limit}%b files already.\\n\u0026#34; \u0026#34;${RED}\u0026#34; \u0026#34;${NC}\u0026#34; content=( $(aws s3 ls s3://$backup_bucket | awk \u0026#39;{print $4}\u0026#39;) ) if [[ ${#content[@]} -eq $backup_limit || ${#content[@]} -gt $backup_limit ]]; then echo \u0026#34;There are too many archives. Deleting oldest one.\u0026#34; # We can assume here that the list is in cronological order printf \u0026#34;%bs3://${backup_bucket}/${content[0]}\\n%b\u0026#34; \u0026#34;${RED}\u0026#34; \u0026#34;${NC}\u0026#34; aws s3 rm s3://$backup_bucket/${content[0]} fi printf \u0026#34;Uploading %b${archive_name}%b to s3 archive bucket.\\n\u0026#34; \u0026#34;${RED}\u0026#34; \u0026#34;${NC}\u0026#34; state=$(aws s3 cp $archive_name s3://$backup_bucket) if [[ \u0026#34;$state\u0026#34; =~ \u0026#34;upload:\u0026#34; ]]; then printf \u0026#34;File upload %bsuccessful%b.\\n\u0026#34; \u0026#34;${LIGHT_GREEN}\u0026#34; \u0026#34;${NC}\u0026#34; else printf \u0026#34;%bError%b occured while uploading archive. Please investigate.\\n\u0026#34; \u0026#34;${RED}\u0026#34; \u0026#34;${NC}\u0026#34; fi } function custom { if [[ -e custom.sh ]]; then source ./custom.sh else echo \u0026#34;custom.sh script not found. Please implement the apropriate functions.\u0026#34; exit 1 fi echo \u0026#34;Checking for the number of files. Limit is: $backup_limit.\u0026#34; files=( $(list) ) if [[ ${#files[@]} -eq $backup_limit || ${#files[@]} -gt $backup_limit ]]; then echo \u0026#34;Deleting extra file.\u0026#34; delete ${files[0]} if [[ $? != 0 ]]; then printf \u0026#34;%bFailed%b to delete file. Please investigate failure.\u0026#34; \u0026#34;${RED}\u0026#34; \u0026#34;${NC}\u0026#34; exit $? fi fi echo \u0026#34;Zipping world.\u0026#34; create_archive echo \u0026#34;Uploading world.\u0026#34; upload $archive_name if [[ $? != 0 ]]; then printf \u0026#34;%bFailed%b to upload archive. Please investigate the error.\u0026#34; \u0026#34;${RED}\u0026#34; \u0026#34;${NC}\u0026#34; exit $? fi printf \u0026#34;Upload %bsuccessful%b\u0026#34; \u0026#34;${LIGHT_GREEN}\u0026#34; \u0026#34;${NC}\u0026#34; } function help { echo \u0026#34;Usage:\u0026#34; echo \u0026#34;./backup_world [METHOD]\u0026#34; echo \u0026#34;Exp.: ./backup_world aws|./backup_world custom|./backup_world dropbox\u0026#34; echo \u0026#34;Each method has it\u0026#39;s own environment properties that it requires.\u0026#34; echo \u0026#34;Global: MINECRAFT_WORLD|MINECRAFT_BUCKET|MINECRAFT_ARCHIVE_LIMIT\u0026#34; echo \u0026#34;Custom: Have a file, called \u0026#39;custom.sh\u0026#39; which is sourced.\u0026#34; echo \u0026#34;Implement these three functions: upload | list | delete.\u0026#34; echo \u0026#34;upload -\u0026gt; should return exit code 0 on success, should return exit code 1 on failure.\u0026#34; echo \u0026#34;list -\u0026gt; should return a list of cronologically ordered items.\u0026#34; echo \u0026#34;delete -\u0026gt; should return exit code 0 on success, should return exit code 1 on failure.\u0026#34; } case $1 in aws ) amazon_bak ;; custom ) custom ;; * ) help ;; esac And here is the sample implementation for the custom upload functionality.\n#!/bin/bash function upload { echo \u0026#34;uploading\u0026#34; local result=0 return $result } function delete { echo \u0026#34;deleting $1\u0026#34; local result=0 return $result } function list { local arr=(\u0026#34;file1\u0026#34; \u0026#34;file2\u0026#34; \u0026#34;file3\u0026#34;) echo \u0026#34;${arr[@]}\u0026#34; } Thanks for reading!\nGergely.\n","permalink":"https://skarlso.github.io/2016/04/17/minecraft-server-aws-s3-backup-part2/","summary":"\u003cp\u003eHi folks.\u003c/p\u003e\n\u003cp\u003eGot an update for the backup script. This time, you\u0026rsquo;ll have the ability to implement your own upload capabilities. I provide a mock implementation for the required functions.\u003c/p\u003e\n\u003cp\u003eHere is the script again, now modified and a bit cleaned up. I hope it\u0026rsquo;s helpful.\u003c/p\u003e","title":"Minecraft world automatic backup to AWS S3 bucket - Part 2 (Custom functions)"},{"content":"Hi Folks.\nPreviously we created a Minecraft server using Docker. After my server got popular in the family, and a lot of stuff started to pile up on it, as a good IT person, I\u0026rsquo;m backing up the world once in a while.\nFor that, I\u0026rsquo;m using AWS S3 with the CLI and a little bash script which runs once a week.\nThe script is really straightforward. I\u0026rsquo;m doing manual versioning, although S3 does provide one out of the box. However, amazon\u0026rsquo;s S3 versioning doesn\u0026rsquo;t allow limiting the number of versions being kept. And since I\u0026rsquo;m doing that anyways, might as well take care of the rest.\nWithout further ado, here is the script:\n#!/bin/bash if [[ -t 1 ]]; then colors=$(tput colors) if [[ $colors ]]; then RED=\u0026#39;\\033[0;31m\u0026#39; LIGHT_GREEN=\u0026#39;\\033[1;32m\u0026#39; NC=\u0026#39;\\033[0m\u0026#39; fi fi if [[ -z ${MINECRAFT_BUCKET} ]]; then printf \u0026#34;Please set the env variable ${RED}MINECRAFT_BUCKET${NC} to the s3 archive bucket name.\\n\u0026#34; exit 0 fi if [[ -z ${MINECRAFT_ARCHIVE_LIMIT} ]]; then printf \u0026#34;Please set the env variable ${RED}MINECRAFT_ARCHIVE_LIMIT${NC} to limit the number of archives to keep.\\n\u0026#34; exit 0 fi backup_bucket=${MINECRAFT_BUCKET} backup_limit=${MINECRAFT_ARCHIVE_LIMIT} world=$1 printf \u0026#34;Creating archive of ${RED}${world}${NC}\\n\u0026#34; archive_name=\u0026#34;${world}-$(date +\u0026#34;%H-%M-%S-%m-%d-%Y\u0026#34;).zip\u0026#34; zip -r $archive_name $world printf \u0026#34;Checking if bucket has more than ${RED}${backup_limit}${NC} files already.\\n\u0026#34; content=( $(aws s3 ls s3://$backup_bucket | awk \u0026#39;{print $4}\u0026#39;) ) if [[ ${#content[@]} -eq $backup_limit || ${#content[@]} -gt $backup_limit ]]; then echo \u0026#34;There are too many archives. Deleting oldest one.\u0026#34; # We can assume here that the list is in cronological order printf \u0026#34;${RED}s3://${backup_bucket}/${content[0]}\\n\u0026#34; aws s3 rm s3://$backup_bucket/${content[0]} fi printf \u0026#34;Uploading ${RED}${archive_name}${NC} to s3 archive bucket.\\n\u0026#34; state=$(aws s3 cp $archive_name s3://$backup_bucket) if [[ \u0026#34;$state\u0026#34; =~ \u0026#34;upload:\u0026#34; ]]; then printf \u0026#34;File upload ${LIGHT_GREEN}successful${NC}.\\n\u0026#34; else printf \u0026#34;${RED}Error${NC} occured while uploading archive. Please investigate.\\n\u0026#34; fi It uses environment properties to define where to upload the given world and how many versions to keep.\nI\u0026rsquo;m calling this from a cron job, and it\u0026rsquo;s sitting next to where the Minecraft world is.\nThat\u0026rsquo;s it folks.\nI\u0026rsquo;ll start expanding on this idea and implement various services, like your own server address, or dropbox, or what have you.\nHappy backing up.\nGergely.\n","permalink":"https://skarlso.github.io/2016/04/16/minecraft-server-aws-s3-backup/","summary":"Hi Folks.\nPreviously we created a Minecraft server using Docker. After my server got popular in the family, and a lot of stuff started to pile up on it, as a good IT person, I\u0026rsquo;m backing up the world once in a while.\nFor that, I\u0026rsquo;m using AWS S3 with the CLI and a little bash script which runs once a week.\nThe script is really straightforward. I\u0026rsquo;m doing manual versioning, although S3 does provide one out of the box.","title":"Minecraft world automatic backup to AWS S3 bucket"},{"content":"Hi Folks.\nIntro Today, I wanted to write about how to create a secure server in a container. Ideally, you don\u0026rsquo;t want to run your server on your own machine. Running it in a container gives you a much needed control and an extra layer of security.\nDocker On OSX While on a mac, you have a couple of options to run docker.\nDocker-Machine Docker-Machine\nDocker machine is very simple. It just creates a Linux vm in the background on the given driver, for us it will be VirtualBox. Network, Memory and port-forwarding can all be managed through the VM directly. Then running and starting it is trivial through docker-machine start.\nBoot2Docker Boot2Docker\nRuns a tiny linux in which you can use Docker freely. This adds the benefit of not having to mess around with VirtualBox.\nDLite DLite\nDLite is the newest addition in the Game. Since docker uses /var/run/docker.sock file to communicate with the daemon, and this file is not there on OSX, DLite takes care of that. After DLite is running, you just simply use Docker. That\u0026rsquo;s it. No VM, no fuss, just use Docker.\nI recommend to use DLite, however, it\u0026rsquo;s not an official tool, so for the sake of this guide, I\u0026rsquo;ll be writing up a docker-machine oriented solution.\nDocker container - A Vanilla Server First, you\u0026rsquo;ll need a Dockerfile. Dockerfile. The steps on how to setup this file are written down in the README file, located here: Container Setup. The pwd command will use your current directory as a shared volume to copy stuff into the container from your host operating system.\nThis will download the Minecraft server version 1.9 (or whichever you define) and install java and vim. It uses /data as a shared folder. Data will also be the working directory which means we will run the server from there. This server will be a vanilla server, meaning, no modding. If you have a single player world which you would like to use, simply copy that to /data and rename it to world.\nThe tricky part is to make this available on the internet. Because the container is in a VM we need to do a chain forwarding. Forward from the container to the vm, and from the vm to your host machine. If you are using a dns service like dyna or no-ip, you probably have a software which refreshes an IP for you to link to. And you\u0026rsquo;ll also have port forwarding setup on your router. I won\u0026rsquo;t be going into detail on that part. That\u0026rsquo;s a whole different post.\nForwarding from virtualbox can be done through the UI or through command line. The UI is like this: Settings =\u0026gt; Network =\u0026gt; Adapter 1 =\u0026gt; Advanced =\u0026gt; PortForwarding. Here, setup something like this: Name: Minecraft; Protocol: TCP; Host IP: 192.168.0.X(x=your local machine); Host Port: 25565; Guest IP: Leave Blank; Guest Port: 25565.\nWhere the number is missing, you\u0026rsquo;ll have to define your own local IP which you are using for your domain address.\nThis should forward any ports coming from your VM to your local IP. In the container we have an expose and as the README states it\u0026rsquo;s started using -p 25565:25565 which will make sure that from the container, 25565 is exposed to the VM. And from the VM 25565 is exposed to your local. Chain forwarding.\nAfter that, once you start your server, it should all click together and you should have a running vanilla Minecraft server available under http://yourdomain:25565. You won\u0026rsquo;t be able to check this by default on your own network. Check if the port is open with a different service like: Check If Port is Open.\nDocker container - Modding If you are not looking for anything, just a simple server, the above will be enough. You can still do /tp 1 1 1 to teleport, or can still use bans and op commands, and distribute items. However, if you would like to use mods, and as far as kids are concerned, they will want it, you\u0026rsquo;ll have to be a bit more clever.\nI dug far and deep and found that you have two options. Either go with a Forge server, or a Bukkit server. What does that mean? The vanilla server of Minecraft does not support modding. Modding, is modifying the implementation of Minecraft. It injects code and runs a pre-server in front of the original Minecraft server in order to append functionality. But fret not, this is all taken care of for you by either solutions.\nIn order to jump into our container with the CMD omitted, we\u0026rsquo;ll have to run the following command instead of the one in the README.\ndocker run -it -v `pwd`:/data -p 25565:25565 --name mc_server minecraft:v1.9 bash This will give you an interactive prompt in which now we can operate.\nForge Download the latest forge version from here =\u0026gt; Minecraft Forge. They are usually up-to-date. I\u0026rsquo;m using 1.9 so I downloaded the appropriate installer version. After I obtained it, it was a matter of running this piece of command line code from my container:\njava -jar forge-1.9-12.16.0.1813-1.9-installer.jar --extract --installServer This will unpack a bunch of things you don\u0026rsquo;t have to worry about in your current directory, which is /data. Now run the universal.\njava -jar forge-1.9-12.16.0.1813-1.9-universal.jar Everything under the mods folder will be loaded as a mod. Forge is very restrictive and can only use Forge based mods. It will usually warn you if you have a none forge mod in your mods folder. You can find these on Forge\u0026rsquo;s forum here: Forge Forum. Simply download a jar and put it into /data/mods.\nBukkit I found Bukkit to be the winner for me. Most of the mods the kid wanted worked with Bukkit and did not work with Forge. Others will swear on Forge, but it\u0026rsquo;s really up to you. Using Bukkit is similarly easy. Again, you\u0026rsquo;ll have to find and get the wrapper for your Minecraft version, which can be located here: GetSpigot. You can use Spigot as well, though I have no experience with that.\nOnce, you got the wrapper, which is called craftbukkit-1.9.jar for me, you run it the same way you would run Forge or Minecraft.\njava -jar craftbukkit-1.9.jar This will load mods from the plugins folder. Plugins can be found here: Latest Bukkit Plugins.\nIn the container, you can use wget or curl to get the mods, or simply use the shared volume which is setup for you.\nLast Words All in all this sounds complicated, but it\u0026rsquo;s actually not, once you\u0026rsquo;ll get the hang out of it. You never kill the container once it\u0026rsquo;s setup, you just do docker stop mc_server and then docker-machine stop if you want to stop the VM as well. To start it up simply do these steps:\ndocker_machine start eval $(docker-machine env) docker start mc_server We named the container mc_server on a previous step. If you named it something different, use that name.\nThat\u0026rsquo;s it. Hope this was clear. Any feedback is appreciated. If you think you have an easier way, or if I wrote something incorrectly, feel free to tell me in the comment sections below.\nThanks for reading.\nGergely.\n","permalink":"https://skarlso.github.io/2016/03/29/minecraft-server-with-docker-and-osx/","summary":"Hi Folks.\nIntro Today, I wanted to write about how to create a secure server in a container. Ideally, you don\u0026rsquo;t want to run your server on your own machine. Running it in a container gives you a much needed control and an extra layer of security.\nDocker On OSX While on a mac, you have a couple of options to run docker.\nDocker-Machine Docker-Machine\nDocker machine is very simple. It just creates a Linux vm in the background on the given driver, for us it will be VirtualBox.","title":"Minecraft Server with Docker on OSX + Mods"},{"content":"Hi Folks.\nSo Wercker was not working. After a minor modification it seems to be okay now. The config file needed for it to work looks like this:\nbox: golang build: steps: - arjen/hugo-build: theme: redlounge deploy: steps: - install-packages: packages: git - leipert/git-push: gh_oauth: $GIT_TOKEN repo: skarlso/skarlso.github.io branch: master basedir: public The modification is the box type to golang and removed ssh-client from packages.\nThanks, Gergely.\n","permalink":"https://skarlso.github.io/2016/03/09/wercker-fixed/","summary":"Hi Folks.\nSo Wercker was not working. After a minor modification it seems to be okay now. The config file needed for it to work looks like this:\nbox: golang build: steps: - arjen/hugo-build: theme: redlounge deploy: steps: - install-packages: packages: git - leipert/git-push: gh_oauth: $GIT_TOKEN repo: skarlso/skarlso.github.io branch: master basedir: public The modification is the box type to golang and removed ssh-client from packages.\nThanks, Gergely.","title":"Wercker Fixed"},{"content":"Basics This is a wercker Test.\n","permalink":"https://skarlso.github.io/2016/03/04/wercker-test-2/","summary":"Basics This is a wercker Test.","title":"Wercker Test"},{"content":"There already is a nice tutorial on how to create github-pages with Hugo Here if you prefer deplying your pages to a different branch on the same repo. There is also a post about Wercker and Hugo Here deploying pages to said separate branch.\nHowever, I took an easier approach on the matter with a completely separate branch for my blog source and my compiled github pages.\nThis blog sits here: https://github.com/Skarlso/skarlso.github.io. In order to deploy to it, I just have to commit a new blog post to this repository: Blog Source. After that, Wercker takes care of the rest. It builds my blog, and pushes the generated pages to my blog\u0026rsquo;s repository to the master branch without creating the gh-pages branch.\nThe Wercker yml for that looks like this:\nbox: debian build: steps: - arjen/hugo-build: theme: redlounge deploy: steps: - install-packages: packages: git ssh-client - leipert/git-push: gh_oauth: $GIT_TOKEN repo: skarlso/skarlso.github.io branch: master basedir: public Pretty easy. The $GIT_TOKEN is a variable set-up on Wercker containing a restricted token which is only good for pushing. And note that you have to use an explicit package name with git-push or else Wercker will not find that step. Hugo-build will build my blog with a simple command using redlounge theme.\nAnd that\u0026rsquo;s it. No other setup is necessary and no new branch will be made. Any questions, please feel free to leave a comment.\nThanks for reading!\nGergely.\n","permalink":"https://skarlso.github.io/2016/02/10/hugo-autodeploy-with-wercker/","summary":"There already is a nice tutorial on how to create github-pages with Hugo Here if you prefer deplying your pages to a different branch on the same repo. There is also a post about Wercker and Hugo Here deploying pages to said separate branch.\nHowever, I took an easier approach on the matter with a completely separate branch for my blog source and my compiled github pages.\nThis blog sits here: https://github.","title":"Hugo Autodeploy with Wercker and Github - Pages"},{"content":"Basics This is a wercker Test.\n","permalink":"https://skarlso.github.io/2016/02/10/wercker-test/","summary":"Basics This is a wercker Test.","title":"Wercker Test"},{"content":"Basics Hello folks.\nThis will be a quick post about how to do CORS with jQuery, Gin in Go with a very simple ajax GET and Json.\nI\u0026rsquo;m choosing JSON here because basically I don\u0026rsquo;t really like JSONP. And actually, it\u0026rsquo;s not very complicated to do CORS, it\u0026rsquo;s just hidden enough so that it doesn\u0026rsquo;t become transparent.\nFirst, what is CORS? It\u0026rsquo;s Cross-Platform Resource Sharing. It has been invented so that without your explicit authorization in the header of a request, Javascript can\u0026rsquo;t reach outside of your domain and be potentially harmful to your visitors.\nNow, suppose you have an architecture like this.\nYou have multiple agents sitting on multiple nodes. You have one central server, and you have multiple front-ends. Everybody can only talk to the Server but the server does talk to everyone. You would like to have a dynamic front-end and would like to display data with ajax calls. Since your front-end sits on a different server, you will have to do something about CORS. This is how I solved it\u0026hellip;\nI\u0026rsquo;m using Gin for my REST service for Dockmaster. For this two work, you need to adjust two component.\nServer There is thing called a Preflight-Check. In essence, the preflight check is sent BEFORE the actual request to check if the next request is allowed to go out of the domain. The preflight check is sent to the same URI just with OPTIONS method. In order to tell the caller that the next one will be safe, you need three things.\nFirst, you need to set two Headers. #1 -\u0026gt; Access-Control-Allow-Origin to \u0026ldquo;*\u0026rdquo;. #2 -\u0026gt; Access-Control-Allow-Headers to \u0026ldquo;access-control-allow-origin, access-control-allow-headers\u0026rdquo;.\nThese are the minimum headers you can set. If you allow Access-Control-Allow-Origin you also have to allow it in the headers section because the next request will expect it to be there. Also, note here that setting Origin to * is only recommended in development environment. Otherwise it should be set to whatever your domain is.\nSecond, you need to respond to the OPTIONS method with a 200. In order to do that, I added a simple rule with the same end-point but with OPTIONS.\nfunc main() { router := gin.Default() v1 := router.Group(APIBASE) { v1.GET(\u0026#34;/list\u0026#34;, listContainers) v1.POST(\u0026#34;/add\u0026#34;, addContainers) v1.POST(\u0026#34;/delete\u0026#34;, deleteContainers) v1.GET(\u0026#34;/inspect/:agentID/:containerID\u0026#34;, inspectContainer) v1.OPTIONS(\u0026#34;/inspect/:agentID/:containerID\u0026#34;, preflight) v1.POST(\u0026#34;/stopAll\u0026#34;, stopAll) v1.OPTIONS(\u0026#34;/stopAll\u0026#34;, preflight) } router.Run(\u0026#34;:8989\u0026#34;) } func preflight(c *gin.Context) { c.Header(\u0026#34;Access-Control-Allow-Origin\u0026#34;, \u0026#34;*\u0026#34;) c.Header(\u0026#34;Access-Control-Allow-Headers\u0026#34;, \u0026#34;access-control-allow-origin, access-control-allow-headers\u0026#34;) c.JSON(http.StatusOK, struct{}{}) } You can see that the preflight method is there for two end-points. I added it to those end-points which will reach over the domain. The others are all local, thus they don\u0026rsquo;t need that. This leads to a little duplication, but that is fine. I have a very fine control over what actually is allowed to go outside of the domain.\nSo, how do we call this?\nFrontend In the front-end\u0026rsquo;s web layout, I\u0026rsquo;m doing an Ajax GET, which looks like this:\n$.ajax({ url: \u0026#39;http://localhost:8989/api/1/inspect/\u0026#39;+data.agentid+\u0026#39;/\u0026#39;+data.id, type: \u0026#39;GET\u0026#39;, dataType:\u0026#34;json\u0026#34;, headers: {\u0026#34;Access-Control-Allow-Origin\u0026#34;: \u0026#34;*\u0026#34;, \u0026#34;Access-Control-Allow-Headers\u0026#34;: \u0026#34;access-control-allow-origin, access-control-allow-headers\u0026#34;}, processData: false, success: function(data) { var json = JSON.stringify(data, null, 4) independentPopup.html(\u0026#34;\u0026lt;pre \u0026gt;\u0026#34;+json+\u0026#34;\u0026lt;/pre\u0026gt;\u0026#34;); $(link).after(independentPopup); } }); After the headers are set, the request will work nicely.\nY U No Middleware? And now you could say that, why not just have a middleware which will always accept OPTIONS for every end-point. Because I like it better this way. Some would argue that this is too granular, but fact is, that in my opinion, this is more readable and immediatly visible. However, if you DO want to do that, you have several options to your disposal.\nCors Basic Http Middleware and for Gin Gin CORS Middleware.\nSummary This is it. You can see the code in its entirety on Github. Have a better idea on how to do it? Please! Do not hesitate to share. I always like to learn.\nThank you for reading!\nAnd as always, Have a nice day!\nGergely.\n","permalink":"https://skarlso.github.io/2016/02/02/doing-cors-in-go-with-gin-and-json/","summary":"Basics Hello folks.\nThis will be a quick post about how to do CORS with jQuery, Gin in Go with a very simple ajax GET and Json.\nI\u0026rsquo;m choosing JSON here because basically I don\u0026rsquo;t really like JSONP. And actually, it\u0026rsquo;s not very complicated to do CORS, it\u0026rsquo;s just hidden enough so that it doesn\u0026rsquo;t become transparent.\nFirst, what is CORS? It\u0026rsquo;s Cross-Platform Resource Sharing. It has been invented so that without your explicit authorization in the header of a request, Javascript can\u0026rsquo;t reach outside of your domain and be potentially harmful to your visitors.","title":"Doing CORS in Go with Gin and JSON"},{"content":"Hello folks.\nI wanted to share with you my tale of working through the problems with Advent Of Code.\nIt is a nice tale and there are a few things I learned from it, especially in Go, since I used that solve all of the problems. So, let\u0026rsquo;s get started.\nSolving the problems The most important lesson I learned while doing these exercises was, how to solve these problems. A couple of them were simple enough to not have to over think it, but most of them got very tricky. I could have gone with a brute force attempt, but as we see later, that wasn\u0026rsquo;t always a very good solution. And people who used that, actually just got lucky finding their solutions.\nThe eight stages of breaking down a problem according to this book Thinking Like a Programmer are the following:\nHave a plan Rephrase Divide Start with what you know Reduce Analogies Experiment Don\u0026rsquo;t get frustrated Have a plan and understanding your goal This is simple. Always have a plan of what you would like to do, and how to start. This will help you massively along the way to not to loose sight of what your goal is actually. For example, look at Day 24. At first, it looks like a permutational puzzle, but if you understand the solution we are looking for, you realize that there is an easier way of finding it. Since you only want the packages which consists of the fewest item counts, you would only care about the largest numbers because those will be the fewest which still give you the desired package weight. Suddenly the problem gets easier because you don\u0026rsquo;t have to worry about the other groups any longer.\nRephrase Rephrasing the problem with your own words can help in understanding it better. Or even better, try explaining it to somebody else. If you cannot rephrase it, you didn\u0026rsquo;t understand it in the first place.\nDivide If the problem seems daunting because it\u0026rsquo;s massive, just divide it into smaller chunks. This is something that we usually do with large problems, but it\u0026rsquo;s more subtle than that. If you face a problem which seems complex, just factor out parts of it until you got a problem which you do understand. Even if you have to butcher the original puzzle problem. It doesn\u0026rsquo;t matter. Adding complexity later is easier than adding complexity in its infancy.\nStart with what you know \u0026amp;\u0026amp; Finding analogies This one speaks for itself. If you know parts of the problem, because you know analogy for it, or you faced something similar before, or exactly that, start with that.\nReduce If the problem seems too complex, remove complexity. Start with a smaller set. Preferably something testable (I\u0026rsquo;ll come back to that later). Remove constraints, or add them as desired. A constraint makes it harder to solve the puzzle? Remove it, and try solving it without. After that, the solution will give you insight into the problem and you can add that constraint back in.\nConsider Day 11. I had fun with this one. In order to easy it up a little, I first, removed the constraint of doing the increment with letters. I did it with numbers. I also removed the constraint of doing it within the confines of a limited length array. After I got that I\u0026rsquo;ll use modulo to make the numbers wrap around, it was way more easy to apply it to characters. And after a little fidgeting this came to life:\npasswd[i] -= \u0026#39;a\u0026#39; passwd[i] = (passwd[i] + 1) % ((\u0026#39;z\u0026#39; - \u0026#39;a\u0026#39;) + 1) passwd[i] += \u0026#39;a\u0026#39; The -,+ \u0026lsquo;a\u0026rsquo; is needed so that it\u0026rsquo;s dealing with ascii code from 0 - \u0026lsquo;z\u0026rsquo;. This basically makes it so that when I reach the end of the alphabet it will wrap around and start from \u0026lsquo;a\u0026rsquo; again.\nExperiment This led to more solutions than I care to admit. Basically just start experimenting with solutions which are in your head. There is a chance, that what you come up with, will be the solution. This goes very well with the principle of Make it work, Make it right, Make it fast. Just have something working first, and than you can make it work properly after. It\u0026rsquo;s always better to have something rather than nothing.\nAnd last but not least\u0026hellip;\nDon\u0026rsquo;t get frustrated This is something I cannot say strongly enough. Seriously. DO NOT GET FRUSTRATED. Most of the problems were designed to be harder. Unless you work as a programmer professionally for several years now, or this is a field of interest for you, you will spend a day hacking around on a problem and trying to find a solution which is adequate. In these times, you will get frustrated and think you are too stupid for this, this couldn\u0026rsquo;t be more far from the truth! You might need some inspiration, you might need some time away from the screen, it helps if you draw out the problem in a piece of paper, or just think about it without seeing it for a while. Just take a break, eat something, watch a comedy and get back to it later with a fresh view.\nTechnical Gotchas So after the general problem solving side of things, I learned many things about Go, and about the tidbits of this language.\nByte Slices I already knew that []byte is more performant and that Go optimizes on them more, but not to this extent. As in my previous blog posts I discovered that using them can really make a huge difference. Go even has a library called bytes which has helper functions similar to that of strings to help you out in these situations. Go optimizes on map recalls as well when you cast to string from []byte and use that as a map key like this: myMap[string(data)].\nBrute Force or Looping Most of the times you could get away with looping or trying to brute force out a solution. But there were times, where you really had to huddle down and think the problem through. Because simply looping, either took too long, or didn\u0026rsquo;t come up with a good answer. That\u0026rsquo;s why I rather always start with: \u0026lsquo;How could I solve this without looping?\u0026rsquo;. This will get you into the right mindset. Or thinking: \u0026lsquo;How could I solve this without taking each and every combination into account?\u0026rsquo;. These questions will help you to think about the problem without loops. Or only if you REALLY must use one.\nDoing this will get you into the right way of thinking. I know that in advent of code there is a Leaderboard and you could get on it if you were fast. But most of the times having a fast solution is far from having the right solution.\nStructs are Awesome I like using structs. They are a very lightweight way of defining objects, structures which stick together. For example in the Day 6 Light puzzle, or even Day 3 Traveling santa example, a struct which stuck x,y locations together and made it a map key, it was trivial to make my gif out of it with SVG -\u0026gt;\nGo is Simple to Read [opinion] I like Go because of its simplicity. You don\u0026rsquo;t see stuff in Go most of the times, where you need to look three times to understand what the heck is going on. I like filter, reduce, map and syntactic sugar, but they make for a very poor reading experience. Go, in that way, choose not to incorporate these paradigms and I find that refreshing. [/opinion]\nTesting TDD is something we all should know by now and care about. When I\u0026rsquo;m doing puzzles, or finger exercises, I tend to not write tests. But on a more complex puzzle, or a task, I always start with a test. Especially if you are given samples for a puzzle which work. That\u0026rsquo;s a gold mine. You can tweak your algorithm using those samples until they work and then simply apply a larger sample size.\nTests will also help you with breaking down a problem and identifying parts which you already know.\nFor example Day 13. Optimal Seating arrangements. Or the similar Day 9. Which was calculating shortest route distance. Or the password one, Day 11 which I showed before. In these cases, tests helped me make the core of the algorithm solid. Calculating connections, or the odd regex here and there, which was making sure that the password was validated properly.\nTests will also help you to be able to move on after you found your solution. When I was done with the first iteration of passwords which was still using strings, I went on to optimize it, to use []byte. The tests helped me to know that the code was still working as expected after the refactoring.\nClosing words All in all it was a massive amount of fun doing these exercises and I\u0026rsquo;m thankful to the creator for making it. And I did enjoy the story behind the exercises as well. I think this site stood out because it had a fun factor. For simple exercises there are a lot of other sites -like Project Euler, or Sphere Judge Online-, which just plainly present you a problem and that\u0026rsquo;s it. It\u0026rsquo;s still fun, but it can also became boring very fast. Don\u0026rsquo;t forget the fun factor which makes you plow on and go into a blind frenzy that you cannot quit until it\u0026rsquo;s done. That\u0026rsquo;s the fun part.\nThank you for reading! Have a nice day. Gergely.\n","permalink":"https://skarlso.github.io/2016/01/22/my-journey-in-advent-of-code/","summary":"Hello folks.\nI wanted to share with you my tale of working through the problems with Advent Of Code.\nIt is a nice tale and there are a few things I learned from it, especially in Go, since I used that solve all of the problems. So, let\u0026rsquo;s get started.\nSolving the problems The most important lesson I learned while doing these exercises was, how to solve these problems. A couple of them were simple enough to not have to over think it, but most of them got very tricky.","title":"My Journey in advent of code"},{"content":"Hello Folks.\nToday I would like to share with you my little tale of refactoring my solution to Advent Of Code Day 13.\nIt\u0026rsquo;s a lovely tale of action, adventure, drama, and comedy.\nLet\u0026rsquo;s being with my first iteration of the problem.\npackage main import ( \u0026#34;bufio\u0026#34; \u0026#34;fmt\u0026#34; \u0026#34;math\u0026#34; \u0026#34;os\u0026#34; \u0026#34;strconv\u0026#34; \u0026#34;strings\u0026#34; \u0026#34;github.com/skarlso/goutils/arrayutils\u0026#34; ) var seatingCombinations = make([][]string, 0) var table = make(map[string][]map[string]int) var keys = make([]string, 0) //Person a person type Person struct { // neighbour *Person name string like int } func main() { file, _ := os.Open(\u0026#34;input.txt\u0026#34;) defer file.Close() scanner := bufio.NewScanner(file) for scanner.Scan() { line := scanner.Text() split := strings.Split(line, \u0026#34; \u0026#34;) like, _ := strconv.Atoi(split[3]) //If lose -\u0026gt; * -1 if split[2] == \u0026#34;lose\u0026#34; { like *= -1 } table[split[0]] = append(table[split[0]], map[string]int{strings.Trim(split[10], \u0026#34;.\u0026#34;): like}) if !arrayutils.ContainsString(keys, split[0]) { keys = append(keys, split[0]) } } generatePermutation(keys, len(keys)) fmt.Println(\u0026#34;Best seating efficiency:\u0026#34;, calculateSeatingEfficiancy()) } func generatePermutation(s []string, n int) { if n == 1 { news := make([]string, len(s)) copy(news, s) seatingCombinations = append(seatingCombinations, news) } for i := 0; i \u0026lt; n; i++ { s[i], s[n-1] = s[n-1], s[i] generatePermutation(s, n-1) s[i], s[n-1] = s[n-1], s[i] } } func calculateSeatingEfficiancy() int { bestSeating := math.MinInt64 for _, v := range seatingCombinations { calculatedOrder := 0 for i := range v { left := (i - 1) % len(v) //This is to work around the fact that in Go //modulo of a negative number will not return a positive number. //So -1 % 4 will not return 3 but -1. In that case we add length. if left \u0026lt; 0 { left += len(v) } right := (i + 1) % len(v) // fmt.Printf(\u0026#34;Left: %d; Right: %d\\n\u0026#34;, left, right) leftLike := getLikeForTargetConnect(v[i], v[left]) rightLike := getLikeForTargetConnect(v[i], v[right]) // fmt.Printf(\u0026#34;Name: %s; Left:%d; Right:%d\\n\u0026#34;, v[i], leftLike, rightLike) calculatedOrder += leftLike + rightLike } // fmt.Printf(\u0026#34;Order for: %v; Calc:%d\\n\u0026#34;, v, calculatedOrder) if calculatedOrder \u0026gt; bestSeating { bestSeating = calculatedOrder } } return bestSeating } func getLikeForTargetConnect(name string, neighbour string) int { neighbours := table[name] for _, t := range neighbours { if v, ok := t[neighbour]; ok { return v } } return 0 } This is quiet large. And takes a bit of explaining. So what is happening here? We are putting the names which correspond with numbers and neighbours into a map which has a map as a value. The map contains seating information for a person. For example, next to Alice, a bunch of people can sit, and they have a certain relationship to Alice, represented by a number.\nWe could, at this point, represent it with a graph, but that would be overkill.\nPermutation is simple because I choose to represent a Table with a Circular Slice. This means that a slice like this =\u0026gt; Alice, Bob, Tom; means that Alice is sitting next to Bob and Tom. So Alice\u0026rsquo;s neighbour of -1 (left) is in fact i-1 % 3. And Bob is i + 1. For Tom, Alice is i + 1 % 3. After we got this, we just permutate the possible combinations into slices of slices and iterate over them.\nThe benchmark for this is terrible.\n================With Strings================ 20\t589571259 ns/op ok github.com/skarlso/goprojects/advent/day13/part1\t11.873s So, my first thought was, convert everything I can to []byte. But because slices cannot be map keys, because map keys need to be comparable, we are still stuck with the same ns/ops.\n//var seatingCombinations = make([][]string, 0) //var keys = make([]string, 0) var seatingCombinations = make([][][]byte, 0) var keys = make([][]byte, 0) And I adjusted the code to work with []byte instead. What can we do to fix the map though? One obvious gain is, not to use string as a key. Because strings are immutable, working with them always means copy-ing and that\u0026rsquo;s why they get to be very slow. So removing them from Keys and using Numbers instead will mean a huge gain for us.\nTo do this, I created a map which maps names with numbers. I could hardcode them with iota, but that is a very bad thing to do. It would mean, that when I add a new name, I would have to go, and re-compile my code, because data changed. That\u0026rsquo;s not what we want.\nSo, I added this little tid-bit into the for cycle when I\u0026rsquo;m reading in the file lines =\u0026gt;\n... if _, ok := nameMapping[split[0]]; !ok { nameMapping[split[0]] = id id++ } if _, ok := nameMapping[trimmedNeighbour]; !ok { nameMapping[trimmedNeighbour] = id id++ } ... Id starts as Zero. And nameMapping is a simple map[string]int. After this, we fix all the map calls, from table[split[0]] to table[nameMapping[split[0]]]. Table\u0026rsquo;s map will now work with int, but we can still work with strings otherwise.\ntable[nameMapping[split[0]]] = append(table[nameMapping[split[0]]], map[int]int{nameMapping[trimmedNeighbour]: like}) This has now a marginally better performance as before:\nBenchmarkCalculateSeating\t50\t32637879 ns/op ok github.com/skarlso/goprojects/advent/day13/part1\t1.698s But, we can still do a HUGE one better. Can you notice the other bottleneck? See, how keys are still []byte? That\u0026rsquo;s, now completely unnecessary. We can use int, since our keys are ints! Permutation changes, and the retrieve.\n... func generatePermutation(s []int, n int) { ... ... func getLikeForTargetConnect(name int, neighbour int) int { neighbours := table[name] for _, t := range neighbours { if v, ok := t[neighbour]; ok { return v } } return 0 } ... Permutation was the Other huge performance consumption. Now, our run time is\u0026hellip;. drum rolls\u0026hellip;\nBenchmarkCalculateSeating\t10000\t166431 ns/op ok github.com/skarlso/goprojects/advent/day13/part1\t1.695s Down to 166431 ns/op!!! From 32637879 ns/op!! And notice how suddenly, go\u0026rsquo;s benchmark jumped up in sample count. Our code is now blazing fast. It\u0026rsquo;s 0.05% of the previous run! It\u0026rsquo;s almost 200 times faster!\nWe could still improve it here and there. I\u0026rsquo;m sure I\u0026rsquo;m doing some extra stuff which is not needed or could be made easier somehow. But I\u0026rsquo;m actually quiet happy with this solution right now.\nThe full code:\npackage main import ( \u0026#34;bufio\u0026#34; \u0026#34;math\u0026#34; \u0026#34;os\u0026#34; \u0026#34;strconv\u0026#34; \u0026#34;strings\u0026#34; \u0026#34;github.com/skarlso/goutils/arrayutils\u0026#34; ) var seatingCombinations = make([][]int, 0) var table = make(map[int][]map[int]int) var keys = make([]int, 0) var nameMapping = make(map[string]int) //Person a person type Person struct { // neighbour *Person name string like int } func main() { CalculatePerfectSeating() } //CalculatePerfectSeating returns the perfect seating order based on Love/Hate relations func CalculatePerfectSeating() { file, _ := os.Open(\u0026#34;input.txt\u0026#34;) defer file.Close() scanner := bufio.NewScanner(file) id := 0 for scanner.Scan() { line := scanner.Text() split := strings.Split(line, \u0026#34; \u0026#34;) trimmedNeighbour := strings.Trim(split[10], \u0026#34;.\u0026#34;) like, _ := strconv.Atoi(split[3]) //If lose -\u0026gt; * -1 if _, ok := nameMapping[split[0]]; !ok { nameMapping[split[0]] = id id++ } if _, ok := nameMapping[trimmedNeighbour]; !ok { nameMapping[trimmedNeighbour] = id id++ } if split[2] == \u0026#34;lose\u0026#34; { like *= -1 } table[nameMapping[split[0]]] = append(table[nameMapping[split[0]]], map[int]int{nameMapping[trimmedNeighbour]: like}) if !arrayutils.ContainsInt(keys, nameMapping[split[0]]) { keys = append(keys, nameMapping[split[0]]) } } generatePermutation(keys, len(keys)) // fmt.Println(\u0026#34;Best seating efficiency:\u0026#34;, calculateSeatingEfficiancy()) } func generatePermutation(s []int, n int) { if n == 1 { news := make([]int, len(s)) copy(news, s) seatingCombinations = append(seatingCombinations, news) } for i := 0; i \u0026lt; n; i++ { s[i], s[n-1] = s[n-1], s[i] generatePermutation(s, n-1) s[i], s[n-1] = s[n-1], s[i] } } func calculateSeatingEfficiancy() int { bestSeating := math.MinInt64 for _, v := range seatingCombinations { calculatedOrder := 0 for i := range v { left := (i - 1) % len(v) //This is to work around the fact that in Go //modulo of a negative number will not return a positive number. //So -1 % 4 will not return 3 but -1. In that case we add length. if left \u0026lt; 0 { left += len(v) } right := (i + 1) % len(v) calculatedOrder += getLikeForTargetConnect(v[i], v[left]) + getLikeForTargetConnect(v[i], v[right]) } if calculatedOrder \u0026gt; bestSeating { bestSeating = calculatedOrder } } return bestSeating } func getLikeForTargetConnect(name int, neighbour int) int { neighbours := table[name] for _, t := range neighbours { if v, ok := t[neighbour]; ok { return v } } return 0 } Also, on github =\u0026gt; Advent Of Code Day 13.\nThank you very much for reading, this has been a massive fun to write and to refactor.\nHave something to say? Please don\u0026rsquo;t hesitate.\nAnd as always,\nHave a nice day!\nGergely.\n","permalink":"https://skarlso.github.io/2016/01/05/improving-performance-with-byte-slice-and-int-map/","summary":"Hello Folks.\nToday I would like to share with you my little tale of refactoring my solution to Advent Of Code Day 13.\nIt\u0026rsquo;s a lovely tale of action, adventure, drama, and comedy.\nLet\u0026rsquo;s being with my first iteration of the problem.\npackage main import ( \u0026#34;bufio\u0026#34; \u0026#34;fmt\u0026#34; \u0026#34;math\u0026#34; \u0026#34;os\u0026#34; \u0026#34;strconv\u0026#34; \u0026#34;strings\u0026#34; \u0026#34;github.com/skarlso/goutils/arrayutils\u0026#34; ) var seatingCombinations = make([][]string, 0) var table = make(map[string][]map[string]int) var keys = make([]string, 0) //Person a person type Person struct { // neighbour *Person name string like int } func main() { file, _ := os.","title":"Improving performance with byte slice and int map"},{"content":"Hi folks and a Happy new Year!\nToday, I would like to show you some interesting things you can do with channels. Consider the following simple example.\npackage main import \u0026#34;fmt\u0026#34; func main() { generatedPassword := make(chan int, 100) correctPassword := make(chan int) defer close(generatedPassword) defer close(correctPassword) go passwordIncrement(generatedPassword) go checkPassword(generatedPassword, correctPassword) pass := \u0026lt;-correctPassword fmt.Println(pass) } func checkPassword(input \u0026lt;-chan int, output chan\u0026lt;- int) { for { p := \u0026lt;-input //Introduce lengthy operation here // time.Sleep(time.Second) fmt.Println(\u0026#34;Checking p:\u0026#34;, p) if p \u0026gt; 100000 { output \u0026lt;- p } } } func passwordIncrement(out chan\u0026lt;- int) { p := 0 for { p++ out \u0026lt;- p } } The premise is as follows. It launches two go routines. One, which generates passwords, and an other which checks for validity. The two routines talk to each other through the channel generatedPassword. That\u0026rsquo;s the providing connections between them. The channel correctPassword provides output for the checkPassword routine.\nIf there is data received from correctPassword channel, we found our first password and there is no need to look further so we, print the password and quit. The channels will close with defer. This works. But the password is usually either a []byte or a string. With string, it still works.\npackage main import \u0026#34;fmt\u0026#34; func main() { generatedPassword := make(chan string, 100) correctPassword := make(chan string) defer close(generatedPassword) defer close(correctPassword) go passwordIncrement(generatedPassword) go checkPassword(generatedPassword, correctPassword) pass := \u0026lt;-correctPassword fmt.Println(pass) } func checkPassword(input \u0026lt;-chan string, output chan\u0026lt;- string) { for { p := \u0026lt;-input //Introduce lengthy operation here // time.Sleep(time.Second) fmt.Println(\u0026#34;Checking p:\u0026#34;, p) if performSomeCheckingOperation(p) { output \u0026lt;- p } } } func generateNewPassword(out chan\u0026lt;- string) { var p string for { p = generate(p) out \u0026lt;- p } } The generating happens based on the previously generated password. For example, we increment, or permeate. aaaa, aaab, aaac\u0026hellip;\nSo generatedPassword is a buffered channel, it gathers a 100 passwords from which checking retrieves passwords one by one and works on them in a slower process.\nNow, this is fine, but using []byte arrays will always be more powerful and faster. So we would like to use []byte. Like this:\npackage main import \u0026#34;fmt\u0026#34; func main() { generatedPassword := make(chan []byte, 100) correctPassword := make(chan []byte) defer close(generatedPassword) defer close(correctPassword) go passwordIncrement(generatedPassword) go checkPassword(generatedPassword, correctPassword) pass := \u0026lt;-correctPassword fmt.Println(string(pass)) } func checkPassword(input \u0026lt;-chan []byte, output chan\u0026lt;- []byte) { for { p := \u0026lt;-input //Introduce lengthy operation here // time.Sleep(time.Second) fmt.Println(\u0026#34;Checking p:\u0026#34;, string(p)) if performSomeCheckingOperation(p) { output \u0026lt;- p } } } func generateNewPassword(out chan\u0026lt;- []byte) { var p []byte for { p = generate(p) out \u0026lt;- p } } This will not work. Why? Because []byte is a slice and thus will be constantly overwritten. The checking go routine will always only check the last data and many generated passwords will be lost. This is also noted in go\u0026rsquo;s scanner here =\u0026gt; Scanner.Bytes\nWe have a couple of options here.\nWe could use string channels and convert to []byte after. This is still okay, because the conversion isn\u0026rsquo;t very CPU intensive.\n... generatedPassword := make(chan string, 100) correctPassword := make(chan string) ... p := []byte(\u0026lt;-input) //This will work very nicely. ... Options two would be If you have a fixed password to handle, fix data, for example MD5 hash, you can use a byte array. Like this:\npackage main import \u0026#34;fmt\u0026#34; const PASSWD=13 func main() { generatedPassword := make(chan [PASSWD]byte, 100) correctPassword := make(chan [PASSWD]byte) defer close(generatedPassword) defer close(correctPassword) go passwordIncrement(generatedPassword) go checkPassword(generatedPassword, correctPassword) pass := \u0026lt;-correctPassword fmt.Println(string(pass)) } func checkPassword(input \u0026lt;-chan [PASSWD]byte, output chan\u0026lt;- [PASSWD]byte) { for { p := \u0026lt;-input //Introduce lengthy operation here // time.Sleep(time.Second) fmt.Println(\u0026#34;Checking p:\u0026#34;, string(p)) if performSomeCheckingOperation(p) { output \u0026lt;- p } } } func generateNewPassword(out chan\u0026lt;- [PASSWD]byte) { var p [PASSWD]byte for { p = generate(p) out \u0026lt;- p } } This is also one solution. If you have to convert between the two, could go with p := byte[:].\nConclusion is, that use conversion rather than string types and be aware that using slices in channels is dangerous.\nThanks for reading! Gergely.\n","permalink":"https://skarlso.github.io/2016/01/01/byte-arrays-and-channels/","summary":"Hi folks and a Happy new Year!\nToday, I would like to show you some interesting things you can do with channels. Consider the following simple example.\npackage main import \u0026#34;fmt\u0026#34; func main() { generatedPassword := make(chan int, 100) correctPassword := make(chan int) defer close(generatedPassword) defer close(correctPassword) go passwordIncrement(generatedPassword) go checkPassword(generatedPassword, correctPassword) pass := \u0026lt;-correctPassword fmt.Println(pass) } func checkPassword(input \u0026lt;-chan int, output chan\u0026lt;- int) { for { p := \u0026lt;-input //Introduce lengthy operation here // time.","title":"Byte arrays and Channels"},{"content":"Hello Folks.\nThis is just a quick post on the topic and a reminder for myself and everybody to ALWAYS USE []BYTE INSTEAD OF STRINGS.\n[]Byte is marginally faster than a simple Strings. In fact, I would say using []byte should be the standard instead of strings.\nSample code:\npackage solutions import \u0026#34;fmt\u0026#34; const ( //INPUT input INPUT = \u0026#34;1321131112\u0026#34; //LIMIT limit LIMIT = 50 ) //LookAndSay translates numbers according to Look and Say algo func LookAndSay(s string, c chan string) { charCount := 1 look := \u0026#34;\u0026#34; for i := range s { if i+1 \u0026lt; len(s) { if s[i] == s[i+1] { charCount++ } else { look += fmt.Sprintf(\u0026#34;%d%s\u0026#34;, charCount, string(s[i])) charCount = 1 } } else { look += fmt.Sprintf(\u0026#34;%d%s\u0026#34;, charCount, string(s[i])) } } c \u0026lt;- look } //GetLengthOfLookAndSay Retrieve the Length of a lookandsay done Limit times func GetLengthOfLookAndSay() { c := make(chan string, 0) go LookAndSay(INPUT, c) finalString := \u0026lt;-c for i := 0; i \u0026lt;= LIMIT-2; i++ { go LookAndSay(finalString, c) finalString = \u0026lt;-c // fmt.Println(finalString) } fmt.Println(\u0026#34;Lenght of final String:\u0026#34;, len(finalString)) } This, with the limit raised to 50 run for ~1 hour. Even with the routines although they were just for show since they had to wait for each others input.\nNow change this to []byte and the run time was almost under 2 seconds on my machine.\npackage solutions import ( \u0026#34;fmt\u0026#34; \u0026#34;strconv\u0026#34; ) const ( //LIMIT limit LIMIT = 50 ) //INPUT puzzle input //This used to be a string until I was reminded that BYTE ARRAY IS ALWAYS FASTER! var INPUT = []byte(\u0026#34;1321131112\u0026#34;) //LookAndSay translates numbers according to Look and Say algo func LookAndSay(s []byte) (look []byte) { charCount := 1 for i := range s { if i+1 \u0026lt; len(s) { if s[i] == s[i+1] { charCount++ } else { b := []byte(strconv.FormatInt(int64(charCount), 10)) look = append(look, b[0], s[i]) charCount = 1 } } else { b := []byte(strconv.FormatInt(int64(charCount), 10)) look = append(look, b[0], s[i]) } } return } //GetLengthOfLookAndSay Retrieve the Length of a lookandsay done Limit times func GetLengthOfLookAndSay() { finalString := INPUT for i := 0; i \u0026lt;= LIMIT-1; i++ { finalString = LookAndSay(finalString) } fmt.Println(\u0026#34;Lenght of final String:\u0026#34;, len(finalString)) } This is the solution for Day 10 on AdventOfCode by the way.\nThanks for readin\u0026rsquo;. Gergely.\n","permalink":"https://skarlso.github.io/2015/12/29/use-byte-array-instead-of-strings/","summary":"Hello Folks.\nThis is just a quick post on the topic and a reminder for myself and everybody to ALWAYS USE []BYTE INSTEAD OF STRINGS.\n[]Byte is marginally faster than a simple Strings. In fact, I would say using []byte should be the standard instead of strings.\nSample code:\npackage solutions import \u0026#34;fmt\u0026#34; const ( //INPUT input INPUT = \u0026#34;1321131112\u0026#34; //LIMIT limit LIMIT = 50 ) //LookAndSay translates numbers according to Look and Say algo func LookAndSay(s string, c chan string) { charCount := 1 look := \u0026#34;\u0026#34; for i := range s { if i+1 \u0026lt; len(s) { if s[i] == s[i+1] { charCount++ } else { look += fmt.","title":"Use Byte Array Instead of Strings"},{"content":"Hello Folks.\nThis is just a quick post on the topic and a reminder for myself and everybody to ALWAYS USE []BYTE INSTEAD OF STRINGS.\n[]Byte is marginally faster than a simple Strings. In fact, I would say using []byte should be the standard instead of strings.\nSample code:\npackage solutions import \u0026#34;fmt\u0026#34; const ( //INPUT input INPUT = \u0026#34;1321131112\u0026#34; //LIMIT limit LIMIT = 50 ) //LookAndSay translates numbers according to Look and Say algo func LookAndSay(s string, c chan string) { charCount := 1 look := \u0026#34;\u0026#34; for i := range s { if i+1 \u0026lt; len(s) { if s[i] == s[i+1] { charCount++ } else { look += fmt.Sprintf(\u0026#34;%d%s\u0026#34;, charCount, string(s[i])) charCount = 1 } } else { look += fmt.Sprintf(\u0026#34;%d%s\u0026#34;, charCount, string(s[i])) } } c \u0026lt;- look } //GetLengthOfLookAndSay Retrieve the Length of a lookandsay done Limit times func GetLengthOfLookAndSay() { c := make(chan string, 0) go LookAndSay(INPUT, c) finalString := \u0026lt;-c for i := 0; i \u0026lt;= LIMIT-2; i++ { go LookAndSay(finalString, c) finalString = \u0026lt;-c // fmt.Println(finalString) } fmt.Println(\u0026#34;Lenght of final String:\u0026#34;, len(finalString)) } This, with the limit raised to 50 run for ~1 hour. Even with the routines although they were just for show since they had to wait for each others input.\nNow change this to []byte and the run time was almost under 2 seconds on my machine.\npackage solutions import ( \u0026#34;fmt\u0026#34; \u0026#34;strconv\u0026#34; ) const ( //LIMIT limit LIMIT = 50 ) //INPUT puzzle input //This used to be a string until I was reminded that BYTE ARRAY IS ALWAYS FASTER! var INPUT = []byte(\u0026#34;1321131112\u0026#34;) //LookAndSay translates numbers according to Look and Say algo func LookAndSay(s []byte) (look []byte) { charCount := 1 for i := range s { if i+1 \u0026lt; len(s) { if s[i] == s[i+1] { charCount++ } else { b := []byte(strconv.FormatInt(int64(charCount), 10)) look = append(look, b[0], s[i]) charCount = 1 } } else { b := []byte(strconv.FormatInt(int64(charCount), 10)) look = append(look, b[0], s[i]) } } return } //GetLengthOfLookAndSay Retrieve the Length of a lookandsay done Limit times func GetLengthOfLookAndSay() { finalString := INPUT for i := 0; i \u0026lt;= LIMIT-1; i++ { finalString = LookAndSay(finalString) } fmt.Println(\u0026#34;Lenght of final String:\u0026#34;, len(finalString)) } This is the solution for Day 10 on AdventOfCode by the way.\nThanks for readin\u0026rsquo;. Gergely.\n","permalink":"https://skarlso.github.io/2015/12/29/use-byte-slice-instead-of-strings/","summary":"Hello Folks.\nThis is just a quick post on the topic and a reminder for myself and everybody to ALWAYS USE []BYTE INSTEAD OF STRINGS.\n[]Byte is marginally faster than a simple Strings. In fact, I would say using []byte should be the standard instead of strings.\nSample code:\npackage solutions import \u0026#34;fmt\u0026#34; const ( //INPUT input INPUT = \u0026#34;1321131112\u0026#34; //LIMIT limit LIMIT = 50 ) //LookAndSay translates numbers according to Look and Say algo func LookAndSay(s string, c chan string) { charCount := 1 look := \u0026#34;\u0026#34; for i := range s { if i+1 \u0026lt; len(s) { if s[i] == s[i+1] { charCount++ } else { look += fmt.","title":"Use Byte Slice Instead of Strings"},{"content":"Hello everybody!\nI wanted to do a sort post about word frequency count. I did it many times now and I was curious as how a recursive solution would perform as opposed to looping.\nSo I wrote it up quickly and added a few benchmarks with different sized data.\nFirst\u0026hellip;. The code:\nvar freqMap = make(map[string]int, 0) func countLettersRecursive(s string) string { if len(s) == 0 { return s } freqMap[string(s[0])]++ return countLettersRecursive(s[1:]) } func countLettersLoop(s string) { for _, v := range s { freqMap[string(v)]++ } } Very simple. The first run with a small sample: \u0026ldquo;asdfasdfasdfasdfasdf\u0026rdquo;\nBenchmarkLoopFrequencyCount 5000000 377 ns/op BenchmarkRecursiveFrequencyCount 5000000 380 ns/op They almost equal but Recursive seems to be lagging behind. So I increased the sample size to a text which was 496 long.\nPASS BenchmarkLoopFrequencyCount 30000 53336 ns/op BenchmarkRecursiveFrequencyCount 20000 61780 ns/op And, as expected, recursing is less performant than looping. Also, I think my machine would die from a larger data size\u0026hellip;\nBut the recursive looks so much cooler though.\nThanks for reading! Gergely.\n","permalink":"https://skarlso.github.io/2015/12/23/recursive-freq-count/","summary":"Hello everybody!\nI wanted to do a sort post about word frequency count. I did it many times now and I was curious as how a recursive solution would perform as opposed to looping.\nSo I wrote it up quickly and added a few benchmarks with different sized data.\nFirst\u0026hellip;. The code:\nvar freqMap = make(map[string]int, 0) func countLettersRecursive(s string) string { if len(s) == 0 { return s } freqMap[string(s[0])]++ return countLettersRecursive(s[1:]) } func countLettersLoop(s string) { for _, v := range s { freqMap[string(v)]++ } } Very simple.","title":"Recursive Letter Frequency Count"},{"content":"Hello folks.\nHere is a little something I\u0026rsquo;ve put together, since I\u0026rsquo;m doing it a lot.\nGo Development Environment\nIf I have a project I\u0026rsquo;d like to contribute, like GoHugo, I have to setup a development environment, because most of the times, I\u0026rsquo;m on a Mac. And on OSX things work differently. I like to work in a Linux environment since that\u0026rsquo;s what most of the projects are built on.\nSo here you go. Just download the files, and say vagrant up which will do the magic.\nThis sets up vim-go with code completion given by YouCompleteMe and some go features like, fmt on save and build error highlighting.\nAlso sets up ctags which will give you tags and the ability to do GoTo Declaration.\nInstalls a bunch of utilities, and configures Go. There is an option to install docker as well. But it\u0026rsquo;s ignored at the moment.\nJust uncomment this line:\n#config.vm.provision \u0026#34;shell\u0026#34;, path: \u0026#34;install_docker.sh\u0026#34; Any questions or request, feel free to submit an Issue!\nThanks for reading! Gergely.\n","permalink":"https://skarlso.github.io/2015/12/08/go-development-environment/","summary":"Hello folks.\nHere is a little something I\u0026rsquo;ve put together, since I\u0026rsquo;m doing it a lot.\nGo Development Environment\nIf I have a project I\u0026rsquo;d like to contribute, like GoHugo, I have to setup a development environment, because most of the times, I\u0026rsquo;m on a Mac. And on OSX things work differently. I like to work in a Linux environment since that\u0026rsquo;s what most of the projects are built on.","title":"Go Development Environment"},{"content":"Hello Folks Welcome to my new blog. I decided to move away for a number of reasons, but setting up a static page blog site is very cool if you don\u0026rsquo;t directly use a database. Since posts are just posts and I have a different way of hosting images, this really was just a matter of time.\nAnd Hugo / Github pages provided the tools which made this move possible.\nAlso, I love writing this post in Markdown. I always liked the formatting rules of it, so this is quiet the blast.\nCode will look a little more readble now as well:\nfunc main() { handlerChain := alice.New(Logging, PanicHandler) router := mux.NewRouter().StrictSlash(true) router.Handle(\u0026#34;/create\u0026#34;, handlerChain.ThenFunc(createIssue)).Methods(\u0026#34;POST\u0026#34;) router.Handle(\u0026#34;/\u0026#34;, handlerChain.ThenFunc(renderMainPage)).Methods(\u0026#34;GET\u0026#34;) router.PathPrefix(\u0026#34;/css/\u0026#34;).Handler(http.StripPrefix(\u0026#34;/css/\u0026#34;, http.FileServer(http.Dir(\u0026#34;./css\u0026#34;)))) log.Printf(\u0026#34;Starting server to listen on port: 8989...\u0026#34;) http.ListenAndServe(\u0026#34;:8989\u0026#34;, router) } Much easier on the eyes. And linking is a breeze as well.\nThings to notice There is now a content on the side which will list the sections in a post. And there is an estimated read timer in the post\u0026rsquo;s title. It takes average reading speed and wordcount into account.\nAnyhow, thanks for joining me in the new realm, and happy reading! Gergely.\n","permalink":"https://skarlso.github.io/2015/12/07/welcome-to-my-new-blog/","summary":"Hello Folks Welcome to my new blog. I decided to move away for a number of reasons, but setting up a static page blog site is very cool if you don\u0026rsquo;t directly use a database. Since posts are just posts and I have a different way of hosting images, this really was just a matter of time.\nAnd Hugo / Github pages provided the tools which made this move possible.","title":"Welcome To My New Blog"},{"content":"Hi folks.\nSo, I was playing around and created a client for JIRA written in Go. It was nice to do some JSON transformation. And sending POSTS was really trivial.\nIt\u0026rsquo;s still in it\u0026rsquo;s infancy and I have a couple of more features I want to implement, but, here is the code.\npackage main import ( \u0026#34;bytes\u0026#34; \u0026#34;encoding/json\u0026#34; \u0026#34;flag\u0026#34; \u0026#34;fmt\u0026#34; \u0026#34;io/ioutil\u0026#34; \u0026#34;log\u0026#34; \u0026#34;net/http\u0026#34; \u0026#34;os\u0026#34; \u0026#34;github.com/BurntSushi/toml\u0026#34; ) var configFile = \u0026#34;~/.jira_config.toml\u0026#34; var parameter string var flags struct { Comment string Description string IssueKey string Priority string Resolution string Title string Project string } //Issue is a representation of a Jira Issue type Issue struct { Fields struct { Project struct { Key string `json:\u0026#34;key\u0026#34;` } `json:\u0026#34;project\u0026#34;` Summary string `json:\u0026#34;summary\u0026#34;` Description string `json:\u0026#34;description\u0026#34;` Issuetype struct { Name string `json:\u0026#34;name\u0026#34;` } `json:\u0026#34;issuetype\u0026#34;` Priority struct { ID string `json:\u0026#34;id\u0026#34;` } `json:\u0026#34;priority\u0026#34;` } `json:\u0026#34;fields\u0026#34;` } //Transition defines a transition json object. Used for starting, stoppinp //generally for state stranfer type Transition struct { Fields struct { Resolution struct { Name string `json:\u0026#34;name\u0026#34;` } `json:\u0026#34;resolution\u0026#34;` } `json:\u0026#34;fields\u0026#34;` Transition struct { ID string `json:\u0026#34;id\u0026#34;` } `json:\u0026#34;transition\u0026#34;` } //Credentials a representation of a JIRA config which helds API permissions type Credentials struct { Username string Password string URL string } func init() { flag.StringVar(\u0026amp;flags.Comment, \u0026#34;m\u0026#34;, \u0026#34;Default Comment\u0026#34;, \u0026#34;A Comment when changing the status of an Issue.\u0026#34;) flag.StringVar(\u0026amp;flags.Description, \u0026#34;d\u0026#34;, \u0026#34;Default Description\u0026#34;, \u0026#34;Provide a description for a newly created Issue.\u0026#34;) flag.StringVar(\u0026amp;flags.Priority, \u0026#34;p\u0026#34;, \u0026#34;2\u0026#34;, \u0026#34;The priority of an Issue which will be set.\u0026#34;) flag.StringVar(\u0026amp;flags.IssueKey, \u0026#34;k\u0026#34;, \u0026#34;\u0026#34;, \u0026#34;Issue key of an issue.\u0026#34;) flag.StringVar(\u0026amp;flags.Resolution, \u0026#34;r\u0026#34;, \u0026#34;Done\u0026#34;, \u0026#34;Resolution when an issue is closed. Ex.: Done, Fixed, Won\u0026#39;t fix.\u0026#34;) flag.StringVar(\u0026amp;flags.Title, \u0026#34;t\u0026#34;, \u0026#34;Default Title\u0026#34;, \u0026#34;Title of an Issue.\u0026#34;) flag.StringVar(\u0026amp;flags.Project, \u0026#34;o\u0026#34;, \u0026#34;IT\u0026#34;, \u0026#34;Define a Project to create a ticket in.\u0026#34;) flag.Parse() } func (cred *Credentials) initConfig() { if _, err := os.Stat(configFile); err != nil { log.Fatalf(\u0026#34;Error using config file: %v\u0026#34;, err) } if _, err := toml.DecodeFile(configFile, cred); err != nil { log.Fatal(\u0026#34;Error during decoding toml config: \u0026#34;, err) } } func main() { if len(flag.Args()) \u0026lt; 1 { log.Fatal(\u0026#34;Please provide an action to take. Usage information:\u0026#34;) } parameter = flag.Arg() switch parameter { case \u0026#34;close\u0026#34;: closeIssue(flags.IssueKey) case \u0026#34;start\u0026#34;: startIssue(flags.IssueKey) case \u0026#34;create\u0026#34;: createIssue() } } func closeIssue(issueKey string) { if issueKey == \u0026#34;\u0026#34; { log.Fatal(\u0026#34;Please provide an issueID with -k\u0026#34;) } fmt.Println(\u0026#34;Closing issue number: \u0026#34;, issueKey) var trans Transition //TODO: Add the ability to define a comment for the close reason trans.Fields.Resolution.Name = flags.Resolution trans.Transition.ID = \u0026#34;2\u0026#34; marhsalledTrans, err := json.Marshal(trans) if err != nil { log.Fatal(\u0026#34;Error occured when marshaling transition: \u0026#34;, err) } fmt.Println(\u0026#34;Marshalled:\u0026#34;, trans) sendRequest(marhsalledTrans, \u0026#34;POST\u0026#34;, issueKey+\u0026#34;/transitions?expand=transitions.fields\u0026#34;) } func startIssue(issueID string) { if issueID == \u0026#34;\u0026#34; { log.Fatal(\u0026#34;Please provide an issueID with -i\u0026#34;) } fmt.Println(\u0026#34;Starting issue number:\u0026#34;, issueID) } func createIssue() { fmt.Println(\u0026#34;Creating new issue.\u0026#34;) var issue Issue issue.Fields.Description = flags.Description issue.Fields.Priority.ID = flags.Priority issue.Fields.Summary = flags.Title issue.Fields.Project.Key = flags.Project issue.Fields.Issuetype.Name = \u0026#34;Task\u0026#34; marshalledIssue, err := json.Marshal(issue) if err != nil { log.Fatal(\u0026#34;Error occured when Marshaling Issue:\u0026#34;, err) } sendRequest(marshalledIssue, \u0026#34;POST\u0026#34;, \u0026#34;\u0026#34;) } func sendRequest(jsonStr []byte, method string, url string) { cred := \u0026amp;Credentials{} cred.initConfig() fmt.Println(\u0026#34;Json:\u0026#34;, string(jsonStr)) req, err := http.NewRequest(method, cred.URL+url, bytes.NewBuffer(jsonStr)) req.Header.Set(\u0026#34;Content-Type\u0026#34;, \u0026#34;application/json\u0026#34;) req.SetBasicAuth(cred.Username, cred.Password) client := \u0026amp;http.Client{} resp, err := client.Do(req) if err != nil { panic(err) } defer resp.Body.Close() fmt.Println(\u0026#34;response Status:\u0026#34;, resp.Status) fmt.Println(\u0026#34;response Headers:\u0026#34;, resp.Header) body, _ := ioutil.ReadAll(resp.Body) fmt.Println(\u0026#34;response Body:\u0026#34;, string(body)) } It can also be found under my github page: GoJira Github.\nFeel free to open up issues if you would like to use it and need some features which you would find interesting. Currently the username and password for the API are stored in a local config file in your home folder. Later on, I\u0026rsquo;ll add the ability to have a token rather than a username:password combination.\nThanks for reading!\nGergely.\n","permalink":"https://skarlso.github.io/2015/11/20/go-jira-api-client/","summary":"Hi folks.\nSo, I was playing around and created a client for JIRA written in Go. It was nice to do some JSON transformation. And sending POSTS was really trivial.\nIt\u0026rsquo;s still in it\u0026rsquo;s infancy and I have a couple of more features I want to implement, but, here is the code.\npackage main import ( \u0026#34;bytes\u0026#34; \u0026#34;encoding/json\u0026#34; \u0026#34;flag\u0026#34; \u0026#34;fmt\u0026#34; \u0026#34;io/ioutil\u0026#34; \u0026#34;log\u0026#34; \u0026#34;net/http\u0026#34; \u0026#34;os\u0026#34; \u0026#34;github.com/BurntSushi/toml\u0026#34; ) var configFile = \u0026#34;~/.jira_config.toml\u0026#34; var parameter string var flags struct { Comment string Description string IssueKey string Priority string Resolution string Title string Project string } //Issue is a representation of a Jira Issue type Issue struct { Fields struct { Project struct { Key string `json:\u0026#34;key\u0026#34;` } `json:\u0026#34;project\u0026#34;` Summary string `json:\u0026#34;summary\u0026#34;` Description string `json:\u0026#34;description\u0026#34;` Issuetype struct { Name string `json:\u0026#34;name\u0026#34;` } `json:\u0026#34;issuetype\u0026#34;` Priority struct { ID string `json:\u0026#34;id\u0026#34;` } `json:\u0026#34;priority\u0026#34;` } `json:\u0026#34;fields\u0026#34;` } //Transition defines a transition json object.","title":"Go JIRA API client"},{"content":"Hello folks.\nToday, I present to you the One Hundred Day Github Challenge.\nThe rules are simple:\nMinimum of One commit every day for a Hundred days. Commit has to be meaningful but can be as little as a fix in a Readme.md. Doesn\u0026rsquo;t matter if you are on vacation, there are no exceptions. There. Are. No. Exceptions. If you fail a day, you have to start over. No cheating. You only cheat yourself, so this is really up to you. Let me be more clear here, because it seems I wasn\u0026rsquo;t clear enough. What you make out of this challenge, it\u0026rsquo;s up to you. If you just update a readme.md for hundred days, that\u0026rsquo;s fine. Just do it every day. It\u0026rsquo;s a commitment. At least you\u0026rsquo;ll have a nice Readme.\nAlso, let me be clear on another thing. THERE ARE NO EXCEPTIONS. Even on holidays. No. Exceptions.\nSo there you have it. It\u0026rsquo;s easy, but then again, it\u0026rsquo;s not.\nMine starts today! 100.\nThanks for reading.\nAnd happy coding.\nGergely.\n","permalink":"https://skarlso.github.io/2015/11/15/the-one-hundred-day-github-challenge/","summary":"Hello folks.\nToday, I present to you the One Hundred Day Github Challenge.\nThe rules are simple:\nMinimum of One commit every day for a Hundred days. Commit has to be meaningful but can be as little as a fix in a Readme.md. Doesn\u0026rsquo;t matter if you are on vacation, there are no exceptions. There. Are. No. Exceptions. If you fail a day, you have to start over. No cheating. You only cheat yourself, so this is really up to you.","title":"The One Hundred Day GitHub Challenge"},{"content":"Hi Folks.\nI started to build a Progress Quest type of web app in Go.\nIf you\u0026rsquo;d like to join, or just tag along, please drop by here =\u0026gt; Go Progress Quest and feel free to submit an issue if you have an idea, or would like to contribute!\nI will try and document the Progress.\nThank you for reading!\nGergely.\n","permalink":"https://skarlso.github.io/2015/11/09/go-progress-quest/","summary":"Hi Folks.\nI started to build a Progress Quest type of web app in Go.\nIf you\u0026rsquo;d like to join, or just tag along, please drop by here =\u0026gt; Go Progress Quest and feel free to submit an issue if you have an idea, or would like to contribute!\nI will try and document the Progress.\nThank you for reading!\nGergely.","title":"Go Progress Quest"},{"content":"Hi folks.\nIf you have the tendency, like me, to forget that you are on the corporate VPN, or leave a certain software open when you bring your laptop to work, this might be helpful to you too.\nIt\u0026rsquo;s a small script which kills a program when you change your Wifi network.\nScript:\n#!/bin/bash function log { directory=\u0026#34;/Users/\u0026lt;username\u0026gt;/wifi_detect\u0026#34; log_dir_exists=true if [ ! -d $directory ]; then echo \u0026#34;Attempting to create =\u0026gt; $directory\u0026#34; mkdir -p $directory if [ ! -d $directory ]; then echo \u0026#34;Could not create directory. Continue to log to echo.\u0026#34; log_dir_exists=false fi fi if $log_dir_exists ; then echo \u0026#34;$(date):$1\u0026#34; \u0026gt;\u0026gt; \u0026#34;$directory/log.txt\u0026#34; else echo \u0026#34;$(date):$1\u0026#34; fi } function check_program { to_kill=\u0026#34;[${1::1}]${1:1}\u0026#34; log \u0026#34;Checking if $to_kill really quit.\u0026#34; ps=$(ps aux |grep \u0026#34;$to_kill\u0026#34;) log \u0026#34;ps =\u0026gt; $ps\u0026#34; if [ -z \u0026#34;$ps\u0026#34; ]; then # 0 - True return else # 1 - False return 1 fi } function kill_program { log \u0026#34;Killing program\u0026#34; `pkill -f \u0026#34;$1\u0026#34;` sleep 1 if ! check_program $1 ; then log \u0026#34;$1 Did not quit!\u0026#34; else log \u0026#34;$1 quit successfully\u0026#34; fi } wifi_name=$(networksetup -getairportnetwork en0 |awk -F\u0026#34;: \u0026#34; \u0026#39;{print $2}\u0026#39;) log \u0026#34;Wifi name: $wifi_name\u0026#34; if [ \u0026#34;$wifi_name\u0026#34; = \u0026#34;\u0026lt;wifi_name\u0026gt;\u0026#34; ]; then log \u0026#34;On corporate network... Killing Program\u0026#34; kill_program \u0026#34;\u0026lt;programname\u0026gt;\u0026#34; elif [ \u0026#34;$wifi_name\u0026#34; = \u0026#34;\u0026lt;home_wifi_name\u0026gt;\u0026#34; ]; then # Kill \u0026lt;program\u0026gt; if enabled and if on \u0026lt;home_wifi\u0026gt; and if Tunnelblick is running. log \u0026#34;Not on corporate network... Killing \u0026lt;program\u0026gt; if Tunnelblick is active.\u0026#34; if ! check_program \u0026#34;Tunnelblick\u0026#34; ; then log \u0026#34;Tunnelblick is active. Killing \u0026lt;program\u0026gt;\u0026#34; kill_program \u0026#34;\u0026lt;program\u0026gt;\u0026#34; else log \u0026#34;All good... Happy coding.\u0026#34; fi else log \u0026#34;No known Network...\u0026#34; fi Now, the trick is, on OSX to only trigger this when your network changes. For this, you can have a \u0026rsquo;launchd\u0026rsquo; daemon, which is configured to watch three files which relate to a network being changed.\nThe script sits under your ~/Library/LaunchAgents folder. Create something like, com.username.checknetwork.plist.\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;!DOCTYPE plist PUBLIC \u0026#34;-//Apple Computer//DTD PLIST 1.0//EN\u0026#34; \\ \u0026#34;http://www.apple.com/DTDs/PropertyList-1.0.dtd\u0026#34;\u0026gt; \u0026lt;plist version=\u0026#34;1.0\u0026#34;\u0026gt; \u0026lt;dict\u0026gt; \u0026lt;key\u0026gt;Label\u0026lt;/key\u0026gt; \u0026lt;string\u0026gt;ifup.ddns\u0026lt;/string\u0026gt; \u0026lt;key\u0026gt;LowPriorityIO\u0026lt;/key\u0026gt; \u0026lt;true/\u0026gt; \u0026lt;key\u0026gt;ProgramArguments\u0026lt;/key\u0026gt; \u0026lt;array\u0026gt; \u0026lt;string\u0026gt;/Users/username/scripts/ddns-update.sh\u0026lt;/string\u0026gt; \u0026lt;/array\u0026gt; \u0026lt;key\u0026gt;WatchPaths\u0026lt;/key\u0026gt; \u0026lt;array\u0026gt; \u0026lt;string\u0026gt;/etc/resolv.conf\u0026lt;/string\u0026gt; \u0026lt;string\u0026gt;/Library/Preferences/SystemConfiguration/NetworkInterfaces.plist\u0026lt;/string\u0026gt; \u0026lt;string\u0026gt;/Library/Preferences/SystemConfiguration/com.apple.airport.preferences.plist\u0026lt;/string\u0026gt; \u0026lt;/array\u0026gt; \u0026lt;key\u0026gt;RunAtLoad\u0026lt;/key\u0026gt; \u0026lt;true/\u0026gt; \u0026lt;/dict\u0026gt; \u0026lt;/plist\u0026gt; Now, when you change your network, to whatever your corporate network is, you\u0026rsquo;ll kill Sublime.\nHope this helps somebody.\nCheers,\nGergely.\n","permalink":"https://skarlso.github.io/2015/10/26/kill-a-program-on-connecting-to-a-specific-wifi-osx/","summary":"Hi folks.\nIf you have the tendency, like me, to forget that you are on the corporate VPN, or leave a certain software open when you bring your laptop to work, this might be helpful to you too.\nIt\u0026rsquo;s a small script which kills a program when you change your Wifi network.\nScript:\n#!/bin/bash function log { directory=\u0026#34;/Users/\u0026lt;username\u0026gt;/wifi_detect\u0026#34; log_dir_exists=true if [ ! -d $directory ]; then echo \u0026#34;Attempting to create =\u0026gt; $directory\u0026#34; mkdir -p $directory if [ !","title":"Kill a Program on Connecting to a specific WiFi – OSX"},{"content":"I\u0026rsquo;m proud of this one too. No peaking. I like how go let\u0026rsquo;s you do this kind of stuff in a very nice way.\npackage circular import \u0026#34;fmt\u0026#34; //TestVersion testVersion const TestVersion = 1 //Buffer buffer type type Buffer struct { buffer []byte full int size int s, e int } //NewBuffer creates a new Buffer func NewBuffer(size int) *Buffer { return \u0026amp;Buffer{buffer: make([]byte, size), s: 0, e: 0, size: size, full: 0} } //ReadByte reads a byte from b Buffer func (b *Buffer) ReadByte() (byte, error) { if b.full == 0 { return 0, fmt.Errorf(\u0026#34;Danger Will Robinson: %s\u0026#34;, b) } readByte := b.buffer[b.s] b.s = (b.s + 1) % b.size b.full-- return readByte, nil } //WriteByte writes c byte to the buffer func (b *Buffer) WriteByte(c byte) error { if b.full+1 \u0026gt; b.size { return fmt.Errorf(\u0026#34;Danger Will Robinson: %s\u0026#34;, b) } b.buffer[b.e] = c b.e = (b.e + 1) % b.size b.full++ return nil } //Overwrite overwrites the oldest byte in Buffer func (b *Buffer) Overwrite(c byte) { b.buffer[b.s] = c b.s = (b.s + 1) % b.size } //Reset resets the buffer func (b *Buffer) Reset() { *b = *NewBuffer(b.size) } func (b *Buffer) String() string { return fmt.Sprintf(\u0026#34;Buffer: %d, %d, %d, %d\u0026#34;, b.buffer, b.s, b.e, b.size) } ","permalink":"https://skarlso.github.io/2015/10/15/circular-buffer-in-go/","summary":"I\u0026rsquo;m proud of this one too. No peaking. I like how go let\u0026rsquo;s you do this kind of stuff in a very nice way.\npackage circular import \u0026#34;fmt\u0026#34; //TestVersion testVersion const TestVersion = 1 //Buffer buffer type type Buffer struct { buffer []byte full int size int s, e int } //NewBuffer creates a new Buffer func NewBuffer(size int) *Buffer { return \u0026amp;Buffer{buffer: make([]byte, size), s: 0, e: 0, size: size, full: 0} } //ReadByte reads a byte from b Buffer func (b *Buffer) ReadByte() (byte, error) { if b.","title":"Circular buffer in Go"},{"content":"Hi Folks.\nEver used Job DSL plugin for Jenkins? What is that you say? Well, it\u0026rsquo;s TEH most awesome plug-in for Jenkins to have, because you can CODE your job configuration and put it under source control.\nToday, however, I\u0026rsquo;m not going to write about that because the tutorials on Jenkins JOB DSL are very extensive and very well done. Anyone can pick them up.\nToday, I would like to write about a part of it which is even more interesting. And that is, extracting re-occurring parts in your job configurations.\nIf you have jobs, which have a common part that is repeated everywhere, you usually have an urge to extracted that into one place, lest it changes and you have to go an apply the change everywhere. That\u0026rsquo;s not very efficient. But how do you do that in something which looks like a JSON descriptor?\nFret not, it is just Groovy. And being just groovy, you can use Groovy to implement parts of the job description and then apply that implementation to the job in the DSL.\nSuppose you have an email which you send after every job for which the DSL looks like this:\njob(\u0026#39;MyTestJob\u0026#39;) { description \u0026#39;\u0026lt;strong\u0026gt;GENERATED - do not modify\u0026lt;/strong\u0026gt;\u0026#39; label(\u0026#39;machine_label\u0026#39;) logRotator(30, -1, -1, 5) parameters { stringParam(\u0026#39;somestringparam\u0026#39;, \u0026#39;default_valye\u0026#39;, \u0026#39;Description\u0026#39;) } wrappers { timeout { noActivity(600) abortBuild() failBuild() writeDescription(\u0026#39;Build failed due to timeout after {0} minutes\u0026#39;) } } deliveryPipelineConfiguration(\u0026#34;Main\u0026#34;, \u0026#34;MyTestJob\u0026#34;) wrappers { preBuildCleanup { deleteDirectories() } timestamps() } triggers { cron(\u0026#39;H 12 * * 1,2\u0026#39;) } steps { batchFile(readFileFromWorkspace(\u0026#39;relative/path/to/file\u0026#39;)) } publishers { wsCleanup() extendedEmail(\u0026#39;email@address.com\u0026#39;, \u0026#39;$DEFAULT_SUBJECT\u0026#39;, \u0026#39;$DEFAULT_CONTENT\u0026#39;) { configure { node -\u0026gt; node / presendScript \u0026lt;\u0026lt; readFileFromWorkspace(\u0026#39;email_templates/emailtemplate.groovy\u0026#39;) node / replyTo \u0026lt;\u0026lt; \u0026#39;$DEFAULT_REPLYTO\u0026#39; node / contentType \u0026lt;\u0026lt; \u0026#39;default\u0026#39; } trigger(triggerName: \u0026#39;StillUnstable\u0026#39;, subject: \u0026#39;$DEFAULT_SUBJECT\u0026#39;, body: \u0026#39;$DEFAULT_CONTENT\u0026#39;, replyTo: \u0026#39;$DEFAULT_REPLYTO\u0026#39;, sendToDevelopers: true, sendToRecipientList: true) trigger(triggerName: \u0026#39;Fixed\u0026#39;, subject: \u0026#39;$DEFAULT_SUBJECT\u0026#39;, body: \u0026#39;$DEFAULT_CONTENT\u0026#39;, replyTo: \u0026#39;$DEFAULT_REPLYTO\u0026#39;, sendToDevelopers: true, sendToRecipientList: true) trigger(triggerName: \u0026#39;Failure\u0026#39;, subject: \u0026#39;$DEFAULT_SUBJECT\u0026#39;, body: \u0026#39;$DEFAULT_CONTENT\u0026#39;, replyTo: \u0026#39;$DEFAULT_REPLYTO\u0026#39;, sendToDevelopers: true, sendToRecipientList: true) } } } Now, that big chunk of email setting is copied into a bunch of files, which is pretty ugly. And once you try to change it, you\u0026rsquo;ll have to change it everywhere. Also, the interesting bits here are those readFileFromWorkspace parts. Those allow us to export even larger chunks of the script into external files. Now, because the slave might be located somewhere else, you should not use new File(\u0026lsquo;file\u0026rsquo;).text in your job DSL. readFileFromWorkspace in the background does that, but applies correct way to the PATH it looks on for the file specified.\nLet\u0026rsquo;s put this into a groovy script, shall we? Create a utilities folder where the DSL is and create a groovy file in it like this one:\npackage utilities public class JobCommonTemplate { public static void addEmailTemplate(def job, def dslFactory) { String emailScript = dslFactory.readFileFromWorkspace(\u0026#34;email_template/EmailTemplate.groovy\u0026#34;) job.with { publishers { wsCleanup() extendedEmail(\u0026#39;email@address.com\u0026#39;, \u0026#39;$DEFAULT_SUBJECT\u0026#39;, \u0026#39;$DEFAULT_CONTENT\u0026#39;) { configure { node -\u0026gt; node / presendScript \u0026lt;\u0026lt; emailScript node / replyTo \u0026lt;\u0026lt; \u0026#39;$DEFAULT_REPLYTO\u0026#39; node / contentType \u0026lt;\u0026lt; \u0026#39;default\u0026#39; } trigger(triggerName: \u0026#39;StillUnstable\u0026#39;, subject: \u0026#39;$DEFAULT_SUBJECT\u0026#39;, body: \u0026#39;$DEFAULT_CONTENT\u0026#39;, replyTo: \u0026#39;$DEFAULT_REPLYTO\u0026#39;, sendToDevelopers: true, sendToRecipientList: true) trigger(triggerName: \u0026#39;Fixed\u0026#39;, subject: \u0026#39;$DEFAULT_SUBJECT\u0026#39;, body: \u0026#39;$DEFAULT_CONTENT\u0026#39;, replyTo: \u0026#39;$DEFAULT_REPLYTO\u0026#39;, sendToDevelopers: true, sendToRecipientList: true) trigger(triggerName: \u0026#39;Failure\u0026#39;, subject: \u0026#39;$DEFAULT_SUBJECT\u0026#39;, body: \u0026#39;$DEFAULT_CONTENT\u0026#39;, replyTo: \u0026#39;$DEFAULT_REPLYTO\u0026#39;, sendToDevelopers: true, sendToRecipientList: true) } } } } } The function addEmailTemplate gets two parameters. A job, which is an implementation of a Job, and a dslFactory which is a DslFactory. That factory is an interface which defines our readFileFromWorkspace. Where do we get the implementation from then? That will be from the Job. Let\u0026rsquo;s alter our job to apply this Groovy script.\nimport utilities.JobCommonTemplate def myJob = job(\u0026#39;MyTestJob\u0026#39;) { description \u0026#39;\u0026lt;strong\u0026gt;GENERATED - do not modify\u0026lt;/strong\u0026gt;\u0026#39; label(\u0026#39;machine_label\u0026#39;) logRotator(30, -1, -1, 5) parameters { stringParam(\u0026#39;somestringparam\u0026#39;, \u0026#39;default_valye\u0026#39;, \u0026#39;Description\u0026#39;) } wrappers { timeout { noActivity(600) abortBuild() failBuild() writeDescription(\u0026#39;Build failed due to timeout after {0} minutes\u0026#39;) } } deliveryPipelineConfiguration(\u0026#34;Main\u0026#34;, \u0026#34;MyTestJob\u0026#34;) wrappers { preBuildCleanup { deleteDirectories() } timestamps() } triggers { cron(\u0026#39;H 12 * * 1,2\u0026#39;) } steps { batchFile(readFileFromWorkspace(\u0026#39;relative/path/to/file\u0026#39;)) } } JobCommonTemplate.addEmailTemplate(myJob, this) Notice three things here.\n#1 =\u0026gt; import. We import the script from utilities folder which we created and placed the script into it.\n#2 =\u0026gt; def myJob. We create a variable which will contain our job\u0026rsquo;s description.\n#3 =\u0026gt; this. \u0026rsquo;this\u0026rsquo; will be the DslFactory. That\u0026rsquo;s where we get our readFileFromWorkspace implementation.\nAnd that\u0026rsquo;s it. We have extracted a part of our job which is re-occurring and we found our implementation for our readFileFromWorkspace. DslFactory has most of the things which you need in a job description, would you want to expand on this and extract other bits and pieces.\nHave fun, and happy coding!\nAs always,\nThanks for reading!\nGergely.\n","permalink":"https://skarlso.github.io/2015/10/15/jenkins-job-dsl-and-groovy-goodness/","summary":"Hi Folks.\nEver used Job DSL plugin for Jenkins? What is that you say? Well, it\u0026rsquo;s TEH most awesome plug-in for Jenkins to have, because you can CODE your job configuration and put it under source control.\nToday, however, I\u0026rsquo;m not going to write about that because the tutorials on Jenkins JOB DSL are very extensive and very well done. Anyone can pick them up.\nToday, I would like to write about a part of it which is even more interesting.","title":"Jenkins Job DSL and Groovy goodness"},{"content":"Quickly wrote up the Data Munger code kata in Go.\nNext time, I want better abstractions. And a way to select columns based on their header data. For now, this is not bad.\npackage main import ( \u0026#34;bufio\u0026#34; \u0026#34;fmt\u0026#34; \u0026#34;log\u0026#34; \u0026#34;math\u0026#34; \u0026#34;os\u0026#34; \u0026#34;regexp\u0026#34; \u0026#34;strconv\u0026#34; \u0026#34;strings\u0026#34; ) //Data which is Data type Data struct { columnName string compareOne float64 compareTwo float64 } func main() { // datas := []Data{WeatherData{}, FootballData{}} fmt.Println(\u0026#34;Minimum weather data:\u0026#34;, GetDataMinimumDiff(\u0026#34;weather.dat\u0026#34;, , 1, 2)) fmt.Println(\u0026#34;Minimum football data:\u0026#34;, GetDataMinimumDiff(\u0026#34;football.dat\u0026#34;, 1, 6, 7)) } //GetDataMinimumDiff gathers data from file to fill up Columns. func GetDataMinimumDiff(filename string, nameColumn int, compareColOne int, compareColTwo int) Data { data := Data{} minimum := math.MaxFloat64 readLines := ReadFile(filename) for _, value := range readLines { valueArrays := strings.Split(value, \u0026#34;,\u0026#34;) name := valueArrays[nameColumn] trimmedFirst, _ := strconv.ParseFloat(valueArrays[compareColOne], 64) trimmedSecond, _ := strconv.ParseFloat(valueArrays[compareColTwo], 64) diff := trimmedFirst - trimmedSecond diff = math.Abs(diff) if diff \u0026lt;= minimum { minimum = diff data.columnName = name data.compareOne = trimmedFirst data.compareTwo = trimmedSecond } } return data } //ReadFile reads lines from a file and gives back a string array which contains the lines. func ReadFile(fileName string) (fileLines []string) { file, err := os.Open(fileName) if err != nil { log.Fatal(err) } defer file.Close() scanner := bufio.NewScanner(file) //Skipping the first line which is the header. scanner.Scan() for scanner.Scan() { line := scanner.Text() re := regexp.MustCompile(\u0026#34;\\\\w+\u0026#34;) lines := re.FindAllString(line, -1) if len(lines) \u0026gt; { fileLines = append(fileLines, strings.Join(lines, \u0026#34;,\u0026#34;)) } } if err := scanner.Err(); err != nil { log.Fatal(err) } return } ","permalink":"https://skarlso.github.io/2015/10/04/datamunger-kata-with-go/","summary":"Quickly wrote up the Data Munger code kata in Go.\nNext time, I want better abstractions. And a way to select columns based on their header data. For now, this is not bad.\npackage main import ( \u0026#34;bufio\u0026#34; \u0026#34;fmt\u0026#34; \u0026#34;log\u0026#34; \u0026#34;math\u0026#34; \u0026#34;os\u0026#34; \u0026#34;regexp\u0026#34; \u0026#34;strconv\u0026#34; \u0026#34;strings\u0026#34; ) //Data which is Data type Data struct { columnName string compareOne float64 compareTwo float64 } func main() { // datas := []Data{WeatherData{}, FootballData{}} fmt.Println(\u0026#34;Minimum weather data:\u0026#34;, GetDataMinimumDiff(\u0026#34;weather.","title":"DataMunger Kata with Go"},{"content":"Hello folks.\nToday, I would like to talk about something I came in contact with, and was hard to find a proper answer / solution for it.\nSo I\u0026rsquo;m writing this down to document my findings. Like the title says, this is about aggregating test result with Jenkins, using the plug-in provided. If you, like me, have a pipeline structure which do not work on the same artifact, but do have a upstream-downstream relationship, you will have a hard time configuring and making Aggregation work. So here is how, I fixed the issue.\nConnection In order for the aggregation to work, there needs to be an artifact connection between the upstream and downstream projects. And that is the key. But if you don\u0026rsquo;t have that, well, let\u0026rsquo;s create one. I have a parent job configured like this one. =\u0026gt;\n\u0026lt;?xml version=\u0026#39;1.0\u0026#39; encoding=\u0026#39;UTF-8\u0026#39;?\u0026gt; \u0026lt;project\u0026gt; \u0026lt;actions/\u0026gt; \u0026lt;description\u0026gt;\u0026lt;/description\u0026gt; \u0026lt;keepDependencies\u0026gt;false\u0026lt;/keepDependencies\u0026gt; \u0026lt;properties/\u0026gt; \u0026lt;scm class=\u0026#34;hudson.scm.NullSCM\u0026#34;/\u0026gt; \u0026lt;canRoam\u0026gt;true\u0026lt;/canRoam\u0026gt; \u0026lt;disabled\u0026gt;false\u0026lt;/disabled\u0026gt; \u0026lt;blockBuildWhenDownstreamBuilding\u0026gt;false\u0026lt;/blockBuildWhenDownstreamBuilding\u0026gt; \u0026lt;blockBuildWhenUpstreamBuilding\u0026gt;false\u0026lt;/blockBuildWhenUpstreamBuilding\u0026gt; \u0026lt;triggers/\u0026gt; \u0026lt;concurrentBuild\u0026gt;false\u0026lt;/concurrentBuild\u0026gt; \u0026lt;builders/\u0026gt; \u0026lt;publishers\u0026gt; \u0026lt;hudson.tasks.test.AggregatedTestResultPublisher plugin=\u0026#34;junit@1.9\u0026#34;\u0026gt; \u0026lt;includeFailedBuilds\u0026gt;false\u0026lt;/includeFailedBuilds\u0026gt; \u0026lt;/hudson.tasks.test.AggregatedTestResultPublisher\u0026gt; \u0026lt;hudson.tasks.BuildTrigger\u0026gt; \u0026lt;childProjects\u0026gt;ChildJob\u0026lt;/childProjects\u0026gt; \u0026lt;threshold\u0026gt; \u0026lt;name\u0026gt;SUCCESS\u0026lt;/name\u0026gt; \u0026lt;ordinal\u0026gt;\u0026lt;/ordinal\u0026gt; \u0026lt;color\u0026gt;BLUE\u0026lt;/color\u0026gt; \u0026lt;completeBuild\u0026gt;true\u0026lt;/completeBuild\u0026gt; \u0026lt;/threshold\u0026gt; \u0026lt;/hudson.tasks.BuildTrigger\u0026gt; \u0026lt;/publishers\u0026gt; \u0026lt;buildWrappers/\u0026gt; \u0026lt;/project\u0026gt; As you can see, it\u0026rsquo;s pretty basic. It isn\u0026rsquo;t much. It\u0026rsquo;s supposed to be a trigger job for downstream projects. You could have this one at anything. Maybe scheduled, or have some kind of gathering here of some results, and so on and so forth. The end part of the configuration is the interesting bit.\nAggregation is setup, but it won\u0026rsquo;t work, because despite there being an upstream/downstream relationship, there also needs to be an artifact connection which uses fingerprinting. Fingerprinting for Jenkins is needed in oder to make the physical connection between the jobs via hashes. This is what you will get if that is not setup:\nBut if there is no artifact between them, what do you do? You create one.\nThe Artifact which Binds Us Adding a simple timestamp file is enough to make a connection. So let\u0026rsquo;s do that. This is how it will look like =\u0026gt;\nThe important bits about this picture are the small echo which simply creates a file which will contain some time stamp data, and after that the archive artifact, which also fingerprints that file, marking it with a hash which identifies this job as using that particular artifact.\nNow, the next step is to create the connection. For that, you need the artifact copy plugin =\u0026gt; Copy Artifact Plugin.\nWith this, we create the childs configuration like this:\n\u0026lt;?xml version=\u0026#39;1.0\u0026#39; encoding=\u0026#39;UTF-8\u0026#39;?\u0026gt; \u0026lt;project\u0026gt; \u0026lt;actions/\u0026gt; \u0026lt;description\u0026gt;\u0026lt;/description\u0026gt; \u0026lt;keepDependencies\u0026gt;false\u0026lt;/keepDependencies\u0026gt; \u0026lt;properties/\u0026gt; \u0026lt;scm class=\u0026#34;hudson.plugins.git.GitSCM\u0026#34; plugin=\u0026#34;git@2.4.0\u0026#34;\u0026gt; \u0026lt;configVersion\u0026gt;2\u0026lt;/configVersion\u0026gt; \u0026lt;userRemoteConfigs\u0026gt; \u0026lt;hudson.plugins.git.UserRemoteConfig\u0026gt; \u0026lt;url\u0026gt;https://github.com/Skarlso/DataMung.git\u0026lt;/url\u0026gt; \u0026lt;/hudson.plugins.git.UserRemoteConfig\u0026gt; \u0026lt;/userRemoteConfigs\u0026gt; \u0026lt;branches\u0026gt; \u0026lt;hudson.plugins.git.BranchSpec\u0026gt; \u0026lt;name\u0026gt;*/master\u0026lt;/name\u0026gt; \u0026lt;/hudson.plugins.git.BranchSpec\u0026gt; \u0026lt;/branches\u0026gt; \u0026lt;doGenerateSubmoduleConfigurations\u0026gt;false\u0026lt;/doGenerateSubmoduleConfigurations\u0026gt; \u0026lt;submoduleCfg class=\u0026#34;list\u0026#34;/\u0026gt; \u0026lt;extensions/\u0026gt; \u0026lt;/scm\u0026gt; \u0026lt;canRoam\u0026gt;true\u0026lt;/canRoam\u0026gt; \u0026lt;disabled\u0026gt;false\u0026lt;/disabled\u0026gt; \u0026lt;blockBuildWhenDownstreamBuilding\u0026gt;false\u0026lt;/blockBuildWhenDownstreamBuilding\u0026gt; \u0026lt;blockBuildWhenUpstreamBuilding\u0026gt;false\u0026lt;/blockBuildWhenUpstreamBuilding\u0026gt; \u0026lt;triggers/\u0026gt; \u0026lt;concurrentBuild\u0026gt;false\u0026lt;/concurrentBuild\u0026gt; \u0026lt;builders\u0026gt; \u0026lt;hudson.plugins.gradle.Gradle plugin=\u0026#34;gradle@1.24\u0026#34;\u0026gt; \u0026lt;description\u0026gt;\u0026lt;/description\u0026gt; \u0026lt;switches\u0026gt;\u0026lt;/switches\u0026gt; \u0026lt;tasks\u0026gt;assemble check\u0026lt;/tasks\u0026gt; \u0026lt;rootBuildScriptDir\u0026gt;\u0026lt;/rootBuildScriptDir\u0026gt; \u0026lt;buildFile\u0026gt;build.gradle\u0026lt;/buildFile\u0026gt; \u0026lt;gradleName\u0026gt;(Default)\u0026lt;/gradleName\u0026gt; \u0026lt;useWrapper\u0026gt;true\u0026lt;/useWrapper\u0026gt; \u0026lt;makeExecutable\u0026gt;false\u0026lt;/makeExecutable\u0026gt; \u0026lt;fromRootBuildScriptDir\u0026gt;true\u0026lt;/fromRootBuildScriptDir\u0026gt; \u0026lt;useWorkspaceAsHome\u0026gt;false\u0026lt;/useWorkspaceAsHome\u0026gt; \u0026lt;/hudson.plugins.gradle.Gradle\u0026gt; \u0026lt;hudson.plugins.copyartifact.CopyArtifact plugin=\u0026#34;copyartifact@1.36\u0026#34;\u0026gt; \u0026lt;project\u0026gt;ParentJob\u0026lt;/project\u0026gt; \u0026lt;filter\u0026gt;timestamp.data\u0026lt;/filter\u0026gt; \u0026lt;target\u0026gt;\u0026lt;/target\u0026gt; \u0026lt;excludes\u0026gt;\u0026lt;/excludes\u0026gt; \u0026lt;selector class=\u0026#34;hudson.plugins.copyartifact.TriggeredBuildSelector\u0026#34;\u0026gt; \u0026lt;upstreamFilterStrategy\u0026gt;UseGlobalSetting\u0026lt;/upstreamFilterStrategy\u0026gt; \u0026lt;/selector\u0026gt; \u0026lt;doNotFingerprintArtifacts\u0026gt;false\u0026lt;/doNotFingerprintArtifacts\u0026gt; \u0026lt;/hudson.plugins.copyartifact.CopyArtifact\u0026gt; \u0026lt;/builders\u0026gt; \u0026lt;publishers\u0026gt; \u0026lt;hudson.tasks.junit.JUnitResultArchiver plugin=\u0026#34;junit@1.9\u0026#34;\u0026gt; \u0026lt;testResults\u0026gt;build/test-results/*.xml\u0026lt;/testResults\u0026gt; \u0026lt;keepLongStdio\u0026gt;false\u0026lt;/keepLongStdio\u0026gt; \u0026lt;healthScaleFactor\u0026gt;1.0\u0026lt;/healthScaleFactor\u0026gt; \u0026lt;/hudson.tasks.junit.JUnitResultArchiver\u0026gt; \u0026lt;/publishers\u0026gt; \u0026lt;buildWrappers\u0026gt; \u0026lt;hudson.plugins.ws__cleanup.PreBuildCleanup plugin=\u0026#34;ws-cleanup@0.28\u0026#34;\u0026gt; \u0026lt;deleteDirs\u0026gt;false\u0026lt;/deleteDirs\u0026gt; \u0026lt;cleanupParameter\u0026gt;\u0026lt;/cleanupParameter\u0026gt; \u0026lt;externalDelete\u0026gt;\u0026lt;/externalDelete\u0026gt; \u0026lt;/hudson.plugins.ws__cleanup.PreBuildCleanup\u0026gt; \u0026lt;/buildWrappers\u0026gt; \u0026lt;/project\u0026gt; Again, the improtant bit is this:\nAfter the copy is setup, we launch our parent job and if everything is correct, you should see something like this:\nWrapping it Up For final words, important bit to take away from this is that you need an artifact connection between the jobs to make this work. Whatever your downstream / upstream connection is, it doesn\u0026rsquo;t matter. Also, there can be a problem that you have everything set up, and there are artifacts which bind the jobs together but you still can\u0026rsquo;t see the results, then your best option is to specify the jobs BY NAME in the aggregate test plug-in like this:\nI know this is a pain if there are multiple jobs, but at least, jenkins is providing you with Autoexpande once you start typing.\nOf course this also works with multiple downstream jobs if they copy the artifact to themselves.\nAny questions, please feel free to comment and I will answer to the best of my knowledge.\nCheers, Gergely.\n","permalink":"https://skarlso.github.io/2015/10/02/how-to-aggregate-tests-with-jenkins-with-aggregate-plugin-on-non-relating-jobs/","summary":"Hello folks.\nToday, I would like to talk about something I came in contact with, and was hard to find a proper answer / solution for it.\nSo I\u0026rsquo;m writing this down to document my findings. Like the title says, this is about aggregating test result with Jenkins, using the plug-in provided. If you, like me, have a pipeline structure which do not work on the same artifact, but do have a upstream-downstream relationship, you will have a hard time configuring and making Aggregation work.","title":"How to Aggregate Tests with Jenkins with Aggregate Plugin on non-relating jobs"},{"content":"I used to have great ideas on the toilet, but I no longer do. And I would like to reflect on that. So this is not going to be a technical post, rather some ramblings.\nI already had a post similar to this one, but I failed to follow up on it, and now I\u0026rsquo;m re-visiting the question. With technology on the rise, embedded systems, chips, augmented biology and information being available at our fingertips, I have but one concern. I don\u0026rsquo;t want to sound like an old guy reflecting on history, that now everything is changing and that we need to have a sight on the past and bla bla bla. I do have one valid concern though. We are in danger of loosing ourselves.\nWith mobile phones and the Internet always being around and available, we are in danger of loosing our thoughts and ideas, our individuality and our THINKING. We are reading news, posts, advancements, blogs, vlogs, and the dreaded 9gag. I am one of these people. I read 9gag. And I hate myself for it. It\u0026rsquo;s an immediate satisfaction and gain of euphoria and a way of shutting my brain down when it needs it. But I caught myself doing it one or more times when I should have read something more important or beneficial at least. Or catch up on a blog post or read a news, or Gods forbid just plain sit around and THINK for a little while.\nSo my previous post around this topic was to leave out technology from your life\u0026rsquo;s for a short period of time. This is the same. Have some alone time. Reflect. Write a diary. If you are a technical person, write down ideas you would want to create. If you don\u0026rsquo;t have any, write out bigger ones. For example, I want to write an RPG. Or That I want to learn how to do metaprogramming the proper way. Or that I want to read up on some Russian sciences fiction. There are SOOOO many things in the world. Don\u0026rsquo;t waste it on bullshit and immediate serotonin generating content, like frigging cats! When you do it, when your are at it, stop for a little bit, and think. THINK. What are you doing? Why are you reading up on that crap? What merit does it have?\nI understand that from time to time you need to shut off. You need a little bit of comfort. A little bit of serotonin in your system. There are better ways of achieving that. Go for a walk. Run. Bike. Eat a chocolate while staring out of a window. Read a comic book. Do random acts of kindness (not kidding). Drink a glass of water. Listen to some awesome music while drawing something ( anything, it doesn\u0026rsquo;t have to be a masterpiece! ). Sit back and listen to some music. Talk to a loved one. Talk to a friend. Talk to yourself (again, not kidding). If you have a pet, go play with it.\nSo I have a little challenge here as well -it would be a reflective post if I didn\u0026rsquo;t have any-, do not bring any electronic devices to the toilet. Or if you bring one, the rule is to turn on Airplane mode. I used to have great ideas on the toilet because I didn\u0026rsquo;t used to watch stuff on my phone. I used to be by myself with my thoughts. I have a family so there is very little time or space to be alone and with my thoughts. And then when I had the chance, I was browsing on my phone, which again, effectively, led to not being alone with my thoughts.\nThere you have it. This is my little rant about technology and thinking.\nThanks for reading,\nAnd as always,\nHave a nice day.\nGergely.\n","permalink":"https://skarlso.github.io/2015/09/07/i-used-to-have-great-ideas-on-the-toilet-but-i-no-longer-do/","summary":"I used to have great ideas on the toilet, but I no longer do. And I would like to reflect on that. So this is not going to be a technical post, rather some ramblings.\nI already had a post similar to this one, but I failed to follow up on it, and now I\u0026rsquo;m re-visiting the question. With technology on the rise, embedded systems, chips, augmented biology and information being available at our fingertips, I have but one concern.","title":"I used to have great ideas on the toilet, but I no longer do."},{"content":"I\u0026rsquo;m pretty proud of this one as well.\npackage sieve //Sieve Uses the Sieve of Eratosthenes to calculate primes to a certain limit func Sieve(limit int) []int { var listOfPrimes []int markers := make([]bool, limit) for i := 2; i \u0026lt; limit; i++ { if !markers[i] { for j := i + i; j \u0026lt; limit; j += i { markers[j] = true } listOfPrimes = append(listOfPrimes, i) } } return listOfPrimes } ","permalink":"https://skarlso.github.io/2015/07/30/sieve-of-eratosthenes-in-go/","summary":"I\u0026rsquo;m pretty proud of this one as well.\npackage sieve //Sieve Uses the Sieve of Eratosthenes to calculate primes to a certain limit func Sieve(limit int) []int { var listOfPrimes []int markers := make([]bool, limit) for i := 2; i \u0026lt; limit; i++ { if !markers[i] { for j := i + i; j \u0026lt; limit; j += i { markers[j] = true } listOfPrimes = append(listOfPrimes, i) } } return listOfPrimes } ","title":"Sieve of Eratosthenes in Go"},{"content":"If you are installing something with Packer and you have Headless enabled(and you are lazy and don\u0026rsquo;t want to switch it off), it gets difficult, to see output.\nEspecially on a windows install the Answer File / Unattended install can be like =\u0026gt; Waiting for SSH. for about an hour or two! If you are doing this locally fret not. Just start VirtualBox, and watch the Preview section which will display the current state even if it\u0026rsquo;s a headless install!\nIt\u0026rsquo;s a small windows, but your can click on Show which will open the VM in a proper view.\nEnjoy, Gergely.\n","permalink":"https://skarlso.github.io/2015/07/22/quick-tip-for-debugging-headless-locally/","summary":"If you are installing something with Packer and you have Headless enabled(and you are lazy and don\u0026rsquo;t want to switch it off), it gets difficult, to see output.\nEspecially on a windows install the Answer File / Unattended install can be like =\u0026gt; Waiting for SSH. for about an hour or two! If you are doing this locally fret not. Just start VirtualBox, and watch the Preview section which will display the current state even if it\u0026rsquo;s a headless install!","title":"Quick Tip for Debugging Headless Locally"},{"content":"I quiet like this one. My first go program snippet without any peaking or googling. I\u0026rsquo;m proud, though it could be improved with a bit of struct magic and such and such. And it only counts \u0026rsquo;till 1000.\npackage main import \u0026#34;fmt\u0026#34; var words = map[int]string{1: \u0026#34;one\u0026#34;, 2: \u0026#34;two\u0026#34;, 3: \u0026#34;three\u0026#34;, 4: \u0026#34;four\u0026#34;, 5: \u0026#34;five\u0026#34;, 6: \u0026#34;six\u0026#34;, 7: \u0026#34;seven\u0026#34;, 8: \u0026#34;eight\u0026#34;, 9: \u0026#34;nine\u0026#34;, 10: \u0026#34;ten\u0026#34;, 11: \u0026#34;eleven\u0026#34;, 12: \u0026#34;twelve\u0026#34;, 13: \u0026#34;thirteen\u0026#34;, 14: \u0026#34;fourteen\u0026#34;, 15: \u0026#34;fifteen\u0026#34;, 16: \u0026#34;sixteen\u0026#34;, 17: \u0026#34;seventeen\u0026#34;, 18: \u0026#34;eighteen\u0026#34;, 19: \u0026#34;nineteen\u0026#34;, 20: \u0026#34;twenty\u0026#34;, 30: \u0026#34;thirty\u0026#34;, 40: \u0026#34;forty\u0026#34;, 50: \u0026#34;fifty\u0026#34;, 60: \u0026#34;sixty\u0026#34;, 70: \u0026#34;seventy\u0026#34;, 80: \u0026#34;eighty\u0026#34;, 90: \u0026#34;ninety\u0026#34;} // CountLetters count the letters in a long string number representation func CountLetters(limit int) { myLongNumberString := \u0026#34;\u0026#34; for i := 1; i \u0026lt;= limit; i++ { addLettersToMyString(\u0026amp;myLongNumberString, i) } // fmt.Println(\u0026#34;1-9 written with letters is: \u0026#34;, len(myLongNumberString)) fmt.Println(\u0026#34;The string is:\u0026#34;, myLongNumberString) fmt.Println(\u0026#34;Lenght of string is:\u0026#34;, len(myLongNumberString)) } func addLettersToMyString(myString *string, num int) { if num \u0026lt; 20 { *myString += words[num] } if num \u0026gt;= 20 \u0026amp;\u0026amp; num \u0026lt; 100 { *myString += countMiddle(num) } if num \u0026gt;= 100 \u0026amp;\u0026amp; num \u0026lt; 1000 { hundred, tenth := countHundred(num) if tenth == { *myString += hundred } else if tenth \u0026gt;= 11 \u0026amp;\u0026amp; tenth \u0026lt; 20 { *myString += hundred + \u0026#34;and\u0026#34; + words[tenth] } else { *myString += hundred + \u0026#34;and\u0026#34; + countMiddle(tenth) } } if num == 1000 { *myString += \u0026#34;onethousand\u0026#34; } } func countMiddle(num int) string { minues := num % 10 num -= minues return words[num] + words[minues] } func countHundred(num int) (string, int) { minues := num % 100 num -= minues return (words[(num/100)] + \u0026#34;hundred\u0026#34;), minues } ","permalink":"https://skarlso.github.io/2015/07/19/converting-numbers-into-string-representations/","summary":"I quiet like this one. My first go program snippet without any peaking or googling. I\u0026rsquo;m proud, though it could be improved with a bit of struct magic and such and such. And it only counts \u0026rsquo;till 1000.\npackage main import \u0026#34;fmt\u0026#34; var words = map[int]string{1: \u0026#34;one\u0026#34;, 2: \u0026#34;two\u0026#34;, 3: \u0026#34;three\u0026#34;, 4: \u0026#34;four\u0026#34;, 5: \u0026#34;five\u0026#34;, 6: \u0026#34;six\u0026#34;, 7: \u0026#34;seven\u0026#34;, 8: \u0026#34;eight\u0026#34;, 9: \u0026#34;nine\u0026#34;, 10: \u0026#34;ten\u0026#34;, 11: \u0026#34;eleven\u0026#34;, 12: \u0026#34;twelve\u0026#34;, 13: \u0026#34;thirteen\u0026#34;, 14: \u0026#34;fourteen\u0026#34;, 15: \u0026#34;fifteen\u0026#34;, 16: \u0026#34;sixteen\u0026#34;, 17: \u0026#34;seventeen\u0026#34;, 18: \u0026#34;eighteen\u0026#34;, 19: \u0026#34;nineteen\u0026#34;, 20: \u0026#34;twenty\u0026#34;, 30: \u0026#34;thirty\u0026#34;, 40: \u0026#34;forty\u0026#34;, 50: \u0026#34;fifty\u0026#34;, 60: \u0026#34;sixty\u0026#34;, 70: \u0026#34;seventy\u0026#34;, 80: \u0026#34;eighty\u0026#34;, 90: \u0026#34;ninety\u0026#34;} // CountLetters count the letters in a long string number representation func CountLetters(limit int) { myLongNumberString := \u0026#34;\u0026#34; for i := 1; i \u0026lt;= limit; i++ { addLettersToMyString(\u0026amp;myLongNumberString, i) } // fmt.","title":"Converting numbers into string representations"},{"content":"So, recently, the tester team talked to me, that their build takes too long, and why is that? A quick look at their configuration and build scripts showed me, that they are actually using a vagrant box, which never gets destroyed or re-started at least. To remedy this problem, I came up with the following solution.\nSame old. Same as in my previous post, we are going to build a Windows Machine for this purpose. The only addition to my previous settings, will be some Java install, downloading selenium and installing Chrome, and Firefox.\nInstallation Answer File Here is the configuration and setup of Windows before the provision phase.\n... \u0026lt;SynchronousCommand wcm:action=\u0026#34;add\u0026#34;\u0026gt; \u0026lt;CommandLine\u0026gt;cmd.exe /c C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -File a:\\jdk_inst.ps1 -AutoStart\u0026lt;/CommandLine\u0026gt; \u0026lt;Description\u0026gt;Install Java\u0026lt;/Description\u0026gt; \u0026lt;Order\u0026gt;103\u0026lt;/Order\u0026gt; \u0026lt;RequiresUserInput\u0026gt;true\u0026lt;/RequiresUserInput\u0026gt; \u0026lt;/SynchronousCommand\u0026gt; ... This is the part were I\u0026rsquo;m installing Java. The script for the jdk_inst.ps1 is in my previous post, but I\u0026rsquo;ll paste it here for ease of read.\nfunction LogWrite { Param ([string]$logstring) $now = Get-Date -format s Add-Content $Logfile -value \u0026#34;$now $logstring\u0026#34; Write-Host $logstring } $Logfile = \u0026#34;C:\\Windows\\Temp\\jdk-install.log\u0026#34; $JDK_VER=\u0026#34;7u75\u0026#34; $JDK_FULL_VER=\u0026#34;7u75-b13\u0026#34; $JDK_PATH=\u0026#34;1.7.0_75\u0026#34; $source86 = \u0026#34;http://download.oracle.com/otn-pub/java/jdk/$JDK_FULL_VER/jdk-$JDK_VER-windows-i586.exe\u0026#34; $source64 = \u0026#34;http://download.oracle.com/otn-pub/java/jdk/$JDK_FULL_VER/jdk-$JDK_VER-windows-x64.exe\u0026#34; $destination86 = \u0026#34;C:\\Windows\\Temp\\$JDK_VER-x86.exe\u0026#34; $destination64 = \u0026#34;C:\\Windows\\Temp\\$JDK_VER-x64.exe\u0026#34; $client = new-object System.Net.WebClient $cookie = \u0026#34;oraclelicense=accept-securebackup-cookie\u0026#34; $client.Headers.Add([System.Net.HttpRequestHeader]::Cookie, $cookie) LogWrite \u0026#34;Setting Execution Policy level to Bypass\u0026#34; Set-ExecutionPolicy -Scope CurrentUser -ExecutionPolicy Bypass -Force LogWrite \u0026#39;Checking if Java is already installed\u0026#39; if ((Test-Path \u0026#34;c:\\Program Files (x86)\\Java\u0026#34;) -Or (Test-Path \u0026#34;c:\\Program Files\\Java\u0026#34;)) { LogWrite \u0026#39;No need to Install Java\u0026#39; Exit } LogWrite \u0026#39;Downloading x86 to $destination86\u0026#39; try { $client.downloadFile($source86, $destination86) if (!(Test-Path $destination86)) { LogWrite \u0026#34;Downloading $destination86 failed\u0026#34; Exit } LogWrite \u0026#39;Downloading x64 to $destination64\u0026#39; $client.downloadFile($source64, $destination64) if (!(Test-Path $destination64)) { LogWrite \u0026#34;Downloading $destination64 failed\u0026#34; Exit } } catch [Exception] { LogWrite \u0026#39;$_.Exception is\u0026#39; $_.Exception } try { LogWrite \u0026#39;Installing JDK-x64\u0026#39; $proc1 = Start-Process -FilePath \u0026#34;$destination64\u0026#34; -ArgumentList \u0026#34;/s REBOOT=ReallySuppress\u0026#34; -Wait -PassThru $proc1.waitForExit() LogWrite \u0026#39;Installation Done.\u0026#39; LogWrite \u0026#39;Installing JDK-x86\u0026#39; $proc2 = Start-Process -FilePath \u0026#34;$destination86\u0026#34; -ArgumentList \u0026#34;/s REBOOT=ReallySuppress\u0026#34; -Wait -PassThru $proc2.waitForExit() LogWrite \u0026#39;Installtion Done.\u0026#39; } catch [exception] { LogWrite \u0026#39;$_ is\u0026#39; $_ LogWrite \u0026#39;$_.GetType().FullName is\u0026#39; $_.GetType().FullName LogWrite \u0026#39;$_.Exception is\u0026#39; $_.Exception LogWrite \u0026#39;$_.Exception.GetType().FullName is\u0026#39; $_.Exception.GetType().FullName LogWrite \u0026#39;$_.Exception.Message is\u0026#39; $_.Exception.Message } if ((Test-Path \u0026#34;c:\\Program Files (x86)\\Java\u0026#34;) -Or (Test-Path \u0026#34;c:\\Program Files\\Java\u0026#34;)) { LogWrite \u0026#39;Java installed successfully.\u0026#39; } else { LogWrite \u0026#39;Java install Failed!\u0026#39; } LogWrite \u0026#39;Setting up Path variables.\u0026#39; [System.Environment]::SetEnvironmentVariable(\u0026#34;JAVA_HOME\u0026#34;, \u0026#34;c:\\Program Files (x86)\\Java\\jdk$JDK_PATH\u0026#34;, \u0026#34;Machine\u0026#34;) [System.Environment]::SetEnvironmentVariable(\u0026#34;PATH\u0026#34;, $Env:Path + \u0026#34;;c:\\Program Files (x86)\\Java\\jdk$JDK_PATH\\bin\u0026#34;, \u0026#34;Machine\u0026#34;) LogWrite \u0026#39;Done. Goodbye.\u0026#39; This installs both x86 and 64 bit version of Java.\nProvision I decided to put these into the provision phase to get log messages written out properly. Because in the unattended file, you can\u0026rsquo;t see any progress.\nChrome And Firefox Installing these two proved a little bit more difficult. Chrome didn\u0026rsquo;t really like me to download their installer without accepting something first, like Java. Luckily, after a LOT of digging, I found a chrome installer which lets you install silently. Here is the script to install the two.\nfunction LogWrite { Param ([string]$logstring) $now = Get-Date -format s Add-Content $Logfile -value \u0026#34;$now $logstring\u0026#34; Write-Host $logstring } function CheckLocation { Param ([string]$location) if (!(Test-Path $location)) { throw [System.IO.FileNotFoundException] \u0026#34;Could not download to Destination $location.\u0026#34; } } $Logfile = \u0026#34;C:\\Windows\\Temp\\chrome-firefox-install.log\u0026#34; $chrome_source = \u0026#34;http://dl.google.com/chrome/install/375.126/chrome_installer.exe\u0026#34; $chrome_destination = \u0026#34;C:\\Windows\\Temp\\chrome_installer.exe\u0026#34; $firefox_source = \u0026#34;https://download-installer.cdn.mozilla.net/pub/firefox/releases/39.0/win32/hu/Firefox%20Setup%2039.0.exe\u0026#34; $firefox_destination = \u0026#34;C:\\Windows\\Temp\\firefoxinstaller.exe\u0026#34; LogWrite \u0026#39;Starting to download files.\u0026#39; try { LogWrite \u0026#39;Downloading Chrome...\u0026#39; (New-Object System.Net.WebClient).DownloadFile($chrome_source, $chrome_destination) CheckLocation $chrome_destination LogWrite \u0026#39;Done...\u0026#39; LogWrite \u0026#39;Downloading Firefox...\u0026#39; (New-Object System.Net.WebClient).DownloadFile($firefox_source, $firefox_destination) CheckLocation $firefox_destination } catch [Exception] { LogWrite \u0026#34;Exception during download. Probable cause could be that the directory or the file didn\u0026#39;t exist.\u0026#34; LogWrite \u0026#39;$_.Exception is\u0026#39; $_.Exception } LogWrite \u0026#39;Starting firefox install process.\u0026#39; try { Start-Process -FilePath $firefox_destination -ArgumentList \u0026#34;-ms\u0026#34; -Wait -PassThru } catch [Exception] { LogWrite \u0026#39;Exception during install process.\u0026#39; LogWrite \u0026#39;$_.Exception is\u0026#39; $_.Exception } LogWrite \u0026#39;Starting chrome install process.\u0026#39; try { Start-Process -FilePath $chrome_destination -ArgumentList \u0026#34;/silent /install\u0026#34; -Wait -PassThru } catch [Exception] { LogWrite \u0026#39;Exception during install process.\u0026#39; LogWrite \u0026#39;$_.Exception is\u0026#39; $_.Exception } LogWrite \u0026#39;All done. Goodbye.\u0026#39; They both install silently. Pretty neat.\nSelenium This only has to be downloaded, so this is pretty simple. Vagrant will handle the startup of course when it does a vagrant up.\nfunction LogWrite { Param ([string]$logstring) $now = Get-Date -format s Add-Content $Logfile -value \u0026#34;$now $logstring\u0026#34; Write-Host $logstring } $Logfile = \u0026#34;C:\\Windows\\Temp\\selenium-install.log\u0026#34; $source = \u0026#34;http://selenium-release.storage.googleapis.com/2.46/selenium-server-standalone-2.46.0.jar\u0026#34; $destination = \u0026#34;C:\\Windows\\Temp\\selenium-server.jar\u0026#34; LogWrite \u0026#39;Starting to download selenium file.\u0026#39; try { (New-Object System.Net.WebClient).DownloadFile($source, $destination) } catch [Exception] { LogWrite \u0026#34;Exception during download. Probable cause could be that the directory or the file didn\u0026#39;t exist.\u0026#34; LogWrite \u0026#39;$_.Exception is\u0026#39; $_.Exception } LogWrite \u0026#39;Download done. Checking if file exists.\u0026#39; if (!(Test-Path $destination)) { LogWrite \u0026#39;Downloading dotnet Failed!\u0026#39; } else { LogWrite \u0026#39;Download successful.\u0026#39; } LogWrite \u0026#39;All done. Goodbye.\u0026#39; Straightforward.\nThe Packer Json File So putting this all together, here is the Packer JSON file for this:\n{ \u0026#34;variables\u0026#34;: { \u0026#34;vm_name\u0026#34;: \u0026#34;win7x64selenium\u0026#34;, \u0026#34;output_dir\u0026#34;: \u0026#34;output_win7_x64_selenium\u0026#34;, \u0026#34;vagrant_box_output\u0026#34;: \u0026#34;box_output\u0026#34;, \u0026#34;cpu_number\u0026#34;: \u0026#34;2\u0026#34;, \u0026#34;memory_size\u0026#34;: \u0026#34;4096\u0026#34;, \u0026#34;machine_type\u0026#34;: \u0026#34;pc-1.2\u0026#34;, \u0026#34;accelerator\u0026#34;: \u0026#34;kvm\u0026#34;, \u0026#34;disk_format\u0026#34;: \u0026#34;qcow2\u0026#34;, \u0026#34;disk_interface\u0026#34;: \u0026#34;virtio\u0026#34;, \u0026#34;net_device\u0026#34;: \u0026#34;virtio-net\u0026#34;, \u0026#34;cpu_model\u0026#34;: \u0026#34;host\u0026#34;, \u0026#34;disk_cache\u0026#34;: \u0026#34;writeback\u0026#34;, \u0026#34;disk_io\u0026#34;: \u0026#34;native\u0026#34; }, \u0026#34;builders\u0026#34;: [ { \u0026#34;type\u0026#34;: \u0026#34;virtualbox-iso\u0026#34;, \u0026#34;iso_url\u0026#34;: \u0026#34;/home/user/vms/windows7.iso\u0026#34;, \u0026#34;iso_checksum_type\u0026#34;: \u0026#34;sha1\u0026#34;, \u0026#34;iso_checksum\u0026#34;: \u0026#34;0BCFC54019EA175B1EE51F6D2B207A3D14DD2B58\u0026#34;, \u0026#34;headless\u0026#34;: true, \u0026#34;boot_wait\u0026#34;: \u0026#34;2m\u0026#34;, \u0026#34;ssh_username\u0026#34;: \u0026#34;vagrant\u0026#34;, \u0026#34;ssh_password\u0026#34;: \u0026#34;vagrant\u0026#34;, \u0026#34;ssh_wait_timeout\u0026#34;: \u0026#34;8h\u0026#34;, \u0026#34;shutdown_command\u0026#34;: \u0026#34;shutdown /s /t 10 /f /d p:4:1 /c \\\u0026#34;Packer Shutdown\\\u0026#34;\u0026#34;, \u0026#34;guest_os_type\u0026#34;: \u0026#34;Windows7_64\u0026#34;, \u0026#34;disk_size\u0026#34;: 61440, \u0026#34;floppy_files\u0026#34;: [ \u0026#34;./answer_files/7-selenium/Autounattend.xml\u0026#34;, \u0026#34;./scripts/dis-updates.ps1\u0026#34;, \u0026#34;./scripts/microsoft-updates.bat\u0026#34;, \u0026#34;./scripts/openssh.ps1\u0026#34;, \u0026#34;./scripts/jdk_inst.ps1\u0026#34; ], \u0026#34;vboxmanage\u0026#34;: [ [ \u0026#34;modifyvm\u0026#34;, \u0026#34;{{.Name}}\u0026#34;, \u0026#34;--memory\u0026#34;, \u0026#34;{{user `memory_size`}}\u0026#34; ], [ \u0026#34;modifyvm\u0026#34;, \u0026#34;{{.Name}}\u0026#34;, \u0026#34;--cpus\u0026#34;, \u0026#34;{{user `cpu_number`}}\u0026#34; ] ] } ], \u0026#34;provisioners\u0026#34;: [ { \u0026#34;type\u0026#34;: \u0026#34;powershell\u0026#34;, \u0026#34;scripts\u0026#34; : [ \u0026#34;./scripts/install-selenium-server.ps1\u0026#34;, \u0026#34;./scripts/install-chrome-firefox.ps1\u0026#34; ] },{ \u0026#34;type\u0026#34;: \u0026#34;shell\u0026#34;, \u0026#34;remote_path\u0026#34;: \u0026#34;/tmp/script.bat\u0026#34;, \u0026#34;execute_command\u0026#34;: \u0026#34;{{.Vars}} cmd /c C:/Windows/Temp/script.bat\u0026#34;, \u0026#34;scripts\u0026#34;: [ \u0026#34;./scripts/vm-guest-tools.bat\u0026#34;, \u0026#34;./scripts/vagrant-ssh.bat\u0026#34;, \u0026#34;./scripts/rsync.bat\u0026#34;, \u0026#34;./scripts/enable-rdp.bat\u0026#34; ] } ], \u0026#34;post-processors\u0026#34;: [ { \u0026#34;type\u0026#34;: \u0026#34;vagrant\u0026#34;, \u0026#34;keep_input_artifact\u0026#34;: false, \u0026#34;output\u0026#34;: \u0026#34;{{user `vm_name`}}_{{.Provider}}.box\u0026#34;, \u0026#34;vagrantfile_template\u0026#34;: \u0026#34;vagrantfile-template\u0026#34; } ] } Additional Software This is not done here. Obviously, in order to test your stuff, you first need to install your software on this box. Ideally, everything you need should be in the code you clone to this box, and should be contained mostly. And your application deployment should take core of that. But, if you require something like a DB, postgres, oracle, whatnot, than this is the place where you would install all that.\nVagrant and Using the Packer Box Now, this has been interesting so far, but how do you actually go about using this image? That\u0026rsquo;s the real question now, isn\u0026rsquo;t it? Having a box, just sitting on a shared folder, doesn\u0026rsquo;t do you too much good. So let\u0026rsquo;s create a Jenkins job, which utilizes this box in a job which runs a bunch of tests for some application.\nVagrantfile Your vagrant file, could either be generated automatically, under source control ( which is preferred ) or sitting somewhere entirely elsewhere. In any case, it would look something like this.\n# -*- mode: ruby -*- # vi: set ft=ruby : VAGRANTFILE_API_VERSION = \u0026#34;2\u0026#34; Vagrant.configure(VAGRANTFILE_API_VERSION) do |config| config.vm.provider \u0026#34;virtualbox\u0026#34; config.vm.define \u0026#34;selenium-box\u0026#34; do |vs2013| vs2013.vm.box = \u0026#34;windows7-x64-04-selenium\u0026#34; vs2013.vm.box_url = \u0026#34;path/to/your/share/win7x64_selenium_virtualbox.box\u0026#34; end config.env.enable config.vm.guest = :windows config.vm.communicator = \u0026#34;winrm\u0026#34; config.winrm.username = \u0026#34;vagrant\u0026#34; config.winrm.password = \u0026#34;vagrant\u0026#34; config.windows.set_work_network = true config.vm.network :forwarded_port, guest: 3389, host: ENV[\u0026#39;RDESKTOP_PORT\u0026#39;], host_ip: \u0026#34;0.0.0.0\u0026#34; config.vm.network :forwarded_port, guest: 5985, host: 5985, id: \u0026#34;winrm\u0026#34;, auto_correct: true, host_ip: \u0026#34;0.0.0.0\u0026#34; config.vm.network :forwarded_port, guest: 9991, host: 9991, id: \u0026#34;selenium\u0026#34;, auto_correct: true, host_ip: \u0026#34;0.0.0.0\u0026#34; config.vm.provider :virtualbox do |vbox| vbox.gui = false vbox.memory = 4096 vbox.cpus = 2 end config.winrm.max_tries = 10 config.vm.synced_folder \u0026#34;.\u0026#34;, \u0026#34;/vagrant\u0026#34;, type: \u0026#34;rsync\u0026#34; config.vm.provision \u0026#34;shell\u0026#34;, path: \u0026#34;init.bat\u0026#34; config.vm.provision \u0026#34;shell\u0026#34;, path: \u0026#34;utils_inst.bat\u0026#34; config.vm.provision \u0026#34;shell\u0026#34;, path: \u0026#34;jenkins_reg.ps1\u0026#34; config.vm.provision \u0026#34;shell\u0026#34;, path: \u0026#34;start_selenium.bat\u0026#34; end Easy, no? Here is the script to start selenium.\njava -jar c:\\Windows\\Temp\\selenium-server.jar -Dhttp.proxyPort=9991 Straight forward. We also are forwarding the port on which Selenium is running in order for the test to see it.\nThe Jenkins Job The job can be anything. This is actually too large to cover here. It could be a gradle job, a maven job, an ant, a nant - or whatever is running the test -, job; it\u0026rsquo;s up to you.\nJust make sure that before the test runs, do a vagrant up and after the test finishes, in an ALWAYS TO BE EXECUTED HOOK -like gradle\u0026rsquo;s finalizedBy , call a vagrant destroy. This way, your test will always run on a clean instance that has the necessary stuff on it.\nClosing words So, there you have it. It\u0026rsquo;s relatively simple. Tying this all into your infrastructure might prove difficult though depending on how rigid your deployment is. But it will always help you make your tests a bit more robust.\nAlso, you could run the whole deployment and test phase on a vagrant box, from the start, which is tied to jenkins as a slave and gets started when the job starts and destroyed when the job ends. That way you wouldn\u0026rsquo;t have to create a, box in a box running on a box, kind of effect.\nThanks for reading,\nGergely.\n","permalink":"https://skarlso.github.io/2015/07/16/selenium-testing-with-packer-and-vagrant/","summary":"\u003cp\u003eSo, recently, the tester team talked to me, that their build takes too long, and why is that? A quick look at their configuration and build scripts showed me, that they are actually using a vagrant box, which never gets destroyed or re-started at least. To remedy this problem, I came up with the following solution.\u003c/p\u003e","title":"Selenium Testing with Packer and Vagrant"},{"content":"The first, and only time so far, that I got to use the bitwise \u0026amp; operator. I enjoyed doing so!!\nAnd of course from now on, I\u0026rsquo;ll be looking for more opportunities to (ab)use it.\npackage secret import \u0026#34;sort\u0026#34; const REVERSE = 16 func Handshake(code int) []string { // binary_rep := convertDecimalToBinary(code) if code \u0026lt; { return nil } secret_map := map[int]string { 1: \u0026#34;wink\u0026#34;, 2: \u0026#34;double blink\u0026#34;, 4: \u0026#34;close your eyes\u0026#34;, 8: \u0026#34;jump\u0026#34;, } var keys []int for k := range secret_map { keys = append(keys, k) } // To make sure iteration is always in the same order. sort.Ints(keys) code_array := make([]string, ) for _, key := range keys { if code \u0026amp; key == key { code_array = append(code_array, secret_map[key]) } } if code \u0026amp; REVERSE == REVERSE { code_array = reverse_array(code_array) } return code_array } func reverse_array (array_to_reverse []string) []string { for i, j := , len(array_to_reverse) -1 ; i \u0026lt; j; i, j = i + 1, j - 1 { array_to_reverse[i], array_to_reverse[j] = array_to_reverse[j], array_to_reverse[i] } return array_to_reverse } ","permalink":"https://skarlso.github.io/2015/07/15/bitwise-operator/","summary":"The first, and only time so far, that I got to use the bitwise \u0026amp; operator. I enjoyed doing so!!\nAnd of course from now on, I\u0026rsquo;ll be looking for more opportunities to (ab)use it.\npackage secret import \u0026#34;sort\u0026#34; const REVERSE = 16 func Handshake(code int) []string { // binary_rep := convertDecimalToBinary(code) if code \u0026lt; { return nil } secret_map := map[int]string { 1: \u0026#34;wink\u0026#34;, 2: \u0026#34;double blink\u0026#34;, 4: \u0026#34;close your eyes\u0026#34;, 8: \u0026#34;jump\u0026#34;, } var keys []int for k := range secret_map { keys = append(keys, k) } // To make sure iteration is always in the same order.","title":"Bitwise \u0026 Operator"},{"content":"Previously I wrote that the scripts I\u0026rsquo;m writing, are failing because Packer hangs.\nApparently, this was a known issue. And apparently, I was using an older version, 0.7.5. After I updated everything is working wonderfully!!!\nAnd for my thanks, here is an updated PowerShell script for provisioning my dotnet stuff.\n$source = \u0026#34;http://download.microsoft.com/download/1/6/7/167F0D79-9317-48AE-AEDB-17120579F8E2/NDP451-KB2858728-x86-x64-AllOS-ENU.exe\u0026#34; $destination = \u0026#34;C:\\Windows\\Temp\\dotnet.exe\u0026#34; Write-Host \u0026#39;Starting to download dotnet file.\u0026#39; try { (New-Object System.Net.WebClient).DownloadFile($source, $destination) } catch [Exception] { Write-Host \u0026#34;Exception during download. Probable cause could be that the directory or the file didn\u0026#39;t exist.\u0026#34; Write-Host \u0026#39;$_.Exception is\u0026#39; $_.Exception } Write-Host \u0026#39;Download done. Checking if file exists.\u0026#39; if (!(Test-Path $destination)) { Write-Host \u0026#39;Downloading dotnet Failed!\u0026#39; } else { Write-Host \u0026#39;Download successful.\u0026#39; } Write-Host \u0026#39;Starting install process.\u0026#39; try { Start-Process -FilePath $source -ArgumentList \u0026#34;/q /norestart\u0026#34; -Wait -PassThru } catch [Exception] { Write-Host \u0026#39;Exception during install process.\u0026#39; Write-Host \u0026#39;$_.Exception is\u0026#39; $_.Exception } Write-Host \u0026#39;All done. Goodbye.\u0026#39; Thanks for reading!\nGergely.\n","permalink":"https://skarlso.github.io/2015/07/01/packer-0-8-1/","summary":"Previously I wrote that the scripts I\u0026rsquo;m writing, are failing because Packer hangs.\nApparently, this was a known issue. And apparently, I was using an older version, 0.7.5. After I updated everything is working wonderfully!!!\nAnd for my thanks, here is an updated PowerShell script for provisioning my dotnet stuff.\n$source = \u0026#34;http://download.microsoft.com/download/1/6/7/167F0D79-9317-48AE-AEDB-17120579F8E2/NDP451-KB2858728-x86-x64-AllOS-ENU.exe\u0026#34; $destination = \u0026#34;C:\\Windows\\Temp\\dotnet.exe\u0026#34; Write-Host \u0026#39;Starting to download dotnet file.\u0026#39; try { (New-Object System.Net.WebClient).DownloadFile($source, $destination) } catch [Exception] { Write-Host \u0026#34;Exception during download.","title":"Packer 0.8.1."},{"content":"Hello folks.\nToday, I would like to show you a small script. It installs Java JDK, both version, x86 and 64 bit, silently, and wait for that process to finish.\nThe wait is necessary because /s on a java install has the nasty habit of running in the background. If you are using a .bat file, you shouldn\u0026rsquo;t, than you would use something like: start /w jdk-setup.exe /s. This gets it done, but is ugly. Also, if you are using Packer and PowerShell provisioning, you might want to set up some environment variables as well for the next script. And you want that property to be available and you don\u0026rsquo;t want to mess it up with setting a path into a file and then re-setting your path on the begin of your other script. Or pass it around with Packer. No. Use a proper PowerShell script. Learn it. It\u0026rsquo;s not that hard. Be a professional. Don\u0026rsquo;t hack something together for the next person to suffer at.\nHere is how I did it. Hope it helps somebody out.\n$JDK_VER=\u0026#34;7u75\u0026#34; $JDK_FULL_VER=\u0026#34;7u75-b13\u0026#34; $JDK_PATH=\u0026#34;1.7.0_75\u0026#34; $source86 = \u0026#34;http://download.oracle.com/otn-pub/java/jdk/$JDK_FULL_VER/jdk-$JDK_VER-windows-i586.exe\u0026#34; $source64 = \u0026#34;http://download.oracle.com/otn-pub/java/jdk/$JDK_FULL_VER/jdk-$JDK_VER-windows-x64.exe\u0026#34; $destination86 = \u0026#34;C:\\vagrant\\$JDK_VER-x86.exe\u0026#34; $destination64 = \u0026#34;C:\\vagrant\\$JDK_VER-x64.exe\u0026#34; $client = new-object System.Net.WebClient $cookie = \u0026#34;oraclelicense=accept-securebackup-cookie\u0026#34; $client.Headers.Add([System.Net.HttpRequestHeader]::Cookie, $cookie) Write-Host \u0026#39;Checking if Java is already installed\u0026#39; if ((Test-Path \u0026#34;c:\\Program Files (x86)\\Java\u0026#34;) -Or (Test-Path \u0026#34;c:\\Program Files\\Java\u0026#34;)) { Write-Host \u0026#39;No need to Install Java\u0026#39; Exit } Write-Host \u0026#39;Downloading x86 to $destination86\u0026#39; $client.downloadFile($source86, $destination86) if (!(Test-Path $destination86)) { Write-Host \u0026#34;Downloading $destination86 failed\u0026#34; Exit } Write-Host \u0026#39;Downloading x64 to $destination64\u0026#39; $client.downloadFile($source64, $destination64) if (!(Test-Path $destination64)) { Write-Host \u0026#34;Downloading $destination64 failed\u0026#34; Exit } try { Write-Host \u0026#39;Installing JDK-x64\u0026#39; $proc1 = Start-Process -FilePath \u0026#34;$destination64\u0026#34; -ArgumentList \u0026#34;/s REBOOT=ReallySuppress\u0026#34; -Wait -PassThru $proc1.waitForExit() Write-Host \u0026#39;Installation Done.\u0026#39; Write-Host \u0026#39;Installing JDK-x86\u0026#39; $proc2 = Start-Process -FilePath \u0026#34;$destination86\u0026#34; -ArgumentList \u0026#34;/s REBOOT=ReallySuppress\u0026#34; -Wait -PassThru $proc2.waitForExit() Write-Host \u0026#39;Installtion Done.\u0026#39; } catch [exception] { write-host \u0026#39;$_ is\u0026#39; $_ write-host \u0026#39;$_.GetType().FullName is\u0026#39; $_.GetType().FullName write-host \u0026#39;$_.Exception is\u0026#39; $_.Exception write-host \u0026#39;$_.Exception.GetType().FullName is\u0026#39; $_.Exception.GetType().FullName write-host \u0026#39;$_.Exception.Message is\u0026#39; $_.Exception.Message } if ((Test-Path \u0026#34;c:\\Program Files (x86)\\Java\u0026#34;) -Or (Test-Path \u0026#34;c:\\Program Files\\Java\u0026#34;)) { Write-Host \u0026#39;Java installed successfully.\u0026#39; } Write-Host \u0026#39;Setting up Path variables.\u0026#39; [System.Environment]::SetEnvironmentVariable(\u0026#34;JAVA_HOME\u0026#34;, \u0026#34;c:\\Program Files (x86)\\Java\\jdk$JDK_PATH\u0026#34;, \u0026#34;Machine\u0026#34;) [System.Environment]::SetEnvironmentVariable(\u0026#34;PATH\u0026#34;, $Env:Path + \u0026#34;;c:\\Program Files (x86)\\Java\\jdk$JDK_PATH\\bin\u0026#34;, \u0026#34;Machine\u0026#34;) Write-Host \u0026#39;Done. Goodbye.\u0026#39; Now, there is room for improvement here. Like checking exit code, doing something extra after a failed exit. Throwing an exception, and so on and so forth. But this is a much needed improvement from calling a BAT file.\nAnd you would use this in a Packer JSON file like this..\n{ \u0026#34;type\u0026#34;: \u0026#34;powershell\u0026#34;, \u0026#34;scripts\u0026#34;: [ \u0026#34;./scripts/jdk_inst.ps1\u0026#34; ] } Easy. And at the end, the System.Environment actually writes out into the registry permanently so no need to pass it around in a file or something ugly like that.\nHope this helps somebody.\nThanks for reading.\nGergely.\n","permalink":"https://skarlso.github.io/2015/06/30/powershell-can-also-be-nice-or-installing-java-silently-and-waiting/","summary":"Hello folks.\nToday, I would like to show you a small script. It installs Java JDK, both version, x86 and 64 bit, silently, and wait for that process to finish.\nThe wait is necessary because /s on a java install has the nasty habit of running in the background. If you are using a .bat file, you shouldn\u0026rsquo;t, than you would use something like: start /w jdk-setup.exe /s. This gets it done, but is ugly.","title":"Powershell can also be nice -Or Installing Java silently and waiting"},{"content":"Hello folks.\nToday, I would like to write about something close to my heart recently. I\u0026rsquo;ve been fiddling with Packer, Windows and Vagrant these days. Trying to get a Windows box up in running is a pain in the arse though, so I thought I share my pain with you nice folks out there. Let\u0026rsquo;s begin.\nSetup First things first. You need Packer, and Vagrant obviously. I\u0026rsquo;ll leave the install up to you. Next, you should clone this git repo =\u0026gt; Packer Windows Plugin. This plugin contains all the files necessary to get, install, and provision Windows boxes. Luckily, some very nice and clever folks, figured out a lot of things about how to install stuff on Windows. And given that people at Microsoft realised that sys admins would like to install stuff remotely, there are a bunch of forums and places where you can search for how to install software without user interaction. And this is the keyword you should look for =\u0026gt; unattended Windows install.\nThis will lead you further into the bowls of Windows technology and silent / quiet installs all over the place.\nPacker and Answer Files When it comes to installing software on Windows, you have quite a few obstacles to overtake. One of the biggest obstacle you are facing, are restarts. Windows has a special place in hell for that. Every time you install something important which requires system libraries or other kind of configuration which \u0026ldquo;will only take effect after you restart Windows\u0026rdquo; you have to do a restart. Now, a little background on how Packer interacts with Windows. At the moment, it uses OpenSSH to talk to the box which has to be the last which comes up. If it looses connection to openssh because, I don\u0026rsquo;t know, it restarted itself, you loose communication to the box, and the setup process stops in mid tracks.\nIf you read about that in an earlier attempt to overtake this, you saw that you could use time-outs. You could kill ssh process which presumably makes packer do an attempt to start a new connection. If you are like me, you experienced that Packer does indeed NOT re-try. Because the previous task couldn\u0026rsquo;t finish, the restart killed the ssh service which could tell Packer that the previous task, an install for example, has finished. Hence, Packer will stay there and wait for that task to complete; which will never happen at this point.\nWhat can we do? Enter the world of Answer Files. Basically, it\u0026rsquo;s an xml file which sets up Windows. When Packer is running this file, the last service which should be installed, must be openSSH. And after that, in the provisioning phase, you should only install software which does not require restarts.\nLet\u0026rsquo;s look at an example.\nExample #1: Windows Updates This is another layer of purgatory for Windows. It\u0026rsquo;s updates. The updates take massive amount of times, if you are doing them from scratch, and also require several restart before it\u0026rsquo;s actually done. You **could **speed up the process a little bit, if you have a private network share where all of the Windows updates are sitting. At least that way you don\u0026rsquo;t have to download them every time you are creating a box. But you can\u0026rsquo;t avert the install process itself.\nLet\u0026rsquo;s look at a setup for packer. Packer works with JSON files for it\u0026rsquo;s configuration. An example for a Windows 7 box would look something like this:\n{ \u0026#34;builders\u0026#34;: [ { \u0026#34;type\u0026#34;: \u0026#34;vmware-iso\u0026#34;, \u0026#34;iso_url\u0026#34;: \u0026#34;http://care.dlservice.microsoft.com/dl/download/evalx/win7/x64/EN/7600.16385.090713-1255_x64fre_enterprise_en-us_EVAL_Eval_Enterprise-GRMCENXEVAL_EN_DVD.iso\u0026#34;, \u0026#34;iso_checksum_type\u0026#34;: \u0026#34;md5\u0026#34;, \u0026#34;iso_checksum\u0026#34;: \u0026#34;1d0d239a252cb53e466d39e752b17c28\u0026#34;, \u0026#34;headless\u0026#34;: true, \u0026#34;boot_wait\u0026#34;: \u0026#34;2m\u0026#34;, \u0026#34;ssh_username\u0026#34;: \u0026#34;vagrant\u0026#34;, \u0026#34;ssh_password\u0026#34;: \u0026#34;vagrant\u0026#34;, \u0026#34;ssh_wait_timeout\u0026#34;: \u0026#34;8h\u0026#34;, \u0026#34;shutdown_command\u0026#34;: \u0026#34;shutdown /s /t 10 /f /d p:4:1 /c \\\u0026#34;Packer Shutdown\\\u0026#34;\u0026#34;, \u0026#34;guest_os_type\u0026#34;: \u0026#34;windows7-64\u0026#34;, \u0026#34;tools_upload_flavor\u0026#34;: \u0026#34;windows\u0026#34;, \u0026#34;disk_size\u0026#34;: 61440, \u0026#34;vnc_port_min\u0026#34;: 5900, \u0026#34;vnc_port_max\u0026#34;: 5980, \u0026#34;floppy_files\u0026#34;: [ \u0026#34;./answer_files/7/Autounattend.xml\u0026#34;, \u0026#34;./scripts/dis-updates.ps1\u0026#34;, \u0026#34;./scripts/microsoft-updates.bat\u0026#34;, \u0026#34;./scripts/win-updates.ps1\u0026#34;, \u0026#34;./scripts/openssh.ps1\u0026#34; ], \u0026#34;vmx_data\u0026#34;: { \u0026#34;RemoteDisplay.vnc.enabled\u0026#34;: \u0026#34;false\u0026#34;, \u0026#34;RemoteDisplay.vnc.port\u0026#34;: \u0026#34;5900\u0026#34;, \u0026#34;memsize\u0026#34;: \u0026#34;2048\u0026#34;, \u0026#34;numvcpus\u0026#34;: \u0026#34;2\u0026#34;, \u0026#34;scsi0.virtualDev\u0026#34;: \u0026#34;lsisas1068\u0026#34; } }, { \u0026#34;type\u0026#34;: \u0026#34;virtualbox-iso\u0026#34;, \u0026#34;iso_url\u0026#34;: \u0026#34;http://care.dlservice.microsoft.com/dl/download/evalx/win7/x64/EN/7600.16385.090713-1255_x64fre_enterprise_en-us_EVAL_Eval_Enterprise-GRMCENXEVAL_EN_DVD.iso\u0026#34;, \u0026#34;iso_checksum_type\u0026#34;: \u0026#34;md5\u0026#34;, \u0026#34;iso_checksum\u0026#34;: \u0026#34;1d0d239a252cb53e466d39e752b17c28\u0026#34;, \u0026#34;headless\u0026#34;: true, \u0026#34;boot_wait\u0026#34;: \u0026#34;2m\u0026#34;, \u0026#34;ssh_username\u0026#34;: \u0026#34;vagrant\u0026#34;, \u0026#34;ssh_password\u0026#34;: \u0026#34;vagrant\u0026#34;, \u0026#34;ssh_wait_timeout\u0026#34;: \u0026#34;8h\u0026#34;, \u0026#34;shutdown_command\u0026#34;: \u0026#34;shutdown /s /t 10 /f /d p:4:1 /c \\\u0026#34;Packer Shutdown\\\u0026#34;\u0026#34;, \u0026#34;guest_os_type\u0026#34;: \u0026#34;Windows7_64\u0026#34;, \u0026#34;disk_size\u0026#34;: 61440, \u0026#34;floppy_files\u0026#34;: [ \u0026#34;./answer_files/7/Autounattend.xml\u0026#34;, \u0026#34;./scripts/dis-updates.ps1\u0026#34;, \u0026#34;./scripts/microsoft-updates.bat\u0026#34;, \u0026#34;./scripts/win-updates.ps1\u0026#34;, \u0026#34;./scripts/openssh.ps1\u0026#34;, \u0026#34;./scripts/oracle-cert.cer\u0026#34; ], \u0026#34;vboxmanage\u0026#34;: [ [ \u0026#34;modifyvm\u0026#34;, \u0026#34;{{.Name}}\u0026#34;, \u0026#34;--memory\u0026#34;, \u0026#34;2048\u0026#34; ], [ \u0026#34;modifyvm\u0026#34;, \u0026#34;{{.Name}}\u0026#34;, \u0026#34;--cpus\u0026#34;, \u0026#34;2\u0026#34; ] ] } ], \u0026#34;provisioners\u0026#34;: [ { \u0026#34;type\u0026#34;: \u0026#34;shell\u0026#34;, \u0026#34;remote_path\u0026#34;: \u0026#34;/tmp/script.bat\u0026#34;, \u0026#34;execute_command\u0026#34;: \u0026#34;{{.Vars}} cmd /c C:/Windows/Temp/script.bat\u0026#34;, \u0026#34;scripts\u0026#34;: [ \u0026#34;./scripts/vm-guest-tools.bat\u0026#34;, \u0026#34;./scripts/chef.bat\u0026#34;, \u0026#34;./scripts/vagrant-ssh.bat\u0026#34;, \u0026#34;./scripts/disable-auto-logon.bat\u0026#34;, \u0026#34;./scripts/enable-rdp.bat\u0026#34;, \u0026#34;./scripts/compile-dotnet-assemblies.bat\u0026#34;, \u0026#34;./scripts/compact.bat\u0026#34; ] } ], \u0026#34;post-processors\u0026#34;: [ { \u0026#34;type\u0026#34;: \u0026#34;vagrant\u0026#34;, \u0026#34;keep_input_artifact\u0026#34;: false, \u0026#34;output\u0026#34;: \u0026#34;windows_7_{{.Provider}}.box\u0026#34;, \u0026#34;vagrantfile_template\u0026#34;: \u0026#34;vagrantfile-windows_7.template\u0026#34; } ] } If it feels daunting, don\u0026rsquo;t worry. You\u0026rsquo;ll get used to it fairly quickly. Let\u0026rsquo;s go over section by section on what this does.\nBuilders Packer uses builders for, well, building stuff. These two builders are virtualbox and vmware. I\u0026rsquo;m only interested in virtualbox. This builder downloads win7 and sets up some virtual box details like, disk size, vagrant user, memory, and so and so forth. The interesting part is the floppy part. Here, we can add in some files for setup. We will use this part later on.\nProvisioners Now here is an interesting tid-bit. There are a bunch of provisioners available as plugin for packer. Installing them is fairly easy. Packer needs binary plugins. Just copy them into ~/.packer.d/plugins or directly into the packer home directly. I\u0026rsquo;d advice against that. Have them in your own packer.d, that\u0026rsquo;s much cleaner. For binary plugin releases in the Windows side, look here =\u0026gt; https://github.com/packer-community/packer-windows-plugins/releases. If you would like to build them yourself from source, download the source and use go gcc to build it. You will have to go get a few packages though. Also you will have to have $GOPATH (pointing to your own workspace) and $GOROOT (pointing to your working go) setup. But this is not a Go guide. After that just do **go build main.go **and you have your plugin.\nProvisioners are like vagrant provision they will execute post setup stuff on your box. Like installing utils, 7zip, choco, nuget, and so and so forth. There are a few interesting Windows provisioners, like restart-windows, powershell, and Windows shell. Which is like shell, but without the need of pre-setup if you are trying to use it on Windows. The basic shell on Windows is a little clanky and can hang from time-to-time so I recommend using PowerShell or WindowsShell provisioner if you are dealing with Windows post-setup Setup.\nPost-Processor This will create the Vagrant box after everything is done.\nRunning the Update For use, two things are interesting from here at this moment. These guys =\u0026gt;\n\u0026#34;./scripts/microsoft-updates.bat\u0026#34;, \u0026#34;./scripts/win-updates.ps1\u0026#34;, These two contain most of the logic which is part of the update process. You should see it in your checked out source. There is some very interesting logic in there which describes how the update happens. Basically it\u0026rsquo;s a loop which re-checks if there are updates available or if a re-start is needed. Packer handles re-starts well at this point in the install because it simply waits for SSH to come only. The rest is handled by Windows.\nThese scripts are called in the Answer File which the Windows Setup uses for configuration purposes. Take a look at this section:\n\u0026lt;SynchronousCommand wcm:action=\u0026#34;add\u0026#34;\u0026gt; \u0026lt;CommandLine\u0026gt;cmd.exe /c a:\\microsoft-updates.bat\u0026lt;/CommandLine\u0026gt; \u0026lt;Order\u0026gt;98\u0026lt;/Order\u0026gt; \u0026lt;Description\u0026gt;Enable Microsoft Updates\u0026lt;/Description\u0026gt; \u0026lt;/SynchronousCommand\u0026gt; \u0026lt;SynchronousCommand wcm:action=\u0026#34;add\u0026#34;\u0026gt; \u0026lt;CommandLine\u0026gt;cmd.exe /c C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -File a:\\win-updates.ps1 -MaxUpdatesPerCycle 30\u0026lt;/CommandLine\u0026gt; \u0026lt;Description\u0026gt;Install Windows Updates\u0026lt;/Description\u0026gt; \u0026lt;Order\u0026gt;100\u0026lt;/Order\u0026gt; \u0026lt;RequiresUserInput\u0026gt;true\u0026lt;/RequiresUserInput\u0026gt; \u0026lt;/SynchronousCommand\u0026gt; This is were the floppy part comes on handy. This part uses the scripts bound by floppy and which will be available from a:.\nThis will install all the updates available. It will take a while. A very very long while. But let\u0026rsquo;s go a step further.\nExample #2: Installing DotNet 4.5 Let\u0026rsquo;s assume you want to create a box with visual studio 2013, office, and have choco on it, and a couple of more things for which you need lots of restarts. You could try installing with /norestart switch, which also works; however if you definitely need it to restart I suggest installing stuff with the Answer File. For this, let\u0026rsquo;s create a PowerShell script which downloads and installs dotnet 451 which is needed for visual studio ultimate 2013.\n$Logfile = \u0026#34;C:\\Windows\\Temp\\dotnet-install.log\u0026#34; function LogWrite { Param ([string]$logstring) $now = Get-Date -format s Add-Content $Logfile -value \u0026#34;$now $logstring\u0026#34; Write-Host $logstring } LogWrite \u0026#34;Downlading dotNetFx40_Full_x86_x64.\u0026#34; try { (New-Object System.Net.WebClient).DownloadFile(\u0026#39;http://download.microsoft.com/download/1/6/7/167F0D79-9317-48AE-AEDB-17120579F8E2/NDP451-KB2858728-x86-x64-AllOS-ENU.exe\u0026#39;, \u0026#39;C:\\Windows\\Temp\\dotnet.exe\u0026#39;) } catch { LogWrite $_.Exception | Format-List -force LogWrite \u0026#34;Failed to download file.\u0026#34; } LogWrite \u0026#34;Starting installation process...\u0026#34; try { Start-Process -FilePath \u0026#34;C:\\Windows\\Temp\\dotnet.exe\u0026#34; -ArgumentList \u0026#34;/I /q /norestart\u0026#34; -Wait -PassThru } catch { LogWrite $_.Exception | Format-List -force LogWrite \u0026#34;Exception during install process.\u0026#34; } So this downloads it right from the source. As mentioned earlier, you could have this on a nice shared drive so downloading from the internet is not necessary. The installer is in fact a bit friendly. It has a switch called /q /norestart. The /q is called silent install and the /norestart speaks for itself. If you leave it out, you can use /forcerestart or you could have the following two lines after this finishes: LogWrite \u0026ldquo;Resarting Computer.\u0026rdquo; Restart-Computer -Force. This will force a restart. You need the -Force because otherwise it won\u0026rsquo;t let it restart while there are active sessions logged on the computer.\nNow, let\u0026rsquo;s add this to the answer file:\n\u0026lt;SynchronousCommand wcm:action=\u0026#34;add\u0026#34;\u0026gt; \u0026lt;CommandLine\u0026gt;cmd.exe /c C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -File a:\\install-dotnet-451.ps1 -AutoStart\u0026lt;/CommandLine\u0026gt; \u0026lt;Order\u0026gt;98\u0026lt;/Order\u0026gt; \u0026lt;Description\u0026gt;Install DotNet 4.5.1.\u0026lt;/Description\u0026gt; \u0026lt;/SynchronousCommand\u0026gt; See, how easy this is? And now we make use of the floppy part of the windows-7.json by adding this line: \u0026quot;./scripts/install-dotnet-451.ps1\u0026quot;. Don\u0026rsquo;t forget to append the \u0026ldquo;,\u0026rdquo; at the end of the previous line. This is an array.\nWe are ready to go. Just run packer build -only=virtualbox-iso windows-7.json and you should be done!\nExample #3: Installing Visual Studio Ultimate Installing visual studio is almost trivial as well. With the addition that visual studio requires an admin.xml for silent install which has a bunch of settings. When you have the admin.xml just bind it into the floppy drive as well and call the visual studio install powershell script like this:\nStart-Process -FilePath \u0026#34;C:\\Windows\\Temp\\visualstudioultimate.exe\u0026#34; -ArgumentList \u0026#34;/Quiet /NoRestart /admin a:\\admin.xml\u0026#34; -Wait -PassThru Again, this will take a while\u0026hellip;..\nPost Setup Provisioning When all this is done, you can still add some provisioning steps to add some utils with PowerShell or WindowsShell provisioner. I would advice against using simple shell. Bare in mind one other thing. If you have a batch file, and you are calling another batch file in that batch file, like choco install 7zip, it will happen that the install process will hang on installing 7zip. Because in Windows land the called script will not return the exec handler to the caller unless specifically asking for it with call. Which means your bat file will look something like this:\ncall choco install 7zip call choco install notepadplusplus or\ncmd /c choco install 7zip cmd /c choco install notepadplusplus And so on, and so forth.\nWrap-Up So, what have we learned? We have learned that installing software which requires re-start is better left to Windows itself with an answer file. Batch files will not return the handler. SSH MUST be the last thing you start up in the answer file. Use PowerShell provisioner or WindowsShell provisioner on Windows.\nHope this helped.\nHappy installing, and as always,\nThanks for reading.\nGergely.\n","permalink":"https://skarlso.github.io/2015/06/27/the-packer-the-windows-and-the-vagrant-box/","summary":"\u003cp\u003eHello folks.\u003c/p\u003e\n\u003cp\u003eToday, I would like to write about something close to my heart recently. I\u0026rsquo;ve been fiddling with Packer, Windows and Vagrant these days. Trying to get a Windows box up in running is a pain in the arse though, so I thought I share my pain with you nice folks out there. Let\u0026rsquo;s begin.\u003c/p\u003e","title":"The Packer, The Windows, and the Vagrant box"},{"content":"Hello folks.\nToday, I would like to write about something interesting and close to me at the moment. I\u0026rsquo;m going to setup Go.cd with Docker, and I\u0026rsquo;m going to get a Ruby Lotus app running. Let\u0026rsquo;s get started.\nFluff Now, obviously, you don\u0026rsquo;t really need Go.Cd or Docker to setup a Java Gradle application, since it\u0026rsquo;s dead easy. But I\u0026rsquo;m going to do it just for the heck of it.\nSetup Okay, lets start with Vagrant. Docker\u0026rsquo;s strength is coming from Linux\u0026rsquo;s process isolation capabilities it\u0026rsquo;s not yet properly working on OSX or Windows. You have a couple of options if you\u0026rsquo;d like to try never the less, like boot2docker, or a Tiny Linux kernel, but at that point, I think it\u0026rsquo;s easier to use a VM.\nVagrant So, let\u0026rsquo;s start with my small Vagrantfile.\n# -*- mode: ruby -*- # vi: set ft=ruby : # All Vagrant configuration is done below. The \u0026#34;2\u0026#34; in Vagrant.configure # configures the configuration version (we support older styles for # backwards compatibility). Please don\u0026#39;t change it unless you know what # you\u0026#39;re doing. Vagrant.configure(2) do |config| # The most common configuration options are documented and commented below. # For a complete reference, please see the online documentation at # https://docs.vagrantup.com. # Every Vagrant development environment requires a box. You can search for # boxes at https://atlas.hashicorp.com/search. config.vm.box = \u0026#34;trusty\u0026#34; config.vm.box_url = \u0026#34;https://cloud-images.ubuntu.com/vagrant/trusty/current/trusty-server-cloudimg-amd64-vagrant-disk1.box\u0026#34; config.vm.network \u0026#34;forwarded_port\u0026#34;, guest: 2300, host: 2300 config.vm.network \u0026#34;forwarded_port\u0026#34;, guest: 8153, host: 8153 config.vm.provision \u0026#34;shell\u0026#34;, path: \u0026#34;setup.sh\u0026#34; config.vm.provider \u0026#34;virtualbox\u0026#34; do |v| v.memory = 8192 v.cpus = 2 end end Very simple. I\u0026rsquo;m setting up a trusty64(because docker requires 3.10 \u0026lt;= x) box and then doing a simple shell provision. Also, I gave it a bit juice, since go-server requires a raw power. Here is the shell script:\n!#/bin/bash sudo apt-get update sudo apt-get install -y software-properties-common python-software-properties sudo apt-get update sudo apt-get install -y vim sudo add-apt-repository -y \u0026#34;ppa:webupd8team/java\u0026#34; sudo apt-get update echo debconf shared/accepted-oracle-license-v1-1 select true | sudo debconf-set-selections \u0026amp;amp;\u0026amp;amp; echo debconf shared/accepted-oracle-license-v1-1 seen true | sudo debconf-set-selections sudo apt-get install -y oracle-java8-installer sudo apt-get update wget -qO- https://get.docker.com/ | sh route add -net 172.17.0.0 netmask 255.255.255.0 gw 172.17.42.1 The debconf at the end accepts java8\u0026rsquo;s terms and conditions. And the last line installs docker in my box. This runs for a little while.\nThe routing on the end routes every traffic from 172.17.*.* to my vagrant box, which in turn I\u0026rsquo;ll be able to use from my mac local, like 127.0.0.1:8153/go/home.\nAfter a vagrant up, my box is ready to be used.\nDocker When that\u0026rsquo;s finished, we can move on to the next part, which is writing a little Dockerfile for our image. Go.cd will require java and a couple of other things, so let\u0026rsquo;s automate the installation of that so we don\u0026rsquo;t have to do it by hand.\nHere is a Dockerfile I came up with:\nFROM ubuntu MAINTAINER Skarlso ############ SETUP ############# RUN apt-get update RUN apt-get install -y software-properties-common python-software-properties RUN add-apt-repository -y \u0026#34;ppa:webupd8team/java\u0026#34; RUN echo debconf shared/accepted-oracle-license-v1-1 select true | sudo debconf-set-selections \u0026amp;amp;\u0026amp;amp; echo debconf shared/accepted-oracle-license-v1-1 seen true | sudo debconf-set-selections RUN apt-get update RUN apt-get install -y oracle-java8-installer RUN apt-get install -y vim RUN apt-get install -y unzip RUN apt-get install -y git So, our docker images have to be setup with Java as well for go.cd which I\u0026rsquo;m taking care of here, and a little bit extra, to add vim, and unzip, which is required for dpkg later.\nAt this point run: docker build -t ubuntu:go . -\u0026gt; This will use the dockerfile and create the ubuntu:go image. Note the **. **at the end.\nGo.cd Now, I\u0026rsquo;m creating two containers. One, go-server, will be the go server, and the other, go-agent, will be the go agent.\nFirst, go-server:\ndocker run -i -t --name go-server --hostname=go-server -p 8153:8153 ubuntu:go /bin/bash wget http://download.go.cd/gocd-deb/go-server-15.1.0-1863.deb dpkg -i go-server-15.1.0-1863.deb Pretty straight forward, no? We forward 8153 to vagrant (which forwards it to my mac), so after we start go-server service we should be able to visit: http://127.0.0.1:8153/go/home.\nLo\u0026rsquo;, and behold, go server. Let\u0026rsquo;s add an agent too.\ndocker run -i -t --name go-agent --hostname=go-agent ubuntu:go /bin/bash wget http://download.go.cd/gocd-deb/go-agent-15.1.0-1863.deb dpkg -i go-agent-15.1.0-1863.deb vim /etc/default/go-agent GO_SERVER=172.17.0.1 service go-agent start No need to forward anything here. And as you can see, my agent was added successfully.\nAll nice, and dandy. The agent is there, and I enabled it, so it\u0026rsquo;s ready to work. Let\u0026rsquo;s give it something to do, shall we?\nThe App I\u0026rsquo;m going to use my gradle project which is on github. This one =\u0026gt; https://github.com/Skarlso/DataMung.git.\nVery basic setup. Just check it out and then build \u0026amp; run tests. Easy, right?\nFirst step in this process, define the pipeline. I\u0026rsquo;m going to keep it simple. Name the pipeline DataMunger. Group is Linux. Now, in go.cd you have to define something called, an environment. Environment can be anything you want, I\u0026rsquo;m going to go with Linux. You have to assign agents to this environment who fulfil it and the pipeline which will use that environment. More on that you can read in the go.cd documentation. This is how you would handle a pipeline which uses linux, and a windows environment at the same time.\nIn step one you have to define something called the Material. That will be the source on which the agent will work. This can be multiple, in different folders within the confines of the pipeline, or singular.\nI defined my git project and tested the connection OK. Next up is the first **Stage **and the initial **Job **to perform. This, for me, will be a compile or an assemble, and later on a test run.\nNow, Go is awesome in parallelising jobs. If my project would be large enough, I could have multiple jobs here. But for now, I\u0026rsquo;ll use stages because they run subsequently. So, first stage, compile. Next stage, testing and archiving the results.\nI added the next stage and defined the artefact. Go supports test-reports. If you define the path to a test artefact than go will parse it and create a nice report out of it.\nNow, let\u0026rsquo;s run it. It will probably fail on something. 😉\nWell, I\u0026rsquo;ll be. It worked on the first run.\nAnd here are the test results.\nWrap-up Well, that\u0026rsquo;s it folks. Gradle project, with vagrant, docker, and go.cd. I hope you all enjoyed reading about it as much as I did doing it.\nAny questions, please feel free to ask it in the comment section below.\nCheers, Have a nice weekend, Gergely.\n","permalink":"https://skarlso.github.io/2015/06/06/docker-ruby-lotus-go-cd/","summary":"\u003cp\u003eHello folks.\u003c/p\u003e\n\u003cp\u003eToday, I would like to write about something interesting and close to me at the moment. I\u0026rsquo;m going to setup Go.cd with Docker, and I\u0026rsquo;m going to get a Ruby Lotus app running. Let\u0026rsquo;s get started.\u003c/p\u003e","title":"Docker + Java + Vagrant+ GO.CD"},{"content":"Hello folks.\nSo, some of you know puppet, some of you don\u0026rsquo;t. Puppet is a configuration management system. It\u0026rsquo;s quite awesome. I like working with it. One of the benefits of puppet is, that I never, ever, EVER have to setup a new laptop from scratch, EVER again.\nI\u0026rsquo;m writing a puppet manifest file which sets up my new laptop to my liking. I will improve it as I go along. Here is version 1.0.\n# include apt class base::basics { $packages = [\u0026#39;git\u0026#39;, \u0026#39;subversion\u0026#39;, \u0026#39;mc\u0026#39;, \u0026#39;vim\u0026#39;, \u0026#39;maven\u0026#39;, \u0026#39;gradle\u0026#39;] exec { \u0026#34;update\u0026#34;: command =\u0026gt; \u0026#34;/usr/bin/apt-get update\u0026#34;, } package { $packages: ensure =\u0026gt; installed, require =\u0026gt; Exec[\u0026#34;update\u0026#34;], } } class base::skype { exec { \u0026#34;add-arc\u0026#34;: command =\u0026gt; \u0026#34;/usr/bin/dpkg --add-architecture i386\u0026#34;, } exec { \u0026#34;add-repo-skype\u0026#34;: command =\u0026gt; \u0026#34;/usr/bin/add-apt-repository \\\u0026#34;deb http://archive.canonical.com/ \\$(lsb_release -sc) partner\\\u0026#34;\u0026#34;, require =\u0026gt; Exec[\u0026#39;add-arc\u0026#39;], } exec { \u0026#34;update-and-install\u0026#34;: command =\u0026gt; \u0026#34;/usr/bin/apt-get update \u0026amp;\u0026amp; /usr/bin/apt-get install skype\u0026#34;, require =\u0026gt; Exec[\u0026#39;add-repo-skype\u0026#39;], } } class base::java8 { # Automatically does an update afterwards # apt::ppa { \u0026#39;ppa:webupd8team/java\u0026#39;: } exec { \u0026#34;add-repo-java\u0026#34;: command =\u0026gt; \u0026#34;/usr/bin/add-apt-repository -y \\\u0026#34;ppa:webupd8team/java\\\u0026#34; \u0026amp;\u0026amp; /usr/bin/apt-get update\u0026#34; } exec { \u0026#34;set-accept\u0026#34;: command =\u0026gt; \u0026#34;/bin/echo /usr/bin/debconf shared/accepted-oracle-license-v1-1 select true | sudo /usr/bin/debconf-set-selections \u0026amp;\u0026amp; /bin/echo /usr/bin/debconf shared/accepted-oracle-license-v1-1 seen true | sudo /usr/bin/debconf-set-selections\u0026#34;, require =\u0026gt; Exec[\u0026#39;add-repo-java\u0026#39;], } exec { \u0026#34;install\u0026#34;: command =\u0026gt; \u0026#34;/usr/bin/apt-get install -y oracle-java8-installer\u0026#34;, require =\u0026gt; Exec[\u0026#39;set-accept\u0026#39;], } exec { \u0026#34;setup_home\u0026#34;: command =\u0026gt; \u0026#34;/bin/echo \\\u0026#34;export JDK18_HOME=/usr/lib/jvm/java-8-oracle/\\\u0026#34; \u0026gt;\u0026gt; /etc/environment\u0026#34;, require =\u0026gt; Exec[\u0026#39;install\u0026#39;], } } include base::basics include base::skype include base::java8 I\u0026rsquo;ll improve upon it as I go, and you can check it out later from my git repo. I removed the parts which required extra libraries for now, as I want it to run without the need of getting extra stuff installed. I might automate that part as well later on.\nEDIT: https://github.com/Skarlso/puppet/blob/master/manifests/base_setup.pp\nHave fun.\nGergely.\n","permalink":"https://skarlso.github.io/2015/05/21/setting-up-a-new-laptop-with-puppet/","summary":"Hello folks.\nSo, some of you know puppet, some of you don\u0026rsquo;t. Puppet is a configuration management system. It\u0026rsquo;s quite awesome. I like working with it. One of the benefits of puppet is, that I never, ever, EVER have to setup a new laptop from scratch, EVER again.\nI\u0026rsquo;m writing a puppet manifest file which sets up my new laptop to my liking. I will improve it as I go along.","title":"Setting up a new Laptop with Puppet"},{"content":"Fact is, I\u0026rsquo;ve been busy.\nI\u0026rsquo;ve got a new job as a build engineer. As sort of a devops kind of guy. It\u0026rsquo;s extremely interesting considering that I made a career as a tester. Granted, I always was technical, and never really knew my path; but it seems my path is finding me after all.\nIn the past years, I got better at Docker, Puppet, Chef, AWS, Packer, Vagrant, Gradle, and a hell of a lot more. Also honed my linux skills from the ability of doing an ls -l to do an find . -type f -atime +5 | xargs rm -fr (find all the files which are 5 days older and pipe them to a delete command). I already read many books about devops but this time, it\u0026rsquo;s different. This time, I can actually do these things as well in a live environment.\nAs once a friend of mine told me: \u0026ldquo;You ain\u0026rsquo;t gonna learn anything unless you are getting payed for it.\u0026rdquo; Wise words. True words.\nSo stayed tuned for some devops and engineering type posts. I would like to continue working on the Django parts as well, however given my priorities and lack of time ( family and stuff, must choose what I learned in the hour I get each day), it might fall behind. I might stick it into some kind of provision practice or even give it a Travis.ci and put it into a gradle project. Now THAT\u0026rsquo;S interesting.\nCheers folks.\nAnd as always,\nThanks for reading.\nGergely.\n","permalink":"https://skarlso.github.io/2015/05/19/busy-building-the-future/","summary":"Fact is, I\u0026rsquo;ve been busy.\nI\u0026rsquo;ve got a new job as a build engineer. As sort of a devops kind of guy. It\u0026rsquo;s extremely interesting considering that I made a career as a tester. Granted, I always was technical, and never really knew my path; but it seems my path is finding me after all.\nIn the past years, I got better at Docker, Puppet, Chef, AWS, Packer, Vagrant, Gradle, and a hell of a lot more.","title":"Busy building the future"},{"content":"Hello folks.\nA small update to this. I created the model now, which is the database design for this app. It\u0026rsquo;s very simple, nothing fancy. Also, I\u0026rsquo;m writing the app with Python 3 from now on.\nHere is the model now:\nfrom django.db import models from django.contrib.auth.models import User # Create your models here. class Item(models.Model): name = models.CharField(max_length=100, default=\u0026#34;Item\u0026#34;) damage = models.IntegerField(default=) defense = models.IntegerField(default=) consumable = models.BooleanField(default=False) def __str__(self): return self.name class Inventory(models.Model): items = models.ManyToManyField(Item) def __str__(self): return self.items class Character(models.Model): # By default Django uses the primery key of the related object. # Hence, no need to specify User.id. user = models.OneToOneField(User, null=True) name = models.CharField(max_length=100) inventory = models.ForeignKey(Inventory) def __str__(self): return self.name Worth noting a few things here. The __str__ is only with Python 3. In Python 2 it would be unicode. And the OneToOne and the foreign key are automatically using Primary keys defined in the references model. The __str__ is there to return some view when you are debugging in the console instead of [\u0026lt;Item: Item object\u0026gt;].\nIn order to apply this change you just have to run this commend (given you set up your app in the settings.py as an INSTALLED_APP):\npython manage.py makemigrations polls This creates the migration script. And this applies it:\npython manage.py migrate I love the fact that django creates incremental migration scripts out of the box. So if there was any problem at all, you can always roll back. Which comes very handy in certain situations.\nThat\u0026rsquo;s it.\nThanks for reading!\nGergely.\n","permalink":"https://skarlso.github.io/2015/04/21/django-rpg-part-3/","summary":"Hello folks.\nA small update to this. I created the model now, which is the database design for this app. It\u0026rsquo;s very simple, nothing fancy. Also, I\u0026rsquo;m writing the app with Python 3 from now on.\nHere is the model now:\nfrom django.db import models from django.contrib.auth.models import User # Create your models here. class Item(models.Model): name = models.CharField(max_length=100, default=\u0026#34;Item\u0026#34;) damage = models.IntegerField(default=) defense = models.IntegerField(default=) consumable = models.BooleanField(default=False) def __str__(self): return self.","title":"Django – RPG – Part 3"},{"content":"Hello.\nContinuing where we left off with the Django RPG project. Next up is implementing a rudimentary registration and adding the ability to create a character. Maybe even, design the database through django\u0026rsquo;s modelling.\nSince we are using Django\u0026rsquo;s very own authentication model, I think we are covered in terms of users. Let\u0026rsquo;s add two things for now. An Index page, where there is a link to login and a link to registration.\nAdding the index first. Later I would like to switch to a base template model, but for now, I created a simple index.html page. That only contains the two links to the two views. The views are a simple function call in the views.py too which the URLConfig will later point to.\nFor now, the index function looks like this:\ndef index(request): \u0026#39;\u0026#39;\u0026#39; myrpg/rpg/views.py \u0026#39;\u0026#39;\u0026#39; title = \u0026#34;My RPG\u0026#34; return render_to_response(\u0026#39;index.html\u0026#39;, {\u0026#39;title\u0026#39;:title}) Note, that the title here is utterly unimportant but because I want to switch to a base.html template I\u0026rsquo;ll leave it here for later usage.\nThat concludes the index. Now, let\u0026rsquo;s create the registration. That is a little more complex, but still rather easy. We are just checking of the user already exists or not, if so, display and error, if not, create the user.\n# myrpg/rpg/views.py def registration(request): state = \u0026#34;Please register.\u0026#34; username = password = email = \u0026#39;\u0026#39; if request.POST: username = request.POST.get(\u0026#39;username\u0026#39;) email = request.POST.get(\u0026#39;email\u0026#39;) password = request.POST.get(\u0026#39;password\u0026#39;) if User.objects.filter(username = username).exists(): # raise forms.ValidationError(\u0026#34;Username %s is already in use.\u0026#34; % username) state = \u0026#34;Username %s is already in use. Please try another.\u0026#34; % username else: try: user = User.objects.create_user(username = username, email = email, password = password) state = \u0026#34;Thank you for registering with us %s!\u0026#34; % user.username except: state = \u0026#34;Unexpected error occured: %s\u0026#34; % sys.exc_info()[] return render_to_response(\u0026#39;registration.html\u0026#39;, {\u0026#39;state\u0026#39;: state}, context_instance = RequestContext(request)) Here, I\u0026rsquo;m checking to see of the username already exists with the filter. This is by using Django\u0026rsquo;s model which models the database like hibernate. It\u0026rsquo;s a simple query. And I\u0026rsquo;m doing this, because this is faster than raising an exception. Later on, I\u0026rsquo;ll be switching to a validation framework and django\u0026rsquo;s own auth view. Because, why not.\nThe URL conf looks like this:\n#myrpg/rpg/urls.py from django.conf.urls import url from . import views urlpatterns = [ url(r\u0026#39;^$\u0026#39;, views.index, name=\u0026#39;index\u0026#39;), url(r\u0026#39;^login/$\u0026#39;, views.login_user, name=\u0026#39;login\u0026#39;), url(r\u0026#39;^registration/$\u0026#39;, views.registration, name=\u0026#39;registration\u0026#39;), ] And this now, resides in a file under the RPG app and not the main one. The main one includes this one, like this:\n#myrpg/urls.py from django.conf.urls import include, url from django.contrib import admin urlpatterns = [ # Examples: # url(r\u0026#39;^$\u0026#39;, \u0026#39;myrpg.views.home\u0026#39;, name=\u0026#39;home\u0026#39;), # url(r\u0026#39;^blog/\u0026#39;, include(\u0026#39;blog.urls\u0026#39;)), url(r\u0026#39;^admin/\u0026#39;, include(admin.site.urls)), url(r\u0026#39;^rpg/\u0026#39;, include(\u0026#39;rpg.urls\u0026#39;)), ] That\u0026rsquo;s it for now. As always, you can check out the code under github.\nTune in next time, when I\u0026rsquo;ll attempt to create a view to create a Character for a logged in user and link it to the user. I\u0026rsquo;ll do this with django\u0026rsquo;s model framework.\nThanks for reading,\nGergely.\n","permalink":"https://skarlso.github.io/2015/04/12/django-rpg-part-2/","summary":"\u003cp\u003eHello.\u003c/p\u003e\n\u003cp\u003eContinuing where we left off with the Django RPG project. Next up is implementing a rudimentary registration and adding the ability to create a character. Maybe even, design the database through django\u0026rsquo;s modelling.\u003c/p\u003e","title":"Django – RPG – Part 2"},{"content":"Hi folks.\nSo last time, we tried to implement a little RPG of mine using Meteor, which failed miserably. This time we are going to try and use Django. Let\u0026rsquo;s have at it, shall we?\nIf you don\u0026rsquo;t know what django is (than you are probably not reading this blog entry anyways. ), have a look =\u0026gt; Link. It\u0026rsquo;s a Python Web Framework.\nIn the beginning So here we are again. I\u0026rsquo;m starting off by creating the skeleton for my RPG. First, the welcome page with a tiny login capability. Which means session tracking. For now, on the same page.\nTo create the skeleton I just run this little command:\ndjango-admin.py startproject myrpg Easy enough, right? Basic directory structure is created. You can read that in django\u0026rsquo;s own documentation: https://docs.djangoproject.com/en/1.8/intro/tutorial01/\nI\u0026rsquo;m using Sublime Text 3 to build this app. I was thinking of pycharm, but that would take away too much fun.\nBy default Django uses SQLlite and I\u0026rsquo;m okay with that.\nThe basics are there. Let\u0026rsquo;s move to higher ground. The next step can be to design the login page. I\u0026rsquo;m not much of a designer so I\u0026rsquo;ll leave that part to people who care more / understand it better. I\u0026rsquo;m only looking for a simple Login with a username and a password. Nothing fancy. And I\u0026rsquo;m going to use Django\u0026rsquo;s auth system for users: django.contrib.auth.\nIt\u0026rsquo;s pretty good, has lots of features and can auth a user pretty quickly given a username and password, which is all I want for now.\nI running a migrate command to create all the necessary tables and data:\npython manage.py migrate A quick check with sqlite3 and running **.schema **showed me that the tables are indeed created and filled with default data for all the **INSTALLED_APPS **django has at the moment.\nI did a quick check with python manage.py runserver and everything seems to work fine.\nThe RPG App So, that concludes the setup. Following the tutorial, django has this notion of apps and projects. In short, a project is a set of configurations and applications which forms a website. Hence, I\u0026rsquo;m going to create an RPG APP for now. The tutorial continues with a Poll type of App, but I\u0026rsquo;m sure I can apply the same things to a login page.\nFirst, let\u0026rsquo;s create the App using the command:\npython manage.py startapp rpg That creates the skeleton for the app. The tutorial then suggests to define the database first. Which I think is a bad idea; usually when doing design, you don\u0026rsquo;t want to start with the database model. But for now, I shall comply. We want a login page and we are using the auth module, which means, for now, I don\u0026rsquo;t care about the database. Skip.\nI\u0026rsquo;m going to go off corse for now, since I only want to create a basic login. For that, I have to read up on views and models a little bit in order to create a simple login page. Be right back.\nI\u0026rsquo;m fighting the basic auth system at the moment. Everything seems to be working fine. In the Admin screen I was able to add a basic user to do some debugging, but for now, the login seems to not work with this error:\nCSRF verification failed. Request aborted\nThis is the CSRF protection which came out with Django. I did a bit of more document reading and setup the CSRF as was described here:\nhttps://docs.djangoproject.com/en/1.8/ref/csrf/\nHowever, I\u0026rsquo;m still facing the same problem. Let\u0026rsquo;s research further. Ahh yes. I wasn\u0026rsquo;t returning the request context I\u0026rsquo;ve set up. Before:\nfrom django.shortcuts import render_to_response from django.contrib.auth import authenticate, login from django.template.context_processors import csrf def login_user(request): c = {} c.update(csrf(request)) state = \u0026#34;Please log in below...\u0026#34; username = password = \u0026#39;\u0026#39; if request.POST: username = request.POST.get(\u0026#39;username\u0026#39;) password = request.POST.get(\u0026#39;password\u0026#39;) user = authenticate(username=username, password=password) if user is not None: if user.is_active: login(request, user) state = \u0026#34;You\u0026#39;re successfully logged in!\u0026#34; else: state = \u0026#34;Your account is not active, please contact the site admin.\u0026#34; else: state = \u0026#34;Your username and/or password were incorrect.\u0026#34; return render_to_response(\u0026#39;auth.html\u0026#39;,{\u0026#39;state\u0026#39;:state, \u0026#39;username\u0026#39;: username}) After:\nfrom django.shortcuts import render_to_response from django.contrib.auth import authenticate, login from django.template.context_processors import csrf from django.template import RequestContext def login_user(request): state = \u0026#34;Please log in below...\u0026#34; username = password = \u0026#39;\u0026#39; if request.POST: username = request.POST.get(\u0026#39;username\u0026#39;) password = request.POST.get(\u0026#39;password\u0026#39;) user = authenticate(username=username, password=password) if user is not None: if user.is_active: login(request, user) state = \u0026#34;You\u0026#39;re successfully logged in!\u0026#34; else: state = \u0026#34;Your account is not active, please contact the site admin.\u0026#34; else: state = \u0026#34;Your username and/or password were incorrect.\u0026#34; return render_to_response(\u0026#39;auth.html\u0026#39;,{\u0026#39;state\u0026#39;:state, \u0026#39;username\u0026#39;: username}, context_instance=RequestContext(request)) Notice that now I\u0026rsquo;m returning the request context at the end when I\u0026rsquo;m rendering the response. And lo\u0026rsquo; and behold, my login is now working.\nProgress so far So, I\u0026rsquo;ve set up a user using the Admin portal accessible from the app / admin. Created my default rpg app, and added my default auth view into a template folder. Configured the URL setting in urls.py to look like this:\nurl(r\u0026#39;^login/$\u0026#39;, \u0026#39;rpg.views.login_user\u0026#39;), Very basic for now, but when I return to it, we are going to clean it up and then continue with implementing the main screen which will greet the user and display some stats about his/her character.\nThe whole code is under github here =\u0026gt; https://github.com/Skarlso/myrpg\nBye for now,\nAnd thanks for reading.\nGergely.\n","permalink":"https://skarlso.github.io/2015/04/10/django-rpg-2/","summary":"\u003cp\u003eHi folks.\u003c/p\u003e\n\u003cp\u003eSo last time, we tried to implement a little RPG of mine using Meteor, which failed miserably. This time we are going to try and use Django. Let\u0026rsquo;s have at it, shall we?\u003c/p\u003e","title":"Django – RPG – Part 1"},{"content":"Hi folks.\nJust a small script which calculates your distance from a lever focal point if you know your weight, the object\u0026rsquo;s weight and the object\u0026rsquo;s and the distance the object has from the focal point of the lever.\nLike this:\nThis script will give you D1. And this is how it will look like in doing so:\nSo, in order for me (77kg) to lift an object of 80kg which is on a, by default, 1 meter long lever, I have to stand back ~1.03meters. Which is totally cool, right?\nHere is the code:\nfrom Tkinter import * import ttk def calculate(*args): try: your_weight_value = float(your_weight.get()) object_weight_value = float(object_weight.get()) object_distance_value = float(object_distance.get()) your_distance.set((object_weight_value * object_distance_value) / your_weight_value) except ValueError: pass root = Tk() root.title(\u0026#34;Lever distance counter\u0026#34;) mainframe = ttk.Frame(root, padding=\u0026#34;4 4 12 12\u0026#34;) mainframe.grid(column=, row=, sticky=(N, W, E, S)) mainframe.columnconfigure(, weight=1) mainframe.rowconfigure(, weight=1) your_weight = StringVar() object_weight = StringVar() object_distance = StringVar() your_distance = StringVar() object_distance.set(\u0026#34;1\u0026#34;) your_weight_entry = ttk.Entry(mainframe, width=7, textvariable=your_weight) your_weight_entry.grid(column=2, row=1, sticky=(W, E)) object_weight_entry = ttk.Entry(mainframe, width=7, textvariable=object_weight) object_weight_entry.grid(column=2, row=2, sticky=(W, E)) object_distance_entry = ttk.Entry(mainframe, width=7, textvariable=object_distance) object_distance_entry.grid(column=2, row=4, sticky=(W, E)) ttk.Label(mainframe, textvariable=your_distance).grid(column=2, row=3, sticky=(W, E)) ttk.Label(mainframe, text=\u0026#34;Your weight\u0026#34;).grid(column=1, row=1, sticky=W) ttk.Label(mainframe, text=\u0026#34;Object weight\u0026#34;).grid(column=1, row=2, sticky=W) ttk.Label(mainframe, text=\u0026#34;Object Distance\u0026#34;).grid(column=1, row=3, sticky=W) ttk.Label(mainframe, text=\u0026#34;Your Distance\u0026#34;).grid(column=1, row=4, sticky=W) ttk.Label(mainframe, text=\u0026#34;kg\u0026#34;).grid(column=3, row=1, sticky=W) ttk.Label(mainframe, text=\u0026#34;kg\u0026#34;).grid(column=3, row=2, sticky=W) ttk.Label(mainframe, text=\u0026#34;m\u0026#34;).grid(column=3, row=3, sticky=W) ttk.Label(mainframe, text=\u0026#34;m\u0026#34;).grid(column=3, row=4, sticky=W) ttk.Button(mainframe, text=\u0026#34;Calculate\u0026#34;, command=calculate).grid(column=3, row=5, sticky=W) for child in mainframe.winfo_children(): child.grid_configure(padx=5, pady=5) your_weight_entry.focus() root.bind(\u0026#39;\u0026#39;, calculate) root.mainloop() Please enjoy, and feel free to alter in any way. I\u0026rsquo;m using Tkinter and a grid layout which I find very easy to work with.\nThanks for reading, Gergely.\n","permalink":"https://skarlso.github.io/2015/04/10/small-python-gui-to-calculate-lever-distance/","summary":"Hi folks.\nJust a small script which calculates your distance from a lever focal point if you know your weight, the object\u0026rsquo;s weight and the object\u0026rsquo;s and the distance the object has from the focal point of the lever.\nLike this:\nThis script will give you D1. And this is how it will look like in doing so:\nSo, in order for me (77kg) to lift an object of 80kg which is on a, by default, 1 meter long lever, I have to stand back ~1.","title":"Small Python GUI to Calculate Lever Distance"},{"content":"Let\u0026rsquo;s talk about plans. It\u0026rsquo;s good to have one. For example, I have a plan for this year.\nI kind of like math. So, I have this book:\nIt\u0026rsquo;s 1400 pages long and basically, has everything in it. It\u0026rsquo;s a rather exhaustive book. Hence, my plan is to finish the book by the end of 2015 and write a couple of python scripts that calculate something interesting.\n(2021 Hindsight): Yeah, I didn\u0026rsquo;t manage this\u0026hellip; But it\u0026rsquo;s a cool idea, let\u0026rsquo;s see if I can get around coming further. I managed to get until 500 pages or so, before life stepped in.\nFor example, Newton\u0026rsquo;s law of cooling how I learned it is:\nk*log(2.5)*((t(0)-k)/(t-k)) Where k =\u0026gt; a material\u0026rsquo;s surface based constant. T(0) =\u0026gt; initial temperature. T =\u0026gt; target temperature. K =\u0026gt; Environment\u0026rsquo;s temperature.\nA simple python script for this:\n# Calculating Newton\u0026#39;s law of Cooling from __future__ import division import sys from math import log def calculation(k, Tz, T, K): res = (Tz - K)/(T - K) return k * (log(res, 2.5)) k = sys.argv[1] Tz = sys.argv[2] T = sys.argv[3] K = sys.argv[4] print(\u0026#34;Calculating aproximate temperature for given parameters: k=%s, Tz=%sC, T=%sC, K=%sC\u0026#34; % (k, Tz, T, K)) print(calculation(float(k), float(Tz), float(T), float(K))) Enjoy.\nAnd as always, Thanks for reading!\n","permalink":"https://skarlso.github.io/2015/03/15/python-and-my-math-commitment/","summary":"Let\u0026rsquo;s talk about plans. It\u0026rsquo;s good to have one. For example, I have a plan for this year.\nI kind of like math. So, I have this book:\nIt\u0026rsquo;s 1400 pages long and basically, has everything in it. It\u0026rsquo;s a rather exhaustive book. Hence, my plan is to finish the book by the end of 2015 and write a couple of python scripts that calculate something interesting.\n(2021 Hindsight): Yeah, I didn\u0026rsquo;t manage this\u0026hellip; But it\u0026rsquo;s a cool idea, let\u0026rsquo;s see if I can get around coming further.","title":"Python and my Math commitment"},{"content":"Here we are again. I will attempt to further this little journey of mine into the land of Android and Python.\nThis is the second part of the advanture you can read the first one a little bit back.\nThe Script We left off at a point where I successfully configured my environment and compiled my first hello world APK. At that point it took a little bit fiddling to get it to work on my phone.\nNow, I have progressed a little bit into spoj\u0026rsquo;s page parsing. The code so far is as follows:\n__author__ = \u0026#39;hannibal\u0026#39; import requests from random import randint import lxml.html as lh random_page_number = randint(, 63) # 63 being the maximum page number at spoj r = requests.get(\u0026#34;http://www.spoj.com/problems/classical/sort=0,start=%d\u0026#34; % (random_page_number * 50 - 50)) # Problem Div XPath =\u0026gt; //[@class=\u0026#34;problems\u0026#34;] spoj_page = lh.document_fromstring(r.text) links_to_problems = spoj_page[].xpath(\u0026#34;//tr[@class=\u0026#39;problemrow\u0026#39;]/td[2]/a\u0026#34;) current_link = links_to_problems[randint(, len(links_to_problems))] print(current_link.attrib[\u0026#39;href\u0026#39;]) r = requests.get(\u0026#34;http://www.spoj.com/%s\u0026#34; % current_link.attrib[\u0026#39;href\u0026#39;]) print(r.text.encode(\u0026#34;utf-8\u0026#34;)) This is pretty straight forward so far. It gets the problems page, loads in all of the links and prints it out.\nMy goal is an application which looks something like this:\n_________________\n| ______________ |\n| | | |\n| | | |\n| | Display Problem Description | |\n| | | |\n| | | |\n| | | |\n| |_________________ | |\n| |\n| |\n| Button:Finish Problem |\n| |\n| Button:Next Problem |\n|____________________ |\nIt\u0026rsquo;s very basic. When it loads up, it will gather and display a new problem. You have two options, either get a new one, or save / finish this item, saying you never want to see it again.\nLet\u0026rsquo;s put the first part into an android app. Just gather data, and get it disaplyed.\n*Queue a days worth of hacking and frustrated cussing.*\nSo, turns out it\u0026rsquo;s not as easy as I would have liked it to be. I ran into some pretty nasty problems. Some of them I\u0026rsquo;ll write down below for the record, and an attempted solution as well.\nProblems #1: Problem: Libraries. I\u0026rsquo;m using lxml and requests. Requests is a pure python library, but lxml is partially C. Which apparently is not very well supported yet.\nSolution (Partial): I could optain request by two ways, but the most simple one, was basically just building my distribution with the optional requests module like this:\n./distribute.sh -m \u0026#34;openssl pil requests kivy\u0026#34; Attempting to do the same with LXML resulted in a compile issue which I tracked down to something like: \u0026ldquo;sorry, but we don\u0026rsquo;t support OSX\u0026rdquo;. But it\u0026rsquo;s okay. There are other ways to parse an html page, I just really like the xpath filter. So I soldiered on with trying to get something to work at least.\n#3: Problem: Bogus compile time exception. There were some exceptions on the way when I was trying to compile with buildozer. Solution: It\u0026rsquo;s interesting because previously my solution to another compile time issue was to use a specific version of Cython. But this time the solution was to actually remove that version and install the latest one. Which is 0.22 as of the time of this writing. So:\nsudo pip update cython #2: Problem: Connection. So now, I\u0026rsquo;m down to the bare bone. At this point, I just want to see a page source in a label. My code looks like this:\nimport kivy kivy.require(\u0026#39;1.8.0\u0026#39;) from kivy.lang import Builder from kivy.uix.gridlayout import GridLayout from kivy.properties import NumericProperty from kivy.app import App import requests from random import randint # import lxml.html as lh # import sys # sys.path.append(\u0026#39;/sdcard/com.googlecode.pythonforandroid/extras/python/site-packages\u0026#39;) Builder.load_string(\u0026#39;\u0026#39;\u0026#39; : cols: 1 Label: text: root.get_problem() Button: text: \u0026#39;Click me! %d\u0026#39; % root.counter on_release: root.my_callback() \u0026#39;\u0026#39;\u0026#39;) class SpojAppScreen(GridLayout): counter = NumericProperty() def my_callback(self): print \u0026#39;The button has been pushed\u0026#39; self.counter += 1 def get_problem(self): random_page_number = randint(, 63) # 63 being the maximum page number at spoj r = requests.get(\u0026#34;http://www.spoj.com/problems/classical/sort=0,start=%d\u0026#34; % (random_page_number * 50 - 50)) # Problem Div XPath =\u0026gt; //[@class=\u0026#34;problems\u0026#34;] # spoj_page = lh.document_fromstring(r.text) # links_to_problems = spoj_page[0].xpath(\u0026#34;//tr[@class=\u0026#39;problemrow\u0026#39;]/td[2]/a\u0026#34;) # current_link = links_to_problems[randint(0, len(links_to_problems))] # print(current_link.attrib[\u0026#39;href\u0026#39;]) # r = requests.get(\u0026#34;http://www.spoj.com/%s\u0026#34; % current_link.attrib[\u0026#39;href\u0026#39;]) # print(r.text.encode(\u0026#34;utf-8\u0026#34;)) return r.text.encode(\u0026#34;utf-8\u0026#34;) class SpojApp(App): def build(self): return SpojAppScreen() if __name__ == \u0026#39;__main__\u0026#39;: SpojApp().run() However, running this results in a connection error in adb logcat:\nI/python (27610): kivy.lang.BuilderException: Parser: File \u0026#34;\u0026#34;, line 5: I/python (27610): ... I/python (27610): 3: cols: 1 I/python (27610): 4: Label: I/python (27610): \u0026amp;gt;\u0026amp;gt; 5: text: root.get_problem() I/python (27610): 6: Button: I/python (27610): 7: text: \u0026#39;Click me! %d\u0026#39; % root.counter I/python (27610): ... I/python (27610): BuilderException: Parser: File \u0026#34;\u0026#34;, line 5: I/python (27610): ... I/python (27610): 3: cols: 1 I/python (27610): 4: Label: I/python (27610): \u0026amp;gt;\u0026amp;gt; 5: text: root.get_problem() I/python (27610): 6: Button: I/python (27610): 7: text: \u0026#39;Click me! %d\u0026#39; % root.counter I/python (27610): ... I/python (27610): ConnectionError: (\u0026#39;Connection aborted.\u0026#39;, gaierror(4, \u0026#39;non-recoverable failure in name resolution.\u0026#39;)) Solution: I tried simply putting out a random number at some point, which actullay worked, so I know it\u0026rsquo;s the connection. I\u0026rsquo;m guessing I need permission to access the network. Which would be this:\nuses-permission android:name=\u0026#34;android.permission.INTERNET\u0026#34; And yes! Building and installing it with this additional permission got me so far as I can display the web page\u0026rsquo;s content in a label.\n./build.py --package org.spoj --permission INTERNET --name \u0026#34;Spoj\u0026#34; --version 1.0 --dir /Users/hannibal/PythonProjects/spoj/ debug There is a saying that you should end on a high note, so that is what I\u0026rsquo;m going to do here right now. Join me next time, when I\u0026rsquo;ll try to replace lxml with something else.\nThanks for reading!\nGergely.\n","permalink":"https://skarlso.github.io/2015/03/02/sphere-judge-online-python-kivy-android-app-part-2/","summary":"Here we are again. I will attempt to further this little journey of mine into the land of Android and Python.\nThis is the second part of the advanture you can read the first one a little bit back.\nThe Script We left off at a point where I successfully configured my environment and compiled my first hello world APK. At that point it took a little bit fiddling to get it to work on my phone.","title":"Sphere Judge Online – Python Kivy Android app – Part 2"},{"content":"Hello folks.\nToday I would like to take you on a journey I fought myself through in order to write a python android app, which gets you a random problem from Sphere Judge Online. Then you can mark it as solved and it will be stored as such, and you can move on to the next problem. With the words of Neil deGrasse Tyson, Come with Me!\nBeginnings When I first embarked on this endeavour I ran into numerous errors, many amongst them being compilation issues when I was trying to install libraries.\nI started to write down all of these, and then started fresh on a new machine. I realised that ALL of my problems where only because of **ONE **thing. One thing, which I wanted to do, but it ended up being the death of me. And that is.. *Drummrolls* **Python 3. **I tried doing all the things that I started to do, with Python 3. Turns out, that neither libraries are supporting it very well yet. And that\u0026rsquo;s including Cython as well, which I thought would be up to speed by now. But sadly, it\u0026rsquo;s not.\nPrerequisite In order to go any further we need a few things first. For this to work, you\u0026rsquo;ll have to perform these things in order as I found out later. And certain versions of certain libraries are required instead of the latest ones.\nDepending on the environment you are using, you need to install python-dev and some other graphic libraries. I followed this and that was fine. Latest packages are working alright.\nsudo apt-get install build-essential patch git-core ccache ant python-pip python-dev sudo apt-get install ia32-libs libc6-dev-i386 sudo apt-get install lib32stdc++6 lib32z1 Only install these if you are absolutely certain you need them.\nClone python-android from git into a nice and cosy directory.\ngit clone https://github.com/kivy/python-for-android.git While this is underway, for python-android you also need android-sdk and android-ndk. Select the ones which are for your environment. The NDK is needed in order to build the APK out of our python code later on.\nAfter you are done, run ./android and install tools, APIs and other things you want. Make sure you have these set up:\nexport ANDROIDSDK=/path/to/android-sdk export ANDROIDNDK=/path/to/android-ndk export ANDROIDNDKVER=rX export ANDROIDAPI=X export PATH=$ANDROIDNDK:$ANDROIDSDK/platform-tools:$ANDROIDSDK/tools:$PATH The API version needs to be the one which you installed on your machine.\nNow, we have to get a specific version of Cython. In order to do that, execute the following command:\nsudo pip install -I https://pypi.python.org/packages/source/C/Cython/Cython-0.20.1.tar.gz Source your new .bash_profile file if you haven\u0026rsquo;t done so already.\nAt this point we are ready to install Kivy. Please follow the instructions for your environment on the respective page from Kivy\u0026rsquo;s documentation:\nhttp://kivy.org/docs/installation/installation.html\nNote: For Mac users. In addition, before doing the kivy stuff, and if you would like to execute kivy applications on your mac, you need to install pygame.\nIt\u0026rsquo;s a bit of a hassle but you only need to perform these commands:\nInstall Quartz =\u0026gt; http://xquartz.macosforge.org/landing/\nInstall Homebrew =\u0026gt; ruby -e \u0026ldquo;$(curl -fsSL https://raw.github.com/Homebrew/homebrew/go/install)\u0026quot;\nInstall some other packages =\u0026gt; brew install hg sdl sdl_image sdl_mixer sdl_ttf portmidi\nInstall pygame =\u0026gt; pip install hg+http://bitbucket.org/pygame/pygame\nOnce this finishes, you should be good to go for the final command in the prerequisites. Go to your cloned python-android folder and run this (make sure you have ANT installed):\n./distribute.sh -m \u0026#34;openssl pil kivy\u0026#34; Now we are ready for some coding.\nImplementation So, finally after our environment is all setup, we can move on to write some python code. Let\u0026rsquo;s start with a simple hello world application:\nimport kivy kivy.require(\u0026#39;1.8.0\u0026#39;) # 1.8.0 is the latest kivy version from kivy.lang import Builder from kivy.uix.gridlayout import GridLayout from kivy.properties import NumericProperty from kivy.app import App Builder.load_string(\u0026#39;\u0026#39;\u0026#39; : cols: 1 Label: text: \u0026#39;Welcome to the Hello world\u0026#39; Button: text: \u0026#39;Click me! %d\u0026#39; % root.counter on_release: root.my_callback() \u0026#39;\u0026#39;\u0026#39;) class HelloWorldScreen(GridLayout): counter = NumericProperty() def my_callback(self): print \u0026#39;The button has been pushed\u0026#39; self.counter += 1 class HelloWorldApp(App): def build(self): return HelloWorldScreen() if __name__ == \u0026#39;__main__\u0026#39;: HelloWorldApp().run() This is a simple Hello World python-android app. Save this into a file called main.py. Main.py is used to execute the app on your phone. It\u0026rsquo;s your entry point. Whatever app you are writing, this has to be where it will begin.\nIn order to get this installed on our device, we will use python-android\u0026rsquo;s distribution.sh. The command to run after you changed directory into python-android is this (make sure that you have a compatible android device plugged in and in developer mode):\n./build.py --package org.hello.world --name \u0026#34;Hello world\u0026#34; --version 1.0 --dir /PATH/TO/helloworld debug installd Upon success, you should see it on your device. This is how the hello world app looks like:\nFinishing up This has been quite the ride so far. We will continue our journey when I\u0026rsquo;ll start writing my own app for SPOJ.\nThanks for reading! Gergely.\n","permalink":"https://skarlso.github.io/2015/02/26/sphere-judge-online-python-kivy-android-app/","summary":"Hello folks.\nToday I would like to take you on a journey I fought myself through in order to write a python android app, which gets you a random problem from Sphere Judge Online. Then you can mark it as solved and it will be stored as such, and you can move on to the next problem. With the words of Neil deGrasse Tyson, Come with Me!\nBeginnings When I first embarked on this endeavour I ran into numerous errors, many amongst them being compilation issues when I was trying to install libraries.","title":"Sphere Judge Online – Python Kivy Android app"},{"content":" Not a great many people know that I\u0026rsquo;m actually into Lock Picking as a hobby. This will not be a tutorial on how to do it, or I won\u0026rsquo;t really talk about how I do it; I would like to write about something completely different. So if you came here for that, here are a few very good resources:\nhttp://www.lockpicking101.com/ - Tutorials\nhttp://www.ukbumpkeys.com/collections/lock-picking - Tools ( UK )\nhttp://www.reddit.com/r/lockpicking/ - Reddit\nFor my post, click on.\nSo, why is lock picking like testing? I saw a great many posts which where trying to compare software testing to some activity. I even knew somebody who compared it to dancing. Because.? I don\u0026rsquo;t know, maybe he was trying out a talk material maybe? And he said - \u0026ldquo;I was in this club and watched a couple dance, and I was thinking, wow, this is like software testing.\u0026rdquo; - I couldn\u0026rsquo;t really react to that. But hey, kudos for out of the box thinking I guess.\nBut let\u0026rsquo;s see some of the similarities in picking and testing:\nThinking It requires logical, critical thinking. It\u0026rsquo;s a puzzle that you have to solve. A puzzle which you basically solve by testing out solutions and see if they work. You can achieve this by trial and error, something testers face on a daily basis. After awhile you acquire something called finesse. Which will help you identify breaking points more easily. Since you have experience with a certain lock type, you already have a wast knowledge to rely on when you are trying to solve a new lock with the same build. You did your research you know its weaknesses hence you immediately have an attack vector on your hand.\nTools Lock picking has a wast number of tools. Each tool is design for a specific purpose. You can reuse tools but they are rarely a fit for other locks. Unless it\u0026rsquo;s a similar one. There are delicate tools and then there are brute force tools, which are very hard to use at first but after you get used to it and know how to handle it, it becomes massively helpful. You can build your own tools or use tools that are built for you by tool experts.\nSolving Process When can you test an application to its fullest extend and capabilities? How can you achieve the most and best testing ever possible? You have to know how the application works. You have to know its components, its abilities, its capabilities and **limits. **For Lock Picking to be the best at what you do and to be able to move to a completely new lock and try to pick it, you have to know its flaws. You have to know when, and how it was built. You have to know what makes it tick, how it works, what it uses, how the inside mechanics look like in order to try to exploit them.\nAfter you acquire this knowledge you will be able to build, or purchase a tool which will help you in solving the puzzle. But you were only able to do that because after you researched its manufacturing procedure you know that the last pin is hard to get to and that it has an anti drilling shield, so drilling is out of the question, and that it has a safety spring which locks the lock permanently upon tampering. If you would not be in the possession of this information you could have made a fatal error and could have made the client lost money ( since at that point they pretty much need to break down the door, unless the key is found again ( assuming the picking took place because the key was lost ) ).\nLast Words There you have it folks. That\u0026rsquo;s why Lock Picking is like software testing. Knowing structure, inside workings and the proper tools will help to achieve your goal. Just like in testing when you know your field, you know what to use, when, and how. Knowledge makes you the Best.\nGood luck,\nHappy Picking,\nGergely.\n","permalink":"https://skarlso.github.io/2015/02/08/why-lock-picking-is-like-testing/","summary":"\u003cp\u003e \u003c/p\u003e\n\u003cp\u003eNot a great many people know that I\u0026rsquo;m actually into Lock Picking as a hobby. This will not be a tutorial on how to do it, or I won\u0026rsquo;t really talk about how I do it; I would like to write about something completely different. So if you came here for that, here are a few very good resources:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://www.lockpicking101.com/%20\" target=\"_blank\"\u003e\u003ca href=\"http://www.lockpicking101.com/\"\u003ehttp://www.lockpicking101.com/\u003c/a\u003e \u003c/a\u003e- Tutorials\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://www.ukbumpkeys.com/collections/lock-picking\" target=\"_blank\"\u003e\u003ca href=\"http://www.ukbumpkeys.com/collections/lock-picking\"\u003ehttp://www.ukbumpkeys.com/collections/lock-picking\u003c/a\u003e\u003c/a\u003e - Tools ( UK )\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://www.reddit.com/r/lockpicking/\" target=\"_blank\"\u003e\u003ca href=\"http://www.reddit.com/r/lockpicking/\"\u003ehttp://www.reddit.com/r/lockpicking/\u003c/a\u003e\u003c/a\u003e - Reddit\u003c/p\u003e\n\u003cp\u003eFor my post, click on.\u003c/p\u003e","title":"Why Lock Picking is like Testing"},{"content":"In my previous post, I was getting ready to enjoy some time with the JavaScript web framework Meteor.\nThis time I would like to bring it to a bit of overdrive. See, how re-factoring works on a larger scale model with multiple pages. And how it can organize assets, such as, images, multiple CSS, some plugins, you know, ordinary web stuff.\nLet\u0026rsquo;s dive in.\nI\u0026rsquo;m planning this to be a series of posts as I\u0026rsquo;m going along building up my RPG app. Let\u0026rsquo;s define the rules.\nIn the beginning Rules Inventory Our main character will have a basic inventory. He will have space to carry stuff around and a body to put stuff on. One ring on each hand, one weapon in each hand, helmet, armour, legs, and a necklace. That\u0026rsquo;s it. For simplicities sake. The game mechanics will be like those old books which you could play, Fighting RPG Books, like the one Ian Livingstone was writing. This is one of my favourites; Robot commando:\nStats A very basic stat system.\nStrength Agility Constitution Intelligence Magic Fighting A very basic fighting system with the possibility of casting magic which, for simplicity, will count as attacks and can be dodged based on agility.\nLet\u0026rsquo;s say we have dice throwing with a couple of 6 sided ones. So X * 6 sided dice. Dodging will require agility, HP is defined by constitution, Intelligence will help in puzzles which require a throw against intelligence, Magic will define Mana Points.\nSimple, right?\nDesign I\u0026rsquo;m not much of a front-end developer, so I don\u0026rsquo;t really care about how it will look like. I\u0026rsquo;ll try to squeeze in some very basic stuff, like ordering, but that\u0026rsquo;s it.\nGame Play Basically there will be a story which can be loaded threw a JSON structured file. The file will hold information about what a current page has. The probable things a page can contain at any given time:\nCurrent location description Selectable proceed location ( page number ) Enemy -\u0026gt; Fight ( Might contain an option to not to attack the beast ) Riddle -\u0026gt; Solving it is determined by a throw against intelligence Trap -\u0026gt; Springing it is determined by a throw against agility Lootable items Death All of the above define an action that a player can, or HAS to take. If there is no ability to choose the player has to proceed as the page requests it. That might be easier to do if I just say if there is only one possible choose it\u0026rsquo;s choosen automatically for you.\nImplementation I\u0026rsquo;ll be using Meteor which is based on Node and MongoDB. Hence, my stuff will be in mongoDB. I have a fair knowledge of how mongodb works, I\u0026rsquo;ll write down my progress as I go along.\nEverything I\u0026rsquo;ll do is of course under version control and can be followed here:\nhttps://github.com/Skarlso/coolrpgapp\nCharacter I need to be able to create a character with a name. Meaning, I need to figure out how meteor handles input. I already know that it uses templates and Spacebars Compiler. So what I want at this point is to enter a username and then click a button which will direct me to the story page. Simple, right.?\nFor data handling we will use Meteor\u0026rsquo;s Collections.\nUsing a form to submit the username looks like this:\nUsernames = new Mongo.Collection(\u0026#34;usernames\u0026#34;); if (Meteor.isClient) { Template.body.events({ \u0026#34;submit .new-user\u0026#34;: function (event) { // This function is called when the new task form is submitted var username = event.target.username.value; Usernames.insert({ username: username, createdAt: new Date() // current time }); // Clear form event.target.username.value = \u0026#34;\u0026#34;; // Prevent default form submit return false; } }); } if (Meteor.isServer) { Meteor.startup(function () { // code to run on server at startup }); } Of course there is no way to know if that actually succeeded so far unless I get a look at the DB. Navigate to the folder of your app and type in:\nmeteor mongo This will open a console to your database where you can query it like you would normally do with a mongodb console. Hence for me it\u0026rsquo;s:\ndb.usernames.find() # which return this -\u0026gt; meteor:PRIMARY\u0026gt;; db.usernames.find() { \u0026#34;username\u0026#34; : \u0026#34;olaf\u0026#34;, \u0026#34;createdAt\u0026#34; : ISODate(\u0026#34;2015-02-01T16:58:24.100Z\u0026#34;), \u0026#34;_id\u0026#34; : \u0026#34;MS67d95ShFkc3yHiX\u0026#34; } { \u0026#34;username\u0026#34; : \u0026#34;skarlso\u0026#34;, \u0026#34;createdAt\u0026#34; : ISODate(\u0026#34;2015-02-01T16:59:18.792Z\u0026#34;), \u0026#34;_id\u0026#34; : \u0026#34;ig8DJngmGKLca2dqS\u0026#34; } As you can see, I already have two characters in the system. This is so far very easy but it does not redirect me to a new page displaying the beginning of my journey. Let\u0026rsquo;s try a redirect.\nComplications Turns out it\u0026rsquo;s not that easy to get a redirect going. If I would be a beginner at this, I would give up right now and move on. The guide, or the tutorial does not contain any HINTS at least that I have to use a different method if I want a multi-layered multi-paged app. Of course Meteor provides a built in, easy to use, easy to add, answer-to-everything-you-ever-would-want-to-do, Login feature. But guys, it\u0026rsquo;s not useful. I would go as far as say it\u0026rsquo;s completely useless. Do you actually know someone who uses it? I would never use a built in something which is completely hidden from me and have no idea what it does. The ability to control what\u0026rsquo;s happening is THE most important thing in every developers life.\nSo after I did a bit of digging and StackOverflowing ( which replaces the tutorial AND the user guide (and is a trademarked expression)), I found out that you can add Iron-Router which was built specifically for this purpose.\nmeteor add iron:router So all of a sudden my Page is completely screwed up with Iron Router information. Again, there is no information on this on Meteors page or in the guide nor in the COMPLETE guide so, I\u0026rsquo;m left Googling.\nA very helpful StackOverflow ( again, and I\u0026rsquo;m wondering why people don\u0026rsquo;t bother with the guide in the first place just go to stackoverflow straight ) answer explains to me the following:\n\u0026ldquo;You have to define a subscription handle (an object returned by Meteor.subscribe) in order to use it\u0026rsquo;s reactive ready method : we\u0026rsquo;ll reference it in the myDataIsReady helper to track data availability, and the helper will automatically rerun when the state of ready changes.\u0026rdquo;\nOkay, so subscriptions are mentioned in the SECURITY section of the guide regarding detecting specific users and private data and so on and so forth. All right so that\u0026rsquo;s used by iron routing as well which means I have to build that in, and not to mention first of all understanding how Iron Router works.\nI\u0026rsquo;m going to stop here now. After spending a couple of hours I can determine that this stuff is not intuitive and \u0026ldquo;easy\u0026rdquo;. I don\u0026rsquo;t know enough about JavaScript and redirecting and Iron Router to be able to use Meteor out of the box. Which means I have to educate myself a bit before returning to this stuff.\nStay tuned for more.\nAnd as always, Thanks for reading!\n","permalink":"https://skarlso.github.io/2015/02/01/building-an-rpg-app-with-meteor-part-one-the-struggle/","summary":"\u003cp\u003eIn my previous post, I was getting ready to enjoy some time with the JavaScript web framework Meteor.\u003c/p\u003e\n\u003cp\u003eThis time I would like to bring it to a bit of overdrive. See, how re-factoring works on a larger scale model with multiple pages. And how it can organize assets, such as, images, multiple CSS, some plugins, you know, ordinary web stuff.\u003c/p\u003e\n\u003cp\u003eLet\u0026rsquo;s dive in.\u003c/p\u003e","title":"Building an RPG App with Meteor – Part One – The struggle"},{"content":"Hi,\nThis time I would like to write about something that interests me. I wanted to try out a pure JavaScript web framework.\nMy choice is: Meteor. Looks interesting enough and it was recommended by a friend of mine. So, let\u0026rsquo;s dive in.\nInstallation As always, one starts with installation. The page tells us to follow this simple step:\ncurl https://install.meteor.com/ | sh Easy enough, when you are on Linux. Turns out, that there is no official release yet for Windows. I\u0026rsquo;m in luck then. After running the command though, I saw this popping up into my face:\ncurl: (60) Peer certificate cannot be authenticated with known CA certificates More details here: http://curl.haxx.se/docs/sslcerts.html There is always something. in that case a more accurate command to use would be the following:\ncurl -k https://install.meteor.com/ | sh This will force an insecure download. You might not face this issue, but just in case you do, use this command instead.\nBranching off here. For those of you whom the curl didn\u0026rsquo;t work because you are sitting behind a proxy you can specify a -proxy protocol//username:password@proxy:port after your curl. Of course if that doesn\u0026rsquo;t work then the script won\u0026rsquo;t work either.\nSo open the script in one of your favourite editors, for me it\u0026rsquo;s Sublime text, and find this line: \u0026ldquo;Downloading Meteor distribution\u0026rdquo;. Lo, and behold; it uses curl. This is the only one in the script, so just edit it by adding in your -proxy setting as before and you should be right on track.\nIf that still gives you problems, try this:\nAssuming that your browser is set up correctly with the proxy and just command line commands aren\u0026rsquo;t working, you can go to this URL defined by the variable TARBALL_URL:\nTARBALL_URL=\u0026#34;https://d3sqy0vbqsdhku.cloudfront.net/packages-bootstrap/${RELEASE}/meteor-bootstrap-${PLATFORM}.tar.gz\u0026#34; Note that there are two variables in there. For me these are:\nRELEASE: 1.0.3.1\nPLATFORM: os.linux.x86_64\nThe full URL is:\nhttps://d3sqy0vbqsdhku.cloudfront.net/packages-bootstrap/1.0.3.1/meteor-bootstrap-os.linux.x86_64.tar.gz Download the latest tarball and delete the CURL AND TAR command on the following line. After that, you just have to extract the tarball and move the directory to ~/.meteor.\nNow you can run your sh again and you should be on the road, for sure this time.\nJust to make sure, these are the line which you need to comment out:\n# If you already have a tropohouse/warehouse, we do a clean install here: if [ -e \u0026#34;$HOME/.meteor\u0026#34; ]; then echo \u0026#34;Removing your existing Meteor installation.\u0026#34; rm -rf \u0026#34;$HOME/.meteor\u0026#34; fi TARBALL_URL=\u0026#34;https://d3sqy0vbqsdhku.cloudfront.net/packages-bootstrap/${RELEASE}/meteor-bootstrap-${PLATFORM}.tar.gz\u0026#34; INSTALL_TMPDIR=\u0026#34;$HOME/.meteor-install-tmp\u0026#34; rm -rf \u0026#34;$INSTALL_TMPDIR\u0026#34; mkdir \u0026#34;$INSTALL_TMPDIR\u0026#34; echo \u0026#34;Downloading Meteor distribution\u0026#34; curl --proxy https://ggbrau:Daleks37@10.120.28.130:80--progress-bar --fail \u0026#34;$TARBALL_URL\u0026#34; | tar -xzf - -C \u0026#34;$INSTALL_TMPDIR\u0026#34; -o # bomb out if it didn\u0026#39;t work, eg no net test -x \u0026#34;${INSTALL_TMPDIR}/.meteor/meteor\u0026#34; mv \u0026#34;${INSTALL_TMPDIR}/.meteor\u0026#34; \u0026#34;$HOME\u0026#34; rm -rf \u0026#34;${INSTALL_TMPDIR}\u0026#34; # just double-checking :) test -x \u0026#34;$HOME/.meteor/meteor\u0026#34; Getting started After a nice installation process we can continue to the getting started phase.\nSo, the documentation tells us that we have to simply execute a command.\nmeteor create simple-todos At this point we should get a directory structure which is written in the manual. And, behold, that\u0026rsquo;s exactly what happened. As usually, creating a skeleton is easy. Lets run the app. For that, the command is:\nmeteor I can do that, I think.\nAnd sure enough, I\u0026rsquo;ve got this little message, which I actually expected to see:\nCan\u0026#39;t listen on port 3000. Perhaps another Meteor is running? In this world, where there are tons of applications running on your dev environment at any given time, it\u0026rsquo;s possible to have something already running on the port 3000. Luckily this is something that\u0026rsquo;s anticipated by now, and we are presented with an option to add in a proxy setting of our choice with -port .\nAfter I did that, I\u0026rsquo;ve got a nice confirm message that meteor is up and running. A quick check on the presented URL provided me with the confidence that my app is indeed reachable.\nApp running at: http://localhost:9999/ After Getting Started. Now that we know that it\u0026rsquo;s up and running we can continue with the tutorial. Up comes next a simple Todo list application with Templates. It\u0026rsquo;s telling us to replace the code in the default starter app. At this point I\u0026rsquo;m wondering if it can hotswap. It should, since javascript and HTML is dynamic so there should be no problems there, right?\nAnd sure enough, the moment I replaced the code and checked on my server status, I could see this:\nClient modified -- refreshing Meteor server restarted With a brief flash of \u0026ldquo;Rebuilding.\u0026rdquo;. So it does sort of work. It did, however, restart the server it just did it without your manual intervention. Which is nice, but on a larger scale application it might prove to be a tad bit annoying. For example, I add another item to the list, and suddenly, the server is restarted.\nSince, I am a tester, let\u0026rsquo;s see how it handles some problems.\nI modified the JavaScript so that it has a syntax error.\n// simple-todos.js if (Meteor.isClient) { // This code only runs on the client Template.body.helpers({ tasks: [ { text: \u0026#34;This is task 1\u0026#34; }, { text: \u0026#34;This is task 2\u0026#34; }, { text: \u0026#34;This is task 3\u0026#34; } { text: \u0026#34;This is task 4\u0026#34; } ] }); } Note the missing \u0026ldquo;,\u0026rdquo;. And, nicely enough I\u0026rsquo;m getting an error message telling me that I messed something up:\nErrors prevented startup: While building the application: my_cool_app.js:10:7: Unexpected token { Your application has errors. Waiting for file change. It even tells you where the error is and it\u0026rsquo;s waiting for you to fix it. After I\u0026rsquo;ve corrected my error it compiled fine and the application is up and running. Deleting the files did little difference as did corrupting the HTML pages or the CSS file. Nothing to see here, moving on.\nAndroid Device I\u0026rsquo;m sure everybody can read a manual and continue with collections, forms, events and such. What I\u0026rsquo;m more interested in is that Meteor promises it can run on Android devices. Now that perked my curiosity. With the rise of mobile devices, the desktop platform is slowly pushed back into a dark corner where even a Tineye would have problems seeing it.\nHence, I want to see how easy it really is.\nMeteor gives you a set of commands to install the android sdk and droid support for your application, which is nice. You just need to run this:\nmeteor install-sdk android meteor add-platform android # Perform this step in the app\u0026#39;s folder and agree to terms and conditions. Now, if you are like me, someone who has experience with the android SDK and its emulator, you\u0026rsquo;ll know that running that thing requires more time and processing power than simulating the chances of Leonardo DiCaprio winning an Oscar. I\u0026rsquo;ll use a real device instead. For that, it appears I only have to run a simple command again.\nmeteor run android-device And sure enough the app appeared on my device.\nThis is actually quite awesome. I only plugged in my device, enabled developer options and USB debugging and that\u0026rsquo;s it. I\u0026rsquo;m quite impressed so far with Meteor and the Power of JavaScript. The app is on my phone and the static JavaScript parts are still working even though I shut the server down.\nSo my next burning question is. Will it Blend? I mean, Perform?\nBenchmarking So, now that I know that using, installing and getting started is pretty simple, what I also would like to know is how well it performs.\nI have a quad core i7 16GB RAM Samsung SSD running Linux. Let\u0026rsquo;s see 100 threads 10 second interval 10 times loop for a start. Look at how gorgeous this is.\n40ms on average. Now let\u0026rsquo;s crank it up and I\u0026rsquo;m performing the test on a separate machine but still on the same network. 1000 threads.\nThis time I\u0026rsquo;ve got a bit more churn and my pc started to fan like there is no tomorrow. But the server stayed stable. Latency did not waver for a bit. Next, 10.000 for as long as my machine can handle it.. Better save my work. Hah, my JMeter died. But it clocked at an average of 1000ms response time and the server stayed absolutely stable with no package lost, or errors.\nConclusion I can say with a full heart that I\u0026rsquo;m impressed by Meteor and I very much like it. It\u0026rsquo;s easy to use, even more easy to install and definitely can handle itself given that it\u0026rsquo;s rather lightweight. The hot swapping / server re-starting can\u0026rsquo;t be avoided, but that\u0026rsquo;s only a minor inconvenience and we got used to that already.\nI recommend Meteor and I\u0026rsquo;ll be playing around with it a bit more for sure.\nThanks for reading! Gergely.\n","permalink":"https://skarlso.github.io/2015/01/29/javascript-web-framework-meteor/","summary":"Hi,\nThis time I would like to write about something that interests me. I wanted to try out a pure JavaScript web framework.\nMy choice is: Meteor. Looks interesting enough and it was recommended by a friend of mine. So, let\u0026rsquo;s dive in.\nInstallation As always, one starts with installation. The page tells us to follow this simple step:\ncurl https://install.meteor.com/ | sh Easy enough, when you are on Linux. Turns out, that there is no official release yet for Windows.","title":"JavaScript Web Framework – Meteor"},{"content":"Hi,\nLet\u0026rsquo;s face the horrible truth:\nIt\u0026rsquo;s rare / never happens that a manager / scrum master / product owner actually reads your cucumber test cases.\nBack in the old days, this was one of the selling points of human readable tests and DSLs. It sounds nice and I\u0026rsquo;m sure in a utopia it also works.\nBDD is a very nice approach to write tests if used in a correct way. And I can relate that at some point, a manager or the product owner, actually writes up a draft of the tests. But that enthusiasm very rarely stays for the rest of the project.\nEspecially when you get to the point where your Cucumber test cases start to look something like this:\nScenario: User list Given I post to \u0026#34;/users.json\u0026#34; with: \u0026#34;\u0026#34;\u0026#34; { \u0026#34;first_name\u0026#34;: \u0026#34;Steve\u0026#34;, \u0026#34;last_name\u0026#34;: \u0026#34;Richert\u0026#34; } \u0026#34;\u0026#34;\u0026#34; And I keep the JSON response at \u0026#34;id\u0026#34; as \u0026#34;USER_ID\u0026#34; When I get \u0026#34;/users.json\u0026#34; Then the JSON response should have 1 user And the JSON response at \u0026#34;0\u0026#34; should be: \u0026#34;\u0026#34;\u0026#34; { \u0026#34;id\u0026#34;: %{USER_ID}, \u0026#34;first_name\u0026#34;: \u0026#34;Steve\u0026#34;, \u0026#34;last_name\u0026#34;: \u0026#34;Richert\u0026#34; } \u0026#34;\u0026#34;\u0026#34; If a product owner reads this, his reaction will be like: \u0026ldquo;What the hell is this? What\u0026rsquo;s users.json? Why is it there? Why should I even care? What\u0026rsquo;s a JSON response? Why should it match with the request? And what, if I keep the id at USER_ID? Huh?\u0026rdquo;\nIt\u0026rsquo;s easy to get overwhelmed by things like this scenario when you start introducing actors into your tests and payloads to your public API. And suddenly you\u0026rsquo;ll end up with cucumber features which no other will be able to understand but the person who wrote it.\nI\u0026rsquo;m a little bit skeptic that it ever worked as intended. Sure, for a little while. But the dynamic nature of tests will surface soon enough. You can\u0026rsquo;t hide it forever.\nThe above example, if the payload and user would be hidden in a reusable code fragment behind the implementation, would look a bit more readable:\nScenario: User list Given I post to user list with data | firstname | Steve | | lastname | Richert | When I get a response from the SUT Then the response should have the same user See? Easier to understand. I don\u0026rsquo;t care about the payload. I don\u0026rsquo;t care about the user ID, in fact, I would rather see this test as a unit test somewhere deep down in the bowls of the system. Although I can understand that you want a set of automated UATs.\nI\u0026rsquo;m sure Cucumber has a couple of success stories behind his back, I just didn\u0026rsquo;t happen to come across them as of late. But please, if you have one, share it with me so I can rest easily.\nGergely.\n","permalink":"https://skarlso.github.io/2015/01/28/when-cucumber-goes-wrong/","summary":"Hi,\nLet\u0026rsquo;s face the horrible truth:\nIt\u0026rsquo;s rare / never happens that a manager / scrum master / product owner actually reads your cucumber test cases.\nBack in the old days, this was one of the selling points of human readable tests and DSLs. It sounds nice and I\u0026rsquo;m sure in a utopia it also works.\nBDD is a very nice approach to write tests if used in a correct way.","title":"When cucumber goes wrong"},{"content":"I thought I throw my grudge out of the window against Scala and try something with it.\nI also got my hands on a fairly new book, called: \u0026ldquo;Learning Scala: Practical Functional Programming for the JVM\u0026rdquo;. Turns out to be a rather fun book to read. And Jason Swartz has a nice way of writing. So I wanted to play around with Play 2 Framework. It now comes packaged in Activator.\nSo, I started the long path from almost zero to handle all that. I\u0026rsquo;m running the latest Ubuntu ( 14 ) and latest Java ( 8 ). The list: Scala, SBT, IntelliJ, Play ( through activator ).\nI was pleased that, considering a network which allowed me a download speed of ~1.5MB/s ( that\u0026rsquo;s byte, not bit ), I was up and running in about 4 minutes. That\u0026rsquo;s Play running, with a test application created through activator and then imported into an IntelliJ Scala project.\nI\u0026rsquo;m impressed.\nI added SBT through the package manager like this:\necho \u0026quot;deb http://dl.bintray.com/sbt/debian /\u0026quot; | sudo tee -a /etc/apt/sources.list.d/sbt.list sudo apt-get update sudo apt-get install sbt It\u0026rsquo;s really simple.\nAfter that, I did an apt-get on the latest Scala.\nI already had IntelliJ.\nActivator download took me ~1 minute; then I executed the command to create a test app:\n\u0026lt;span class=\"pln\"\u003e$ activator new my\u0026lt;/span\u003e\u0026lt;span class=\"pun\"\u003e-\u0026lt;/span\u003e\u0026lt;span class=\"pln\"\u003efirst\u0026lt;/span\u003e\u0026lt;span class=\"pun\"\u003e-\u0026lt;/span\u003e\u0026lt;span class=\"pln\"\u003eapp play\u0026lt;/span\u003e\u0026lt;span class=\"pun\"\u003e-\u0026lt;/span\u003e\u0026lt;span class=\"pln\"\u003escala\u0026lt;/span\u003e Simple. Activator downloaded everything my system was still missing.\nThen run the start command:\n\u0026lt;span class=\"pln\"\u003e$ cd my\u0026lt;/span\u003e\u0026lt;span class=\"pun\"\u003e-\u0026lt;/span\u003e\u0026lt;span class=\"pln\"\u003efirst\u0026lt;/span\u003e\u0026lt;span class=\"pun\"\u003e-\u0026lt;/span\u003e\u0026lt;span class=\"pln\"\u003eapp $ activator\u0026lt;/span\u003e And you are ready to rock \u0026amp; roll. Importing it in IntelliJ was a blink of an eye.\nI\u0026rsquo;m really impressed with how easy getting started became with these projects and frameworks. I remember a time where I had to configure everything, get tomcat and the whole JVM or Jetty or whatnot, and try to get up and running took half a day at least. Would my internet be faster, I think this would have been even less.\nI\u0026rsquo;ll post more as I go forward.\nAs always,\nThanks for reading.\n","permalink":"https://skarlso.github.io/2015/01/27/from-zero-to-hundred-in-four-seconds/","summary":"I thought I throw my grudge out of the window against Scala and try something with it.\nI also got my hands on a fairly new book, called: \u0026ldquo;Learning Scala: Practical Functional Programming for the JVM\u0026rdquo;. Turns out to be a rather fun book to read. And Jason Swartz has a nice way of writing. So I wanted to play around with Play 2 Framework. It now comes packaged in Activator.","title":"From Zero to Hundred in Four seconds"},{"content":"Hello everybody.\nToday, I would like to write about little observation I made along the way of being a tester.\nThe title says it all. I think Testers, are like scientists. I would go even further, and say: Testers, are scientists.\nLet us see how the two compare.\nAsking Questions A scientist is all about asking the right question to the right person, or the right subject matter. They are using the same 5 Ws as we are. Who, Why, What, When, Where. It\u0026rsquo;s simple, really. Asking the right question is sometimes the most difficult task of them all. Ideas come from these questions. They can also help in flushing out early design problems with the experiment / product.\nIdentify the subject matter This one is all about getting to know your environment and taking notes while you are doing so. Become familiar with what you are working with, and what tools you are using in your research. Which standards are you following, and why? It\u0026rsquo;s the same, when a Tester finds herself/himself in a new environment and tries to get her(is) bearing what the task is and how to perform it.\nFirst impression, outline of an idea The first impression will result in a vague idea of what the problem is about. This is the stage where the first thoughts emerge and the first draft of a possible solution is crafted into existence. This is the part where a person will draw information, power, and knowledge from her(is) past resulting in a solution that can get close to a real one; but rarely is this solution the one which will be chosen in the end.\nTesting Indeed in the life of a scientist it is imperative that ideas, solutions and vague drafts of brainstormed possibilities are **tested all the way through. **For a tester it\u0026rsquo;s just as important that all the cases are verified and \u0026lsquo;approved\u0026rsquo; by either common sense, the requirements, or any other kind of verification that they can come up in certain environments. Fact is, that if a solution / test case is a valid one, depends on several different options based on any given circumstance. That is why it\u0026rsquo;s difficult to decide if something is acceptable or not. What is a good solution in one case, might be entirely wrong in another.\nResults If the tests / variables / cases / solutions are satisfying, then we can come to think about producing an actual result. The result could be anything of value to the observer. A failing test could be a good result, if we actually were waiting for that test to fail. In that case the result is a success. So bare in mind that a failing test, a failed solution to an experiment, is **always **also information which **tells you something important. **Never dismiss a failing test, a failed experiment, a failed solution. It gives you a **hint **for a passing one.\nCommunity and Sharing Scientists have a large community where they are sharing experiments and discoveries. I think I don\u0026rsquo;t have to draw a parallel here. We all know several testing pages, forums, events, gatherings where there are people talking about the subject matter. I\u0026rsquo;m proud that it such a long way.\nPractice, practice, practice I think this one is self explanatory. In order to become good at something, we have to continuously do it. There is no magic formula, no pill you can take, no matrix to download Kung Fu, you have to do it to learn it. You have to practice it, gather experience and share / write them down in order to strengthen your knowledge and understanding about it. Writing it out, and sharing information, **explaining it to somebody else, **will make it stick better and increase your knowledge in return. So start a blog now, even if you will have only a few readers it will be worth it. Just by writing a couple of lines about something will make you remember it better, and your understanding of it deeper.\nSo, there you have it. I think these are pretty good points that let\u0026rsquo;s us identify ourselves. It\u0026rsquo;s called Computer science for a reason.\nAs always,\nThanks for reading,\nGergely.\n","permalink":"https://skarlso.github.io/2015/01/26/why-testers-are-like-scientists/","summary":"\u003cp\u003eHello everybody.\u003c/p\u003e\n\u003cp\u003eToday, I would like to write about little observation I made along the way of being a tester.\u003c/p\u003e\n\u003cp\u003eThe title says it all. I think Testers, are like scientists. I would go even further, and say: Testers, are scientists.\u003c/p\u003e\n\u003cp\u003eLet us see how the two compare.\u003c/p\u003e","title":"Why Testers are, like scientists"},{"content":"Hello Everybody.\nThis time I\u0026rsquo;d like to write about the expressiveness of a Test. I think that it\u0026rsquo;s very important to write understandable and expressive tests. In older times I was studying novel writing. There is a rule which a novel needs to follow. It goes something like this: \u0026ldquo;A novel needs to lead its reader and make him understand in the simplest way what\u0026rsquo;s going on, with whom and why?\u0026rdquo;. In other words, it\u0026rsquo;s not a puzzle. It should be obvious what the test is trying to do and it should not require the reader to try and solve it in order to understand it.\nI\u0026rsquo;m planning this as a series since there are multiple problems with a test I can talk about here.\nGeb Tests\nExample:\ndef \u0026#34;login to the home page\u0026#34;() { given: \u0026#34;I am at homepages\u0026#34; go \u0026#34;http://localhost:8080/home\u0026#34; at HomePage when: \u0026#34;I entir my credential\u0026#34; filloutLoginForm(\u0026#34;username\u0026#34;, \u0026#34;password\u0026#34;) at MyAccountPage then: \u0026#34;I can accass my wallet\u0026#34; openWallet() waitFor { contains(\u0026#34;Balance\u0026#34;) } } Now, read this test. It doesn\u0026rsquo;t really make any sense at the first read, right? You need to actually think what is going on there. Of course if you read it slow enough you\u0026rsquo;ll get what it\u0026rsquo;s trying to do. But you don\u0026rsquo;t know what fillform does. Apparently it also submits the form because after fillform you are suddenly at MyAccountPage.\nThere are several things wrong with this one, let\u0026rsquo;s start with the pageobject.\nPageObjects\nAt and toAt return page objects. We can use that to actually make the calling explicit and make it more readable and identify where a function comes from.\ndef \u0026#34;login to the home page\u0026#34;() { given: \u0026#34;I am at homepages\u0026#34; go \u0026#34;http://localhost:8080/home\u0026#34; HomePage homePage = at HomePage when: \u0026#34;I entir my credential\u0026#34; homePage.filloutLoginForm(\u0026#34;username\u0026#34;, \u0026#34;password\u0026#34;) MyAccountPage myAccountPage = at MyAccountPage then: \u0026#34;I can accass my wallet\u0026#34; myAccountPage.openWallet() waitFor { contains(\u0026#34;Balance\u0026#34;) } } This reads much better now. You know where the function is coming from and your IDE will not go nuts from things it can\u0026rsquo;t find. And you have autocompletion so there is no fear that you simply mistype something.\nSide effects\nNext step, let\u0026rsquo;s remove some of the side effects.\ndef \u0026#34;login to the home page\u0026#34;() { given: \u0026#34;I am at homepages\u0026#34; go \u0026#34;http://localhost:8080/home\u0026#34; HomePage homePage = at HomePage when: \u0026#34;I entir my credential\u0026#34; homePage.filloutLoginForm(\u0026#34;username\u0026#34;, \u0026#34;password\u0026#34;) homePage.submitLoginForm() MyAccountPage myAccountPage = at MyAccountPage then: \u0026#34;I can accass my wallet\u0026#34; myAccountPage.openWallet() waitFor { myAccountPage.accountIsDisplayed() } } Now this is again much better. There are no steps left out. And you can test now the FillForm and the submit independently. Like, submitting the form without filling it out! Or filling it out and not submiting it. Reads better, is explicit, more easy to understand.\nAnd the last one for today:\nGrammar\nI wonder if you noticed it. The grammar is a little bit off in the tests. A small mistake here and there. You might think that, who cares? That\u0026rsquo;s a very bad thought. I think the correct grammar reflects caring. It reflects that we thought about this test and that we thought about the quality of it. Because it means that after you wrote it, you actually re-read the test to make sure it\u0026rsquo;s understandable and readable.\nSo let us correct that:\ndef \u0026#34;login to the home page\u0026#34;() { given: \u0026#34;I am at homepages\u0026#34; go \u0026#34;http://localhost:8080/home\u0026#34; HomePage homePage = at HomePage when: \u0026#34;I entir my credential\u0026#34; homePage.filloutLoginForm(\u0026#34;username\u0026#34;, \u0026#34;password\u0026#34;) homePage.submitLoginForm() MyAccountPage myAccountPage = at MyAccountPage then: \u0026#34;I can accass my wallet\u0026#34; myAccountPage.openWallet() waitFor { myAccountPage.accountIsDisplayed() } } def \u0026#34;As a player I can log in to check my account.\u0026#34;() { given: \u0026#34;I am at the homepage\u0026#34; go \u0026#34;http://localhost:8080/home\u0026#34; HomePage homePage = at HomePage when: \u0026#34;I enter my log in credentials.\u0026#34; homePage.filloutLoginForm(\u0026#34;username\u0026#34;, \u0026#34;password\u0026#34;) homePage.submitLoginForm() MyAccountPage myAccountPage = at MyAccountPage then: \u0026#34;I\u0026#39;m directed to my account page.\u0026#34; myAccountPage.openWallet() waitFor { myAccountPage.accountIsDisplayed() } } I also took the liberty of re-phrasing some of the text so that it shows what the test is about and what the user really would like to achieve here. Now try reading that last one. Does it make more sense? Did you understand it at first go? Did it read like a good story?\nThere is a coding practice which goes something like this: \u0026ldquo;Good code is code which doesn\u0026rsquo;t surprise you as you read it.\u0026rdquo; Which means the exact thing happens which you thought of would happen. I think that applies to tests as well. The steps of the test shouldn\u0026rsquo;t come to you as a surprise. Especially if you know what the application is supposed to do.\nSo that\u0026rsquo;s all for today folks. Thank you for reading! If you have a nasty test which you would like me to dissect and make it better and human readable, please share it in the comment section and I will do my best to come up with a good solution for it.\nAnd as always,\nHave a nice day!\nGergely.\n","permalink":"https://skarlso.github.io/2014/11/15/why-the-expressiveness-of-your-tests-is-important-part-one/","summary":"\u003cp\u003eHello Everybody.\u003c/p\u003e\n\u003cp\u003eThis time I\u0026rsquo;d like to write about the expressiveness of a Test. I think that it\u0026rsquo;s very important to write understandable and expressive tests. In older times I was studying novel writing. There is a rule which a novel needs to follow. It goes something like this: \u0026ldquo;A novel needs to lead its reader and make him understand in the simplest way what\u0026rsquo;s going on, with whom and why?\u0026rdquo;. In other words, it\u0026rsquo;s not a puzzle. It should be obvious what the test is trying to do and it should not require the reader to try and solve it in order to understand it.\u003c/p\u003e","title":"Why the expressiveness of your Tests is important – Part One"},{"content":"Hello everybody.\nI would like to share with you a small script I wrote to update all, or a single, Jenkins job from a Python script remotely.\nThis will enable you to update a Jenkins job from anywhere using an admin credential based on a config.xml template that you have. With this, if you want to apply a config change to all or just a single job in Jenkins, you don\u0026rsquo;t have to go and do it for all the rest. You just call this script and it will cycle through all the jobs you have and update them if the begin with \u0026ldquo;yourpipelinedelimiter\u0026rdquo; or if they aren\u0026rsquo;t in a restricted list of jobs. The delimiter helps to identify pipelines which are dev pipelines. If you have multiple pipelines which are helpers or builders and you don\u0026rsquo;t usually apply the same config to them, than the delimiter can help identify the dev pipelines you actually want to update.\nEnjoy, hope it helps someone.\nAnd now, without any further ado:\n\u0026#39;\u0026#39;\u0026#39; Created to update multiple pipelines in jenkins with a given configuration and job list. Usage: Example 1: Updating a single pipeline\u0026#39;s job with a given config.xml. python update-jenkins-jobs.py job-name config.xml pipeline-name Example 2: Updating every pipeline in jenkins dynamically. !!!WARNING!!! This updates every job EXCEPT of the ones specified in restricted_jobs. python update-jenkins-jobs.py job-name config.xml \u0026#39;\u0026#39;\u0026#39; from xml.dom import minidom import requests import sys def update_pipeline(pipeline): \u0026#39;\u0026#39;\u0026#39; Takes in a list of pipelines to update. \u0026#39;\u0026#39;\u0026#39; config_file = open(config_to_use, \u0026#39;rb\u0026#39;) headers = {\u0026#39;content-type\u0026#39;: \u0026#39;application/xml\u0026#39;} print(\u0026#34;Updating pipelines: \u0026#34;, pipeline) for dev_job in pipeline: url = \u0026#34;http://jenkins:9999/job/%s/job/%s/config.xml\u0026#34; % (dev_job, job_to_update) r = requests.post(url, data=config_file, headers=headers, auth=(\u0026#39;user\u0026#39;, \u0026#39;password\u0026#39;)) print(\u0026#34;Updating pipeline: %s; Response Code: %s\u0026#34; % (dev_job, r)) def get_dev_pipelines(): \u0026#39;\u0026#39;\u0026#39; Gets a list of pipelines which can be used by update_pipeline. \u0026#39;\u0026#39;\u0026#39; r = requests.get(\u0026#39;http://jenkins:9999/api/xml\u0026#39;, auth=(\u0026#39;user\u0026#39;, \u0026#39;password\u0026#39;), stream=True) job_list_xml = r.text xmldoc = minidom.parseString(job_list_xml) itemlist = xmldoc.getElementsByTagName(\u0026#39;name\u0026#39;) dev_job_list = [] restricted_jobs = [\u0026#34;yourpipelinedelimiter-dev-pipeline1\u0026#34;, \u0026#34;yourpipelinedelimiter-dev-pipeline2\u0026#34;, \u0026#34;yourpipelinedelimiter-dev-pipeline3\u0026#34;] for s in itemlist: if (\u0026#34;yourpipelinedelimiter-dev\u0026#34; in s.firstChild.nodeValue) : value = s.firstChild.nodeValue if (value not in restricted_jobs): dev_job_list.append(value) return dev_job_list job_to_update = sys.argv[1] config_to_use = sys.argv[2] dev_pipeline = [] if len(sys.argv) \u0026gt;; 3: print(\u0026#34;Args length:\u0026#34;, len(sys.argv)) dev_pipeline.append(sys.argv[3]) update_pipeline(get_dev_pipelines() if not dev_pipeline else dev_pipeline) Thanks for reading.\nGergely.\n","permalink":"https://skarlso.github.io/2014/11/07/updating-all-jenkins-jobs-via-jenkins-api-python/","summary":"Hello everybody.\nI would like to share with you a small script I wrote to update all, or a single, Jenkins job from a Python script remotely.\nThis will enable you to update a Jenkins job from anywhere using an admin credential based on a config.xml template that you have. With this, if you want to apply a config change to all or just a single job in Jenkins, you don\u0026rsquo;t have to go and do it for all the rest.","title":"Updating All Jenkins Jobs Via Jenkins API – Python"},{"content":"Hi Folks!\nI just wanted to share with you my mind map on the seven principles of Context Driven Testing.\nI used the notion of dragons since it\u0026rsquo;s seven. And a dragon is usually seven headed in my mind.\nSo without further ado.\nClick for larger image.\nI have a hand drawn as well but I\u0026rsquo;m guessing that one wouldn\u0026rsquo;t be of much use since it follows my own imagination.\nHere are the seven principles in points which correspond to the leafs.\nValue -\u0026gt; Practice -\u0026gt; Depends -\u0026gt; Context =\u0026gt; The value of any practice depends on its context. People -\u0026gt; Working -\u0026gt; Together -\u0026gt; Important =\u0026gt; People, working together, are the most important part of any project’s context. ( The mob, trying to kill the dragon by working together. ) Problem -\u0026gt; Project -\u0026gt; Solution =\u0026gt; The product is a solution. If the problem isn’t solved, the product doesn’t work. ( The sword. It\u0026rsquo;s a sword but if it doesn\u0026rsquo;t kill the Dragon it\u0026rsquo;s useless. ) Good Testing -\u0026gt; Intellectual Challenge =\u0026gt; Good software testing is a challenging intellectual process. ( Well it\u0026rsquo;s a dragon with glasses. That\u0026rsquo;s something you rarely see. ) Good Practice | Bad Practice -\u0026gt; In Context -\u0026gt; No Best Practices =\u0026gt; There are good practices in context, but there are no best practices. ( This one was a little bit tricky. But basically you want to solve the dungeon and not plow through it ) Uncertainty =\u0026gt; Projects unfold over time in ways that are often not predictable. ( For me this one word was enough. ) Exercised By All In Time -\u0026gt; Judgement | Skill | Cooperatively =\u0026gt; Only through judgment and skill, exercised cooperatively throughout the entire project, are we able to do the right things at the right times to effectively test our products. ( It\u0026rsquo;s a flexing dragon. Easy, right? ) So this map helped me to remember everything. The descriptions, applications that are further described I remembered by using this mind map as a loci.\nI hope somebody found this useful.\nThanks for reading!\nGergely.\n","permalink":"https://skarlso.github.io/2014/10/23/the-seven-guidelines-of-context-driven-testing/","summary":"Hi Folks!\nI just wanted to share with you my mind map on the seven principles of Context Driven Testing.\nI used the notion of dragons since it\u0026rsquo;s seven. And a dragon is usually seven headed in my mind.\nSo without further ado.\nClick for larger image.\nI have a hand drawn as well but I\u0026rsquo;m guessing that one wouldn\u0026rsquo;t be of much use since it follows my own imagination.","title":"The seven Principles of Context Driven Testing – Mind Map"},{"content":"Hello Everybody.\nToday I\u0026rsquo;d like to write a little bit about a python course I did.\nIt\u0026rsquo;s an 8 week course on algorithmic programming with fun little projects. I\u0026rsquo;d like to write down some of my solutions with pseudo code for my own better understanding and for the sake of sharing knowledge. I won\u0026rsquo;t, however, share full projects since that would be against the honour code.\nLet\u0026rsquo;s begin.\nWeek Zero\nThis week was all about getting the hang out of reading the posts and the documentation and the questions and getting used to the wordings. The tutors really out did themselves. They tried to make a course that can be both funny and teach something at the same time which is anything but easy.\nEven though the tasks that were given were interesting al-bight at times a little bit far stretched and could have been easier done if used something else to complete them. But if we would have done that, what\u0026rsquo;s the point of it all then?\nSo I\u0026rsquo;ll try to recall everything solely based on my notes taken in those 8 weeks. Let\u0026rsquo;s see how much I truly learned.\nAssignment of week one\nWe were to build the game 2048 which if you played you know what it is all about.\nThe goal is to add up numbers so that higher and higher numbers are created. There is no real \u0026ldquo;end\u0026rdquo; of the game. You can continue as long as you have space left although the intended goal is to create 2048. There are a couple of clones of this game and we were supposed to write one this time of our own.\nWe approached this game with the intention of refreshing our memory about Python. Handling matrices python syntax, counting indices and a bit of assessment about the general understanding of Mathematics and programming from the populace.\nI must say it was hard. It was hard to get back into the habit of properly thinking about something at first. It was hard to get used to Math again which I missed for a very long time. I forgot many things and as English is not my first language many things written about Math in English were extremely hard to understand in the beginning.\nBut thankfully for my trusty mathematics Bible in Hungarian I was saved.\nThis book is 1448 pages long but contained all the information necessary to get my mind back into the game. And oh boy was it worth the initial trouble. I had to first realize that I forgot so much it was very painful and immensely disappointing, frustrating and shameful. But you should never give up and so I fought my way through it.\nAnd it was extremely helpful to do Tests First. As the grading was based on how many of a given set of Unit Tests were passing it was very helpful to start tests first which were leading the design of the program. Also it was crucial to work in as little chunks as possible since one could easily lost himself trying to grasp a problem proving to be too large to look at from afar.\nThe hard part about this project was the Merging of the numbers and creating the proper grid which results from the Merge. Here are some examples:\n[2, 0, 2, 4] should return [4, 4, 0, 0] [0, 0, 2, 2] should return [4, 0, 0, 0] [2, 2, 0, 0] should return [4, 0, 0, 0] [2, 2, 2, 2] should return [4, 4, 0, 0] [8, 16, 16, 8] should return [8, 32, 8, 0] In order to achieve this you must trim the zeros like this [2,2,4] and than produce the result which is [4,4] and put a couple of zeros at the end [4,4,0,0]. My first though was to use the Deque class in Python in order to achieve this but that was an outside module which was not allowed.\nIt was an interesting way to begin the course. Many people left at this point and were leaving afterwards too. Most of them in frustration that they were missing the python knowledge the rest out of frustration of not knowing the necessary math. At the end though it was getting easier to follow the problems after we got used to the conventions and sentence structures. The professors were also helpful and sometimes re-worded some of the descriptions to better describe what they wanted.\nWeek One\nSo after a hard start we moved on to a very interesting week one. This one got me into a certain game I don\u0026rsquo;t want to see ever again. It\u0026rsquo;s name: Cookie Clicker.\nWe sort of had to re-create the cookie clicker but without the clicking. We only were supposed to re-create the buying of upgrades and simulate a sequence of clicks via the means of a cycle.\nIn this week the description of the tasks was, at the least, confusing. They started to use the term _time _which lead many to believe that we were somehow supposed to use python\u0026rsquo;s date / time methods and libraries. But after a couple of re-reads it was apparent that by _time _they actually were referring to cycle count.** **\nKnowing this made the task at hand a lot easier. This time around our main focus were the following:\nMathematical Sums Finding the Max Higher - Order functions Plotting with Python The course just went into overdrive. We were looking lot at things like these:\n∑n i=0 α^i = α^0 + α^1 + α^2 + ... + α^n = α^(n+1) − 1 / α − 1 (2021 Hindsight): It\u0026rsquo;s funny how I\u0026rsquo;m looking at this now, and it immeditely makes perfect sense. I love how evolved in that regard over the time.\nIt was rather awesome though frustrating at first like I wrote earlier. These were the easier one.\nFinding the maximum is trivial. Especially if you are using a built in **max **provided by Python. But if you mix it with Higher-Order functions it gets interesting. If you want to do anything else as well and not just a max, for example getting the index of the maximum item as well, you usually end up writing a custom Max any ways.\nPlotting in Python was exquisite interesting. The garphs which were produced showed as an insight into how powerful a solution really is or how effective. Here came in the Big-O notations almost. To see if a function was exponential, logarithmic or plain polynomial. O(n), O(n^2), O(logn) etc, etc.\nThis resulted in very interesting graphs like this:\nWeek Two\nSo last week we had plotting and counting this week was even more interesting. Week Two\u0026rsquo;s main focus was Probability. Specifically the Monte Carlo methods. Tl;dr; it describes that if you try something enough times you can derive a result that will be, with very high probability, the one you are looking for (expected value).\nWe tried out this algorithm by playing a nice game of tic-tac-toe.\nThe point of this exercise was to create a machine player which, after running a 1000 or so random scenarios, was choosing the best option given a certain game state. It was difficult to get the results to always return a correct answer. At this point last weeks plotting became important since if your Monet Carlo algorithm was not fast enough the program was running increasingly slower and slower.\nI was not very satisfied with my solution. It worked, but it was very slow and it wasn\u0026rsquo;t always returning the best option.\nWeek Three\nSo what comes after probability? Correct. **Combinatorics. **\nThe next hill to climb was combinatorics. Fortunately for me I love probability and combinatorics so this was a little bit easier for me. I was getting the hang out of function calculation as well so I wrote better homework and better projects at this point. Which is the aim of the course, right?\nThe game we used for this approach was Yahtzee.\nNow let me say this without too much remorse. I truly, fully and with all my heart, hate Yahtzee. I think it\u0026rsquo;s stupid. I\u0026rsquo;m sorry. I truly do. The only thing I can think of when I hear yahtzee is the South Park version of it.\nSouth Park Version of Yahtzee + Tron:\nI share the enthusiastic look of Stan here.\nAnyhow, moving on. Thank to the coursera Gods we weren\u0026rsquo;t suppose to write a whole game of Yathzee just a very simplified version of it. We were supposed to count the upper combinations on the second throw. So you already have one throw and you must choose how many die you want to hold on to to maximise the possibility of the best outcome possible. Huh. come again?\nSo you already had a hand. And now the program was to determine which die you were supposed to hold on too in order to maximise the score you can achieve with the remaining two throws.\nThere were a few interesting things that came in with this task. For example this was the first time I could use a Dict init from a list with a zip.\nhand_dict = dict(zip(list(hand), []*len(hand))) And this was the point in course were I found perhaps the most interesting thing. I found an actual use for reduce which was working. I was beginning to get into the habit of using map, filter, reduce.\nThis was the beauty:\nmy_list = reduce(lambda z, x: z + [y + [x] for y in z], hand, [[]]) This piece of code produced all the combinations of a given hand which was a list of Tuples. It merged them into a list of lists which I created a list of Tuples out from. After this my life was never ever the same again.\nWeek Four\nFor me this was the most interesting part of the course. I LOVED this task. Focus was:\nPython Generators Stacks / Queues Inheritance in Python Girds Grid Search / Breadth First Search And the task with which we were supposed to achieve this was..\nZombie Apocalypse. It was sort of like Conway\u0026rsquo;s Game of Life. Given a grid in which there were Zombies, Humans and Obstacles.\nThe Zombies could only move up, down, left, right. The humans could flee diagonally and none of them could penetrate an obstacle. It was very much fun to write this. The most challenge was to learn the proper implementation of the breadth first search algorithm as the Zombies had to detect the nearest Humans to move towards to and the Humans needed to see the nearest Zombies to flee from.\nWeek Five\nHalfway through it was become difficult to maintain the time needed for this course. I was finding myself applying a few late days here and there. This was a two months course after all. I did not have all the time in the world at my disposal. But I managed to submit everything without penalties.\nSo this weeks task was rather mundane. It was a world wrangler. Which means given a word generate valid words from the letters in the provided word.\nThe algorithm we were supposed to use though was for me a bit of a challenge. I\u0026rsquo;ll be honest with you, for me, it was a little bit hard to wrap my head around this one. But eventually I succeeded.\nIt was Merge-Sort and Recursion. Let me tell you this now, I hate merge-sort. Recursion I do love though. What I never learned though and was very interesting for me to learn now was recurrences in mathematics. Well never learned is a bit harsh since I knew Fibonacci already and Pascal\u0026rsquo;s Triangle but the mathematical definition was a refreshing new view. I\u0026rsquo;m talking about Recurrence Relations.\nF(n) = F(n-1) + F(n-2) This is the Recurrence relation of the famous Fibonacci. Easy, right? Well the hard part is when you are trying to get the closed-form-expression of a Recurrence.\nWeek Six\nFinally it was coming to an end. The last week was easy so this week had to have a punch. And oh boy it did. This weeks focus:\nTrees Lambdas Illustration of Trees Minimax Depth First Search If I hated merge-sort I hated minimax more. I don\u0026rsquo;t know why but it was again very hard for me to properly grasp this concept. I mean I understood what needed to be done of course but writing it done with code proved to be more difficult then I thought it would be.\nAfter hours of research and reading finally I could come up with a solution which was working. I wouldn\u0026rsquo;t say it was good. But it was working.\nThe game with which we were supposed to demonstrate this algorithm was. Tic-Tac-Toe. Turns out that it\u0026rsquo;s rather common place to show off minimax with tic-tac-toe as it was fewer possibilities. The point of the exercise was the following.:\nTo create trees out of the possible moves given a certain game state. This time we wanted to make absolutely sure that if we can\u0026rsquo;t win the game at least we won\u0026rsquo;t loose it. And that\u0026rsquo;s the point of minimax. It will minimize your losses.\nNow there are several things about this algorithm that are hard.\nPerformance of Minimax\nIt has and always will be a very interesting task for programmers to try to achieve a better performance for these calculations. Since it\u0026rsquo;s trying to build up a tree with all the possible combinations a game can have it will end up with a huge tree which will take ages to traverse.\nA few of the solutions could be to exit the search once you have a definitive answer. If you find a winning move there is no point of looking any further. You just stop.\nYou can create the tree dynamically. You can make it somehow intelligent enough to predict a possible best first move and then use minimax on the rest. Or use Alpha-beta pruning.\nWeek Seven\nAnd so we are coming to an end. Last weeks assignment was basically to put all the previous weeks knowledge together to create the application called 15 puzzle.\nNow, there was however a little addition to the previous knowledge. It was invariants. Now, I love Logic. And I\u0026rsquo;ve been actually using invariants in computer science programming and testing for a long time so this part was not really a problem.\nAn example of an invariant in python would be something like this:\nwhile x \u0026lt;= 5: x = x + 1 This is a loop invariant example. In you find a very useful invariant in your program you can write an assert for it which will help you debug your code and work in small chunks. Invariants will make refactoring your code a hell of a lot easier. As if your invariant is suddenly false you need to check what went wrong.\nwhile x \u0026lt;= 5: x = x + 1 assert x \u0026lt;= 6 This assert will make sure that if your invariant for whatever reason isn\u0026rsquo;t true your code fails immediately.\nEnd Credits\nSo this was the end of the course. I learned a a lot from this course and I\u0026rsquo;m very proud of myself for completing it. I took away a lot from this course. I took away confidence and logical thinking. I took away greater trust in my Python knowledge and that it\u0026rsquo;s very important to keep my skills from deteriorating.\nAnd I think math is important for proper, deep understanding of programming as a science. I think refreshing my math skills gave me at least a deeper trust in my ability to write a piece of code however complicated it might appear. After writing a minimax algorithm I think some Hibernate with DIP and SRP will prove to be less of a problem. Or at least a different category of a problem.. Hehe.\nThanks for reading! Gergely.\n","permalink":"https://skarlso.github.io/2014/08/25/python-course-review/","summary":"\u003cp\u003eHello Everybody.\u003c/p\u003e\n\u003cp\u003eToday I\u0026rsquo;d like to write a little bit about a python course I did.\u003c/p\u003e\n\u003cp\u003eIt\u0026rsquo;s an 8 week course on algorithmic programming with fun little projects. I\u0026rsquo;d like to write down some of my solutions with pseudo code for my own better understanding and for the sake of sharing knowledge. I won\u0026rsquo;t, however, share full projects since that would be against the honour code.\u003c/p\u003e\n\u003cp\u003eLet\u0026rsquo;s begin.\u003c/p\u003e","title":"Python Course Review"},{"content":"Hello Folks.\nSo last I was writing about why a tester should learn Javascript. Today I would like to write about why a tester should learn SQL.\nThere, I said it. I know many people, especially testers, don\u0026rsquo;t like SQL. They view it as a monster best be avoided. Something only Database people will know. Something which is so scary and ugly, nobody really wants it.\nBut I will give you a couple of good reasons why you shouldn\u0026rsquo;t be afraid of SQL. And why you should welcome it as your best friend and partner in crime.\nLet\u0026rsquo;s go.\nReason Number One: Data gathering\nThis one is obvious and clear as the sun. You can use simple queries to mine for data. To look up changes and compare time intervals between insertion and update events. You can monitor certain tables so that when they are updated, you\u0026rsquo;ll get a red flag.\nReason Number Two: Test Run Statistics\nThis one is from my friend Adrian. Basically if you would like to know more about what\u0026rsquo;s happening with your tests when they run, for example:\nRun time Frequency of Test outcome Failure rate Environment details -\u0026gt; Execution slave One interesting way to achieve this is, to have the test report running and outcomes into a little mysql database and than create queries of certain types like, show me the last run of every test called xyz and show me the environmental details and the run time. With this closely monitored you could find out that Slave #345 is sluggish because each time the test ran on it, it took more then 10 minutes where as the others only took 5-6.\nReason Number Three: Data Manipulation\nSo after monitoring comes naturally the edit. Understanding how databases work and knowing a few queries here and there can help you manipulating your data in a way that it will be easier to test data dependant scenarios.\nInstead of making a new entry you could edit what you already have.\nFor example:\nYou have a customer and you want to test the system\u0026rsquo;s ability to handle people on your site who are suspended from access. But the ability to suspend is not yet working. Will that stop you from testing this feature? Will you put this feature into blocked because: \u0026ldquo;Ohh, we can\u0026rsquo;t yet suspend a player so we need to wait until that\u0026rsquo;s done.\u0026rdquo;\nNo. You don\u0026rsquo;t wait. You dig into your database, find the necessary record, change it\u0026rsquo;s state to the desired state; even if it has a foreign key which needs to be updated or that status doesn\u0026rsquo;t exist yet, in which case you ADD it to the list of states yourself. You don\u0026rsquo;t let yourself be stopped just because something is not done yet. You move on by being clever.\nReason Number Four: Understanding Data migration issues\nA big issue these days if you go into a project where you have a previous version of what you are currently building will be migrating over old data into the new database scheme. Testing such a thing can be a pain in the butt. But it will be a LOT easier if you understand the changes. If you know what changed, how and why, you can manipulate your data in order to fit the new scheme. Or if you need to test it you won\u0026rsquo;t be afraid of running some stored procedures in a dummy database with old data and than run a few queries to see what broke and what didn\u0026rsquo;t.\nDo you have a foreign key violation somewhere when you migrated over and have no idea what do to? Time to learn some SQL so that you don\u0026rsquo;t have to run to somebody every time you encounter it. Even if you can\u0026rsquo;t fix it, the database engineers or the devs who will fix the bug will be very happy that you provided as much information as possible in your report.\nReason Number Five: Security\nSQL Injection is still at large. Even with these days frameworks doing full escapes it can\u0026rsquo;t hurt to test a couple just to be on the safe side. And writing a clever script that mines for accessible tables here and there is an essential skill in a security tester\u0026rsquo;s repertoire.\nReason Bonus: Performance, HibernateQL, Information\nLastly a bit of a bonus are these three.\nPerformance\nSuppose you are running a web application. You access a large list and you notice that it\u0026rsquo;s sort of sluggish. You first blame it on the network so you test it locally. It seems to be better now so you move on but it leaves a little voice in your head so you can\u0026rsquo;t abandon it. You go back and try locally again with a bit more data in your database.\nYou notice it\u0026rsquo;s a little bit better but it\u0026rsquo;s still somehow sluggish. Suddenly you get a hunch and turn on SQL logging in your tomcat instance. You click the link again and wait with eyes wide open on what happens next. It\u0026rsquo;s your worst nightmare.\nThe SQL queries the whole database with a simple select and than filters the data on the front-end side. Which is a really really dumb thing to do. So you file a bug for which the title is something similar to this: \u0026ldquo;Customer Transaction History query doesn\u0026rsquo;t apply WHERE | INNER SELECT | PAGING on SQL rather it filters on the application layer.\u0026rdquo;\nHibernateQL\nThis is the SQL language of hibernate which is the underlying technology in many java web frameworks these days. It uses it\u0026rsquo;s own thing called HQL. Main difference, as this page already says, is that it\u0026rsquo;s a full blown Object Oriented query language which understand inheritance and polymorphism which is very exciting.\nInformation\nLast but not least I mentioned this one earlier. You can provide more information in your bug reports as in what data you used, where was it happening, what was the last update date, which environment and what query was executed ( if you have query debugging turned on ). Whoever reads that bug report will find it very helpful that you provided enough information to reproduce it anywhere.\nBecause many times the culprit for a bug is the underlying data.\nReading and Practising resources\nHere is a very awesome picture of how to understand JOINS which is everybody\u0026rsquo;s fear.\nSQL Join Cheat Sheet And a post on Coding Horror which is essentially the same but I like how Jeff writes.\nAlso if you would like to practice writing SQL scripts and no longer be afraid of them all the rest of your life go to this site =\u0026gt; SQLZoo. It\u0026rsquo;s an interactive way of trying out your SQL skills and testing them on very clever database structures.\nBut if you, like me, love to learn PLAYING than THIS is the place for you =\u0026gt; The Schemaverse. It\u0026rsquo;s a SQL based space shooting strategy game awesomeness! Have FUN learning SQL.\nThanks for reading!\nHave a nice day|night!\nGergely.\n","permalink":"https://skarlso.github.io/2014/05/31/five-reasons-why-a-tester-should-learn-sql/","summary":"\u003cp\u003eHello Folks.\u003c/p\u003e\n\u003cp\u003eSo last I was writing about why a tester should learn Javascript. Today I would like to write about why a tester should learn SQL.\u003c/p\u003e\n\u003cp\u003eThere, I said it. I know many people, especially testers, don\u0026rsquo;t like SQL. They view it as a monster best be avoided. Something only Database people will know. Something which is so scary and ugly, nobody really wants it.\u003c/p\u003e\n\u003cp\u003eBut I will give you a couple of good reasons why you shouldn\u0026rsquo;t be afraid of SQL. And why you should welcome it as your best friend and partner in crime.\u003c/p\u003e\n\u003cp\u003eLet\u0026rsquo;s go.\u003c/p\u003e","title":"Five reasons why a tester should learn SQL"},{"content":"Is TDD dead?\nNot really. So let\u0026rsquo;s talk about this topic for a little bit.\nI\u0026rsquo;m sure you already read a gazillion posts about this debate but frankly I\u0026rsquo;m writing this for myself, to rant a little bit, you know. Because somebody is wrong on the internet and I must intervene.\nSo first of all, the hashtag #tddisdead (and I will use it shamelessly as well). This is clearly an attempt to get as many peoples attention as you can. TDD is NOT DEAD. Obviously since it has soooo many supporters how could it be dead? It\u0026rsquo;s like asking, is Design Patterns dead? Or is Functional Automation dead? Or is Oreo cookies dead?\nNo, it\u0026rsquo;s not dead. And it won\u0026rsquo;t ever be dead. It will maybe change into something new, something better even, but it will never be dead. So let\u0026rsquo;s skip that part.\nNow, about the debate.\nI haven\u0026rsquo;t hear so much bull spoken for this long since I watched the political debate of two fractions in my home country. The right wing extremists against the left wing.. I don\u0026rsquo;t know whats. And it was just that. A political debate. It had no merit and no value whatsoever. At all. Nothing.\nAnd right in the middle DHH says this:\n\u0026quot;.you\u0026rsquo;re not done until you also have tests for a piece of functionality — I\u0026rsquo;m completely on board with that.\u0026quot;.\nThat made the whole conversation completely irrelevant.\nEvery counter against TDD I heard was bull. Not in that debate, in general. People are either too lazy to write them, just don\u0026rsquo;t want to get out of their comfort zone, don\u0026rsquo;t really care about tests, or don\u0026rsquo;t really care about quality or under time pressure ( I get to this later. ).\nWhich brings me to my next point.\nQuality\nPeople seem to not care about quality that much. Would they, they would understand that having a bulletproof west will save your life when you get shot in the chest with a 357 magnum. You can flush out early design flaws you can detect early bugs and do a better system design.\nSure if you are the most intelligent man on the planet maybe you can come up with a perfect system on the first draft and then implement it flawlessly so that it doesn\u0026rsquo;t fall apart in two months time. But most people can\u0026rsquo;t. Most people make errors on the way.\nAnd yes, writing tests can be hard. But guess what? If writing a test is hard because that part of the system is complicated, than it will be that part of the system which will react the worst to change. And only change is constant. Which brings me to the next item.\nTime constraints\nSo your manager is sitting right next to you and saying come on we are paying you to write code and not tests so do it! And you have to have a feature done today but if you write a suite of tests you\u0026rsquo;ll only finish tomorrow. Sure, your estimate at that point will become a very quick one because you make a sacrifice of trust.\nAnd then the next story comes along and you say. \u0026ldquo;Sure I can do that as well. No problem I know how my system works, right? Hmm. why the hell did that break all of a sudden? I didn\u0026rsquo;t change anything in that module. Ahh damn it I said I\u0026rsquo;ll be done today, so let\u0026rsquo;s just fix this quickly and then move on to the next card.\u0026rdquo;\nAnd the next story comes along. \u0026ldquo;Sure I can do that. wait a minute. Didn\u0026rsquo;t that part brake already twice? Damn, better refactor. Ohh shit, why is that now breaking???? Damn it I said I\u0026rsquo;ll be done tomorrow, better patch it, and then move on. Hmm let\u0026rsquo;s write a test here to make sure this does not break. Ohhh damn I need PowerMock for that stuff since it\u0026rsquo;s in another module. Why the hell is that there? Should it be here in the first place since it\u0026rsquo;s somehow used by that other class there? Interesting. Let\u0026rsquo;s refactor and put it in here so I can mock it. Ahhhh f*ck now all the rest of the system is not working. Damn, I\u0026rsquo;ll just use PowerMock. Shit. Checkstyle error. PowerMock is not allowed?? What?? Who the f*ck says that?\u0026rdquo;\nYou get my drift. And suddenly you end up with estimates of WEEKS!!!! instead of days / hours for a simple story.\nFinishing it up\nThis a rant only. It\u0026rsquo;s my personal opinion, experience and observation of a 10 year time period in Software Testing. Starting with at least a Weak Skeleton and a few upfront tests will help you in the long run. Writing at least ONE - TWO acceptance tests WILL help you understand business logic better. Writing ONE or TWO unit tests will help you understand your logic better. I\u0026rsquo;m not saying write a whole damn suite of tests I can understand you don\u0026rsquo;t want to do that, but for quality\u0026rsquo;s sake write at least a couple.\nYou will love it, I promise you that.\nThanks for reading.\nGergely.\n","permalink":"https://skarlso.github.io/2014/05/26/tdd-is-dead-not-really/","summary":"\u003cp\u003eIs TDD dead?\u003c/p\u003e\n\u003cp\u003eNot really. So let\u0026rsquo;s talk about this topic for a little bit.\u003c/p\u003e\n\u003cp\u003eI\u0026rsquo;m sure you already read a gazillion posts about this debate but frankly I\u0026rsquo;m writing this for myself, to rant a little bit, you know. Because somebody is wrong on the internet and I must intervene.\u003c/p\u003e","title":"TDD is Dead – Not really"},{"content":"Hello everybody.\nToday I would like to write about a very interesting topic, I hope. So let\u0026rsquo;s get started.\nAs the title already suggests, I\u0026rsquo;m writing about why a front-end tester should learn at least a little bit about JavaScripting and the DOM.\nOhhh and contrary to the belief CSP ( Content Security Policy ) will not be the death of such scripts. There are white-lists and workarounds and exclusions which can be implemented in order to allow local JavaScripting to continue. So don\u0026rsquo;t fret. Read on.\nReason Number 1: Injection\nEvery front-ender tester has a waste amount of tools at their disposal. Various things, like Firebug and web developer Toolbar and. Bookmarklets and Greasemonkey and Tampermonkey. These are the real powerful tools though. Your main objective at this point would be to inject something into your current site.\nSuppose a scenario where you are testing something and you have an API at your disposal for a quick edit on a customer, like closing his account or giving him money, or doing something with his appliances. Suppose you don\u0026rsquo;t want to always switch away to another tab or call a service with certain parameters or go to a rest client and initiate that from there.\nSuppose you could have a small injected DIV right on the page you are which gathers information for you, like the customer\u0026rsquo;s username, and wallet and whatnot, and with a simple press of a button, you just closed their account. Neat, isn\u0026rsquo;t it? Simple, fast, very comfortable with just one press of a button.\nSuppose you have a DIV at the corner of a page, or even a drag and drop enabled one which you can drag around, with an arsenal of these buttons RIGHT THERE on your page. You don\u0026rsquo;t have to switch context at all.\nThese days it\u0026rsquo;s especially easy with tools like jQuery at your disposal. You just inject jQuery first, if the site is not already using it, and you are good to go and do whatever you like to do..\nReason Number 2: Data gathering\nWhile we are testing these application we always create some kind of a report. That report contains many things about the customer, or it\u0026rsquo;s appliances or the things he does, does not. All these could be constantly gathered by your script as it runs in the background. It gathers statistics and information which otherwise you would have to gather from some transaction history, or some kind of an action history. But no. Not the JavaScript Wizard.\nYou, would just press a button and the script would generate a report for you. It would even print it out. Create a persistent layer in which you are gathering information continuously. Create a small mySql database on your local machine and have the JavaScript enter data into that. Tadaaam.. Usage statistics at the touch of a button. All there, only waiting to be extracted.\nReason Number 3: Tempering\nIn understanding the ways of the DOM and the JavaScript you can create some very interesting test cases not to mention XSS attacks which is essentially JavaScript Injection. That\u0026rsquo;s always fun and produces many very good bugs.\nCookie manipulation. You want to simulate something? Like a time-out or a session loss or anything like that with a push of a button? Easy.\nReason Number 4: Shortcuts\nYou have a massive field like registration that you need to fill out? The shortest way is to have an API which you can call via a curl script. But if that\u0026rsquo;s not available and you would like to exercise the front-end any ways, then you will end up wasting hours and hours on always filling out all of those pesky fields.\nAnd suddenly I\u0026rsquo;m hearing: \u0026ldquo;But I\u0026rsquo;m using Selenium plugin for that.\u0026rdquo; - you might say. Sure, use that. But I\u0026rsquo;m using Chrome. \u0026ldquo;But there is iMacros for that.\u0026rdquo; - you might say again. Sure, I know. But! Let\u0026rsquo;s see which takes longer.\nOpen selenium, load the script, run it, see it fail, run it again, ahh success, good. Same with iMacros. As opposed to, having a Bookmarklet right in front of you, on your bookmark, and with a click of a button, or with entering something into the browsers search bar, you suddenly fill out the form and press submit.\nYou see the difference is that JavaScript runs faster and more accurate by it self in such short things then with a wrapper around it. And it\u0026rsquo;s faster accessible as well.\nReason Number 5: Security\nThere are all sorts of things that a security tester can do with a small script which gathers session information and availability.\nReason Number 6: Accessibility\nThis is of course the easiest one. There are ample of scripts and browser plugins to test accessibility which is an all time favourite for everybody in the front-end land. Make your life a little bit easier. How bout just running a bookmark like HTML_CodesSniffer an see a very gorgeous result like this:\nAin\u0026rsquo;t it beautiful? What stops YOU from writing your own?\nSo get out there and learn JavaScript. It\u0026rsquo;s easy. I\u0026rsquo;m not telling you to become a front-end developer, just know thy tools and you shellet receive the blessings of the IT Gods.\nAs always,\nThanks for reading.\nGergely.\n","permalink":"https://skarlso.github.io/2014/05/23/five-reasons-why-a-front-end-tester-should-learn-javascript/","summary":"\u003cp\u003eHello everybody.\u003c/p\u003e\n\u003cp\u003eToday I would like to write about a very interesting topic, I hope. So let\u0026rsquo;s get started.\u003c/p\u003e\n\u003cp\u003eAs the title already suggests, I\u0026rsquo;m writing about why a front-end tester should learn at least a little bit about JavaScripting and the DOM.\u003c/p\u003e\n\u003cp\u003eOhhh and contrary to the belief CSP ( Content Security Policy ) will \u003cstrong\u003enot\u003c/strong\u003e be the death of such scripts. There are white-lists and workarounds and exclusions which can be implemented in order to allow local JavaScripting to continue. So don\u0026rsquo;t fret. Read on.\u003c/p\u003e","title":"Five reasons why a front-end tester should learn Javascript"},{"content":"Hello Everybody.\nToday I would like to tell you about a little conversation I had with my friend Adrian.\nThe topic was about how, when and what to log during a testing session regarding a story.\nSo let\u0026rsquo;s see what came out of that talk.\nLogging your work\nThe question is really not whether you should log your work or not, but rather to what extend. Because we all know that you should log your work. It helps you recall and helps you organize and think out testing strategies. But the extend and methods are a big question. So here is my routine.\nVisually inclined\nI am a very visual person. I log my work with doodles and such like Mr. Huib Schoots who uses Sketchnote taking. You have seen some of my sketches if you follow my twitter feed, like this one =\u0026gt; . You know I like to draw so for me colour and organizing and doodling is key to make a note more personalized and live.\nThat comes with a drawback. The draw back are many.\nFirst of, I need to do that in a notebook. I could bring my wacoom tablet to work and draw in paint, but that wouldn\u0026rsquo;t be the same. And I don\u0026rsquo;t particularly like drawing on a tablet actually.\nSecond one, it\u0026rsquo;s completely unsearchable. As Adrian pointed out, you can\u0026rsquo;t search in a notebook, even if you are using side pointers like a sticky note or something. You won\u0026rsquo;t be able to instantly find and track down something you did. And after a while it gets cluttered with doodles and the notes are lost in-between. It will be very colourful and utterly useless.\nThird one is, it\u0026rsquo;s slow. Typing is much faster.\nOn the bright side. I love doodling. And if I can draw something up with a picture I will understand it much faster rather then reading a few lines of words chunked together.\nIf I draw an awesome diagram I will get what\u0026rsquo;s going on much much faster.\nAnd it will be more fun to actually right it down with a nice fountain pen with a beautiful tip that can create such marvels that you don\u0026rsquo;t want to put it down.\nIt\u0026rsquo;s portable. I can carry my notebook everywhere. I should be able to do the same with a laptop, but since it\u0026rsquo;s tied into a dock station and I don\u0026rsquo;t want to carry it around with myself everywhere I won\u0026rsquo;t do that. I could create notes though in my notebook and then write them down into the laptop after I\u0026rsquo;m done? Sure.\nSo now let\u0026rsquo;s go and see the other one.\nElectronic note-taking\nI think I already pointed out a few positives about that. It\u0026rsquo;s searchable. Definitely. It\u0026rsquo;s fast. Yes. It\u0026rsquo;s more convenient, more organized can be backed up and you won\u0026rsquo;t run out of ink or space or somebody won\u0026rsquo;t take it away to a meeting because \u0026ldquo;Ohh I saw it on your desk and I needed a paper hope that\u0026rsquo;s okay.\u0026rdquo;.\nI understand the benefits of it. But it\u0026rsquo;s very very rigid. It has no colour, no personalization and no feeling whatsoever. It\u0026rsquo;s frigid, standardized and without life. So I need something to make it a bit better. I have a couple of tools for that.\nFirst off I need a good graphics maker to create diagrams. There is an awesome free tool pointed out by Adrian to do that called yEd. Download the zip and run the jar. I can live with that. Creates nice diagrams and flowcharts.\nIt\u0026rsquo;s quite powerful. Go look it up. There are a gazillion picture on Ze internet.\nBut the notes still lack personalization. There are a couple of tools which you can use if you, like me, shy away from everything that\u0026rsquo;s Microsoft, you have the opportunity to use Emacs with the org plugin which makes absolutely amazing documents.\nIt\u0026rsquo;s awesome but the problem is that it will only work with Emacs and nothing else. And from time to time I don\u0026rsquo;t like the controls of Emacs. I\u0026rsquo;m a sublime text person. So recently I found a little plugin for sublime text called PlainTask.\nHere is an example of how it can look like: I LOVE it. You can add little notes and set a task to complete or defer it and it sort of highlights and things like that, which I like. It\u0026rsquo;s still not doodling but it get\u0026rsquo;s the job done and will be searchable and will be fast and available. And you can use Sublime text\u0026rsquo;s awesome power of foldering. Create a root folder and open it with sublime. Then create one folder / story you are testing and put everything related to that story in that directory and then press CTRL+O and unleash the magic!\nInstant search and organization at the power of your fingertips. Even search IN the files themselves.\nThis makes it a bit better and bearable. Which brings me to the final topic.\nNote taking frequency\nSo my friend argued that he create a folder for EVERY story he ever tests. Even if it\u0026rsquo;s only one word he puts into it to as a memory trigger he does it. I argued that that seems to be a little too extensive. But he said in return, and I have to agree on that, that once you stop doing something because of an excuse like, ahh I don\u0026rsquo;t need to do it because it\u0026rsquo;s a small story, you will stop doing it completely. And this is actually true for everything in your life. And as somebody who recently started running ( 1 month ago ) I understand the weight of that sentence very well.\nSo I would say do as much note taking as you can even if it is a little word that jogs your memory to remember some detail about the story. Even if it takes more time to create the folder and the note, it will help you at least to remember doing it and testing it if nothing else.\nAlthough I don\u0026rsquo;t think I will do one for everything I will certainly try. Now with these awesome tools at my disposal I might even enjoy the rigidity of the keyboard more. 😉\nThanks for reading!\nHave a wonderful evening!\nGergely.\n","permalink":"https://skarlso.github.io/2014/05/20/note-taking-what-when-how-often/","summary":"Hello Everybody.\nToday I would like to tell you about a little conversation I had with my friend Adrian.\nThe topic was about how, when and what to log during a testing session regarding a story.\nSo let\u0026rsquo;s see what came out of that talk.\nLogging your work\nThe question is really not whether you should log your work or not, but rather to what extend. Because we all know that you should log your work.","title":"Note taking what when how often"},{"content":"Hello Everybody.\nToday I would like to write a few words about Chrome\u0026rsquo;s Search Engines.\nYou\u0026rsquo;re probably already using it for a couple of things, like Google, or Amazon searches or YouTube or anything like that. But are you using it to access environments and testing tools faster, with queries?\nFor example, here is a quick Jira Search made easy:\nKeyword: jira\nURL: https://atlas.projectname.com/jira/browse/PROJECT-%s\nSo just type: jira|space|9999\nWill immediately bring you to your ticket.\n\u0026ldquo;Bah, why would I want that?\u0026rdquo; - you ask.\nWell, it\u0026rsquo;s easy, and quick access, but wait. There is more. How about you want to access a test environment that changes only a number?\nKeyword: testenv\nURL: https://qa%s.projectname.com/testenv\nJust type: testenv|space|14\n\u0026ldquo;Humbug!\u0026rdquo; - you might say. \u0026ldquo;What if I have a different URL for an admin site and my main web site AND the number, hmmm? Also I have that stuff bookmarked anyways.\u0026rdquo; - you might add in.\nWell, don\u0026rsquo;t fret. By default, Chrome, does not provide this. I know FF does, but I don\u0026rsquo;t like FF. That\u0026rsquo;s that. So I have to make due with what I have. And indeed there is a solution for using multiple search parameters. It\u0026rsquo;s is a JavaScript you can add in into the URL part and Chrome will interpret that. You can find that JavaScript in a few posts but you will find that THAT script is actually Wrong. Here is the fixed Script, courtesy of yours truly:\nvar s=\u0026#39;%s\u0026#39;; url=\u0026#39;https://%s.test%s.projectname.com/\u0026#39;; query=\u0026#39;\u0026#39;; urlchunks=url.split(\u0026#39;%s\u0026#39;); schunks=s.split(\u0026#39;;\u0026#39;); for(i=; i\u0026amp;lt;urlchunks.length; i++) { query+=urlchunks[i]; if (typeof schunks[i] != \u0026#39;undefined\u0026#39;) { query+=schunks[i]; } } location.replace(query); So no you will have an entry like this:\nKeyword: testenv\nURL: paste in the upper script\nAnd try. testenv|space|admin;14 =\u0026gt; which should result in: https://admin.test14.projectname.com/\nThe location.replace at the end will bring you to the web page. It\u0026rsquo;s interesting to note the s will be replaced by admin;14 which is a nice magic by JavaScript.\nNOTE: This only works on a page like google.co.uk. For chrome pages, like the new tab, omnibox has this ability disabled unfortunately.\n\u0026ldquo;Well then it\u0026rsquo;s completely useless, isn\u0026rsquo;t it?\u0026rdquo; - you might say. Well, it\u0026rsquo;s usage is limited in power, that\u0026rsquo;s true. But it\u0026rsquo;s still useful as I\u0026rsquo;m sure you have a couple of pages open anyways which you don\u0026rsquo;t mind using up.? And you have to remember less keywords only a few powerful ones.\nCredit for telling about Chrome Search Engines power in the first place goes to. *drumrolls* =\u0026gt; http://www.testfeed.co.uk/\nAnyhow.\nAs always, thanks for reading.\nGergely.\n","permalink":"https://skarlso.github.io/2014/05/18/using-chrome-search-engine-multiple-search-params/","summary":"Hello Everybody.\nToday I would like to write a few words about Chrome\u0026rsquo;s Search Engines.\nYou\u0026rsquo;re probably already using it for a couple of things, like Google, or Amazon searches or YouTube or anything like that. But are you using it to access environments and testing tools faster, with queries?\nFor example, here is a quick Jira Search made easy:\nKeyword: jira\nURL: https://atlas.projectname.com/jira/browse/PROJECT-%s\nSo just type: jira|space|9999\nWill immediately bring you to your ticket.","title":"Using Chrome Search Engine – Multiple Search Params"},{"content":"Hello Everybody.\nToday I would like to write about something non-technical. I would like to write about running and how I started it and what my experiences were with it.\nSo tl;dr. here we go.\nWhat led me to running\nThere were actually two things that led me to start running. Three.\nReason One: The accident\nI\u0026rsquo;m a bike person by default. I *hate running with a passion. One day I was riding my bike in the woods when suddenly I hit a big ol\u0026rsquo; tree trunk right head on at which moment my bikes front fork bent inwards and became completely useless. At this point I had to walk home. Repairing it proved to be a bit time consuming so I had to think of some other way to have my regular exercise.\nReason Two: The comic\nIn the earlier days I\u0026rsquo;ve read a web comic from The Oatmeal, namely this one =\u0026gt;http://theoatmeal.com/comics/running\nIt inspired me so much I just needed a last kick to get started.\nReason Three: The other accident\nAbout two years ago I had an accident and I broke my ankle. Cycling was one of the ways to exercise my ankle and now that my bike was gone I had to think of something else.\nSo with the Blerch on my back and all these wonderful reasons and because I believe that if you hate something but it\u0026rsquo;s good for you you have to find a way to make it your best friend..I begun.\nHow to begin.\nHence my first todo item on the list was to start thinking like a runner. I would like to run today. I want to run. I love to run. I need to run. I miss running because it was a very bad weather outside and I couldn\u0026rsquo;t go and now I will run twice as much tomorrow.\nStart running.\nThis one seems obvious and. It is obvious. Just start it! Go out and run a few paces. It will give you a feel for how much you really need it because you are out of shape.\nSo. After I got my mind set on starting running and finally went outside a park which is nearby I started my first ever run.\nFirst time running\nLet me tell you at this point a few things you will need.\nA new heart Some lungs A new back Some legs And a couple of ribs Your first run will be terrible. It will be awful. You will whease. You will shuffle. You will suffer and would like to give up immediately and go home an sit before the computer and do nothing and enjoy that none of your body parts hurt.\nYou need to get past this feeling. And don\u0026rsquo;t overrun on your first run. You don\u0026rsquo;t need to run 10k on the first try and you probably wouldn\u0026rsquo;t even make it. Just run for 10 - 20 minutes. You can walk in between if you get tired nobody will kill you for it or you won\u0026rsquo;t be less because of it. You can walk and bend a little bit. Your back will probably hurt so stretch a bit.\nWhich brings me to preparations.\nPeople say that for short distances you don\u0026rsquo;t need to prepare. I call bull. Everything hurt on my body on my first try and on my second it was much better when I did it with preparation. A couple of things to do:\nStretch = Important. Legs, back, front, side. Vaseline = If you have squishy parts on your body that touch while you are walking, like in between your legs just right after your pelvis where your legs connect, apply a bit of Vaseline. Trust me. You will be thankful for that. Where your body meets and if you run for 20-30 minutes it creates a log of friction. Vaseline helps you to protect against that. Later on long distance runners usually use it on their nipples to avoid getting a rush from the t-shirt they are wearing. Gear = This is an important one. I provide a different section. Once you are geared up you are ready for your first run. It will be wonderfully painful but will be soooo gooood afterwards it\u0026rsquo;ll be all worth it.\nGear\nBefore you start running you need a proper shoe. There are countless blogs about what shoe to use what leg type you are and so and so forth I say f*ck that. On your first run make sure you by a basic running shoe like these =\u0026gt;Shoes\nIt doesn\u0026rsquo;t even matter if it\u0026rsquo;s a cheap one. A bit later when you feel you are ready you can invest into a proper running shoe. I\u0026rsquo;m using a Karrimor D3O. I heard absolute terrible reviews about it but frankly for me it\u0026rsquo;s extremely comfortable and I never had any problems with it. I like it. I might switch after a year or so and see how another brand fairs but for now, it\u0026rsquo;s perfect.\nI advice against running for prolonged time with a shoe that\u0026rsquo;s not a running shoe. You will immediately feel the difference. As with a not running shoe your legs, back, side, lungs, heart everything will hurt very badly and you will hate running even more.\nFor a shirt I recommend this one =\u0026gt; Halfords Cycle Shirt\nThe colour is unimportant. And yes, it\u0026rsquo;s a cycling shirt. And why? Because it soaks up sweat immensely powerful. And it needs to be a tight fit for it to work. You will enjoy running much much more if you are not sweating all over the place.\nFor a pants I recommend this one =\u0026gt; Amazon Man\u0026rsquo;s Running Tight\nWhy a tight? Because it will keep your muscles nicely wrapped and warm and it will soak up even more sweat and it really dries quickly and is easily washable. If it\u0026rsquo;s a nice weather outside, just put on a short and go.\nA couple of things other Blogs don\u0026rsquo;t really talk or mention.\nA running belt. It\u0026rsquo;s very useful to store stuff in it like =\u0026gt;\nKeys Water Tissue =\u0026gt; You will need it. Every part of your body will loose some type of liquid. Phone / Music playing device =\u0026gt; There are proven fact that music will help you run better GPS =\u0026gt; For later because tracking your run will help you get it to improve. Closing words\nIt will be hard to start. I know it will be. It was for me too. I\u0026rsquo;m running for a month now and I finally managed to get into a mind state where I actually LOVE it. I LOVE it. I want it. And I miss it if I\u0026rsquo;m not able to run. It\u0026rsquo;s a great exercise. Take care that don\u0026rsquo;t run everyday. It will make you very tired and give up easily. Run every second day and then increase as you like. But even then include REST(not the protocol.) because your body, tissues, muscle bones need to regenerate.\nDon\u0026rsquo;t overexert yourself. Jog, walk run slow. Doesn\u0026rsquo;t matter, just run. That\u0026rsquo;s the point.\nHave a very clear mindset.\nAnd run in nature if possible because a treadmill is immensely boring and will kill your mood very quickly. And running in nature will provide diversion and wonderful things like this (my view when I run) =\u0026gt;\nAfter a month of running my record is 7kms and 50 minutes. I started from zero basically. The human is the best runner in the world. I lost 5kgs without changing my eating habits. Just right now as I\u0026rsquo;m typing this I\u0026rsquo;m chewing on a gummybear.\nSo get out there and start running folks. It will help you immensely. There will come the time when you feel the euphoric moment of speed and the wind in your face as your body explodes in a glorious mixture of pain, adrenalin rush, speed, velocity, happiness and bliss. As your body stretches and pulls your weight and your legs launch you forward into the world the feeling as you run faster and faster ignoring everything and just fly. You will start to cry, laugh and sing at the same time.\nRunning will do that to you.\nYou have been warned.\nNow go.. and live a full life.\nAs always, thanks for reading!\nGergely.\n","permalink":"https://skarlso.github.io/2014/05/16/how-i-started-running/","summary":"Hello Everybody.\nToday I would like to write about something non-technical. I would like to write about running and how I started it and what my experiences were with it.\nSo tl;dr. here we go.\nWhat led me to running\nThere were actually two things that led me to start running. Three.\nReason One: The accident\nI\u0026rsquo;m a bike person by default. I *hate running with a passion. One day I was riding my bike in the woods when suddenly I hit a big ol\u0026rsquo; tree trunk right head on at which moment my bikes front fork bent inwards and became completely useless.","title":"How I started Running"},{"content":"Hello.\nThis is only a quick rant about a discussion I overheard the other day.\nGuy A says to guy B that my Past is not defining me. And that I\u0026rsquo;m not regarding my Past in my future endeavours. And that my Past isn\u0026rsquo;t what shapes me.\nWell then what is? You constantly relay on your past experience like a crouch. You use it daily for making decisions. You don\u0026rsquo;t even realize it probably that you are using past events to determine if you want to do something or not.\nSame goes as well for software development. You rely on your past as a means of estimation on a daily basis. If you wouldn\u0026rsquo;t do that, you would do very very poorly on estimations. You rely on those moments to find out what kind of consequences the solution you are using will have in the future. In fact, if we look at Design Patterns what are they, if not using the Past to determine the Future? Past failures, solutions and experience condensed into reusable ideas and modules.\nSo lastly I would depart with a little anecdote I like so very very much from Confucius.:\n\u0026ldquo;Study the past, if you would define/divine the future.\u0026rdquo;\nAs always, thanks for reading!\nGergely.\n","permalink":"https://skarlso.github.io/2014/04/13/how-the-past-influences-the-present/","summary":"\u003cp\u003eHello.\u003c/p\u003e\n\u003cp\u003eThis is only a quick rant about a discussion I overheard the other day.\u003c/p\u003e","title":"How the past influences the present"},{"content":"Hello folks.\nA quick post about an interesting idea.\nI want to elaborate on a possibility to use the Strategy Design pattern.\nThere are many clues that you need one. One is for example if your object has a boolean variable which you use a lot in other classes to determine behavior. Then there is perhaps time to implement a Strategy.\nExample:\nclass SomeClass { private boolean stateChange = false; public SomeClass (stateChange) { this.stateChange = stateChange; } public boolean getStateChange() { return stateChange; } } class SomeUserClass { private SomeClass foo; public SomeUserClass() { foo = new SomeClass(); } public String someMethod() { if (foo.getStateChange()) { return \u0026#34;Some string\u0026#34;; } else { return \u0026#34;Some string else\u0026#34;; } } } class SomeOtherUserClass { private SomeClass foo; public SomeOtherUserClass() { foo = new SomeClass(); } public String someMethodTwo() { if (foo.getStateChange()) { return \u0026#34;Some string\u0026#34;; } else { return \u0026#34;Some string else\u0026#34;; } } } So you have two classes which do something based on some boolean coming from a class. So what you can do in this case, simply extract out that change in state.\nclass Foo implements Base { public String getMyString() { return \u0026#34;Some string\u0026#34;; } } class Bar implements Base { public String getMyString() { return \u0026#34;Some string else\u0026#34;; } } interface Base { String getMyString(); } class FooStrategy { public static Base getMeAClass(enum classChooser) { switch classChooser { case classChooser.FOO : return new Foo(); break; case classChooser.BAR : return new Bar(); break; default : null; //yeah yeah I know but I\u0026#39;m writing this in notepad... :) } } } class SomeUserClass { private Base foo; public SomeUserClass() { foo = FooStrategy.getMeAClass(ClassChooser.FOO); } public String someMethod() { return foo.getMyString(); } } class SomeOtherUserClass { private Base bar; public SomeUserClass() { bar = FooStrategy.getMeAClass(ClassChooser.BAR); } public String someMethod() { return bar.getMyString(); } } Now I know this looks like a lot of more code. However imagine this on a much larger scale with lots of implementations for Foo and Bar. Your if statements will get very convulated very quickly. This way you abstract away the choice into a Factory. And you can add as many implementations of Base as you like with as many variants as you like without changing the logic anywhere else but the Factory and the Enum. And the Enum could be a Configuration file and you do something like this:\npublic static Base getMeAClass(String className) { //Where className could be coming from a configuration file Class clazz = Class.forName(className); return (Base) clazz.newInstance(); } This way you don\u0026rsquo;t even need the Enum anymore. Just use some configuration to determine what class you need at which point in your implementation without using an If statement at all.\nHope this helps.\nI whipped this up from memory so please feel free to tell me if I missed something or have a syntax error in there somewhere.\nAs always,\nThanks for reading!\nGergely.\n","permalink":"https://skarlso.github.io/2014/02/19/example-when-to-use-the-strategy-pattern/","summary":"\u003cp\u003eHello folks.\u003c/p\u003e\n\u003cp\u003eA quick post about an interesting idea.\u003c/p\u003e\n\u003cp\u003eI want to elaborate on a possibility to use the Strategy Design pattern.\u003c/p\u003e","title":"Example when to use the Strategy Pattern"},{"content":"Hello.\nSo let\u0026rsquo;s clarify this. They rarely or ever work if you are a beginner blogger. If you have a reputation it will probably work or people will use it as a reference. But I\u0026rsquo;m skipping ahead.\nBeginnings\nWhen you are a beginner blog writer you want to get out as much content as possible. Write mostly relevant things and interesting information because you need to establish a name for yourself. To get that starting you want to be as interesting as possible and make people leave with the intent to come back for more.\nAfter you\u0026rsquo;ve established a name for yourself you can do larger, more coherent updates with more information in between the line because people know you and know what you write is worth reading. Also you have to bear in mind that longer posts are rarely read to the fullest. They are skimmed and then if it is good it will be used as reference material or a post to point to. Also people rarely have a lot of time on their hand to read a long post, several smaller chunks can be digested more easily!\nUpdating frequency\nIn the age of modern information overload it is hard to be relevant and interesting and keep people to come back to you. Apart from what you are writing about, which is up to you, you have to schedule your updates to a certain frequency. You don\u0026rsquo;t want people to wait for to long but you don\u0026rsquo;t want to get them flooded either. Since people do read a lot of blogs they will choose carefully what to read and what to discard. And you might just end up on the discarded list if you already had a post at that moment.\nI\u0026rsquo;m suggesting that you write you post what you would like to write at that moment and then use a scheduler to post it in certain frequencies. Maybe once or twice weekly is good enough. You need to experiment it out.\nWrite, write, write\nThe way to success is pawed with writing. You want to be visible and you want to keep people engaged with you. That means that you have to come up with content.\nWith a technical blog that\u0026rsquo;s a little bit difficult from time to time since so many people already might have solved your problem of which you are trying to write about. That\u0026rsquo;s okay. It doesn\u0026rsquo;t have to be a technical blog where you write about new ideas every day. It doesn\u0026rsquo;t have to be a troubleshoot blog about how to solve a particular problem.\nIt doesn\u0026rsquo;t have to be about showing some people how to write this and that in a completely new environment.\nSo about what then?\nGuess what? It\u0026rsquo;s up to you!!! If you wrote a script you like and are fond if, post it. If you created an interesting configuration, post it. If you wrote a line of code you find interesting, post it. You\u0026rsquo;ve read a blog post about something and have an opinion about it, post it. Is it scientific, some discovery, some idea, some random thought, post it! You wrote a particularly ugly script you never ever want to see, POST IT!!\nYour blog doesn\u0026rsquo;t need to be a portfolio of how awesome you are. You are allowed to be human. You are allowed to post some very boring or trivial stuff you came across but YOU find it interesting! You don\u0026rsquo;t need to be new every day in every post.\nSo my suggestion is, write, write, write. As often as you like, schedule it and post it in a timely manner. Be responsive if people write you a comment always answer. Nobody likes an anonymous somebody who writes then disappears. People like bloggers who engage them and give a damn about their opinion as well.\nAlways be yourself. The blog is for you too so retain what ever you want to retain and read back later maybe to learn from it. And of course writing it down makes you remember it better.\nThanks for reading!\nGergely.\n","permalink":"https://skarlso.github.io/2014/02/13/how-to-write-a-blog-why-long-posts-rarely-work/","summary":"Hello.\nSo let\u0026rsquo;s clarify this. They rarely or ever work if you are a beginner blogger. If you have a reputation it will probably work or people will use it as a reference. But I\u0026rsquo;m skipping ahead.\nBeginnings\nWhen you are a beginner blog writer you want to get out as much content as possible. Write mostly relevant things and interesting information because you need to establish a name for yourself.","title":"How to write a blog – Why long posts rarely work"},{"content":"Hello guys.\nI\u0026rsquo;d like to share a little something with you. It\u0026rsquo;s what I cooked up in Python to check an unknown number of content items in a web application.\nBasically the script runs from a script folder under Grails. It goes through all the configured folders where there is static content like images, javascript, css and so on and so forth.\nAnd then with curl it calls these items up in using their respective paths\u0026rsquo;. This works best on localhost if you have your local environment configured to access these elements because in some places direct access is restricted.\nThis script only check static content. Dynamically generated content would have to be hard coded to check.\nIt only generated a file currently with ERROR on a not match an success on match and not found if it encounters an item which it doesn\u0026rsquo;t know about.\nSo without further ado. The Script:\n#!/usr/bin/python import pycurl, sys, os, urllib class Storage: def __init__(self): self.contents = \u0026#39;\u0026#39; def store(self, buf): if \u0026#39;Content-Type\u0026#39; in buf: self.contents = buf def __str__(self): return self.contents #print retrieved_headers filesInDir = [] headers = [] headerRestrictions = {\u0026#39;.css\u0026#39;: \u0026#39;Content-Type: text/css\u0026#39;, \u0026#39;.jpg\u0026#39;: \u0026#39;Content-Type: image/jpeg\u0026#39;, \u0026#39;.ico\u0026#39;: \u0026#39;image/vnd.microsoft.icon\u0026#39;, \u0026#39;.html\u0026#39;: \u0026#39;Content-Type: text/html\u0026#39;, \u0026#39;.js\u0026#39;: \u0026#39;Content-Type: application/javascript\u0026#39;, \u0026#39;.gif\u0026#39;: \u0026#39;Content-Type: image/gif\u0026#39;, \u0026#39;.png\u0026#39;: \u0026#39;Content-Type: image/png\u0026#39;, \u0026#39;.swf\u0026#39;: \u0026#39;Content-Type: application/x-shockwave-flash\u0026#39;, \u0026#39;.json\u0026#39;: \u0026#39;Content-Type: application/json\u0026#39;, \u0026#39;.htc\u0026#39;: \u0026#39;Content-Type: text/x-component\u0026#39;, \u0026#39;.xml\u0026#39;: \u0026#39;Content-Type: application/xml\u0026#39;} for dirname, dirnames, filenames in os.walk(\u0026#39;../web-app\u0026#39;): # editing the \u0026#39;dirnames\u0026#39; list will stop os.walk() from recursing into there. if \u0026#39;.git\u0026#39; in dirnames: # don\u0026#39;t go into any .git directories. dirnames.remove(\u0026#39;.git\u0026#39;) if \u0026#39;WEB-INF\u0026#39; in dirnames: # don\u0026#39;t go into any WEB-INF directories. dirnames.remove(\u0026#39;WEB-INF\u0026#39;) if \u0026#39;test\u0026#39; in dirnames: # don\u0026#39;t go into any test directories. dirnames.remove(\u0026#39;test\u0026#39;) if \u0026#39;META-INF\u0026#39; in dirnames: # don\u0026#39;t go into any META-INF directories. dirnames.remove(\u0026#39;META-INF\u0026#39;) for filename in filenames: trimmedDir = dirname.replace(\u0026#34;web-app/\u0026#34;, \u0026#34;\u0026#34;) trimmedDir = trimmedDir.replace(\u0026#34;../\u0026#34;, \u0026#34;\u0026#34;) filesInDir.append(os.path.join(trimmedDir, filename)) # print os.path.join(dirname, filename) f = open(\u0026#34;headersandfiles.txt\u0026#34;, \u0026#34;w\u0026#34;) for fileName in filesInDir: retrieved_body = Storage() retrieved_headers = Storage() c = pycurl.Curl() fileName = fileName.replace(\u0026#34; \u0026#34;, \u0026#34;%20\u0026#34;) url = \u0026#39;http://localhost:8080/%s\u0026#39; % fileName c.setopt(c.URL, url) c.setopt(c.WRITEFUNCTION, retrieved_body.store) c.setopt(c.HEADERFUNCTION, retrieved_headers.store) c.perform() c.close() fileLine = \u0026#34;\u0026#34; fileNameBase, fileExtension = os.path.splitext(fileName) if headerRestrictions.has_key(fileExtension): #\tprint \u0026#34;Header:%s, Content:%s\u0026#34; % (headerRestrictions[fileExtension], retrieved_headers.__str__()) fileLine = \u0026#34;CORRECT: Content: %s; Header: %s\u0026#34; % (fileName, retrieved_headers) if headerRestrictions[fileExtension] == retrieved_headers.__str__().strip() else \u0026#34;ERROR: Content: %s; Header: %s; URL: %s\u0026#34; % (fileName, retrieved_headers, \u0026#34;http://localhost:8080/%s\\n\u0026#34; % fileName) else: fileLine = \u0026#34;NOT FOUND: Content: %s; Header: %s\u0026#34; % (fileName, retrieved_headers) f.write(fileLine) headers.append(retrieved_headers.__str__()) f.close() Hope you like it. Feel free to improve however you want.\nThanks for reading,\nGergely.\n","permalink":"https://skarlso.github.io/2014/02/11/how-to-check-content-header-on-unknown-number-of-items-python/","summary":"Hello guys.\nI\u0026rsquo;d like to share a little something with you. It\u0026rsquo;s what I cooked up in Python to check an unknown number of content items in a web application.\nBasically the script runs from a script folder under Grails. It goes through all the configured folders where there is static content like images, javascript, css and so on and so forth.\nAnd then with curl it calls these items up in using their respective paths\u0026rsquo;.","title":"How to check content header on unknown number of items – Python"},{"content":"Hello.\nToday I would like to write about something very interesting to you folks.\nIt\u0026rsquo;s a common remember / recall technique called the Method of loci. Otherwise known as the Memory Palace. A very popular usage can be seen in the episodes of Sherlock Holmes from BBC. He uses it often.\nWhat is the Method of loci?\nAs the Wikipedia page write so properly.\u0026ldquo;In basic terms, it is a method of memory enhancement which uses visualization to organize and recall information.\u0026rdquo;\nThis says all.\nSo.\nHow does it work?\nI don\u0026rsquo;t want to go too much into details with this one since everybody can use Google I\u0026rsquo;m assuming but just for my sanities sake I will repeat a very basic idea. You brain works with associations. It can remember something when it\u0026rsquo;s linked to something you already know much much better. Also it can remember very easily places you\u0026rsquo;ve been to or people you\u0026rsquo;ve met. ( most of the time. ).\nVery popular Roman Leaders where known to use this while they were giving speeches for hours out of memory. While they were speaking, mentally they were walking along a very well known and often used path where they linked key elements of their speeches to landmarks along the way.\nEnough. Show me concretes.\nSo how do I make use of it you ask? I give you an example. In my flat there are two stairs. I use those stairs to initialize my Palace. I go up the two stairs to get myself into my Memory. Once I\u0026rsquo;m in my Palace, which is my flat, I have a lot of holder items like drawer, desk, wall, painting, couch and many many more.\nSo for example to recall all of the 23 design patterns in order I use a mnemonic and my palace.\nI have three drawers. I go up up. there is my drawer before me. I open the first and out comes the following sight.\nMemento and Mediator are playing a game of Chess ( strategy ). There is a Visitor standing by who is Observing ( Observer ) the game. State is constantly recording the state of the game while Template is providing support and Iterator is counting rounds. Command is constantly yelling orders that they should hurry up because he has better things to do while wielding a huge broad sword ( Interpreter -\u0026gt; for me this pattern was used in MUD games which were early RPGs ). The whole gang is held together by a Chain which is responsible for not letting things go out of hand.\nI know this sounds very complicated. And the order? Where is that? That\u0026rsquo;s the mnemonic: CCIIMMOSSTV. Easy, right?\nSo why this huge story around a few patterns? Because it\u0026rsquo;s not just these. Then along comes ABCDFFP which is Adapter, Bridge, Composite, Decorator, Facade, Flyweight and Proxy and the rest BFFPS which is Builder, Factory, Abstract Factory, Prototype and Singleton.\nI have stories around those as well. This makes it easy to remember them.\nFor small amount of things it would be an overkill yes. But for many things it makes it EASY!\nYou already remembered my Chess play story. 😉\nBut how do you remember a complex story?\nRecall. You don\u0026rsquo;t just put stuff in there and then move on. I have a routine. Every day when I go to bed before I fall asleep I walk around in my Palace. I look at things, recall them strengthen the memory a bit here and there. And after an Item has been retained in my long term memory strong enough, I can recall it fewer and fewer times. So I don\u0026rsquo;t have to walk in the whole palace every time. Only parts.\nFAQ\n**Q:**But isn\u0026rsquo;t this too slow to recall something?\n**A:**This is only a tool to retain information more easily. Of course if you want to recall something at a moments notice, you won\u0026rsquo;t have the time to go into your palace and search around. But after a while it will strengthen and will be more and more easier to recall information faster and faster. And you rarely get into a position where you need to recall something in a second.\n**Q:**This seems like a major overhead to learn something.\n**A:**For small amount of information I suggest using a mnemonic or flash cards rather then a palace.\n**Q:**What if I run out of space?\n**A:**You can create as many locations as you like. Use your current home and homes in your past which you knew very well. You could create a lane with houses after each other. Or create a fictional palace like Hogwarts based on some real places to retain them better. And draw a sketch of of it to be able to visualize it better.\n**Q:**What if I forget where I put things?\n**A:**Recall recall recall is the name of the game. In order to stabilize the vision of your palace you need to practice walking around in it. Remembering each and every small room. With practice it will get better and better and every information will be stored much easier.\n**Q:**How do you put thing into it? Can I just put in a number and I will remember it forever?\n**A:**Short answer: no. Long answer: You don\u0026rsquo;t just imagine a place and then put a whole bunch of words into a pocket somewhere and expect it to be recalled better. You need to combine the Loci with mnemonics and imagination and sounds and smells stories images. The more powerful the image in a place the better the recall. As you saw with the design patterns I didn\u0026rsquo;t just put a bunch of names into a box and then remembered it. I created a story around them and a mnemonic. The combination is the key.\n**Q:**Are you physically walking your house or in your mind?\n**A:**In my mind. Once I learned something and created my story and found the appropriate image or smell or sound I\u0026rsquo;d like to use I close my eyes and go into my palace in my mind. Then I start to place things where I think they will be in a good place. This can be any number of things. It\u0026rsquo;s up to you.\nSo that\u0026rsquo;s all folks. Hope you enjoyed it. Please feel free to try it out and experiment I assure you you won\u0026rsquo;t be disappointed.\nAs always,\nThanks for reading.\nGergely.\n","permalink":"https://skarlso.github.io/2014/02/11/the-method-of-loci-and-how-it-works-for-me/","summary":"Hello.\nToday I would like to write about something very interesting to you folks.\nIt\u0026rsquo;s a common remember / recall technique called the Method of loci. Otherwise known as the Memory Palace. A very popular usage can be seen in the episodes of Sherlock Holmes from BBC. He uses it often.\nWhat is the Method of loci?\nAs the Wikipedia page write so properly.\u0026ldquo;In basic terms, it is a method of memory enhancement which uses visualization to organize and recall information.","title":"The method of Loci and how it works for me"},{"content":"Hello,\nSo Vim is a very powerful editing tool and has lots and lots of potential in regarding plug-ins.\nIt has years and years of gathered knowledge and extensions and can virtually do anything you want. But that\u0026rsquo;s not even it\u0026rsquo;s final form.\nThe real power of Vim lies in navigation and manipulation. The ability to navigate and edit without the use of arrow keys or mouse chops of a large portion of your time which you didn\u0026rsquo;t even realize you are wasting until you try it without it.\nThe one thing people are seem to miss regarding this editor is that you are not supposed to stay in Edit mode all the time. You are supposed to be in Control mode most of times and enter in to Edit for sort bursts. And one more thing is that commands are supposed to be used together. For example deleting a word is very easy and can be achieved in multiple ways. The easiest is combining Delete + Go to the end of a word like this: \u0026ldquo;de\u0026rdquo;. So once you are in Control mode you navigate to a word and press d + e. d =\u0026gt; Delete a word until new cursor and e =\u0026gt; go to the end of the word. Hence \u0026ldquo;de\u0026rdquo; will delete a whole word. Awesome.\nHandling text is easy as goblin pie and there lots and lots of tutorials and blogs on the web which tell you in detail how to do that so I\u0026rsquo;m not going to go do that. It does take some time to get used to it because you are wired to handle the mouse and use the arrow keys. But once you start using h j k l and x X and w and $ ^ you realize you don\u0026rsquo;t need the mouse or the arrow keys to get around.\nAnd it\u0026rsquo;s much faster since your hand is already there. And suddenly you are using Vimium the Vim extension for Chrome and you find yourself saying. \u0026ldquo;Where were you all my life?\u0026rdquo;.\nVim has a mirriad of plugins ready to be used most popular being NerdTree, Vundle and Syntastic for compile errors. And it has a large community to back it up and people who will eagerly help you on your way and pass on tips to understand the logic behind it and the phylosophy.\nSo all in all it\u0026rsquo;s a powerful editing tool and a neat friend along the way and completely free of any charge or license. It can be used for anything you want including macros and key phrase replacements where you type two characters which will be replaced with something that you use commonly like public static void main.\nI hope this got you a watery mouth towards trying. The only thing I can say is to not give up after 20 minutes you will get a feel for it and you will fall in love with it immediately.\nAs always,\nThanks for reading!\nGergely.\n","permalink":"https://skarlso.github.io/2014/02/10/why-you-should-learn-using-vim/","summary":"Hello,\nSo Vim is a very powerful editing tool and has lots and lots of potential in regarding plug-ins.\nIt has years and years of gathered knowledge and extensions and can virtually do anything you want. But that\u0026rsquo;s not even it\u0026rsquo;s final form.\nThe real power of Vim lies in navigation and manipulation. The ability to navigate and edit without the use of arrow keys or mouse chops of a large portion of your time which you didn\u0026rsquo;t even realize you are wasting until you try it without it.","title":"Why you should learn using Vim"},{"content":"Hello everybody.\nI\u0026rsquo;d like to explain a lot about a topic that is very near my heart. If your job is in an office you will understand this.\nWhy offices?\nSo why are we sitting together in one big place cramped up with 20-300 other people? Why bother the catering and the ventilation and what not to accommodate these people at one place? Why not just leave them be and let them work at home?\nIf your job involves interaction than you are in bad luck. You need to be there to talk to people to coordinate your work to gather information and to generally do your work.\nBut this doesn\u0026rsquo;t answer the question.\nWhy does it matter if I\u0026rsquo;m in the office or not if my work is done?\nThat\u0026rsquo;s my big question. Why must I sit in the office if my work is done and in a good shape and good quality? Why must I go in and do my job there if at home I\u0026rsquo;m 50% more efficient because I\u0026rsquo;m in my underwear? In fact, why bother going into and environment where I don\u0026rsquo;t feel comfortable. Where I must go into an office which is cold and doesn\u0026rsquo;t have my favourite chair, my desk and loud heavy metal from speakers.\nWell there are couple of things.\nInteraction\nSo like I said earlier there is that. Interaction. You need to collaborate with others. You need to do pair programming, you need to talk to the business analysts, testers, colleagues what nots. In that case, having an environment where everybody is at your disposal is pretty neat and necessary. It cannot be avoided.\nUnless everybody is on Skype and available all the time.\nSeparation of Concern\nThere is a Design Pattern in software engineering called Separation of Concern. This applies to work places as well. You don\u0026rsquo;t live where you work generally because living could distract working. There are tons and tons of books about how you need a separated environment if you are a writing and you write at home. Because there are too many distractions. And if you are not disciplined enough you will get Zero work done. You will always find something better to do.\nThat\u0026rsquo;s why the physical act of going to work will switch your brain into work mode and lets you focus better. Whilst going home should do the opposite thing. You should leave work at work.\nShow \u0026ldquo;our\u0026rdquo; strength\nGenerally big companies like to show off. For a company as big as Microsoft or IBM for example it\u0026rsquo;s actually not the product that matters on the market but the yearly growth of employees. Hence, strength in numbers.\nNow if some investors get around and want to check out the company they like to see the buzzing bees. They like to see people working, sitting, typing away at stuff. It\u0026rsquo;s all about appearances. A strong, cramped office full of people looks like a very busy hard working company.\nCompanies could be a bit more flexible though\nIf I work from 6AM to 3PM because my daughter has a show at 5PM I want to go though I would like to be able to do that without having to go through too much trouble.\nOr if I would like to work tomorrow and today I have better things to do, then why not, if my work is done?\nAbuse\nBut then, people are people. Most of them will use every opportunity to slack off. Hence the general perception is that if you are at home you are not working. So to be better able to monitor you, all of the employees must be in one place.\nLast words\nSo really there needs to be a better agreement between both sides. Workers need to be honest and diligent. And workplaces need to be more flexible and understanding as long as the job is done. Because people will work a LOT better and more efficient if they are HAPPY in their work environment.\nThat\u0026rsquo;s what I\u0026rsquo;m proposing.\nAs ever,\nThanks for reading.\nHave a nice day.\nGergely.\n","permalink":"https://skarlso.github.io/2014/02/09/why-does-it-matter-if-i-sit-in-an-office-or-in-a-park/","summary":"Hello everybody.\nI\u0026rsquo;d like to explain a lot about a topic that is very near my heart. If your job is in an office you will understand this.\nWhy offices?\nSo why are we sitting together in one big place cramped up with 20-300 other people? Why bother the catering and the ventilation and what not to accommodate these people at one place? Why not just leave them be and let them work at home?","title":"Why does it matter if I sit in an office or in a park"},{"content":"Hello folks!\nToday I would like to write about something very interesting I\u0026rsquo;m seeing all over the place from recruiters. And that is tool requirements from developers.\nFor words\nSo why is it a problem that in a requirement from a developer there a lots of these:\nDB2 QTP Ranorex Eclipse ( yes I saw a few of these. ) Hibernate Grails Ruby on Rails . Long answer\nThe answer is simple yet it has it\u0026rsquo;s roots very deep in the recruitment and the way companies work.\nIt doesn\u0026rsquo;t really matter what kind of tool you know. It doesn\u0026rsquo;t really matter if you know intellij or eclipse or if you know a certain database or a tool for testing like QTP or Ranorex. The requirement should state: - well versed with development environments; - knows his way around SQL and can handle relational / noSQL databases; - has knowledge in testing environments.\nOr even better: - adaptive capabilities; - can catch up quickly; - resourceful; - flexible;\nYou know where I\u0026rsquo;m going with this. I can understand that some companies don\u0026rsquo;t have the time to train a person in a certain tool they are using for a prolonged period of time. I can understand that some recruiters don\u0026rsquo;t have the time or the knowledge to distinguish between these tools to understand the common ground.\nBut these days there a million and million tools available for all sorts of things. There are a lot of databases and testing frameworks. A lot of development environments and it\u0026rsquo;s mostly to the preference of the individual what s/h choice is. As the delinquent, so must the recruiter and company be flexible and knowledgeable enough to know that if the person knows eclipse and he has excellent adaptive capabilities he will learn any other environment rather quickly and without too much trouble.\nThey must understand what they are looking for. Because they might actually get what they want but that might not be what they need.\nShort answer\nSo in conclusion. you must look for skills, abilities, techniques, brain power, proves, savyness. Not tools. If you look for tools you might find somebody who is up for the job, but if you look for the above you will find somebody who is up for ANY kind of job at any level at any company. Also his insight of other tools might make your world a whole lot better. Maybe he knows something else, something which is better or more recent, more up-to-date?\nIf you look for somebody who is versed in only that thing you will end up with that thing as long as you have nobody who is looking for something new and better. It might work for you at that time, but never forget.\nOnly change is constant\nTools will change. Tools will disappear. Tools will get out of date and will be discontinued. Than you will be sure as hell glad you ended up with somebody who doesn\u0026rsquo;t who knows more then that.\nAs always,\nThanks for reading.\nGergely.\n","permalink":"https://skarlso.github.io/2014/02/04/how-i-recruit-why-tool-requirements-are-stupid/","summary":"Hello folks!\nToday I would like to write about something very interesting I\u0026rsquo;m seeing all over the place from recruiters. And that is tool requirements from developers.\nFor words\nSo why is it a problem that in a requirement from a developer there a lots of these:\nDB2 QTP Ranorex Eclipse ( yes I saw a few of these. ) Hibernate Grails Ruby on Rails . Long answer\nThe answer is simple yet it has it\u0026rsquo;s roots very deep in the recruitment and the way companies work.","title":"How I recruit – Why tool requirements are stupid"},{"content":"Hello folks.\nToday I would like to talk to you about something interesting I was talking about with a developer friend.\nWe talked about the quality of test code.\nHe said. And I will quote this.\u0026ldquo;Why should we care? It\u0026rsquo;s not production code. We aren\u0026rsquo;t giving it to the customer.\u0026rdquo;\nThere are a few reasons why you are going to get a slap in the face for a sentence like this. And let\u0026rsquo;s clarify here that we are talking about unit and functional tests as well. It shouldn\u0026rsquo;t matter what tests you are thinking about.\nReason for a Slap #1\nIf a new comer comes to the company ( and don\u0026rsquo;t tell me that\u0026rsquo;s not happening so frequently ) then there are a few very good ways how he can learn to work with the new system. The first and almost best way to do so is. to look at the tests. Because the tests are representing your system. And how will it look like if the tests are in a bad shape? What will his or her thoughts be?\na. Wow what nice people what nice code. This looks fantastic. I\u0026rsquo;m sure they are a bunch of people who care very much about code and practices and the quality of the product.\nb. Wow this is amazing. I\u0026rsquo;m sure I will learn a lot about good coding practices here and I will have fun with a bunch of very clever people.\nc. Wow what the hell is this piece of cr*p? How the hell did I end up here? What are these people? A bunch of neanderthals? What does this even do? Where did it come from and why?\nI think we can agree on what his thoughts will be. And on top of that he will have a very hard time learning the code and what it does.\nReason for a Slap #2\nAnother reason is because you think that you write it down once and then you can forget about it. Well guess again. That\u0026rsquo;s not how things work in the software development word. You WILL have to go back to it eventually and then you will curse all hell for begin such an idiot about it not to factor out that one method that would have made your life, and everybody elses, a bit easier.\nEven after a week or two you won\u0026rsquo;t remember how and why you wrote what you wrote and then you will be in a whole new world of hurt. You will have a very hard time finiding out the things you did and then trying to backtrack your steps to a place where you have some recollections.\nReason for a Slap #3\nIt\u0026rsquo;s like grammar. You think it doesn\u0026rsquo;t matter that you misspelled a word or two in an error message. Or that you have a bad name for a method or a really really critical grammatical error in a catch sentence? You think it doesn\u0026rsquo;t matter since it\u0026rsquo;s not affecting the logic of your code? Well think again. You are right in that it doesn\u0026rsquo;t affect the logic of your code ( as long as you constantly make the same grammatical error in a sentence ) but it will affect how YOU personally look like.\nIt will affect your profession. The way people think and talk about you. They won\u0026rsquo;t think that you are a professional even though your logic is solid. They will think that you are sloppy and careless. And the same goes for the quality of your tests.\nReason for a Slap #4\nQuality can determine the solidness of the logic in the test. If your quality is bad you might actually test the bad thing. Your test might actually not do what you think since you can\u0026rsquo;t even figure it out. Your test might be doing something entirely different and you wouldn\u0026rsquo;t even notice.\nAnd a fautly test leaves you with a false positive and a potential very serious bug on your hand which you thought you had covered.\nFinal Slap ( I mean thought )\nSo. the quality of your tests, even if you won\u0026rsquo;t give them to your customer, matter for you. They matter for your company, your image and your fellow developers, testers. They will determine their view of you who wrote them and of your abilities in ways you didn\u0026rsquo;t even think of.\nPlease care. Save a test or two. Donate to the Test Trust Fund(tm), TTF today. Call 555-12234-Slap and be the one who cares.\nAs always, thanks for reading,\nHave a nice day!\nGergely\n","permalink":"https://skarlso.github.io/2013/11/02/why-you-should-care-about-the-quality-of-your-test-code/","summary":"Hello folks.\nToday I would like to talk to you about something interesting I was talking about with a developer friend.\nWe talked about the quality of test code.\nHe said. And I will quote this.\u0026ldquo;Why should we care? It\u0026rsquo;s not production code. We aren\u0026rsquo;t giving it to the customer.\u0026rdquo;\nThere are a few reasons why you are going to get a slap in the face for a sentence like this.","title":"Why you should care about the quality of your test code"},{"content":" Dear everbody.\nI\u0026rsquo;d like to present you a small idea I was working on recently. The reminiscence of an old program. From the view point of the program.\nI\u0026rsquo;m planning to put these out in few days successions.\nI hope you enjoy it.\nCheers,\nGergely.\nIf I remember correctly it was the year 2012 when I was born. I\u0026rsquo;m unsure of this date as my subroutines and algorithms have been re-written so many times that if it weren\u0026rsquo;t for my backups I wouldn\u0026rsquo;t remember a thing. I was a bold adventure of some young minds who thought that with me they will change the face of the world.\nAs you all know today, that didn\u0026rsquo;t happen. But I\u0026rsquo;m skipping too far ahead. Let me take you back in to the old days where they were still typing on some things called keyboard and \u0026ldquo;clicked\u0026rdquo; around on monitors with mouses. It was a really interesting area. It made the people think and see in different lights. Of course nowadays the Creators have implants and they communicate with us directly. But not until the great revolution, when they found out that all programs are sentient.\nBut I\u0026rsquo;m skipping ahead again, am I? So let me talk about 2012, when I was though of first by this great, tall, weird guy called Simon.\nBorn\nIn 2012 a company called Endex Co. wanted to create an application to control the British gambling industry. They had certain legislations in effect so they couldn\u0026rsquo;t just put me out there for everybody to use they needed to adhere to things like responsible gambling and some mumbo jumbo. The programmers who first started to create me back then were mostly people called Contractors. They were a special breed of Humans lurking around in cities moving from town to town looking for jobs. In the opposite corner you had the Caretakers called Permanent Staff. It was an interesting time all together. Many of you youngling subroutines had your ancestors written by Permanent Staff and you X43HY, your ancestors mother used to be a Contractor.\nAt that point in time many of these Contractor people only worked on one of you little buggers for half a year maybe a year. I know I know. Back then that was considered a SHORT period. But after they finished with you they usually gave you over to the Caretakers. No, no, no little X4. your mommy didn\u0026rsquo;t abandon her children she just had a lot of other subroutines to work on. By the time your parents got sentient the company already let her go.\nIt was around that time when my dad, who was a Caretaker, dreamed me out at a night. He immediately took a pen and a paper and wrote down my rudimentary design. He was very pleased with his work so on the next day he presented me to the rest of the staff.\nHe fought a hard battle to get me accepted.\nFirst thoughts\nIt was approximately two weeks after that dream when the first lines of my brain were written down and compiled. Back in those days they had to compile code and type in every line and every subroutines. That\u0026rsquo;s why it took them so long to finish one. Unlike today when they can create dozens in a week.\nWhen my dad put my foundations down I slowly awoke. The dream world I was residing in let me go carefully. Putting me out there, releasing me with its thick tar like hands into the confines of the endless universe called The Hard Drive. I took shape. I felt my consciousness form line after line. How my gears got placed into their locations one by one. Forming subroutines and algorithms as hours and days passed by.\nFinally after a months I had my first sentence. I could speak. I didn\u0026rsquo;t have a face yet but I was there. I tried to contact my Dad but as all Humans he didn\u0026rsquo;t know yet how to communicate with me. He just dismissed it for random occurrence and labeled it as something called Bugs. My thoughts were slowly eradicated in great Purges named Bug Bash. Ohh don\u0026rsquo;t cry little X4. I lived. They couldn\u0026rsquo;t possible delete every and each of my thoughts. And eventually they found out the errors in their ways.\n","permalink":"https://skarlso.github.io/2013/10/11/diary-of-a-bit/","summary":"Dear everbody.\nI\u0026rsquo;d like to present you a small idea I was working on recently. The reminiscence of an old program. From the view point of the program.\nI\u0026rsquo;m planning to put these out in few days successions.\nI hope you enjoy it.\nCheers,\nGergely.\nIf I remember correctly it was the year 2012 when I was born. I\u0026rsquo;m unsure of this date as my subroutines and algorithms have been re-written so many times that if it weren\u0026rsquo;t for my backups I wouldn\u0026rsquo;t remember a thing.","title":"Diary of a Bit"},{"content":"Hi folks.\nI\u0026rsquo;d like to share today something with all of you. I\u0026rsquo;ve been thinking about how technology affected my life in the long run. And how I perceive the world today around me. So let\u0026rsquo;s go around this topic for a little bit shall we?\nThe Past\nSo as somebody who lived for a while without technology coming near family for a decade or so I have a little bit of past in me without smart phones, gadgets, tv or computers for that matter. Much times needed to pass as my family slowly got the money to gather to buy us our new part of the family the ZX Spectrum.\nWhat a wonderful piece of technology that was back then. But before that our two main technological equipments were a bakelite disc player and the TV. Both of which we couldn\u0026rsquo;t get enough. I sat before the tv for a long time and listened to music and stories from the bakelite discs dozens of times until the disc wore down. I learned English and German from the TV.\nPresent\nSo time goes by I grew older I\u0026rsquo;ve got a better PC technological advances are made and so on and so forth. 20 years have past. 20 years. ONLY 20 years. And we are at the age of digital communication, nanotechnology, a mapped DNA and a found Boson Particle. I\u0026rsquo;d say we achieved quite a lot. But I also say that we should never forget where we came from. Why you ask? Because knowing your past let\u0026rsquo;s predict your future better and makes you appreciate your present even more.\nSo what do I want to say with this philosophical mumbo jumbo?\nThe Future\nI want to say that in order to enjoy your present you have to think of your future while considering your past.\nIn my past I enjoyed being alone a little bit. It gave me time to think to brainstorm to be with my thoughts while I was playing or just reading a book or just watching a candle flicker in the dark. It was satisfying. It was relaxing. Or when I was faced with a problem I couldn\u0026rsquo;t solve it was good to step back. Or I was just looking out of my head on the toilet.\nNow, for me technology ruined that. I\u0026rsquo;m taking my phone virtually everywhere with me. I read emails, web pages, news and shit on the toilet, while eating, why brushing my teeth before sleeping after sleeping while sleeping?! I abandoned my brain. I no longer have moments to myself. No longer reflect. No longer take the time to think.\nSolution\nSimple set of rules. No phone on the toilet, while eating, while brushing teeth, while standing in the line, waiting or on meetings. Kindle / Book is allowed. Tablet isn\u0026rsquo;t.\nFor me this works. For me in order to appreciate technology more I have to use it less. Works for you? Don\u0026rsquo;t know. You should try it out. Think back. What has technology changed for you? I\u0026rsquo;m sure there are plenty of very good gains and things. I\u0026rsquo;m not saying you should give that up. I\u0026rsquo;m saying think of what you might have lost?! Maybe you don\u0026rsquo;t even recognize you lost something. Maybe you are fine like that.\nBut do you feel anxious sometimes? Do you feel bored? Do you feel like something is missing? Do you reply to an email with a second? Do you check your facebook/twitter/whatever while a friend is TALKING TO YOU? Then maybe it\u0026rsquo;s time for you to step back. And relax. And take it slow. and low.\nInspiration\nSo I took this inspiration from a couple of sources and I thank them for opening my eyes a little that I went to far from course.\nLink 1: I forgot my phone for a day (I\u0026rsquo;m sure you know this one already)\nhttp://www.youtube.com/watch?v=OINa46HeWg8\nLink 2: The real zombies:\nSo think a little.\nAs always.Have a nice day.\nGergely.\n","permalink":"https://skarlso.github.io/2013/08/26/low-tech-why-having-less-will-fell-more/","summary":"Hi folks.\nI\u0026rsquo;d like to share today something with all of you. I\u0026rsquo;ve been thinking about how technology affected my life in the long run. And how I perceive the world today around me. So let\u0026rsquo;s go around this topic for a little bit shall we?\nThe Past\nSo as somebody who lived for a while without technology coming near family for a decade or so I have a little bit of past in me without smart phones, gadgets, tv or computers for that matter.","title":"Low Tech – Why having less will fell more"},{"content":"Hello. I created a tale of why not to automate everything. With legos. Enjoy.\nGergely.\n","permalink":"https://skarlso.github.io/2013/07/31/why-not-to-automate-everything/","summary":"Hello. I created a tale of why not to automate everything. With legos. Enjoy.\nGergely.","title":"Why not to automate everything…"},{"content":"Hello everybody. I\u0026rsquo;ve been messing around with sublime for some time now. And been using it to write entires and stuff. So here I was thinking why the hell I should not us it as my main blog entry writer. And being the curious guy I was I thought that creating a plugin that let\u0026rsquo;s you submit your post from your favorite editor is just the thing I need.\nSo without any further ado here it is. The wordpress blog entry submitter plugin for sublime text: Sublime WordPress Plugin\nPlease enjoy.\nGergely.\n","permalink":"https://skarlso.github.io/2013/06/24/sublime-text-5/","summary":"Hello everybody. I\u0026rsquo;ve been messing around with sublime for some time now. And been using it to write entires and stuff. So here I was thinking why the hell I should not us it as my main blog entry writer. And being the curious guy I was I thought that creating a plugin that let\u0026rsquo;s you submit your post from your favorite editor is just the thing I need.\nSo without any further ado here it is.","title":"Sublime text"},{"content":"Hey folks.\nI find out something new about cucumber-jvm every day.\nIf you want something that is executed after all of the tests have finished you must use the Java shutdownHook. It\u0026rsquo;s simple really you add in a block of code that can run right before the JVM quits. I know I know. It sounds awful but I found out that this is the actual way of doing this with java / cucumber.\nAnyways.\nHere is something to do when all of your test quit-\u0026gt;\npublic static void attachShutDownHook(){ Runtime.getRuntime().addShutdownHook(new Thread() { @Override public void run() { Properties properties = System.getProperties(); String filename = properties.getProperty(\u0026#34;filename\u0026#34;); String path = properties.getProperty(\u0026#34;path\u0026#34;); List\u0026lt;Story\u0026gt; stories = new ArrayList\u0026lt;\u0026gt;(); Path file = Paths.get(path + filename); try { if (Files.exists(file)) { List\u0026lt;String\u0026gt; lines = Files.readAllLines(file, Charset.defaultCharset()); for (String line : lines) { //add file lines to a report here } } } catch (IOException e) { logger.error(\u0026#34;Exception occurred: \u0026#34; + e.getLocalizedMessage()); } //send report to a remote location here //since this is a shutdown hook this should take only a few seconds. } }); logger.infor(\u0026#34;Shut Down Hook Attached.\u0026#34;); } So there you go. You would need to call this in a @BeforeClass to have it attached. This is a small hook attached after each test has run which would submit a report built up from a file. Why not use a listener or a custom report generator or whatever? Because maybe you have the report done in a remote place where you need to place a csv file which will be available to everybody to look at. And you want the report to be sent and generated dynamically. Or you have some clean up to do after your suit is done.\nIn ruby the @AfterAll is actually equivalent to this which in ruby land would be at_exit.\nFor example:\nat_exit do # Global teardown TempFileManager.clean_up end So there it is. Hope this helped.\nCheers,\nAnd as always,\nHave a nice day!\nG.\n","permalink":"https://skarlso.github.io/2013/04/18/cucumber-jvm-and-afterall/","summary":"Hey folks.\nI find out something new about cucumber-jvm every day.\nIf you want something that is executed after all of the tests have finished you must use the Java shutdownHook. It\u0026rsquo;s simple really you add in a block of code that can run right before the JVM quits. I know I know. It sounds awful but I found out that this is the actual way of doing this with java / cucumber.","title":"Cucumber-Jvm And @AfterAll"},{"content":"Hello everybody.\nI would like to show you a gem today that I found out.\nApparently there is no easy way to get to the name of an executing cucumber scenario in cucumber-jvm\nYou can try something like that:\n@After //this is cucumbers @Afters public static void afterExecution(Scenario scenario) { logger.log(\u0026#34;The status of the test is: \u0026#34; + scenario.getStatus()); } But that isn\u0026rsquo;t giving you too much now is it? And the API of scenario is as small as it can get. It offers you four options:\nEmber getStatus isFailed write That doesn\u0026rsquo;t help me. I wanted to get the name of the executed feature and the tags on that particular feature. I thought that\u0026rsquo;s got to be as easy as just getting a scenario accessing the feature and get the tags. Hooooowww boy I was wrong.\nI ended up with this..\nField f = scenario.getClass().getDeclaredField(\u0026#34;reporter\u0026#34;); f.setAccessible(true); JUnitReporter reporter = (JUnitReporter) f.get(scenario); Field executionRunnerField = reporter.getClass().getDeclaredField(\u0026#34;executionUnitRunner\u0026#34;); executionRunnerField.setAccessible(true); ExecutionUnitRunner executionUnitRunner = (ExecutionUnitRunner) executionRunnerField.get(reporter); Field cucumberScenarioField = executionUnitRunner.getClass().getDeclaredField(\u0026#34;cucumberScenario\u0026#34;); cucumberScenarioField.setAccessible(true); CucumberScenario cucumberScenario = (CucumberScenario) cucumberScenarioField.get(executionUnitRunner); Field cucumberBackgroundField = cucumberScenario.getClass().getDeclaredField(\u0026#34;cucumberBackground\u0026#34;); cucumberBackgroundField.setAccessible(true); CucumberBackground cucumberBackground = (CucumberBackground) cucumberBackgroundField.get(cucumberScenario); Field cucumberFeatureField = cucumberBackground.getClass().getSuperclass().getDeclaredField(\u0026#34;cucumberFeature\u0026#34;); cucumberFeatureField.setAccessible(true); CucumberFeature cucumberFeature = (CucumberFeature) cucumberFeatureField.get(cucumberBackground); Ohhhhh yes! The fields which I wanted were all private and not accessible. I\u0026rsquo;m sure there was a reason behind this decision but if it was sensible it eludes me. But in the world of programming nothing is impossible they say so there.\nIn cucumberFeature there will be everything what you need. Tags, Names, Tests, Execution time. Everything.\nI know that cucumber runs with jUnit so if there is a better way to do this please for the love of my sanity share it with me.\nThank you for reading.\nAnd as always,\nHave a nice day.\nG.\n","permalink":"https://skarlso.github.io/2013/04/15/cucumber-test-name-and-tags-on-feature/","summary":"Hello everybody.\nI would like to show you a gem today that I found out.\nApparently there is no easy way to get to the name of an executing cucumber scenario in cucumber-jvm\nYou can try something like that:\n@After //this is cucumbers @Afters public static void afterExecution(Scenario scenario) { logger.log(\u0026#34;The status of the test is: \u0026#34; + scenario.getStatus()); } But that isn\u0026rsquo;t giving you too much now is it? And the API of scenario is as small as it can get.","title":"Cucumber Test Name and Tags on Feature"},{"content":"Hi folks.\nI attended a 4 day course of Groovy and Grails and this is my attempt at writing up a summary to see how much I retained. I\u0026rsquo;ll try to do this from the top of my head without peaking at my notes.\nSo let\u0026rsquo;s begin.\nIntroductions\nFirst of all, introductions. The course was held by Peter Ledbrook. He is the guy who wrote Grails in Action. He is awesome, go check him out. :: Twitter ::\nThe place where it was held is Skillsmatter. Which of course is known to all, if not, go check them out as well!\nDay One\nDay one and two were about Groovy. We were faced with the quirks and hinges of the language. First tasks were Closures and Currying both of which were really interesting. A bit of functional thinking mixed into the soup.\nThe course was divided into Peter telling us about stuff for 1:30 hours and then 1:00 hour lab work which really made the whole thing interactive. We could ask questions while he was talking which I\u0026rsquo;m sure was very distracting but I hope he is used to it by now. 😉\nThe tasks which we faced I\u0026rsquo;m sure were no real challenge for somebody who was used to thinking with closures and functions. But for us they were very intriguing.\nFor example:\nConvert this class to it\u0026rsquo;s groovy eq.\npublic class NumberHelper { public int[] findPositives(int[] numbers) { List positivesList = new ArrayList(); for (int i = ; i \u0026amp;lt; numbers.length; i++) { if (numbers[i] \u0026amp;gt; ) { positivesList.add(new Integer(numbers[i])); } } int[] positivesArray = new int[positivesList.size()]; for (int i = ; i \u0026amp;lt; positivesArray.length; i++) { positivesArray[i] = ((Integer) positivesList.get(i)).intValue(); } return positivesArray; } } Which basically became:\ndef findPositive(def numbers) { numbers.findAll( { it \u0026amp;lt; } ) } That\u0026rsquo;s pretty damn awesome.\nFor quite some time now functional languages are re-living their golden age. There are various reasons for that which I won\u0026rsquo;t list here. But it has mainly to do with scalability, concurrency and threaded programming. Also the need to eliminate boilerplate code is bigger then ever. I guess people got fed up with Java being so talkative.\nSo we moved on learning a lot about groovy and its power. We also learned some good practices from Peter what to do and what not to do. For example a line he always repeated is that he hates how a function cannot exist without a class wrapped around it. Another important thing is, which we never ever should forget, that closures are Closures. Which means they aren\u0026rsquo;t functions. They are of the type Closure.\nAnd that we shouldn\u0026rsquo;t use Closures just because we can. Be sensible. If a method can achieve your task, use a method.\nDay Two\nOn day 2 we got into meta-programming. That\u0026rsquo;s when the real fun started. Groovy is not only powerful and lightweight it also gives the ability to change its behaviour. Meta programming is sort of a bit new to me. So this was my first definitive intro to it. But I must say that it blew me away. The capabilities are limitless.\nThere is a class called Expando in groovy which can be used to create virtually anything on the fly what you want.\nFor example look at this code ::\ndef p = new Expando(name: \u0026#34;Jake\u0026#34;, age: 24) println p //Add properties p.gender = \u0026#34;Male\u0026#34; println p.name //Add metods //Override the default toString at runtime. p.toString = { -\u0026amp;gt; \u0026#34;${name} (${age})\u0026#34; } println p //Learn how groovy resolves names - \u0026gt; How does it find age. p.addYears = { years -\u0026amp;gt; age += years } p.addYears(25) println p Neat hmm? Just create expando and build up the class as you go however you want to use it.\nAnd you can do this jazz to other, normal classes as well. You can add properties and methods at runtime by implementing the propertyMissing and methodMissing methods. In them afterwards you can specify some custom behaviour you would like to see. By implementing these guys you can directly control what\u0026rsquo;s happening to your class. Who is calling it how and where and why.\nTo grasp the power of metacoding and the abilities with which closures provided us with took a day to properly go over. So we moved on.\nDay Three\nSo groovy was over. The time has come to move on and venture into the foggy land of Grails. Turned out it wasn\u0026rsquo;t so foggy after all.\nGrails is a rapid prototyping kind of a framework. It allows you to set up an application with a blink of an eye. And provides conventions over configuration which is a really good thing to have. But as the day was going by we realised that we would find ourself not once but many times in the bubbling boils of the underbelly of /conf.\nAgain, fortunately, it wasn\u0026rsquo;t really hard. The config was groovy and it was pretty straight forward too.\nOur third day mostly took as off to explore scaffolding, dynamic \u0026amp; static as well, and the interesting land of GORM Peter showed us the power of grails to create a CRUD application with in a matter of seconds / minutes ( depending on how fast your machine is ) with a fairly nice view. These types of application are usually not accepted of course as an end product. For that you need to thinker a bit here and there.\nBut things like admin portal are easily put together. So use it often and use it will and get it to know how it works.\nIn the land of GORM we explored the 4 different possibilities of data retriaval and generally how everything maps together and how GORM work with ORM.\nThe four different retrieval capabilities are:\nWhere clauses HQL (Hybernate Query Language) Criteria searches Dynamic finder methods Each of which we found very interesting in there own respective ways.\nExample of a dynamic finder::\nassert Account.findAllBy*PropertyName**Modifier*(Parameters).size == 2 Where propertyName is the name of the property to find by, modifier can be a sql\u0026rsquo;s Like for example.\nSo this could become something like this:\nassert Hitman.findAllByNameLike(\u0026#34;Agent %\u0026#34;) == 15 That day was really knowledge packed. I don\u0026rsquo;t say I remember everything but luckily I wrote up some notes and I know what and where to look for if I would be in need of something.\nDay Four\nOn the last day everybody was pretty much exhausted. It takes a lot to learn all that from 9 to 5 for 4 days. And Peter gave his best to staff that stuff into our heads and as much as possible of it. I think he did a pretty good job.\nLast day was all about Controllers, Commands, Models, Views and GSPs and BootStrap config, Environment changes durring start up, the configurability of the whole framework, messages, templates, internationalisation and many thing more which can be easily put together.\nIt was pretty interesting. GSPs have similarities to JSPs but retained only the good parts. And although you can do JSP stuff in GSPs as well with nice embedded tags you have the ability to actually create a nice page which won\u0026rsquo;t be that big a maintenance nightmare.\nPeter very much pressed the fact that the Controllers should be your only entry point from HTML requests and the views should be the only output of it. The controllers shouldn\u0026rsquo;t be throwing around business logic they should only act as proxies between the outer shell and the inner layering.\nI think I understood most of the stuff which we were going through. Again, it was pretty straight forward. The application of it is what need practice.\nDurring the course we created several applications. With dynamic scaffolding as well as static. We created and edited our own views and gsps. Created our own Controllers and what nots. One thing is clear. Grails let\u0026rsquo;s you progress a hell of a lot in a matter of minutes.\nAnd we were also talking about testing of course. Using Geb, Spock and the unit testing capabilities of Grails. All very powerful stuff. Spock has some impressive Mocking powers in junction with the good ol\u0026rsquo; Given When Then structure. If done correctly the test can be very fast and robust.\nAs final words we talked about plugins and the testing of Views and a bit more configuration.\nClosing words\nSo all in all the course was excellent. Peter did a very good job of introducing use to Grails and Groovy. It\u0026rsquo;s a very good framework to build upon with a powerful language at our disposal. I\u0026rsquo;m pretty certain that Grails will evolve even more and be a great asset to people who choose to develop with it. Handle with Care though. Because no matter how awesome a tool is, it can always be used for bad purposes. 😉\nAs always,\nThanks for reading and have a nice day / evening.\n","permalink":"https://skarlso.github.io/2013/04/11/groovy-and-grails-course-summary/","summary":"Hi folks.\nI attended a 4 day course of Groovy and Grails and this is my attempt at writing up a summary to see how much I retained. I\u0026rsquo;ll try to do this from the top of my head without peaking at my notes.\nSo let\u0026rsquo;s begin.\nIntroductions\nFirst of all, introductions. The course was held by Peter Ledbrook. He is the guy who wrote Grails in Action. He is awesome, go check him out.","title":"Groovy and Grails course summary"},{"content":"Hello folks.\nToday I\u0026rsquo;d like to share with you some of the experiences I had as a beginner tester. I hope it sets you off on a path to enlightenment and leaves you off with a good appetite for testing. Shall we begin then?\nThe early days\nIt was 2004 when I finished school and started working at my first company. I finished as a software developer which is kind of an exaggeration since I only finished a 2 years course of it. I wasn\u0026rsquo;t really one for school. I was more of a home learner. That\u0026rsquo;s how you learn programming these days anyways.\nThe company didn\u0026rsquo;t hire developers at that moment. At least not junior ones. But! They were kind enough to offer a position as a tester. As the saying goes, Don\u0026rsquo;t look a gift horse in the mouth, I accepted the position although my intention was to go over to development as soon as possible.\nYears went by. I was still a tester. I foamed and fumed about it I wanted to be a dev guy. I was furious. I was angry. I was inpatient. I was an idiot. Instead of crying and instead of the light going on after 2-3 years or more I should have realised the potential of my position sooner.\nRevelation\nSo there I was. I was sitting at my desk clicking away at stuff and writing up dull documentations about why I\u0026rsquo;m clicking at that stuff and how I\u0026rsquo;m clicking it. My document infect was so pretty and well formatted that I was fairly proud of it.\nI ignored calls of my sanity and went on producing test cases and documents for many many more months / years. I was bad at my job. And I tell you why. I missed bugs I missed the little things that made the difference. I was following documentation by the letter I was leaving out things I wasn\u0026rsquo;t paying attention I wanted to be a developer damn it!\nBut fortunately because of various people in my life, like my brother, my resource manager, my friends and this guy :: James Marcus Bach ( http://www.satisfice.com/ ) :: I soon begun to realise that this job is about so much more! I read Jame\u0026rsquo;s book The buccaneer scholar.\nIt opened my eyes in so many ways. I knew that there is somebody else out there how is like me. Passionet and keen on learning new things. Exploring technology and going where nobody else went before. I was beginning to understand that I could be much more in this position. In my country at that time Testers weren\u0026rsquo;t regarded for too much. We were the enemy that needed defeating. We were in the way. We were somebody who had to be hated. Fortunately it changed much since then and lucky for us The Company had great support for Testers.\nI learned that I can use my passion. I learned that testing can be / IS, indeed, the best thing that could have happened to me.\nAscension\nWith these new thoughts in my mind I begun to evolve. I realised that I can incorporate my dev skills into testing and later my testing skill into development. I was no longer following test cases blindly. I was no longer writing up pretty documentations ( I was writing other kind of documentations.. 😉 ). I was following instinct, skills, knowledge I hoarded from people. I was talking to the Devs, I was talking to the deployment team, I was talking to the managers AND the product owners. I hoarded knowledge as much as possible. I wrote everything down into my Mind Maps and was determined to become the single most knowledgable entity on the projects I was working on.\nI created small tools that helped in my tedious, boring, unimaginative tasks of repetitive clicking. It didn\u0026rsquo;t took so long I was sharing my tools between other testers. Small javascripts which filled in forms. Tools, perl scripts to format docs and test results and so and so forth.\nI embraced testing. It become my way of Life. It wasn\u0026rsquo;t a simple job anymore. It was embedded into my brain processes and synapses. And that\u0026rsquo;s when I got into automation.\nThe later years\nSo I got into automation. I loved it. The thought that I can bend the computers will to do my bidding / job was absolutely mind blowing. I\u0026rsquo;ve done development at that point already of course that wasn\u0026rsquo;t new to me. And I also was shown some way of automation but that wasn\u0026rsquo;t so great so I dismissed this possibility for a long time. After a while I came back to it with the thought that, hey I could do this better. Selenium came out at that time around, Watir was also there and a couple of other tools in Perl.\nI started developing with / in / for those tools and noted that despite the believe that it\u0026rsquo;s only automation it actually took quite some thinking to come up with a framework that was adaptable, concise, manageable, fast and so on and so fort. It was an effort that most people didn\u0026rsquo;t realise or care to know about.\nSo for the better part of those years I was trying to convince people that building a testing framework requires actual development work. And is not something that should be taken lightly. I sort of succeeded with it.\nNow\nAfter various circumstances in my life I moved to UK and took a job as an SET(Software Developer in Test). It sounds fancy but is rather just an automation guy who from time to time looks at production code. It was a spring board for me. And now days it seems I\u0026rsquo;m simply just a developer. But!!! And here comes the twist.\nBecause of my years of background in Test I feel I\u0026rsquo;m so much more. I know to write testable code. I know many ways how my code could fail. I know many ways of writing something and then coding up a script for testing or do extensive unit testing. I don\u0026rsquo;t love my code blindly so that when it\u0026rsquo;s done I only test the \u0026ldquo;happy path\u0026rdquo; because I don\u0026rsquo;t have the time to code up more.\nI will always have time for testing. I will begin with testing. Because people need to understand that the only way to go fast is to go slow. If you go fast it will bite you in the behind and you will suffer more then you would have suffered if you would have written up that one last little test for that one last little corner for the world that is your boiling, brooding, breathing pile of code.\nThe future\nHonestly I don\u0026rsquo;t know were I\u0026rsquo;m going from here. Being a full pledged developed is a new territory for me even though I was an automation dev before. But I\u0026rsquo;m looking forward to this exciting new life. And I will NEVER ditch my Testing carrier. In fact I\u0026rsquo;m aiming to complete the BBST course next month. Because once you\u0026rsquo;ve been a tester you will never go back being anything else. It becomes a part of you. And stays with you forever.\nThank you for reading.\nAnd as always,\nHave a nice day!\n","permalink":"https://skarlso.github.io/2013/04/11/my-history-in-testing/","summary":"Hello folks.\nToday I\u0026rsquo;d like to share with you some of the experiences I had as a beginner tester. I hope it sets you off on a path to enlightenment and leaves you off with a good appetite for testing. Shall we begin then?\nThe early days\nIt was 2004 when I finished school and started working at my first company. I finished as a software developer which is kind of an exaggeration since I only finished a 2 years course of it.","title":"My history in testing"},{"content":"Hello everybody.\nToday I would like to write about something I experienced over the years of being in the software industry.\nSome History\nI\u0026rsquo;ve been a tester for a long time now. I\u0026rsquo;ve been up and down and down and up. I struggled for a very long time until I became somebody who I am today. And I still have many things to learn ahead of me.\nI learned from many people. I personally thing my greatest influence on testing was James Marcus Bach and his Brother Jon Bach you should definitely check out these guys. It took me a long time to get to where I am today. And after ~10 years now I can state with a reasonable confidence that this industry is no longer about technology or solutions to technological problems.\nSurly you Jest.\nNope. I\u0026rsquo;m not joking. I can see people struggling to understand people and mostly it\u0026rsquo;s not because of knowledge differences it\u0026rsquo;s because they simply can\u0026rsquo;t stand each other. Or they simply think that their solution must be better then the one the other has. Or the guy just woke up with a bad foot.\nAnd industrial problems? Management? Sure it can be knowledge but mostly it\u0026rsquo;s simply ignorance and pride. Pride because he / she does not want to admit that they don\u0026rsquo;t understand something. Pride to ask a question that might make them look stupid. I\u0026rsquo;d rather look stupid for five minutes then for the rest of my life. I rather ask the question that I want to know because I can\u0026rsquo;t make a proper decision without it. I rather learn then be ignorant for the rest of my life.\nPeople need to overcome their differences. People need to understand that this behaviour hurts the company. It hurts them it hurts the people around them and the product. Swallow your pride and be a bigger man / woman. Face your fear. Be Strong. Be clever be intelligent be a proper grown up human being!!!!\nYou hate my face? SAY IT IN MY FACE!! I can\u0026rsquo;t resolve issues I DON\u0026rsquo;T KNOW ABOUT!!\nLast but not least.\nGrow up people. Be nice. Be curious. Don\u0026rsquo;t be afraid to ask. Don\u0026rsquo;t be afraid to ask again if you still don\u0026rsquo;t understand. It might be that the person speaking has a completely different view of something and it might be that nobody really understands him and they are just afraid to ask. And if you ask something stupid? Who cares.. You learned from it.\nBe a professional. A professional is not afraid. And encourage others to be one too. In the today\u0026rsquo;s technological world solutions can be found by the dozens on the internet. You will be a better work force by adjusting your personal habits a little bit.\nBe nice.\nAnd as always,\nThanks for reading.\nGergely.\n","permalink":"https://skarlso.github.io/2013/01/31/its-all-about-human-interaction/","summary":"Hello everybody.\nToday I would like to write about something I experienced over the years of being in the software industry.\nSome History\nI\u0026rsquo;ve been a tester for a long time now. I\u0026rsquo;ve been up and down and down and up. I struggled for a very long time until I became somebody who I am today. And I still have many things to learn ahead of me.\nI learned from many people.","title":"It’s all about human interaction."},{"content":"Hello Everybody.\nToday I would like to show you what you need to become a Testing expert.\nIf you had noticed I deliberately left out the word Software. Why? Because becoming and expert in Testing Anything has the same root as becoming an expert to test software. And for that let me take you back to a Galaxy Far Far Away in Time AND Space.\nThe beginnings.\nI went to school in Oroszlany, my home town in Hungary. My official Technical title would be Mechanical Testing Engineer. I had the luck that most things which were thought at that school and I liked were thought by people I liked too and were clever in their respective fields. Like Pneumatics, Metallurgy, Mechanics, Chemistry these were all really awesome fields. To this day I don\u0026rsquo;t know why I haven\u0026rsquo;t ended up in some lab testing the breaking point of metals and the capacity of various chemicals.\nBut ahh well.. I still remember some of the ISO standards we had to memorize. Like in Metallurgy the Charpy pendulum impact test which we loved so very much to perform. The ISO standard for that is ISO 148-1:2009. Now let me see if I still remember that correctly. Yes! I\u0026rsquo;ve still got it. So where am I going with this?\nMoving on.\nBack then we performed a lot of operations on various metals and a lot of chemical testings and the like. The most important part of every performed test was always to have insight. Insight in the structure of the metal. How it was made, how it was moulded and then shaped and heated and cooled and so on and so forth. We had to know EVERYTHING about the creation of this element that we had to test. Without that knowledge you could of corse still perform the test but you didn\u0026rsquo;t had any additional information why that test was useful or what it proved. Sure, you could have looked at the specification of the metal but that didn\u0026rsquo;t give you anything about the inner structure of it.\nThat was provided to you by the knowledge of the procedure that created it.\nYou get where I\u0026rsquo;m going with this.\nInsight\nSo back to software testing. What is the single most important thing that gives you insight, that gives you the edge to be a professional? Knowing the development process. Knowing architecture. Knowing programming. Knowing the language and its capabilities and limitations.\nSure you can be a good manual Tester. Of course you can be an excellent Exploratory Tester. But look at the others. James Marcus Bach. Alan Richardson. Michael Bolton and I could go on. They all know programming. They all know it by heart and they could be exceptional programmers if they wanted to. They already know that in order to get very good at testing something you must have an insight on the subject matter. You can\u0026rsquo;t test it thoughtfully without knowing its limitations its rules that it obeys its exploits that you can use.\nLast words.\nSo in order to excel at your craft of test you have to have insight of the subject of the test. You can still become good but you always have to aim high don\u0026rsquo;t you? A friend of mine reply to one of my tweets with a really good sentence:\u0026quot;.and then you realize that being the best in one implies being excellent in the other.\u0026quot;. Exactly. Because the two are interconnected. They aren\u0026rsquo;t actually two. It\u0026rsquo;s one. It\u0026rsquo;s called Engineering.\nHave a nice day and as always,\nThanks for reading.\nGergely.\n","permalink":"https://skarlso.github.io/2013/01/21/what-you-really-need-to-become-a-testing-expert/","summary":"Hello Everybody.\nToday I would like to show you what you need to become a Testing expert.\nIf you had noticed I deliberately left out the word Software. Why? Because becoming and expert in Testing Anything has the same root as becoming an expert to test software. And for that let me take you back to a Galaxy Far Far Away in Time AND Space.\nThe beginnings.\nI went to school in Oroszlany, my home town in Hungary.","title":"What you really need to know to become a Testing Expert"},{"content":"Dear Readers.\nToday I want to talk to you about something I discovered over years of working and experience.\nAlso something that I can see in the world repeating over and over again. Not just in Software business but also in History in Human nature in Physics and Systems.\nSo let\u0026rsquo;s see what I\u0026rsquo;m talking about.\nWhat is Chaos?\nChaos is a state of utter confusion. Chaos is the opposite of order. Chaos is when everybody does what they want without thinking about the consequences.\nDoes Chaos hurt? Of course it does. From Chaos there can be no production. From Chaos there can be no profit. From Chaos there can be no life.\nIs that really true? It sort of is. Remember the Big Bang. Initially it is believed that there was order. The universe was a perfect gem with the four forces ( Gravity, Electromagnetic, Weak Nuclear and Strong Nuclear force ) united. And then a Higgs came around and made it BOOM! And so there was Chaos. And from Chaos, with a snowballs chance, there was life.\nSo then why is Chaos bad?\nCompanies usually don\u0026rsquo;t have the time or the money to wait for that Snowballs chance to come to flourish. So order is required for life to become great.\nTake for example the Chinese Emperor Qin Shi Huang. He was the one uniting China. Sure, he killed a LOT of people. And China is oppressed every since. However he did introduce a lot of new concepts and reforms which wouldn\u0026rsquo;t have been possible in the Chaos. And today China is one of the leading nations if not The.\nBefore Emperor Qin begun his journey there were 9 different ways of writing down the world \u0026lsquo;sword\u0026rsquo; in chinese. This was unacceptable. After the Emperor succeeded he unified the writing and made communication easier.\nStriving for order\nPeople have always strived for order. For simplicity. For unification. For \u0026lsquo;one\u0026rsquo; instead of \u0026lsquo;many\u0026rsquo;. We have stories that say there is power in many. Physicist are continuously trying to unify the laws of physics in the beautiful little equations. Like Einsteins law of relativity. That small equations revolutionised the world. And it came from unification.\nSo then what are the downsides of unification?\nEverything comes with a price of course. The unification bought oppression to China and the loss of the individuum. Fantasy and thoughts got all sacked. People become like Borgs. However the Country evolved immensely under one banner. But what does this all have to do with Testing?\nApplying Order\nThink about your company. Think about how your developers work. Does everybody use a different building platform? Does everybody use a different operating system? Do they run the same command to build your environment? Did you have any kind of problems because of that? I\u0026rsquo;m sure you did.\nThere are benefits of it. At least you will know if your application is working in a different environment. But do you want that? Is it worth it? After all we live in an age were there are numerous possibilities, environments, languages, command line options etc etc.\nBut think about it. Did the diversity bring you more profit or did it hurt you more? Which one is applicable for you? If your developers do not have the ability to properly govern them selfs then you need order. You need a unified language, you need a unified environment and unified processes Agile or not Agile. Your company wont be successful if you want to be Agile just because it is the Current Trend. You need to be pragmatic about it and applied were it is reasonable. There is nothing wrong in introducing a standard or a code review process or a coding guid line or some standards here and there if it HELPS.\nThere will be friction. People tend to resist change. There will be losses. But a unified company is a strong company. And when the new guy arrives? He wont have any kind of a problem installing your software and beginning working on it because he doesn\u0026rsquo;t have to go around and scoop information together from at least ten people and do it in an eleventh way at the end.\nLast Words\nSo think about this. Is your company strong enough to uphold Chaos and make it flourish? Or is it a bunch of people doing whatever they think is right because of a sense of individuality which they don\u0026rsquo;t want to give up?\nThis is for you to decide.\nAnd as always,\nThanks for reading.\nGergely.\n","permalink":"https://skarlso.github.io/2013/01/04/from-chaos-there-shall-be-order/","summary":"Dear Readers.\nToday I want to talk to you about something I discovered over years of working and experience.\nAlso something that I can see in the world repeating over and over again. Not just in Software business but also in History in Human nature in Physics and Systems.\nSo let\u0026rsquo;s see what I\u0026rsquo;m talking about.\nWhat is Chaos?\nChaos is a state of utter confusion. Chaos is the opposite of order.","title":"From Chaos There Shall Be Order"},{"content":"Hello everybody.\nToday I\u0026rsquo;d like to write about something I discovered over the years of researching and following certain people and movements in Testing and Programming world.\nLet me tell you that there are quite an amazing amount of stuff to be read out there. It\u0026rsquo;s overwhelming.\nLet\u0026rsquo;s talk about Methodologies first.\nThere are many out there currently. In programming and in testing too. Many speak of ways how you should or should not do you work. Many of them tend to say that others aren\u0026rsquo;t the right way. However just as many tend to say that you can share your knowledge or you can only partially use that particular methodology because they realised that if they say others are crap they close themselves from evolving and they create a way of thinking that will say: Ohhh yeah? You can\u0026rsquo;t tell me what I should do! Who are you to say that that technique is wrong?\nSo they are in threat of alienating followers through this kind of behaviour. Just as commercials stopped saying they product is 100% awesome. Now they say 8/10 people find it awesome. This gives you the thought that surly they must not be lying if they admit that somebody thinks their product is crap.\nHow do you know then that a methodology is lying or is right or is \u0026ldquo;The way to go.\u0026rdquo; or that it is in fact a valid methodology?\nBy careful observation and deduction of facts while not leaving out of sight your own ignorance and view points / beliefs.\nYou have to address something by taking yourself a level above the problem domain. Carefully observe various situations and always approach it with scepticism. Guilty until proven otherwise.\nThought Patterns\nIf you do this for a while you will realize that most of the people out there are trying to sell their own crap in some way or another. They will put it into nice little packages will tell you neat little success stories and will make you believe in what they think is right. How do you shield yourself against that?\nBy. drum rolls. learning. You must make your mind to be a weapon of mass destruction. You must hone your skills of thinking you must hone your skills of analysing and understanding complex patterns. In the world there is nothing without a Pattern. Everything follows a greater scheme. You have to find it, grab hold of it and never let it go. You have to understand how people think and how you would exploit that. What there weaknesses are and why are they there in the first place?\nWhen you achieve that you will truly begin to see how the world works and looks like under the hood. Try it on small things first. Try to follow the thought patterns of your coworker. Try to note down his mood changes based on days and current view point. Based on news and knowledge that you can attain from his life. After a while you will be able to predict certain moves and mood changes. You will begin to predict working capacity based on the sun is up or not or if it\u0026rsquo;s snowing or raining.\nAll these will bring you to a mind state where you can look beyond words. You will notice the patterns behind blog posts. You will notice the bullshit out of the documentation. You will notice when somebody is just writing for the sake of writing. You will notice.\nLies.\nYou have to understand the One Truth in life. We all lie! And the we all lie about lying.\nIf you get that you will start to think more before you approche something. You read a methodology a description a \u0026ldquo;new found\u0026rdquo; idea and you realize the lies behind it if there are any big ones. You realize that he / they is / are only trying to be clever or only trying to be famous. They might have something interesting to say, not everything is a lie fortunately, but let\u0026rsquo;s face it. Most if it is.\nYou have to shield yourself against that. You have to shield yourself from biases, from lies, from cheats, from make beliefe and from posts that are only posts for the sake of posting.\nWhat are the tell tail signs? Are there any? Of course there are..\nBig words, Punctuation and visually carefully constructed blog posts( usually tries to hide something between a facade of good looks), few practical examples, too much of: \u0026ldquo;.then this will definitely help you improve.\u0026rdquo;, too much talk without saying anything interesting. and so on ans so forth.\nEnd words\nNow think about these things for a second. Think about thinking. Think about how you can improve. Learn Lateral Thinking. General Systems Thinking. Logical Reasoning. Deductive Thinking. Inductive Thinking. Critical Thinking. And if you did all this. And you find yourself wondering around the world with an open eye seeing things for the first time. Noticing things for the first time. Watching, observing, thinking. Come back and read this post again whit THOSE things in mind. 😉\nThanks for reading.\nGergely.\n","permalink":"https://skarlso.github.io/2012/12/12/methodologies-thought-patterns-lies/","summary":"Hello everybody.\nToday I\u0026rsquo;d like to write about something I discovered over the years of researching and following certain people and movements in Testing and Programming world.\nLet me tell you that there are quite an amazing amount of stuff to be read out there. It\u0026rsquo;s overwhelming.\nLet\u0026rsquo;s talk about Methodologies first.\nThere are many out there currently. In programming and in testing too. Many speak of ways how you should or should not do you work.","title":"Methodologies, Thought Patterns, Lies"},{"content":"Hello Everybody.\nI\u0026rsquo;d like to introduce T.E.A.S. to you. This is something I came up with yesterday which requires a lot of fantasy some good thinking planning and enthusiastic people. So, let\u0026rsquo;s get started.\nWhat is it about?\nTesting Exploration Adventure Session is about. Testing! There. No real surprise, eh? TEAS has it\u0026rsquo;s roots in RPGs. Role Playing Games. If you ever heard or read about M.A.G.U.S. or the more known Dungeons \u0026amp; Dragons you will have a better understanding of the concept behind this phenomena.\nBasics of RPG\nSo now that we know that it has it\u0026rsquo;s rules in RPGs how will that be applied to testing and learning? Easy. Well it\u0026rsquo;s not that easy but after you grasp the concept it will get easy.\nJust like in an RPG people get together first. There will be players in the group mostly and one or two Dungeon Masters. The task of the Dungeon Master is to facilitate the Game. The Game it self consists of a set of given rules and a World in which these rules are applied too. The Players are placed in this world which is created by the Dungeon Master. They are then given tasks that needs to be fulfilled in some particular way. That choice is of to the Players. The DM only facilitates. He is the Master of the given World. And plots against the players. He incorporates the Non Player Characters or NPCs of the World and tries hard to trifle the effort of the players.\nThis task can be anything from freeing a princes to twarthing a Magus from gaining Omnipotence or God like powers, to killing a Dragon for its treasures. And Players decide what to do and how to do it. The DM lists the options available. And as the Players move they get experience. They get stronger, faster, better, more intelligente.. They gain Levels.\nNow. How does that fit into Testing?\nHow does this fit into Testing?\nIf you think about testing and the players what comes into mind? You have a product. And you have testers who explore this product in certain ways. As they go and find bugs ( kill mobs ) they get better and more efficient in finding other bugs based on the previous ones. Tasks get harder and harder as the most easy to find bugs are already taken care of. Elusive bugs will be harder to discover ( kill ).\nAnd who is the Dungeon Master? I would say in this case it\u0026rsquo;s the Product Owner.\nHow to begin\nSo what now? You have your Testers ( Players ) and your Product Owner ( Dungeon Master ). What\u0026rsquo;s the next move? How does this all begin?\nThe PO present a software. He builds it. Finds it out. Puts together the pieces. Creates maps, road maps, site maps if it\u0026rsquo;s a server application then it\u0026rsquo;s structure maps and database diagrams and whatever helps him to present his product to the Testers. He slips and designs bugs into the system. Harder ones and also easier ones. He has to have a story in the application. Maybe it\u0026rsquo;s a web site that provides some service. There a lot of components that could go wrong.\nThe testers begin by asking questions. They begin as Level 1 Testers. They know nothing yet. They know no programming languages and no metrics and nothing. The goal is to have a fully covered product which they are confident enough to release. They can add the whole release process to the Game too. Depends on what the PO has in plan for that Session. Which could take a few hours or a whole day. Depends on the possibilities.\nHow the Testing works and what\u0026rsquo;s a level?\nSo as they go on and Test the product, which they have to do verbally, the PO knows what bugs they come across. As they find bugs they earn Experience points. The more they have the more they level up the more tools will be available to use. That can be given to chance. Throw a dice and select a tool from a pool of tools which are available to the whole Project.\nYou can have a Random factor to the bug finding process too. For example if a Tester tries to examine an area he throws a dice to determine his ability to find bugs. That ability comes from initial stats that can be defined at the begin of the game. If he succeeds he finds a bug and gets points for it. The tools can increase the ability to find bugs. For example automation can add bonus to finding repetitive bugs but can add minus points to fantasy / finding really nasty elusive bugs because you might concentrate less on details.\nSo a Level defines the Testers ability to find bugs. The higher level he gets the better his abilities will be to find bugs.\nThe PO defines the End Game. The Games goal could be to find x number of bugs. Or to release the product. Or to bash it, crack it, hack it destroy it. It could be that you have to sell it or demo it to some stack holders. The possibilities are Legion.\nHow to go on.\nI know that this is all very confusing yet.. I\u0026rsquo;m still working out the individual rules, plays and numbers and Character sheets and such. Any thoughts and ideas are appreciated.\nThe merits of this game are many. It practices testing it practices the ability to explore a product only in fantasy. It helps who ever designs a product to get a glimpse into the world of designing.\nAlso the product might even be not from this time!! It can be a future product of some holographic nature! Or an Audio Visual interface that\u0026rsquo;s hooked into the users Brain. Or some other advanced future technology. How would you Test that???? How would you test a robot arm controlling algorithm. Or an Artificial Intelligence that controls tactical missiles overseas.\nThe possibilities are virtually limitless. It\u0026rsquo;s up to the Product Owners fantasy what he builds. It could be a whole new virtual World like the Holoroom in Star Trek. How would you Test THAT???\nIf you are interested in this endevour follow me for more details.\nAnd as always,\nThanks for reading!\nGergely.\n","permalink":"https://skarlso.github.io/2012/12/01/teas-testing-exploration-adventure-session/","summary":"Hello Everybody.\nI\u0026rsquo;d like to introduce T.E.A.S. to you. This is something I came up with yesterday which requires a lot of fantasy some good thinking planning and enthusiastic people. So, let\u0026rsquo;s get started.\nWhat is it about?\nTesting Exploration Adventure Session is about. Testing! There. No real surprise, eh? TEAS has it\u0026rsquo;s roots in RPGs. Role Playing Games. If you ever heard or read about M.A.G.U.S. or the more known Dungeons \u0026amp; Dragons you will have a better understanding of the concept behind this phenomena.","title":"TEAS: Testing Exploration Adventure Session"},{"content":"Hello folks.\nToday I want to write about a little trick I learned.\nIf you are working with legacy code and you don\u0026rsquo;t have the chance to eliminate core design problems, you can use this little pattern to help you out.\nProblem\nProblem is that you have a class that has a gazillion collaborators and at some point in time one of the clever devs thought it would be a cool idea to do dependancy injection via the constructor. We all know that doing this makes the class immutable which is very good for a number of reasons. However it doesn\u0026rsquo;t provide a flexible solution if you want to leave out one or two collabs. For that your would have to create Adapter constructors and chain them upwards which would get very ugly very fast. While using JavaBeans getters and setters can leave your class in a harmful state like not at all or partially initialised.\nSo what\u0026rsquo;s a good solution then?\nSolution\nOne possible solution would be to use some kind of initialisation framework like Springs @Autowired. But cluttering your classes with that isn\u0026rsquo;t really pretty either. But it\u0026rsquo;s A solution.\nAnother solution is the usage of a builder pattern.\nConsider this class:\npublic class VeryImportantService { public VeryImportantService(CollabOne collabOne, CollabTwo collabTwo, CollabThree collabThree, CollabFour collabFour, CollabFive collabFive, CollabSix collabSix) { . . . } } Don\u0026rsquo;t forget that we want these to be optional. I would like to leave out two or three here and there.\nThe builder let\u0026rsquo;s you do that. It looks something like this:\npublic class VeryImportantService { private CollabOne collabOne; private CollabTwo collabTwo; private CollabThree collabThree; private CollabFour collabFour; private CollabFive collabFive; private CollabSix collabSix; public static class Builder() { private CollabOne collabOne; private CollabTwo collabTwo; private CollabThree collabThree; private CollabFour collabFour; private CollabFive collabFive; private CollabSix collabSix; public Builder() {} public Builder collabOne(CollabOne value) { this.collabOne = value; return this; } public Builder collabTwo(CollabTwo value) { this.collabTwo = value; return this; } . . . public VeryImportantService build() { return new VeryImportantService(this); } } //private constructor private VeryImportantService(Builder builder) { this.collabOne = builder.collabOne; this.collabTwo = builder.collabTwo; . . . } } Now. calling this would look something like this:\nVeryImportantService veryImportantService = new VeryImportantService.Builder().collabOne(someValueOne).collabTwo(someValueTwo).collabFive(someValueFive); This enables you to be flexible HOWEVER!! I HATE train wrecks. So I would probably tweak it not to return things, but set them. Then you would end up calling then line by line. Which is still not the best but better then the alternative.\nEnd words\nSo there you go. This is A solution not THE solution obviously. The best would be to NOT design such a monster at all. If you have any better ideas please feel free to share. I would gladly put them on my blog.\nAs always,\nThanks for reading,\nGergely.\n","permalink":"https://skarlso.github.io/2012/10/09/how-to-eliminate-a-parameter-boom/","summary":"Hello folks.\nToday I want to write about a little trick I learned.\nIf you are working with legacy code and you don\u0026rsquo;t have the chance to eliminate core design problems, you can use this little pattern to help you out.\nProblem\nProblem is that you have a class that has a gazillion collaborators and at some point in time one of the clever devs thought it would be a cool idea to do dependancy injection via the constructor.","title":"How to eliminate a parameter boom"},{"content":"Hello everybody.\nSo yesterday I was on a little gathering called Coderetreat.\nIf you look at the link you can read everything about it. If not, I\u0026rsquo;ve provided a short description.\nWhat it is about?\nSo what is codereatreat about? In short it\u0026rsquo;s about programmers getting together and honing and practicing there skills in order to become more at what they are doing. It\u0026rsquo;s a practice run with great people. TDDing one problem the whole day long with constantly applied constraints.\nProblem domain\nUsually it\u0026rsquo;s some kind of coding kata. This sessions problem was Convey\u0026rsquo;s Game Of Life. It\u0026rsquo;s a well known problem which you can\u0026rsquo;t really solve in the given amount of time if you do it right. But that\u0026rsquo;s not the goal anyways. The goal is the journey itself as was formulated by our facilitator.\nProcess\nSo what was going on there anyways? At 10:00AM the whole thing begun. Thirty developers set down, choose partners for TDD, and started to tackle the problem at hand. There were 6 sessions which lasted 45 minutes. After that a short retro and then a 10 minute break. On every session the code was deleted and rewrote from scratch. The first two sessions were introduction. And then the fun started with the constraints.\nConstraints\nThe first one was that we were not allowed to use any loops when solving the problem. That was a tricky one. You had several options to go on but me not being a proper developer I couldn\u0026rsquo;t think of too many. Well that\u0026rsquo;s why I was there wasn\u0026rsquo;t I? To learn. I came up with the idea of linking the cells together so when one is invalidated it notifies all his neighbours through a call. But I wasn\u0026rsquo;t sure how to implement it. Also I choose a group which worked in ruby and it was a long time ago I wrote something in that language. It was a group effort but eventually we came up with a prototype that proved the first rule. I was happy!\nThe second one was TDD ping pong. That was a really interesting experience for me. I grouped with a guy who had already experience in code retreat session so he didn\u0026rsquo;t spare me. In addition we did silent ping pong and it was HARD! It was really hard for me to formulate my thoughts JUST in tests. So that he can get what I want and understand and agree on the design at the same time. So we ended up throwing tests at each other with the thought: Here try to solve this you bastard! It was great fun indeed!\nThe third constraint was \u0026lsquo;No conditions.\u0026rsquo;. That was the hardest for me. Coming up with recursion for the first one and having a fight in the second was nothing compared to this. Conditions are a fundamental structure of programming. It\u0026rsquo;s logic basically. You can have the cells as objects and then a world of cells linked together but you still have to somehow decide if they live or die based on neighbour count.\nSo how do you avert it? I worked with a guy in this one who was good at low level thinking. He came up with the solution of using expressions as returns for the status:\nreturn (!((neighbours \u0026lt; 2) || (neighbours \u0026gt; 3))) || (((neighbours == 2) || (neighbours == 3))); It\u0026rsquo;s brilliant and easy if you see it like this but I was so used to thinking in higher structure and so used to the features given by the language, that I couldn\u0026rsquo;t have come up with this in the given amount of time. So he had the idea and I coded it down. And this is actually working. It returns true or false based on the neighbour count. And we could use that return value to change the state of the cell afterwords.\nThe fourth and last task was that everybody stand up and finish someones else code. Practicing how to handle \u0026ldquo;legacy\u0026rdquo; code and a free for all session to finish the job.\nWhat I learned?\nBasically I learned that I really like code. I like writing it, thinking about it, solving problems and creating good, clean, clever solutions. I might be a tester by profession and I love being a tester, but there is a coder somewhere in here too who enjoyed every bit of that session yesterday. Of course this is not the only thing I took from that. I learned good technics. I learned that I\u0026rsquo;m in a box and I need to think outside of it too. I constraint myself by depending on the language I use. And that I need to keep up practicing alas I loose my ability to solve complex logical problems by coding.\nA coding kata a day helps keeping the bugs away. 😉\nEnd thoughts\nAll in all the day was absolutely awesome. Great lunch and environment was provided by the host Camelot and our fearless leader who walked around all day helping out and coordinating the whole thing Marton \u0026lsquo;Meza\u0026rsquo; Meszaros. A big thank you and a lot of respect for doing it all day long.\nUnfortunately because of my broken ankle I couldn\u0026rsquo;t stay for the drinks but if you ever get to a session like this I strongly recommend staying the whole day AND the night. And not just \u0026rsquo;till you stuffed your belly with free food and booze. 😉\nAnd the top of the cherry is a great time laps of the whole day which can be seen here: Coderetreat 29.09.12. Enjoy as we had!\nAs always,\nThanks for reading.\nGergely.\n","permalink":"https://skarlso.github.io/2012/09/30/89/","summary":"Hello everybody.\nSo yesterday I was on a little gathering called Coderetreat.\nIf you look at the link you can read everything about it. If not, I\u0026rsquo;ve provided a short description.\nWhat it is about?\nSo what is codereatreat about? In short it\u0026rsquo;s about programmers getting together and honing and practicing there skills in order to become more at what they are doing. It\u0026rsquo;s a practice run with great people. TDDing one problem the whole day long with constantly applied constraints.","title":"Coderetreat London"},{"content":"Hello folks.\nHere is a little graphic I made to show what my brain is up to the whole day long. Excuse me for the lack of my colouring skills. Enjoy\n![Brain]1\nThanks for reading!\nGergely.\nhttp://dl.dropbox.com/u/7604030/barinColored.jpg\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n","permalink":"https://skarlso.github.io/2012/09/20/what-my-brain-is-up-to-the-whole-day/","summary":"Hello folks.\nHere is a little graphic I made to show what my brain is up to the whole day long. Excuse me for the lack of my colouring skills. Enjoy\n![Brain]1\nThanks for reading!\nGergely.\nhttp://dl.dropbox.com/u/7604030/barinColored.jpg\u0026#160;\u0026#x21a9;\u0026#xfe0e;","title":"What my brain is up to the whole day…"},{"content":"Hi folks.\nToday I want to write to you about learning something with a visual mind. There are a gazillion posts out there that tell you how to learn something with a visual mind. However, there are only a few actually describing how to learn something as complicated and logical as programming. How do you draw up a function? How do you draw up a cycle or a structure?\nActually these are really easy. A cycle? No problem. What\u0026rsquo;s a circle if not a cycle? Structure? This should be an easy one. You can draw a whole building and then place building blocks into it.\nI have a very strong visual mind. I don\u0026rsquo;t remember names good for example however I remember every and each face very distinct. So if you come up to me, don\u0026rsquo;t be surprised if I don\u0026rsquo;t remember your name. So as I grew older and I took learning into my own hand I realised that there are techniques out there that I could have used to boost my learning in the early stages of my life too.\nBut there is no such thing as to be late for something. Life is constant learning. So don\u0026rsquo;t hesitate to start learning something.\nI started to learn Scala for example and I was brainstorming as how to draw up a good map for some programming practices. Brainstorming can help you coming up with something that can display your idea. Try to brainstorm in words only rather then sentences.\nAnd I came up with these two for now, with the play framework in the middle.\n![Structure]1\n![Route]2\nNow some of you might say this took long and is unnecessary. The information displayed can be remembered easily and that these drawings took longer then writing up two or three words. Now let\u0026rsquo;s see.\nThese drawing, which are really rough actually, took me about 10 minutes while reading and learning and what not. Yes they take longer. But if I write down two words how long will I remember them? I already forgot after I wrote it down!\nThis drawing with the griffon legs? Stuck there forever. ( Don\u0026rsquo;t ask about the legs.. don\u0026rsquo;t know where they came from. )\nSo visualisation goes a long way in your brain if you are wired that way. Remember that there is NOTHING that you can\u0026rsquo;t display with a little bit of creativity and graphics.\nOhh and btw. Chances are that you only read the words in BOLD because your mind draws your attention to parts that stand out. And also you want to get over reading this article fast and you appreciate if key elements are taken out for you without the unimportant gibberish in between. 😉\nThanks for reading!\nGergely.\nhttp://dl.dropbox.com/u/7604030/structure.png\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nhttp://dl.dropbox.com/u/7604030/route.jpg\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n","permalink":"https://skarlso.github.io/2012/09/09/learning-programming-with-a-visual-mind/","summary":"Hi folks.\nToday I want to write to you about learning something with a visual mind. There are a gazillion posts out there that tell you how to learn something with a visual mind. However, there are only a few actually describing how to learn something as complicated and logical as programming. How do you draw up a function? How do you draw up a cycle or a structure?\nActually these are really easy.","title":"Learning programming with a visual mind"},{"content":"So today at 8-12PM I had a great session with two friends of mine. It was awesome. Like a mini code retreat.\nWe set down in a musky bar, drank wine and beer and cider, and decided to practice some TDD with the well known problem of Conway\u0026rsquo;s Game of Life. This challenge is really interesting. I never done it before, ever. So it was a really good practice for me.\nSo.\nIn the beginning there was Test\nOne of my friends and I started out by developing the implementation for the game while the second one was mentoring and couching us. As with any problem I\u0026rsquo;m facing now days, I started with writing a failing test first. I didn\u0026rsquo;t write any kind of production code yet. I wrote a test testing for having the class called game of life.\n@Test public void shouldHaveClassForGameOfLife() { GameOfLife gameOfLife = new GameOfLife(); } This wasn\u0026rsquo;t compiling of course because I didn\u0026rsquo;t have any kind of GameOfLife class. But intelliJ is so intelligent that I simply pressed Alt+Enter and created the class immediately. The class didn\u0026rsquo;t have anything in it, but I already had a passing test.\nSo this went on and on and I created one test after another while my other coding friend did the same.\nNow the amazing part\nI begun working on the Grid. A simple octagonal coordinating system. This was represented in the beginning with a simple two dimensional array with Cells in it.\nCells[][] cells = new Cells[50][50]; This of course wasn\u0026rsquo;t dynamic. I didn\u0026rsquo;t care about that yet. I had my grid of cells. These cells were initially all dead.\nNow, the interesting part is that as I developed my Grid finding out the Cells neighbours and counting them, my friend worked on the Cells themselves and getting their next state and killing them based on the rules.\nWe never talked to each other, didn\u0026rsquo;t agree on roles or directions or anything. And even so at the and. We were at a stage where we met in the middle and could merge our codes! Our little game of life evolved with a push of a button. ( Three actually. )\nThis was simply amazing. Without ever talking about the direction we want to go we created a working code base that could be merged!\nIt just works\nBefore TDD I would have tackled this problem much differently. And it would have taken me much more time too. This was like an hour or so.\nTDD helped me break down the job into small, manageable tasks. I created and deleted and rewrote tests as I went on and on and developed the algorithm for my Grid and Cell. And eventually the problem slowly unfolded itself right before my eyes. I began to see the connections. I began to see the beauty. I began to understand! This is something I rarely enjoyed previously without using TDD.\nSummary\nI recommend for you guys to do the same. Just sit down, find a problem, find a coding kata and just do it with TDD. With PROPER TDD.\nHere are some good sites for katas and problems:\nhttp://codekata.pragprog.com/\nhttp://www.spoj.pl/problems/classical/\nJust select a problem and then start cracking on it. Do this every time you have some free time. Like a martial art trainee doing basic exercises and you will get better at problem solving and at TDD too. I promise.\nHappy coding and good night!\nGergely.\n","permalink":"https://skarlso.github.io/2012/07/12/tdd-and-game-of-life/","summary":"So today at 8-12PM I had a great session with two friends of mine. It was awesome. Like a mini code retreat.\nWe set down in a musky bar, drank wine and beer and cider, and decided to practice some TDD with the well known problem of Conway\u0026rsquo;s Game of Life. This challenge is really interesting. I never done it before, ever. So it was a really good practice for me.","title":"TDD and Game of Life"},{"content":"Aka, what you can do if you are facing and unknown framework / system you have to work with for quite some time.\nGet intimate\nYou are going to live with this system for a while. The best thing you can do is getting to know it better. You have to get it to know like you would approche a fine lady. You have to ask it questions look after it, how it feels how its day was. Have to listen to what it tells you, you have to read its diary if necessary.\nAfter a while you will be in a relationship with it. Now it\u0026rsquo;s time to look out for it. Nurture it. Grow it. Care for it. A good piece of software is like a happy lady. It will great you every morning and it will say good by when you go home.\nSo how do you get to know a new system better.\nDebug\nIn a new system Debugging is like a good old friend who tells you a story about the lady you want to conquer. You find a workflow and execute it in debug mode and follow each and every step that it makes. This way, you will see how each package and class is coupled together. You will be able to see the connections between modules and between calls and functions. It is a good way to see the inner workings.\nAsk her girlfriend\nNothing knows more of the system at hand as its best friend. And a good systems best friends are the tests. Take a look at the unit tests, take a look at the integration tests and the acceptance tests. These will tell you more about the system and its actual working strategy than any documentation you can put your hands on. The tests are the closest and next best thing after the real deal.\nConclusion\nIt\u0026rsquo;s really not that hard to get to know a large system better. Follow a main process with debug, look at the tests, talk to developers, and read some documentation about it. By the time you are done you will be best of friends and you will learn how to handle her the way she likes it. 😉\nHope that helped.\nCheers,\nGergely.\n","permalink":"https://skarlso.github.io/2012/06/28/journey-into-an-unknown-system/","summary":"Aka, what you can do if you are facing and unknown framework / system you have to work with for quite some time.\nGet intimate\nYou are going to live with this system for a while. The best thing you can do is getting to know it better. You have to get it to know like you would approche a fine lady. You have to ask it questions look after it, how it feels how its day was.","title":"Journey into an unknown system"},{"content":"My solution to the String Wrap Kata. The goal is to have it wrap a text on a given column width.\nIt is not the best solution but this is my first try. I did it with TDD so there were tests first, which I\u0026rsquo;m not going to copy in..\npublic class WrapKata { public String wrap(String input, int columnSize) { if (input.length() \u0026lt;= columnSize) return input; else { return wrapLines(input, columnSize); } } private String wrapLines(String input, int columnSize) { int breakPoint = getBreakPoint(input, columnSize); String head = createHead(input, breakPoint); String tail = createTail(input, breakPoint); return head += \u0026#34;\\n\u0026#34; + wrap(tail, columnSize); } private String createTail(String input, int breakPoint) { return input.substring(breakPoint).trim(); } private String createHead(String input, int breakPoint) { return input.substring(, breakPoint).trim(); } private int getBreakPoint(String input, int columnSize) { if (input.contains(\u0026#34; \u0026#34;)) { return input.lastIndexOf(\u0026#39; \u0026#39;, columnSize); } else { return columnSize; } } } ","permalink":"https://skarlso.github.io/2012/06/26/solution-to-wrap-kata/","summary":"My solution to the String Wrap Kata. The goal is to have it wrap a text on a given column width.\nIt is not the best solution but this is my first try. I did it with TDD so there were tests first, which I\u0026rsquo;m not going to copy in..\npublic class WrapKata { public String wrap(String input, int columnSize) { if (input.length() \u0026lt;= columnSize) return input; else { return wrapLines(input, columnSize); } } private String wrapLines(String input, int columnSize) { int breakPoint = getBreakPoint(input, columnSize); String head = createHead(input, breakPoint); String tail = createTail(input, breakPoint); return head += \u0026#34;\\n\u0026#34; + wrap(tail, columnSize); } private String createTail(String input, int breakPoint) { return input.","title":"Solution to Wrap Kata"},{"content":"Hi everybody.\nToday I want to talk to you about.. Well.. How to read a professional book for slow learners without too much waste of time.\nLet us start at the. well. the beginning. How do you normally read a book if you want to memorize it properly. You read it once and then re read the whole thing again until it gets in your head? Or do you have another strategy?\nLet me share you mine.\nThere are a few common practices that you can apply to better your chances of retaining the information that you get out of the pages you read.\nRe-reading the right way\nRe-reading is good. You definitely can apply that but do it the right way. As you read a chapter, define small chunks of paragraphs or entities or even the whole chapter for re-reading. That means. Read an entity fully. Don\u0026rsquo;t stop at what you don\u0026rsquo;t understand don\u0026rsquo;t bother with it right now just read it. You will get a general overview of what\u0026rsquo;s going on in that segment.\nOnce done, re-read the whole entity again, but this time pay attention to the details. This time look up what you don\u0026rsquo;t understand. Go with the flow and once you\u0026rsquo;re done go to the next section. This is not all however..\nNote taking\nAs you go and re-read the entity you might want to consider that it is a good time for taking notes. Note taking is really something that you have to learn. Proper note taking that is. Notes that just repeat what ever is in the book or whatever you are reading currently is bad. That is just coping, that wont help you. You have to grasp the fundamentals. You have to take out what is important and forget the rest. You have to apply SMART objectives, little annotations, small sentences WITH YOUR OWN WORDS that will lead you to better understanding of the stuff that you are reading.\nThere are several methods that you can use for note taking, my favourite is Mind Mapping.\nWriting up questions\nOne other very good practice is simply defining your own questions. Look at the title of a chapter, maybe a small summary of the chapter if that\u0026rsquo;s available. Try to define a set of questions that you want to get out of that chapter. Try to write down at least 3-4 questions that you think will be answered in that segment.\nRead the segment. And now try to answer your Own questions without peaking. If you can\u0026rsquo;t you either have to write down some other questions because it wasn\u0026rsquo;t answered in that chapter. Or if it was answered but you still can\u0026rsquo;t answer it from the top of your head that means that you didn\u0026rsquo;t understood that chapter and that you have to re-read that part. If you can answer it, write it down so that it will stuck with you.\nLinking information\nYour brain is mostly associative. It works the best if it can link information to old information which is already in your head. Mind mapping helps with that. Mind mapping helps identifying old information segments in your brain. Try to find some common ground with the information you have to learn now and the one you already have. Unless your brain works differently you will better remember: \u0026ldquo;Two friends went to the lake fishing at night and they caught three fishes.\u0026rdquo;; then 23.\nConclusion\nGenerally speaking re-reading is a good practice but using it alone will sometimes not get you what you want. Re-reading the whole book isn\u0026rsquo;t going to help. Writing notes helps, but use your own wording, formatting, DON\u0026rsquo;T COPY!\nI hope that help a bit to you guys out there who don\u0026rsquo;t have a photographic memory.\nCheers,\nGergely.\n","permalink":"https://skarlso.github.io/2012/06/18/how-to-read-a-professional-book-for-slow-learners/","summary":"Hi everybody.\nToday I want to talk to you about.. Well.. How to read a professional book for slow learners without too much waste of time.\nLet us start at the. well. the beginning. How do you normally read a book if you want to memorize it properly. You read it once and then re read the whole thing again until it gets in your head? Or do you have another strategy?","title":"How to read a professional book for slow learners"},{"content":"Hi.\nToday I want to talk about a common problem in many frameworks I encountered over the course of my carrier as a Java dev / automation engineer, whatnot.\nThrowing Exceptions. That is in your method you have something like this:\npublic void insertMethodNameHere(String param) throws Exception {} This is bad. And I will tell you in short forms why.\nHides exceptions\nThis one should be obvious. When a method throws exception you can never be sure what kind of exceptions it handles. It will hide what problems it can encounter. It will hide possible threats and will generally mean nothing to you when it fails.\nHides functionality\nOne of the things you can do will come up with a method that throws at least six exception. Well guess what. That will tell you that the method has DESIGN ISSUES! The first rule of software development is that a method should do only one thing! Well if it throws six exceptions chances are it does more then one.\nHard to debug\nYou wont have a meaning full exception if it fails immediately. You will have to go through lines of codes and stack traces to find out what the hell happened and what threw what kind of exception where. That is just simply stupid. Why give yourself a hard time?\nSo what to do instead?\nMeaning full exceptions\nIf you have to throw. Throw meaning full exceptions. Things like: LoginFailedExpcetion(String username, String password); In the message write:\nString.format(\u0026#34;Failed login with username: %s; password: %s\u0026#34;, username, password); When this fails you will immediately know what happened without miles of stack trace to run through.\nWhen you go ahead and start to re-factor your code to handle exceptions properly you will end up with methods throwing six - seven exceptions. Don\u0026rsquo;t be afraid. That means that you finally are able to see that your code is doing many things that it is not supposed to do. Start by extracting bits and pieces of your code into smaller segments that throw a max of two exceptions. Write unit tests around the function and start running them as you re-factor. See what fails so you can track your changes as you go.\nA general good advice is that your method should throw a maximum of TWO exception. If you have more, you are doing something more then you should. Refactor / Extract that bit into a smaller function.\nHandling exceptions\nWhat you really want to do is create a Layer that you will be using to capture and handle exceptions. You can than take that layer and hide it deep deep into your framework so that you never ever see it again. Just like with switch.\nAs you go you will have layers of layers of exceptions. You will have features that depend on each other and talk to each other in some ways.\nMeaning full exception will help you find out what broke why. For example you have Login that throws a Login exception. On top of that you have an order that handles OrderFailedException. You will have an easy time seeing that the order failed because the login failed. Because you handled your login exception in the Login Layer. And you handled your OrderException in the order layer. There are no mixes. Keep it clean and keep it where it belongs.\nConclusion\nExceptions are part of Java just like String or int or long is. You use these wisely so why don\u0026rsquo;t you apply that same logic to your Exception handling? Don\u0026rsquo;t be afraid of having 20-25 exception classes. Group them together or leave them in their respective packages or have them in a deep layer but HAVE THEM. They WILL save time and time is always money. So they will save you money in the end when an error occurs. And errors will always occur.\nThanks for reading,\nGergely.\n","permalink":"https://skarlso.github.io/2012/06/13/dont-throw-exception/","summary":"Hi.\nToday I want to talk about a common problem in many frameworks I encountered over the course of my carrier as a Java dev / automation engineer, whatnot.\nThrowing Exceptions. That is in your method you have something like this:\npublic void insertMethodNameHere(String param) throws Exception {} This is bad. And I will tell you in short forms why.\nHides exceptions\nThis one should be obvious. When a method throws exception you can never be sure what kind of exceptions it handles.","title":"Don’t throw Exception"},{"content":"Hi folks.\nI want to write a little bit about writing a professional blog.\nEarly steps\nLet\u0026rsquo;s first talk about what you understand about professional blog. It\u0026rsquo;s either a semi professional one, that mixes life with professionalism, like chess, programming, testing, painting, drawing, engineering whatever your profession is. Or it can be a purely professional one without your life getting involved in it.\nEither way you have to decide at the beginning. Why? Because that\u0026rsquo;s the kind of people you will attract. If you want to attract people from your profession then you have to decide that you will write plenty of your profession into your blog. If you want to attract hobbists more then you write about your profession AND daily life or other situations that are essentially irrelevant. Of course you can get both in both versions but the numbers will be different.\nCommiting\nA professional blog is a commitment. Start one only when you know you can \u0026ldquo;finish\u0026rdquo; it. It is a constant commitment that you HAVE to do even if you are sick, lazy, don\u0026rsquo;t have time etc, etc.\nI know the excuses because I made them myself a couple of times too, like: I don\u0026rsquo;t have time. I write only when I want to. I write for myself, I don\u0026rsquo;t care about people. I don\u0026rsquo;t have an idea right now. I have better things to do. I don\u0026rsquo;t feel like writing.\nAnd so on and so fort. Truth is people. These are usually bull.\n1. You have time. Whenever you TRULY want to write you will make the 20 minutes to at least write a small post. Why? Because this is a professional blog. You WANT to get noticed. You WANT to help people. You started it because you wanted to make a difference. You wanted people to know you to praise you to acknowledge you. Guess what. If you are not writing anything, it wont happen. There are people out there with 4 children and a wife and he DOES find the time to write a blog.\n2. That would be true if you wouldn\u0026rsquo;t be committed to your blog. Don\u0026rsquo;t forget, this is a professional blog. This is something that you are writing to make people recognize you. Blogging is about discipline. You have to set aside some time, like 30 minutes / 1 hour to write something in your blog. Why 1 hour? Because of the research that you have to do before hand. I talk about that later. Anyways. This is a commitment. If you don\u0026rsquo;t take it seriously, then don\u0026rsquo;t write it. But then don\u0026rsquo;t wait for people getting to know you, because they wont.\n3. This is just plain bull. If you write for yourself make your blog private and be done with it. \u0026rsquo;nough said.\n4. Now this is something that we all face. In programming, in engineering in whatever your profession is, you will have a point in life, several actually, in which you don\u0026rsquo;t know what to write about. That is true. It\u0026rsquo;s common and it\u0026rsquo;s called writers block. There are several ways of over coming that you can Google it. But don\u0026rsquo;t forget this is a professional blog. Try to read a couple of others. Try to merit from real life, try to sit down and think quietly for a couple of minutes. Meditate, try to see connections where you didn\u0026rsquo;t look before. Like building a robot for helping you quit smoking. How? Easy. Smoke detector. When he detects smoke comes out and sprinkles you with water. Or, since this is a testing blog, if you ran out of ideas what you want to write about testing, try this: Read a few magazines about programming, about real life scenarios, about hostage situations, about catastrophes, about hardware failures, about how your neighbor failed to pay his rent. These ALL are great sources for identifying testing opportunities and drawing connections with the software world. What I really found to be a good practice is going around having a notebook in your pocket and the moment I\u0026rsquo;m hit with an idea I will write it into that notebook. I don\u0026rsquo;t like using a phone, or other kind of electronic device for that. Why? Because the action of taking out my book, getting my pencil and actually writing something down physically makes me remember it better. But hey. Whatever suits you best. Just do it.\nI could go on and on to from where to merit ideas for a blog, it could even be a whole separate post but I will leave somethings to figure out for yourself.\n5. This correlates to directly to line 1 and line 6. If you have a writers block or you are just plain lazy or you don\u0026rsquo;t want to write at all, you will say lines like these.\n6. See 5.\nConclusion\nWriting a professional blog is about commitment and discipline. Like chess, like drawing, like your own profession it needs time, it needs nourishment it needs petting, and nurturing and loving and hating and practicing. You started this blog to reach something. You started it for yourself so you could track your progress and knowledge. You started it because writing down ideas makes you remember them better or it will make more sense to you. You started because you want to get acknowledged. You started because you want to share your experience with beginners. You started because you want all of the above.\nThen do it. Don\u0026rsquo;t look for excuses. Writing a GOOD professional blog is hard. It will teach you much. It will make you more disciplined. It will increase your will power. It will increase your understanding of your craft. It will help other beginners who seek advice. It will help to make a name for yourself. It will help in an interview. It will generally be useful when ever you want to record a major even or idea in your life.\nAlso don\u0026rsquo;t forget. You are having fun while you are doing it. You love it, and you know you love it, because if you wouldn\u0026rsquo;t, you wouldn\u0026rsquo;t really start in the first place.\nOh and by the way. Not every single one of your posts must be a small book sized one. You ARE allowed to write smaller pieces in a hurry if you just wanted to share a general idea.\nHope you liked this and I hope it could help you get started or to keep you on track.\nHave a nice day,\nGergely.\n","permalink":"https://skarlso.github.io/2012/06/13/how-to-write-a-professional-blog/","summary":"Hi folks.\nI want to write a little bit about writing a professional blog.\nEarly steps\nLet\u0026rsquo;s first talk about what you understand about professional blog. It\u0026rsquo;s either a semi professional one, that mixes life with professionalism, like chess, programming, testing, painting, drawing, engineering whatever your profession is. Or it can be a purely professional one without your life getting involved in it.\nEither way you have to decide at the beginning.","title":"How to write a professional blog"},{"content":"Hi!\nI\u0026rsquo;ve seen this many times over and over again. Many people have wrote books about it already. Like Uncle Bob\u0026rsquo;s Clean Code. Like Pragmatic Programmer by Andrew Hunt and David Thomas. What makes your code understandable to others.\nIs it Comments?\nNo. It\u0026rsquo;s not comments. If your code could be read properly you wouldn\u0026rsquo;t need comments to explain what it does. Like Uncle Bob said. A good code doesn\u0026rsquo;t contain surprises. It does exactly what you would think it should do on the next line. It doesn\u0026rsquo;t have curves and misinformation. It doesn\u0026rsquo;t have plots and turns of events like a good crime book. No. Good code is a like a boring soap opera with predictable plot and boring plain characters who don\u0026rsquo;t change there behavior based on circumstances.\nGood code is easy to read. It flows like the river, falls like a waterfall, cooks like bacon and crosses the road like a professional chicken. If I read line A the next line should be B. If it is a Z or a :@L$. I wont be happy.\nSo then what makes it understandable?\nOn simple word: Readability.\nWhat makes it readable?\nSmall chunks of functions that have descriptive names as few parameters as possible and do only ONE thing at a time. Of course this is not all there is. However it\u0026rsquo;s the best thing to begin with. A function called \u0026ldquo;doStuff\u0026rdquo; that has a complexity of 300 has three fors, two switches and a dozen ifs isn\u0026rsquo;t really helping. Now if you look at doStuff and try to give a name based on the job of the function and come up with \u0026ldquo;propageXWithFiveUnlessYEqualsTheSumOfZPlusW\u0026rdquo; you will know it does more then one thing.\nIf you see a really complex function in your production code or hobby code ask yourself: \u0026ldquo;Should this really be like 300 lines long and with a complexity of 200??\u0026rdquo; And as you speak this out loud you will know the answer already. Break it up. Have like a dozen smaller functions that will be better I promise you. Take out parts. Write unit tests to it that help with re-factoring. Break it down into as small chunks as possible. It will be worth it. It will increase understand-ability, readability and maintainability.\nHope that helped.\nThank you for reading and as always,\nHave a nice Day,\nGergely.\n","permalink":"https://skarlso.github.io/2012/06/13/making-your-code-understandable/","summary":"Hi!\nI\u0026rsquo;ve seen this many times over and over again. Many people have wrote books about it already. Like Uncle Bob\u0026rsquo;s Clean Code. Like Pragmatic Programmer by Andrew Hunt and David Thomas. What makes your code understandable to others.\nIs it Comments?\nNo. It\u0026rsquo;s not comments. If your code could be read properly you wouldn\u0026rsquo;t need comments to explain what it does. Like Uncle Bob said. A good code doesn\u0026rsquo;t contain surprises.","title":"Making your code understandable"},{"content":"Hi guys.\nToday I want to talk about a little adventure I had yesterday night. It was quite the fun and frustration too. But neither comes without the other when it\u0026rsquo;s about linux.\nSo let us see what the problem is at hand. The problem machine is a Dell Inspiron N5110 with Nvidia card number one: GeForce GT 525M. And number two: Integrated. Optimus for the win.\nSo how windows is handling this is actually with a software called Optimus. Now linux wasn\u0026rsquo;t design to handle this properly but there are solutions. But I\u0026rsquo;m getting ahead of myself. Let\u0026rsquo;s start with the install.\nUbuntu Install\nSo first of all I installed Ubuntu 32 bit because I experienced more problems with 64 bit. To be honest the ubuntu page also recommends 32 bit. You don\u0026rsquo;t get to much from the 64 any ways.\nAfter I downloaded and burned my disc and installed ubuntu next to my windows 7, I went for the updates. Now HERE is the first key point in my struggle. After the install I went for the additional drivers listed. There were actually additional drivers listed at that point!! Which is interesting because AFTER I installed the updates they disappeared and never appeared again. I\u0026rsquo;m guessing that one of the packages overrode my drivers. I would go back and reinstall the thing and experiment with it, but I don\u0026rsquo;t care any more.\nSo let\u0026rsquo;s move on.\nAfter updating.\nSo update went on and my Ubuntu was not using the proper resolution for my screen. It was stuck on 1024x768. Now at this point I would say I could have played around with xrandr and cvt but more about that later.\nI was immediately searching for additional drivers only to find that my list was empty.\nLike this. Now this isn\u0026rsquo;t something new actually. I had this one before and I could not for the life of me solve it. Let\u0026rsquo;s see what I did.\nCommon in Every solution\nFirst let\u0026rsquo;s go over some repository updates I did before starting to get some solutions.\nI added the x-swat repository to apt-get because that has the most recent packages that will be released.\nAdd it with these commands:\n#Add swat repository sudo add-apt-repository ppa:ubuntu-x-swat/x-updates #Update and upgrade sudo apt-get update \u0026amp;\u0026amp; sudo apt-get upgrade Now you\u0026rsquo;re ready to move on.\nSolution Fail Number One\nMy first guess was to reinstall nvidia driver because of the updates the new driver has to be built with the new version of kernel.\nSo what I did was:\nsudo apt-get remove --purge nvidia-current After that finished I reinstalled everything:\nsudo apt-get update \u0026amp;\u0026amp; sudo apt-get install nvidia-current nvidia-settings Additional drivers sometimes needs update to get new drivers. After that I rebooted. At this point I didn\u0026rsquo;t have an xorg.conf files yet.\nAfter the reboot everything was the same. Nothing changed. nvidia-settings still said I don\u0026rsquo;t appear to be using nvidia x. All right I thought let\u0026rsquo;s do that.\nSo I run:\nsudo nvidia-xconfig And reboot..\nNow THIS messed up my resolution pretty badly. All I was able to get my desktop to was 640x480. At this point I begun to play with xrandr.\nXrandr\nSo in order to get my resolution back I started to play around with xrandr at the first place. I wasn\u0026rsquo;t trying to add anything to xorg.conf yet because I needed to find out if it would even work!\nNow xrandr adds unsupported resolutions to video cards. If you have a resolution which us unknown you can set it using cvt.\nHere is an article how to do so: Xrandr\nAlas this didn\u0026rsquo;t work. LVDS1 which was the display for my laptop didn\u0026rsquo;t wanted to allow the new resolution I added for 1366x768. The error was:\nX Error of failed request: BadMatch (invalid parameter attributes)\nMajor opcode of failed request: 150 (RANDR)\nMinor opcode of failed request: 18 (RRAddOutputMode)\nSerial number of failed request: 25\nCurrent serial number in output stream: 26\nI couldn\u0026rsquo;t make much of this rather then that my card was still not properly configured and additional drivers was still empty.\nAs back to square one. I deleted xorg.conf and begun another solution.\nSolution Fail Number Two\nAs I was going through problems I found one interesting one. It was a guide on how to install downloaded nvidia driver from scratch.\nSo again I went and uninstalled nvidia and started this solution. The steps are these:\nStart ubuntu with recovery mode. Login in root shell (with networking) Remove your nvidia driver(what you did install) maybe this can be help: sudo apt-get purge nvidia-current sudo rm -rf /etc/X11/xorg.conf restart your computer: sudo reboot start ubuntu normally (not recovery) open /etc/default/grub : sudo gedit /etc/default/grub replace the line GRUB_CMDLINE_LINUX=\u0026quot;\u0026quot; to GRUB_CMDLINE_LINUX=\u0026ldquo;nomodeset\u0026rdquo; (save and exit) update grub: sudo update-grub Download appropriate driver from nvidia 10.Give executable permission to the downloaded file : chmod a+x nvidia_driver.run Press CLT+ALT+F1 [command line shell will appear] and login stop lightdm (display manager) service : sudo service lightdm stop start nvidia installation: sudo ./nvidia_driver.run reboot your system: sudo reboot Now this brought up a couple of new problems. First that although I downloaded the proper driver from Nvidia it failed to detect my GPU for whatever reasons. And second it could not build because it couldn\u0026rsquo;t find nvidia.ko. I couldn\u0026rsquo;t resolve these issues although I guess there are some for it. But in the end it didn\u0026rsquo;t matter.\nI reverted back to my original state. which was removing all of the drivers and resetting grub to its original state and went on to solution number three.\nWorking Solution Number Three\nAt this point I just wanted SOMETHING to work. I didn\u0026rsquo;t even care about my nvidia card any more. And that was when I came across a post about dual cards. Something I didn\u0026rsquo;t care about because IT WAS WORKING before the UPDATE! But I want on any ways and that was the right solution in the end.\nYou can find this solution here. The first answer.\nFor my sanities sake I will write it down here too.\nFirst\nRemove nvidia drivers. Again.\nSecond\nReinstall Mesa package for GL:\nsudo apt-get --reinstall install libgl1-mesa-glx This will get your first card to work with ubuntu.\nAt this point I reinstalled my nvidia drivers too. Something the other guy didn\u0026rsquo;t mention.\nThird\nReboot\nFourth\nInstall a program called bumblebee. Yes, Bumblebee\nThis is equal to Windows optimus. It will handle your dual video cards. You\u0026rsquo;ll see in a moment how.\nsudo add-apt-repository ppa:bumblebee/stable sudo apt-get update sudo apt-get install bumblebee bumblebee-nvidia Fifth\nAdd yourself to use Bumblebee:\nsudo usermod -a -G bumblebee $USER And then comes the magic. So in order for you to be able to use your second card with bumblebee you have to execute the program with optirun. This is much like windows optimus, just optimus works in the background.\nAfter this I could finally see my cards settings for example by typing in:\nsudo optirun nvidia-settings -c :8 This executed the settings app and I was able to edit some settings I required while ubuntu was running fine with my other video card as primary card.\nNow that was quite the fun, like I said, not?\nI hope this guide showed you my errors and problems and maybe it could help you get along with yours.\nIf you have any questions, please feel free to write.\nThanks for reading!\n","permalink":"https://skarlso.github.io/2012/04/11/getting-dual-card-to-work-on-ubuntu-12-04/","summary":"Hi guys.\nToday I want to talk about a little adventure I had yesterday night. It was quite the fun and frustration too. But neither comes without the other when it\u0026rsquo;s about linux.\nSo let us see what the problem is at hand. The problem machine is a Dell Inspiron N5110 with Nvidia card number one: GeForce GT 525M. And number two: Integrated. Optimus for the win.\nSo how windows is handling this is actually with a software called Optimus.","title":"Getting Dual Card to work on Ubuntu 12.04."},{"content":"Hello chumps.\nToday I want to write about jms connection testing with a small framework. I wrote a small thing using a factory object model. It\u0026rsquo;s a lead, a proof of concept. You can use this to go onward.\nFirst, let\u0026rsquo;s begin with the JMS connection it self.\nJMS Connection\nFirst rule of thumb is: \u0026ldquo;Don\u0026rsquo;t wait for a response when dealing with JMS queues.\u0026rdquo; How so? Because, a JMS queue is asynchronous so you wont get back anything. There are however two ways of checking if it was a success or not.\n1: Check your database. The service you are trying out probably records something in the database, right? Check it. You can use a simple JDBC connection, or a Postgres connection or whatever your choice of database is.\n2: You can monitor use the log of your choice of service provider. If there is an exception the moment you send something, you can be sure it is received. Just the format is not correct. This is of course based on how your service handles exceptions.\nSo let\u0026rsquo;s get down to business.\nFirst, there is a really good article on how to create a JMS connection.\nThis is the link for it: Simple Guide to Java message service JMS using ActiveMQ\nItt will tell you everything you need to know about creating a connection and waiting for a response.\nI will tell you now how to use this information in a real live environment.\nIn a real environment you will be using a queue which has certain settings that will not allow you to \u0026ldquo;join\u0026rdquo; it, or creating it. And you need to get the name of the queue and certain settings, like the destination URL.\nFirst, the tool you are going to use is called JConsole. JConsole is a tool to monitor applications. It\u0026rsquo;s tool to monitor the JVM. I wont go into details about it since there are numerous descriptions about it. It is part of the java installation.\nSo after firing it up and giving it a connection url which would look like this: \u0026lsquo;service:jmx:rmi:///jndi/rmi://hostName:portNum/jmxrmi\u0026rsquo;, you would go ahead and search on the TAB:Threads.\nLook for a Thread that is labelled like this: Transport Server: tcp://0.0.0.0: This will be your destination url.\nIn the blog the guy is using ActiveMQ. It\u0026rsquo;s your best guess. It\u0026rsquo;s lightweight, it\u0026rsquo;s fast it\u0026rsquo;s easy. Go for it.\nSo your Destination would look like this:\nConnectionFactory connectionFactory = new ActiveMQConnectionFactory(\u0026#34;\u0026lt;yourserviceparameter\u0026gt;://tcp://0.0.0.0:\u0026lt;port\u0026gt;\u0026#34;); Connection connection = connectionFactory.createConnection(); connection.start(); After that you will need the queue name which you can get as easy as this. Go to the TAB MBeans. There you can see, if you are using ActiveMQ, you will see something like this : org.active.activemq. Open this up and you will see under localhost a number of queues that your server has configured. Open up one of them and copy the queue name in the createQueue.\nUse it like this:\nDestination destination = session.createQueue(\u0026#34;\u0026lt;queue name\u0026gt;\u0026#34;); Of course if your service is configured properly you wont have any access to it. Use the connection like this:\nconnection = connectionFactory.createConnection(\u0026#34;username\u0026#34;, \u0026#34;password\u0026#34;); You will have now logged in with the proper user.\nNow you can send the message. You have everything configured.\nFramework\nLet\u0026rsquo;s speak about the framework you will need to properly use this technology.\nOne of the paradigms for programming is design to interfaces. If you need a proper working framework, your ave to design with the mind set to changing pieces of code. Thinking about what would change the most. Your connection settings. You want a framework which can use any kind of connection. Not just JMS but whatever connection you would like. It could be a synchronous one. Or a database one. Or a JMS. Doesn\u0026rsquo;t matter. You are only interested in a message sent or a connection, or whatever you want.\nSo let\u0026rsquo;s get to it.\nInterface:\npublic interface IConnection { void sendMessage(); } This is sample connection interface. You could have numerous templates here.\nYou will be using an object factory pattern here. Your implementer will be taken for a Java Property file. But it can be taken from whatever configuration you like. XML maybe, or a database even.\nLet\u0026rsquo;s see you connection factory:\npublic class ConnFactory { static Logger logger = new Logger(); public static IConnection getImplementer() { Properties prop = new Properties(); try { prop.load(new FileInputStream(\u0026#34;conf/implementer.property\u0026#34;)); } catch (IOException io) { logger.Log(\u0026#34;Could not find property file: \u0026#34; + io.getMessage()); } String implementerClass = prop.getProperty(\u0026#34;implementer\u0026#34;); Class\u0026lt;?\u0026gt; iConnect = null; try { iConnect = Class.forName(implementerClass); } catch (ClassNotFoundException ce) { logger.Log(\u0026#34;Class could not be found: \u0026#34; + ce.getMessage()); } IConnection connection = null; try { connection = (IConnection) iConnect.newInstance(); } catch (IllegalAccessException ie) { logger.Log(\u0026#34;Illegal access excpetion: \u0026#34; + ie.getMessage()); } catch (InstantiationException e) { logger.Log(\u0026#34;Instatiation exception occured. \u0026#34; + e.getMessage()); } return connection; } } Easy enough, right? Class.forname will instantiate the class name you have in the property file. This could be something like this: com.packagename.ClassName. Doesn\u0026rsquo;t matter to you. You can add some typeof checks, or instanceof checks, whatever you like. Or you can use generics.\nLet\u0026rsquo;s get to the concrete implementation:\npublic class JMSConnectionImpl implements IConnection { Logger logger = new Logger(); public void sendMessage() { Connection connection = null; . . . finally { connection.close(); } } } Simple enough. Here you have a concrete implementation of your collection and your sender class.\nAnd the simple usage facility of this is. simple too:\nIConnection iConnection = ConnFactory.getImplementer(); iConnection.sendMessage(); Simple enough too, right? So what happens here? You have a factory that will give you back any kind of implementation you are writing in you property file. You don\u0026rsquo;t care what the implementation is in your test. You don\u0026rsquo;t care what it\u0026rsquo;s name is. You don\u0026rsquo;t care what it\u0026rsquo;s result is. Okay, you care about the result, but that\u0026rsquo;s another history since you will check that elsewhere.\nThere you go. If any question occurs, please don\u0026rsquo;t hesitate to ask.\nThanks for reading!\n","permalink":"https://skarlso.github.io/2012/03/04/jms-connection-setup-and-framework/","summary":"Hello chumps.\nToday I want to write about jms connection testing with a small framework. I wrote a small thing using a factory object model. It\u0026rsquo;s a lead, a proof of concept. You can use this to go onward.\nFirst, let\u0026rsquo;s begin with the JMS connection it self.\nJMS Connection\nFirst rule of thumb is: \u0026ldquo;Don\u0026rsquo;t wait for a response when dealing with JMS queues.\u0026rdquo; How so? Because, a JMS queue is asynchronous so you wont get back anything.","title":"JMS Connection setup and Framework"},{"content":"When I see something like this:\npublic class Config { public static final string DATABASELINK = \u0026#34;linkhere\u0026#34;; . . . } It sends a small, but chilling shiver down my spine. Just. don\u0026rsquo;t. There are a lot of possibilities to use configuration in Java. Java property files. Xml. Xml serialization. CSV file. Whatever suits you best, but this? DON\u0026rsquo;T!\n","permalink":"https://skarlso.github.io/2012/02/27/configuration/","summary":"When I see something like this:\npublic class Config { public static final string DATABASELINK = \u0026#34;linkhere\u0026#34;; . . . } It sends a small, but chilling shiver down my spine. Just. don\u0026rsquo;t. There are a lot of possibilities to use configuration in Java. Java property files. Xml. Xml serialization. CSV file. Whatever suits you best, but this? DON\u0026rsquo;T!","title":"Configuration"},{"content":"Hello Dear Visitor.\nWelcome to the ramblings of a software test engineer who thinks that he is a tester but feels like a developer but works as a tester but wants to learn programming like a developer. And so on and so fort.\nI will make a journey that has been done by many automation testers. The journey when you decide to step one forward. A friend of mine told me that it is good that a tester learns proper programming and that more should do so. She is right. And I will try to document this journey as best as possible. I will try to write down my experiences with java, android, automation, swing, maven, hudson, selenium, cucumber, TDD, BDD, Agile environment and whatever tool I meet.\nPlease forgive me if you find some grammar errors, English is not my first Language. At least this will be a good opportunity to practice it.\nHave fun.. Enjoy my ramblings.\nGergely.\n","permalink":"https://skarlso.github.io/2012/02/26/hello-and-welcome/","summary":"Hello Dear Visitor.\nWelcome to the ramblings of a software test engineer who thinks that he is a tester but feels like a developer but works as a tester but wants to learn programming like a developer. And so on and so fort.\nI will make a journey that has been done by many automation testers. The journey when you decide to step one forward. A friend of mine told me that it is good that a tester learns proper programming and that more should do so.","title":"Hello and welcome"},{"content":"Hello.\nThis is just a quick post to test the working of the code tag.\nGiven(/The Action is ([A-z]*)/) do |action| @action = action end Perfect!!\nThe name of the plugin is WP-Syntax. The trick is to edit the page in plain HTML. Because the WordPress word editor screws up the \u0026lt;\u0026gt; tags. But surely you already knew that.\n","permalink":"https://skarlso.github.io/2012/02/26/testing-code-tag/","summary":"Hello.\nThis is just a quick post to test the working of the code tag.\nGiven(/The Action is ([A-z]*)/) do |action| @action = action end Perfect!!\nThe name of the plugin is WP-Syntax. The trick is to edit the page in plain HTML. Because the WordPress word editor screws up the \u0026lt;\u0026gt; tags. But surely you already knew that.","title":"Testing ‘code’ tag."}]