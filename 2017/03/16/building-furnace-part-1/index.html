<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Furnace - The building of an AWS CLI Tool for CloudFormation and CodeDeploy - Part 1 | Ramblings of a cloud engineer</title>
<meta name="keywords" content="">
<meta name="description" content="Other posts:
Part 2, Part 3, Part 4.
Building Furnace: Part 1
Intro
Hi folks.
This is the first part of a 4 part series which talks about the process of building a middlish sized project in Go,
with AWS. Including Unit testing and a experimental plugin feature.
The first part will talk about the AWS services used in brief and will contain a basic description for those who are not familiar
with them. The second part will talk about the Go SDK and the project structure itself, how it can be used, improved, and how it can
help in everyday life. The third part will talk about the experimental plugin system, and finally, we will tackle unit testing AWS
in Go.">
<meta name="author" content="hannibal">
<link rel="canonical" href="https://skarlso.github.io/2017/03/16/building-furnace-part-1/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css" integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://skarlso.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://skarlso.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://skarlso.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://skarlso.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://skarlso.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://skarlso.github.io/2017/03/16/building-furnace-part-1/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Furnace - The building of an AWS CLI Tool for CloudFormation and CodeDeploy - Part 1">
<meta property="og:description" content="Other posts:
Part 2, Part 3, Part 4.
Building Furnace: Part 1
Intro
Hi folks.
This is the first part of a 4 part series which talks about the process of building a middlish sized project in Go,
with AWS. Including Unit testing and a experimental plugin feature.
The first part will talk about the AWS services used in brief and will contain a basic description for those who are not familiar
with them. The second part will talk about the Go SDK and the project structure itself, how it can be used, improved, and how it can
help in everyday life. The third part will talk about the experimental plugin system, and finally, we will tackle unit testing AWS
in Go.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://skarlso.github.io/2017/03/16/building-furnace-part-1/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2017-03-16T21:49:00+01:00">
<meta property="article:modified_time" content="2017-03-16T21:49:00+01:00">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Furnace - The building of an AWS CLI Tool for CloudFormation and CodeDeploy - Part 1">
<meta name="twitter:description" content="Other posts:
Part 2, Part 3, Part 4.
Building Furnace: Part 1
Intro
Hi folks.
This is the first part of a 4 part series which talks about the process of building a middlish sized project in Go,
with AWS. Including Unit testing and a experimental plugin feature.
The first part will talk about the AWS services used in brief and will contain a basic description for those who are not familiar
with them. The second part will talk about the Go SDK and the project structure itself, how it can be used, improved, and how it can
help in everyday life. The third part will talk about the experimental plugin system, and finally, we will tackle unit testing AWS
in Go.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://skarlso.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Furnace - The building of an AWS CLI Tool for CloudFormation and CodeDeploy - Part 1",
      "item": "https://skarlso.github.io/2017/03/16/building-furnace-part-1/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Furnace - The building of an AWS CLI Tool for CloudFormation and CodeDeploy - Part 1",
  "name": "Furnace - The building of an AWS CLI Tool for CloudFormation and CodeDeploy - Part 1",
  "description": "Other posts: Part 2, Part 3, Part 4.\nBuilding Furnace: Part 1 Intro Hi folks.\nThis is the first part of a 4 part series which talks about the process of building a middlish sized project in Go, with AWS. Including Unit testing and a experimental plugin feature.\nThe first part will talk about the AWS services used in brief and will contain a basic description for those who are not familiar with them. The second part will talk about the Go SDK and the project structure itself, how it can be used, improved, and how it can help in everyday life. The third part will talk about the experimental plugin system, and finally, we will tackle unit testing AWS in Go.\n",
  "keywords": [
    
  ],
  "articleBody": "Other posts: Part 2, Part 3, Part 4.\nBuilding Furnace: Part 1 Intro Hi folks.\nThis is the first part of a 4 part series which talks about the process of building a middlish sized project in Go, with AWS. Including Unit testing and a experimental plugin feature.\nThe first part will talk about the AWS services used in brief and will contain a basic description for those who are not familiar with them. The second part will talk about the Go SDK and the project structure itself, how it can be used, improved, and how it can help in everyday life. The third part will talk about the experimental plugin system, and finally, we will tackle unit testing AWS in Go.\nLet’s begin, shall we?\nAWS CloudFormation If you haven’t yet read about, or know off, AWS’ CloudFormation service, you can either go ahead and read the Documentation or read on for a very quick summary. If you are familiar with CF, you should skip ahead to CodeDeploy section.\nCF is a service which bundles together other AWS services (for example: EC2, S3, ELB, ASG, RDS) into one, easily manageable stack. After a stack has been created, all the resources can be handled as one, located, tagged and used via CF specific console commands. It’s also possible to define any number of parameters, so a stack can actually be very versatile. A parameter can be anything, from SSH IP restriction to KeyPair names and list of tags to create or in what region the stack will be in.\nTo describe how these parts fit together, one must use a CloudFormation Template file which is either in JSON or in YAML format. A simple example looks like this:\nParameters: KeyName: Description: The EC2 Key Pair to allow SSH access to the instance Type: AWS::EC2::KeyPair::KeyName Resources: Ec2Instance: Type: AWS::EC2::Instance Properties: SecurityGroups: - Ref: InstanceSecurityGroup - MyExistingSecurityGroup KeyName: Ref: KeyName ImageId: ami-7a11e213 InstanceSecurityGroup: Type: AWS::EC2::SecurityGroup Properties: GroupDescription: Enable SSH access via port 22 SecurityGroupIngress: - IpProtocol: tcp FromPort: '22' ToPort: '22' CidrIp: 0.0.0.0/0 There are a myriad of these template samples here.\nI’m not going to explain this in too much detail. Parameters define the parameters, and resources define all the AWS services which we would like to configure. Here we can see, that we are creating an EC2 instance with a custom Security Group plus and already existing security group. ImageId is the AMI which will be used for the EC2 instance. The InstanceSecurityGroup is only defining some SSH access to the instance.\nThat is pretty much it. This can become bloated relatively quickly once, VPCs, ELBs, and ASGs come into play. And CloudFormation templates can also contain simple logical switches, like, conditions, ref for variables, maps and other shenanigans.\nFor example consider this part in the above example:\nKeyName: Ref: KeyName Here, we use the KeyName parameter as a Reference Value which will be interpolated to the real value, or the default one, as the template gets processed.\nCodeDeploy If you haven’t heard about CodeDeploy yet, please browse the relevant Documentation or follow along for a “quick” description.\nCodeDeploy just does what the name says. It deploys code. Any kind of code, as long as the deployment process is described in a file called appspec.yml. It can be easy as coping a file to a specific location or incredibly complex with builds of various kinds.\nFor a simple example look at this configuration:\nversion: 0.0 os: linux files: - source: /index.html destination: /var/www/html/ - source: /healthy.html destination: /var/www/html/ hooks: BeforeInstall: - location: scripts/install_dependencies timeout: 300 runas: root - location: scripts/clean_up timeout: 300 runas: root - location: scripts/start_server timeout: 300 runas: root ApplicationStop: - location: scripts/stop_server timeout: 300 runas: root CodeDeploy applications have hooks and life-cycle events which can be used to control the deployment process of an like, starting the WebServer; making sure files are in the right location; copying files, running configuration management software like puppet, ansible or chef; etc, etc.\nWhat can be done in an appspec.yml file is described here: Appspec Reference Documentation.\nDeployment happens in one of two ways:\nGitHub If the preferred way to deploy the application is from GitHub a commit hash must be used to identify which “version” of the application is to be deployed. For example:\nrev = \u0026codedeploy.RevisionLocation{ GitHubLocation: \u0026codedeploy.GitHubLocation{ CommitId: aws.String(\"kajdf94j0f9k309klksjdfkj\"), Repository: aws.String(\"Skarlso/furnace-codedeploy-app\"), }, RevisionType: aws.String(\"GitHub\"), } Commit Id is the hash of the latest release and repository is the full account/repository pointing to the application.\nS3 The second way is to use an S3 bucket. The bucket will contain an archived version of the application with a given extension. I’m saying given extension, because it has to be specified like this (and can be either ‘zip’, or ’tar’ or ’tgz’):\nrev = \u0026codedeploy.RevisionLocation{ S3Location: \u0026codedeploy.S3Location{ Bucket: aws.String(\"my_codedeploy_bucket\"), BundleType: aws.String(\"zip\"), Key: aws.String(\"my_awesome_app\"), Version: aws.String(\"VersionId\"), }, RevisionType: aws.String(\"S3\"), } Here, we specify the bucket name, the extension, the name of the file and an optional version id, which can be ignored.\nDeploying So how does code deploy get either of the applications to our EC2 instances? It uses an agent which is running on all of the instances that we create. In order to do this, the agent needs to be present on our instance. For linux this can be achieved with the following UserData (UserData in CF is the equivalent of a bootsrap script):\n\"UserData\" : { \"Fn::Base64\" : { \"Fn::Join\" : [ \"\\n\", [ \"#!/bin/bash -v\", \"sudo yum -y update\", \"sudo yum -y install ruby wget\", \"cd /home/ec2-user/\", \"wget https://aws-codedeploy-eu-central-1.s3.amazonaws.com/latest/install\", \"chmod +x ./install\", \"sudo ./install auto\", \"sudo service codedeploy-agent start\", ] ] } } A simple user data configuration in the CloudFormation template will make sure that every instance that we create will have the CodeDeploy agent running and waiting for instructions. This agent is self updating. Which can cause some trouble if AWS releases a broken agent. However unlikely, it can happen. Never the less, once installed, it’s no longer a concern to be bothered with.\nIt communications on HTTPS port 443.\nCodeDeploy identifies instances which need to be updated according to our preferences, by tagging the EC2 and Auto Scaling groups. Tagging happens in the CloudFormation template through the AutoScalingGroup settings like this:\n\"Tags\" : [ { \"Key\" : \"fu_stage\", \"Value\" : { \"Ref\": \"AWS::StackName\" }, \"PropagateAtLaunch\" : true } ] This will give the EC2 instance a tag called fu_stage with value equaling to the name of the stack. Once this is done, CodeDeploy looks like this:\nparams := \u0026codedeploy.CreateDeploymentInput{ ApplicationName: aws.String(appName), IgnoreApplicationStopFailures: aws.Bool(true), DeploymentGroupName: aws.String(appName + \"DeploymentGroup\"), Revision: revisionLocation(), TargetInstances: \u0026codedeploy.TargetInstances{ AutoScalingGroups: []*string{ aws.String(\"AutoScalingGroupPhysicalID\"), }, TagFilters: []*codedeploy.EC2TagFilter{ { Key: aws.String(\"fu_stage\"), Type: aws.String(\"KEY_AND_VALUE\"), Value: aws.String(config.STACKNAME), }, }, }, UpdateOutdatedInstancesOnly: aws.Bool(false), } CreateDeploymentInput is the entire parameter list that is needed in order to identify instances to deploy code to. We can see here that it looks for an AutoScalingGroup by Physical Id and the tag labeled fu_stage. Once found, it will use UpdateOutdatedInstancesOnly to determine if an instance needs to be updated or not. Set to false means, it always updates.\nFurnace Where does Furnace fit in, in all of this? Furnace provides a very easy mechanism to create, delete and push code to a CloudFormation stack using CodeDeploy, and a couple of environment properties. Furnace create will create a CloudFormation stack according to the provided template, all the while asking for the parameters defined in it for flexibility. delete will remove the stack and all affiliated resources except for the created CodeDeploy application. For that, there is delete-application. status will display information about the stack: Outputs, Parameters, Id, Name, and status. Something like this:\n2017/03/16 21:14:37 Stack state is: { Capabilities: [\"CAPABILITY_IAM\"], CreationTime: 2017-03-16 20:09:38.036 +0000 UTC, DisableRollback: false, Outputs: [{ Description: \"URL of the website\", OutputKey: \"URL\", OutputValue: \"http://FurnaceSt-ElasticL-ID.eu-central-1.elb.amazonaws.com\" }], Parameters: [ { ParameterKey: \"KeyName\", ParameterValue: \"UserKeyPair\" }, { ParameterKey: \"SSHLocation\", ParameterValue: \"0.0.0.0/0\" }, { ParameterKey: \"CodeDeployBucket\", ParameterValue: \"None\" }, { ParameterKey: \"InstanceType\", ParameterValue: \"t2.nano\" } ], StackId: \"arn:aws:cloudformation:eu-central-1:9999999999999:stack/FurnaceStack/asdfadsf-adsfa3-432d-a-fdasdf\", StackName: \"FurnaceStack\", StackStatus: \"CREATE_COMPLETE\" } ( This will later be improved to include created resources as well. )\nOnce the stack is CREATE_COMPLETE a simple push will deliver our application on each instance in the stack. We will get into more detail about how these commands are working in Part 2 of this series.\nFinal Words This is it for now.\nJoin me next time when I will talk about the AWS Go SDK and its intricacies and we will start to look at the basics of Furnace.\nAs always, Thanks for reading! Gergely.\n",
  "wordCount" : "1419",
  "inLanguage": "en",
  "datePublished": "2017-03-16T21:49:00+01:00",
  "dateModified": "2017-03-16T21:49:00+01:00",
  "author":{
    "@type": "Person",
    "name": "hannibal"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://skarlso.github.io/2017/03/16/building-furnace-part-1/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Ramblings of a cloud engineer",
    "logo": {
      "@type": "ImageObject",
      "url": "https://skarlso.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://skarlso.github.io/" accesskey="h" title="Ramblings of a cloud engineer (Alt + H)">Ramblings of a cloud engineer</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://skarlso.github.io/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://skarlso.github.io/search/" title="Search">
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://skarlso.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://skarlso.github.io/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://skarlso.github.io/">Home</a>&nbsp;»&nbsp;<a href="https://skarlso.github.io/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      Furnace - The building of an AWS CLI Tool for CloudFormation and CodeDeploy - Part 1
    </h1>
    <div class="post-meta"><span title='2017-03-16 21:49:00 +0100 +0100'>March 16, 2017</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;hannibal

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#other-posts" aria-label="Other posts:">Other posts:</a></li>
                <li>
                    <a href="#building-furnace-part-1" aria-label="Building Furnace: Part 1">Building Furnace: Part 1</a></li>
                <li>
                    <a href="#intro" aria-label="Intro">Intro</a></li>
                <li>
                    <a href="#aws" aria-label="AWS">AWS</a><ul>
                        
                <li>
                    <a href="#cloudformation" aria-label="CloudFormation">CloudFormation</a></li>
                <li>
                    <a href="#codedeploy" aria-label="CodeDeploy">CodeDeploy</a><ul>
                        
                <li>
                    <a href="#github" aria-label="GitHub">GitHub</a></li>
                <li>
                    <a href="#s3" aria-label="S3">S3</a></li>
                <li>
                    <a href="#deploying" aria-label="Deploying">Deploying</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#furnace" aria-label="Furnace">Furnace</a></li>
                <li>
                    <a href="#final-words" aria-label="Final Words">Final Words</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="other-posts">Other posts:<a hidden class="anchor" aria-hidden="true" href="#other-posts">#</a></h1>
<p><a href="https://skarlso.github.io/2017/03/19/building-furnace-part-2/">Part 2</a>, <a href="https://skarlso.github.io/2017/03/22/building-furnace-part-3/">Part 3</a>, <a href="https://skarlso.github.io/2017/04/16/building-furnace-part-4/">Part 4</a>.</p>
<h1 id="building-furnace-part-1">Building Furnace: Part 1<a hidden class="anchor" aria-hidden="true" href="#building-furnace-part-1">#</a></h1>
<h1 id="intro">Intro<a hidden class="anchor" aria-hidden="true" href="#intro">#</a></h1>
<p>Hi folks.</p>
<p>This is the first part of a 4 part series which talks about the process of building a middlish sized project in Go,
with AWS. Including Unit testing and a experimental plugin feature.</p>
<p>The first part will talk about the AWS services used in brief and will contain a basic description for those who are not familiar
with them. The second part will talk about the Go SDK and the project structure itself, how it can be used, improved, and how it can
help in everyday life. The third part will talk about the experimental plugin system, and finally, we will tackle unit testing AWS
in Go.</p>
<p>Let&rsquo;s begin, shall we?</p>
<h1 id="aws">AWS<a hidden class="anchor" aria-hidden="true" href="#aws">#</a></h1>
<h2 id="cloudformation">CloudFormation<a hidden class="anchor" aria-hidden="true" href="#cloudformation">#</a></h2>
<p>If you haven&rsquo;t yet read about, or know off, AWS&rsquo; CloudFormation service, you can either go ahead and read the <a href="https://aws.amazon.com/cloudformation/">Documentation</a>
or read on for a very quick summary. If you are familiar with CF, you should skip ahead to <a href="/2017/03/16/building-furnace-part-1/##CodeDeploy">CodeDeploy</a> section.</p>
<p>CF is a service which bundles together other AWS services (for example: EC2, S3, ELB, ASG, RDS) into one, easily manageable stack.
After a stack has been created, all the resources can be handled as one, located, tagged and used via CF specific console commands.
It&rsquo;s also possible to define any number of parameters, so a stack can actually be very versatile. A parameter can be anything, from
SSH IP restriction to KeyPair names and list of tags to create or in what region the stack will be in.</p>
<p>To describe how these parts fit together, one must use a CloudFormation Template file which is either in JSON or in
YAML format. A simple example looks like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>    <span style="color:#f92672">Parameters</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">KeyName</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">Description</span>: <span style="color:#ae81ff">The EC2 Key Pair to allow SSH access to the instance</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">Type</span>: <span style="color:#ae81ff">AWS::EC2::KeyPair::KeyName</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">Resources</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">Ec2Instance</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">Type</span>: <span style="color:#ae81ff">AWS::EC2::Instance</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">Properties</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">SecurityGroups</span>:
</span></span><span style="display:flex;"><span>          - <span style="color:#f92672">Ref</span>: <span style="color:#ae81ff">InstanceSecurityGroup</span>
</span></span><span style="display:flex;"><span>          - <span style="color:#ae81ff">MyExistingSecurityGroup</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">KeyName</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">Ref</span>: <span style="color:#ae81ff">KeyName</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">ImageId</span>: <span style="color:#ae81ff">ami-7a11e213</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">InstanceSecurityGroup</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">Type</span>: <span style="color:#ae81ff">AWS::EC2::SecurityGroup</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">Properties</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">GroupDescription</span>: <span style="color:#ae81ff">Enable SSH access via port 22</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">SecurityGroupIngress</span>:
</span></span><span style="display:flex;"><span>          - <span style="color:#f92672">IpProtocol</span>: <span style="color:#ae81ff">tcp</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">FromPort</span>: <span style="color:#e6db74">&#39;22&#39;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">ToPort</span>: <span style="color:#e6db74">&#39;22&#39;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">CidrIp</span>: <span style="color:#ae81ff">0.0.0.0</span><span style="color:#ae81ff">/0</span>
</span></span></code></pre></div><p>There are a myriad of these template samples <a href="https://aws.amazon.com/cloudformation/aws-cloudformation-templates/">here</a>.</p>
<p>I&rsquo;m not going to explain this in too much detail. Parameters define the parameters, and resources define all the AWS services which
we would like to configure. Here we can see, that we are creating an EC2 instance with a custom Security Group plus and already
existing security group. ImageId is the AMI which will be used for the EC2 instance. The InstanceSecurityGroup is only defining
some SSH access to the instance.</p>
<p>That is pretty much it. This can become bloated relatively quickly once, VPCs, ELBs, and ASGs come into play. And CloudFormation
templates can also contain simple logical switches, like, conditions, ref for variables, maps and other shenanigans.</p>
<p>For example consider this part in the above example:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>      <span style="color:#f92672">KeyName</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">Ref</span>: <span style="color:#ae81ff">KeyName</span>
</span></span></code></pre></div><p>Here, we use the <code>KeyName</code> parameter as a Reference Value which will be interpolated to the real value, or the default one, as the
template gets processed.</p>
<h2 id="codedeploy">CodeDeploy<a hidden class="anchor" aria-hidden="true" href="#codedeploy">#</a></h2>
<p>If you haven&rsquo;t heard about CodeDeploy yet, please browse the relevant <a href="http://docs.aws.amazon.com/codedeploy/latest/userguide/welcome.html">Documentation</a>
or follow along for a &ldquo;quick&rdquo; description.</p>
<p>CodeDeploy just does what the name says. It deploys code. Any kind of code, as long as the deployment process is described in a
file called <code>appspec.yml</code>. It can be easy as coping a file to a specific location or incredibly complex with builds of various
kinds.</p>
<p>For a simple example look at this configuration:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>    <span style="color:#f92672">version</span>: <span style="color:#ae81ff">0.0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">os</span>: <span style="color:#ae81ff">linux</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">files</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">source</span>: <span style="color:#ae81ff">/index.html</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">destination</span>: <span style="color:#ae81ff">/var/www/html/</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">source</span>: <span style="color:#ae81ff">/healthy.html</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">destination</span>: <span style="color:#ae81ff">/var/www/html/</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">hooks</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">BeforeInstall</span>:
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">location</span>: <span style="color:#ae81ff">scripts/install_dependencies</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">timeout</span>: <span style="color:#ae81ff">300</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">runas</span>: <span style="color:#ae81ff">root</span>
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">location</span>: <span style="color:#ae81ff">scripts/clean_up</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">timeout</span>: <span style="color:#ae81ff">300</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">runas</span>: <span style="color:#ae81ff">root</span>
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">location</span>: <span style="color:#ae81ff">scripts/start_server</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">timeout</span>: <span style="color:#ae81ff">300</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">runas</span>: <span style="color:#ae81ff">root</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">ApplicationStop</span>:
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">location</span>: <span style="color:#ae81ff">scripts/stop_server</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">timeout</span>: <span style="color:#ae81ff">300</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">runas</span>: <span style="color:#ae81ff">root</span>
</span></span></code></pre></div><p>CodeDeploy applications have hooks and life-cycle events which can be used to control the deployment process of an like, starting
the WebServer; making sure files are in the right location; copying files, running configuration management software like puppet,
ansible or chef; etc, etc.</p>
<p>What can be done in an <code>appspec.yml</code> file is described here: <a href="http://docs.aws.amazon.com/codedeploy/latest/userguide/app-spec-ref.html">Appspec Reference Documentation</a>.</p>
<p>Deployment happens in one of two ways:</p>
<h3 id="github">GitHub<a hidden class="anchor" aria-hidden="true" href="#github">#</a></h3>
<p>If the preferred way to deploy the application is from GitHub a commit hash must be used to identify which &ldquo;version&rdquo; of the
application is to be deployed. For example:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>    <span style="color:#a6e22e">rev</span> = <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">codedeploy</span>.<span style="color:#a6e22e">RevisionLocation</span>{
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">GitHubLocation</span>: <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">codedeploy</span>.<span style="color:#a6e22e">GitHubLocation</span>{
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">CommitId</span>:   <span style="color:#a6e22e">aws</span>.<span style="color:#a6e22e">String</span>(<span style="color:#e6db74">&#34;kajdf94j0f9k309klksjdfkj&#34;</span>),
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">Repository</span>: <span style="color:#a6e22e">aws</span>.<span style="color:#a6e22e">String</span>(<span style="color:#e6db74">&#34;Skarlso/furnace-codedeploy-app&#34;</span>),
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">RevisionType</span>: <span style="color:#a6e22e">aws</span>.<span style="color:#a6e22e">String</span>(<span style="color:#e6db74">&#34;GitHub&#34;</span>),
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><p>Commit Id is the hash of the latest release and repository is the full account/repository pointing to the application.</p>
<h3 id="s3">S3<a hidden class="anchor" aria-hidden="true" href="#s3">#</a></h3>
<p>The second way is to use an S3 bucket. The bucket will contain an archived version of the application with a given extension. I&rsquo;m
saying given extension, because it has to be specified like this (and can be either &lsquo;zip&rsquo;, or &rsquo;tar&rsquo; or &rsquo;tgz&rsquo;):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>    <span style="color:#a6e22e">rev</span> = <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">codedeploy</span>.<span style="color:#a6e22e">RevisionLocation</span>{
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">S3Location</span>: <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">codedeploy</span>.<span style="color:#a6e22e">S3Location</span>{
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">Bucket</span>:     <span style="color:#a6e22e">aws</span>.<span style="color:#a6e22e">String</span>(<span style="color:#e6db74">&#34;my_codedeploy_bucket&#34;</span>),
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">BundleType</span>: <span style="color:#a6e22e">aws</span>.<span style="color:#a6e22e">String</span>(<span style="color:#e6db74">&#34;zip&#34;</span>),
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">Key</span>:        <span style="color:#a6e22e">aws</span>.<span style="color:#a6e22e">String</span>(<span style="color:#e6db74">&#34;my_awesome_app&#34;</span>),
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">Version</span>:    <span style="color:#a6e22e">aws</span>.<span style="color:#a6e22e">String</span>(<span style="color:#e6db74">&#34;VersionId&#34;</span>),
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">RevisionType</span>: <span style="color:#a6e22e">aws</span>.<span style="color:#a6e22e">String</span>(<span style="color:#e6db74">&#34;S3&#34;</span>),
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><p>Here, we specify the bucket name, the extension, the name of the file and an optional version id, which can be ignored.</p>
<h3 id="deploying">Deploying<a hidden class="anchor" aria-hidden="true" href="#deploying">#</a></h3>
<p>So how does code deploy get either of the applications to our EC2 instances? It uses an agent which is running on all of the
instances that we create. In order to do this, the agent needs to be present on our instance. For linux this can be achieved with
the following UserData (UserData in CF is the equivalent of a bootsrap script):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;UserData&#34;</span> : <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Fn::Base64&#34;</span> : <span style="color:#f92672">{</span> <span style="color:#e6db74">&#34;Fn::Join&#34;</span> : <span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;\n&#34;</span>, <span style="color:#f92672">[</span>
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;#!/bin/bash -v&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;sudo yum -y update&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;sudo yum -y install ruby wget&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;cd /home/ec2-user/&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;wget https://aws-codedeploy-eu-central-1.s3.amazonaws.com/latest/install&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;chmod +x ./install&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;sudo ./install auto&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;sudo service codedeploy-agent start&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">]</span> <span style="color:#f92672">]</span> <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span></code></pre></div><p>A simple user data configuration in the CloudFormation template will make sure that every instance that we create will have the
CodeDeploy agent running and waiting for instructions. This agent is self updating. Which can cause some trouble if AWS releases a
broken agent. However unlikely, it can happen. Never the less, once installed, it&rsquo;s no longer a concern to be bothered with.</p>
<p>It communications on HTTPS port 443.</p>
<p>CodeDeploy identifies instances which need to be updated according to our preferences, by tagging the EC2 and Auto Scaling groups.
Tagging happens in the CloudFormation template through the AutoScalingGroup settings like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Tags&#34;</span> <span style="color:#960050;background-color:#1e0010">:</span> [
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;Key&#34;</span> : <span style="color:#e6db74">&#34;fu_stage&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;Value&#34;</span> : { <span style="color:#f92672">&#34;Ref&#34;</span>: <span style="color:#e6db74">&#34;AWS::StackName&#34;</span> },
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;PropagateAtLaunch&#34;</span> : <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    ]
</span></span></code></pre></div><p>This will give the EC2 instance a tag called <code>fu_stage</code> with value equaling to the name of the stack. Once this is done, CodeDeploy
looks like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>    <span style="color:#a6e22e">params</span> <span style="color:#f92672">:=</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">codedeploy</span>.<span style="color:#a6e22e">CreateDeploymentInput</span>{
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">ApplicationName</span>:               <span style="color:#a6e22e">aws</span>.<span style="color:#a6e22e">String</span>(<span style="color:#a6e22e">appName</span>),
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">IgnoreApplicationStopFailures</span>: <span style="color:#a6e22e">aws</span>.<span style="color:#a6e22e">Bool</span>(<span style="color:#66d9ef">true</span>),
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">DeploymentGroupName</span>:           <span style="color:#a6e22e">aws</span>.<span style="color:#a6e22e">String</span>(<span style="color:#a6e22e">appName</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;DeploymentGroup&#34;</span>),
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Revision</span>:                      <span style="color:#a6e22e">revisionLocation</span>(),
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">TargetInstances</span>: <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">codedeploy</span>.<span style="color:#a6e22e">TargetInstances</span>{
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">AutoScalingGroups</span>: []<span style="color:#f92672">*</span><span style="color:#66d9ef">string</span>{
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">aws</span>.<span style="color:#a6e22e">String</span>(<span style="color:#e6db74">&#34;AutoScalingGroupPhysicalID&#34;</span>),
</span></span><span style="display:flex;"><span>            },
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">TagFilters</span>: []<span style="color:#f92672">*</span><span style="color:#a6e22e">codedeploy</span>.<span style="color:#a6e22e">EC2TagFilter</span>{
</span></span><span style="display:flex;"><span>                {
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">Key</span>:   <span style="color:#a6e22e">aws</span>.<span style="color:#a6e22e">String</span>(<span style="color:#e6db74">&#34;fu_stage&#34;</span>),
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">Type</span>:  <span style="color:#a6e22e">aws</span>.<span style="color:#a6e22e">String</span>(<span style="color:#e6db74">&#34;KEY_AND_VALUE&#34;</span>),
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">Value</span>: <span style="color:#a6e22e">aws</span>.<span style="color:#a6e22e">String</span>(<span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">STACKNAME</span>),
</span></span><span style="display:flex;"><span>                },
</span></span><span style="display:flex;"><span>            },
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">UpdateOutdatedInstancesOnly</span>: <span style="color:#a6e22e">aws</span>.<span style="color:#a6e22e">Bool</span>(<span style="color:#66d9ef">false</span>),
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><p>CreateDeploymentInput is the entire parameter list that is needed in order to identify instances to deploy code to. We can see
here that it looks for an AutoScalingGroup by Physical Id and the tag labeled <code>fu_stage</code>. Once found, it will use
<code>UpdateOutdatedInstancesOnly</code> to determine if an instance needs to be updated or not. Set to false means, it always updates.</p>
<h1 id="furnace">Furnace<a hidden class="anchor" aria-hidden="true" href="#furnace">#</a></h1>
<p>Where does <a href="https://github.com/Skarlso/go-furnace">Furnace</a> fit in, in all of this? Furnace provides a very easy mechanism to create,
delete and push code to a CloudFormation stack using CodeDeploy, and a couple of environment properties. Furnace <code>create</code> will
create a CloudFormation stack according to the provided template, all the while asking for the parameters defined in it for
flexibility. <code>delete</code> will remove the stack and all affiliated resources except for the created CodeDeploy application. For that,
there is <code>delete-application</code>. <code>status</code> will display information about the stack: Outputs, Parameters, Id, Name, and status.
Something like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>    2017/03/16 21:14:37 Stack state is:  <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>      Capabilities: <span style="color:#f92672">[</span><span style="color:#e6db74">&#34;CAPABILITY_IAM&#34;</span><span style="color:#f92672">]</span>,
</span></span><span style="display:flex;"><span>      CreationTime: 2017-03-16 20:09:38.036 +0000 UTC,
</span></span><span style="display:flex;"><span>      DisableRollback: false,
</span></span><span style="display:flex;"><span>      Outputs: <span style="color:#f92672">[{</span>
</span></span><span style="display:flex;"><span>          Description: <span style="color:#e6db74">&#34;URL of the website&#34;</span>,
</span></span><span style="display:flex;"><span>          OutputKey: <span style="color:#e6db74">&#34;URL&#34;</span>,
</span></span><span style="display:flex;"><span>          OutputValue: <span style="color:#e6db74">&#34;http://FurnaceSt-ElasticL-ID.eu-central-1.elb.amazonaws.com&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}]</span>,
</span></span><span style="display:flex;"><span>      Parameters: <span style="color:#f92672">[</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>          ParameterKey: <span style="color:#e6db74">&#34;KeyName&#34;</span>,
</span></span><span style="display:flex;"><span>          ParameterValue: <span style="color:#e6db74">&#34;UserKeyPair&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>          ParameterKey: <span style="color:#e6db74">&#34;SSHLocation&#34;</span>,
</span></span><span style="display:flex;"><span>          ParameterValue: <span style="color:#e6db74">&#34;0.0.0.0/0&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>          ParameterKey: <span style="color:#e6db74">&#34;CodeDeployBucket&#34;</span>,
</span></span><span style="display:flex;"><span>          ParameterValue: <span style="color:#e6db74">&#34;None&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>          ParameterKey: <span style="color:#e6db74">&#34;InstanceType&#34;</span>,
</span></span><span style="display:flex;"><span>          ParameterValue: <span style="color:#e6db74">&#34;t2.nano&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">]</span>,
</span></span><span style="display:flex;"><span>      StackId: <span style="color:#e6db74">&#34;arn:aws:cloudformation:eu-central-1:9999999999999:stack/FurnaceStack/asdfadsf-adsfa3-432d-a-fdasdf&#34;</span>,
</span></span><span style="display:flex;"><span>      StackName: <span style="color:#e6db74">&#34;FurnaceStack&#34;</span>,
</span></span><span style="display:flex;"><span>      StackStatus: <span style="color:#e6db74">&#34;CREATE_COMPLETE&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span></code></pre></div><p>( This will later be improved to include created resources as well. )</p>
<p>Once the stack is <code>CREATE_COMPLETE</code> a simple <code>push</code> will deliver our application on each instance in the stack. We will get into
more detail about how these commands are working in Part 2 of this series.</p>
<h1 id="final-words">Final Words<a hidden class="anchor" aria-hidden="true" href="#final-words">#</a></h1>
<p>This is it for now.</p>
<p>Join me next time when I will talk about the AWS Go SDK and its intricacies and we will start to look at the basics of Furnace.</p>
<p>As always,
Thanks for reading!
Gergely.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
<nav class="paginav">
  <a class="prev" href="https://skarlso.github.io/2017/03/17/test-new-hugo/">
    <span class="title">« Prev</span>
    <br>
    <span>Testing new Hugo if posts are generated properly</span>
  </a>
  <a class="next" href="https://skarlso.github.io/2017/03/03/images-on-old-posts/">
    <span class="title">Next »</span>
    <br>
    <span>Images on older posts</span>
  </a>
</nav>

  </footer><div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "hannibalDisqus" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2024 <a href="https://skarlso.github.io/">Ramblings of a cloud engineer</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
